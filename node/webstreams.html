
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Web Streams API - Node.js - W3cubDocs</title>
  
  <meta name="description" content=" Use of this API no longer emit a runtime warning. ">
  <meta name="keywords" content="web, streams, api, node, js">
  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/node/webstreams.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-9c7b0d969c0ce639a6c01c2badcdd81667c7c66206aa3d0fccc5cb0585fb1b912dab72ea882101d18010680927514b4b77b107282db8f756fbf63301fe9c88b0.css">
  <script type="text/javascript" src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js"></script>
  <script src="/json/node.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/node/" class="_nav-link" title="" style="margin-left:0;">Node.js</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _node">
				
				
<h2 id="web-streams-api">Web Streams API
</h2> <div class="api_metadata"> <details class="changelog"><summary>History</summary> <table> <tbody>
<tr>
<th>Version</th>
<th>Changes</th>
</tr> <tr>
<td>v18.0.0</td> <td><p>Use of this API no longer emit a runtime warning.</p></td>
</tr> <tr>
<td>v16.5.0</td> <td><p><span>Added in: v16.5.0</span></p></td>
</tr> </tbody>
</table> </details> </div> 
<div class="api_stability api_stability_1">
<a href="https://nodejs.org/api/documentation.html#stability-index">Stability: 1</a> - Experimental.</div>
 <p>An implementation of the <a href="https://streams.spec.whatwg.org/">WHATWG Streams Standard</a>.</p> <section><h3 id="overview">Overview
</h3> <p>The <a href="https://streams.spec.whatwg.org/">WHATWG Streams Standard</a> (or "web streams") defines an API for handling streaming data. It is similar to the Node.js <a href="stream">Streams</a> API but emerged later and has become the "standard" API for streaming data across many JavaScript environments.</p> <p>There are three primary types of objects:</p> <ul> <li>
<code>ReadableStream</code> - Represents a source of streaming data.</li> <li>
<code>WritableStream</code> - Represents a destination for streaming data.</li> <li>
<code>TransformStream</code> - Represents an algorithm for transforming streaming data.</li> </ul> <h4 id="example-readablestream">Example <code>ReadableStream</code>
</h4> <p>This example creates a simple <code>ReadableStream</code> that pushes the current <code>performance.now()</code> timestamp once every second forever. An async iterable is used to read the data from the stream.</p> <p class="module-type">MJS modules</p>
<pre data-language="js">import {
  ReadableStream
} from 'node:stream/web';

import {
  setInterval as every
} from 'node:timers/promises';

import {
  performance
} from 'node:perf_hooks';

const SECOND = 1000;

const stream = new ReadableStream({
  async start(controller) {
    for await (const _ of every(SECOND))
      controller.enqueue(performance.now());
  }
});

for await (const value of stream)
  console.log(value);</pre>
<p class="module-type">CJS modules</p>
<pre data-language="js">const {
  ReadableStream
} = require('node:stream/web');

const {
  setInterval: every
} = require('node:timers/promises');

const {
  performance
} = require('node:perf_hooks');

const SECOND = 1000;

const stream = new ReadableStream({
  async start(controller) {
    for await (const _ of every(SECOND))
      controller.enqueue(performance.now());
  }
});

(async () =&gt; {
  for await (const value of stream)
    console.log(value);
})();</pre> </section><section><h3 id="api">API
</h3> <h4 id="class-readablestream">Class: <code>ReadableStream</code>
</h4> <div class="api_metadata"> <details class="changelog"><summary>History</summary> <table> <tbody>
<tr>
<th>Version</th>
<th>Changes</th>
</tr> <tr>
<td>v18.0.0</td> <td><p>This class is now exposed on the global object.</p></td>
</tr> <tr>
<td>v16.5.0</td> <td><p><span>Added in: v16.5.0</span></p></td>
</tr> </tbody>
</table> </details> </div> <h5 id="new-readablestreamunderlyingsource--strategy">
<code>new ReadableStream([underlyingSource [, strategy]])</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div>  <ul> <li>
<code>underlyingSource</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a> <ul> <li>
<code>start</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" class="type">&lt;Function&gt;</a> A user-defined function that is invoked immediately when the <code>ReadableStream</code> is created. <ul> <li>
<code>controller</code> <a href="webstreams#class-readablestreamdefaultcontroller" class="type">&lt;ReadableStreamDefaultController&gt;</a> | <a href="webstreams#class-readablebytestreamcontroller" class="type">&lt;ReadableByteStreamController&gt;</a>
</li> <li>Returns: <code>undefined</code> or a promise fulfilled with <code>undefined</code>.</li> </ul> </li> <li>
<code>pull</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" class="type">&lt;Function&gt;</a> A user-defined function that is called repeatedly when the <code>ReadableStream</code> internal queue is not full. The operation may be sync or async. If async, the function will not be called again until the previously returned promise is fulfilled. <ul> <li>
<code>controller</code> <a href="webstreams#class-readablestreamdefaultcontroller" class="type">&lt;ReadableStreamDefaultController&gt;</a> | <a href="webstreams#class-readablebytestreamcontroller" class="type">&lt;ReadableByteStreamController&gt;</a>
</li> <li>Returns: A promise fulfilled with <code>undefined</code>.</li> </ul> </li> <li>
<code>cancel</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" class="type">&lt;Function&gt;</a> A user-defined function that is called when the <code>ReadableStream</code> is canceled. <ul> <li>
<code>reason</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types" class="type">&lt;any&gt;</a>
</li> <li>Returns: A promise fulfilled with <code>undefined</code>.</li> </ul> </li> <li>
<code>type</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> Must be <code>'bytes'</code> or <code>undefined</code>.</li> <li>
<code>autoAllocateChunkSize</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a> Used only when <code>type</code> is equal to <code>'bytes'</code>.</li> </ul> </li> <li>
<code>strategy</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a> <ul> <li>
<code>highWaterMark</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a> The maximum internal queue size before backpressure is applied.</li> <li>
<code>size</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" class="type">&lt;Function&gt;</a> A user-defined function used to identify the size of each chunk of data. <ul> <li>
<code>chunk</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types" class="type">&lt;any&gt;</a>
</li> <li>Returns: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a>
</li> </ul> </li> </ul> </li> </ul>  <h5 id="readablestreamlocked">
<code>readableStream.locked</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>Type: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type" class="type">&lt;boolean&gt;</a> Set to <code>true</code> if there is an active reader for this <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a>.</li> </ul> <p>The <code>readableStream.locked</code> property is <code>false</code> by default, and is switched to <code>true</code> while there is an active reader consuming the stream's data.</p> <h5 id="readablestreamcancelreason">
<code>readableStream.cancel([reason])</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>
<code>reason</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types" class="type">&lt;any&gt;</a>
</li> <li>Returns: A promise fulfilled with <code>undefined</code> once cancelation has been completed.</li> </ul> <h5 id="readablestreamgetreaderoptions">
<code>readableStream.getReader([options])</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>
<code>options</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a> <ul> <li>
<code>mode</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> <code>'byob'</code> or <code>undefined</code>
</li> </ul> </li> <li>Returns: <a href="webstreams#class-readablestreamdefaultreader" class="type">&lt;ReadableStreamDefaultReader&gt;</a> | <a href="webstreams#class-readablestreambyobreader" class="type">&lt;ReadableStreamBYOBReader&gt;</a>
</li> </ul> <p class="module-type">MJS modules</p>
<pre data-language="js">import { ReadableStream } from 'node:stream/web';

const stream = new ReadableStream();

const reader = stream.getReader();

console.log(await reader.read());</pre>
<p class="module-type">CJS modules</p>
<pre data-language="js">const { ReadableStream } = require('node:stream/web');

const stream = new ReadableStream();

const reader = stream.getReader();

reader.read().then(console.log);</pre> <p>Causes the <code>readableStream.locked</code> to be <code>true</code>.</p> <h5 id="readablestreampipethroughtransform-options">
<code>readableStream.pipeThrough(transform[, options])</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>
<code>transform</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a> <ul> <li>
<code>readable</code> <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a> The <code>ReadableStream</code> to which <code>transform.writable</code> will push the potentially modified data is receives from this <code>ReadableStream</code>.</li> <li>
<code>writable</code> <a href="webstreams#class-writablestream" class="type">&lt;WritableStream&gt;</a> The <code>WritableStream</code> to which this <code>ReadableStream</code>'s data will be written.</li> </ul> </li> <li>
<code>options</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a> <ul> <li>
<code>preventAbort</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type" class="type">&lt;boolean&gt;</a> When <code>true</code>, errors in this <code>ReadableStream</code> will not cause <code>transform.writable</code> to be aborted.</li> <li>
<code>preventCancel</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type" class="type">&lt;boolean&gt;</a> When <code>true</code>, errors in the destination <code>transform.writable</code> do not cause this <code>ReadableStream</code> to be canceled.</li> <li>
<code>preventClose</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type" class="type">&lt;boolean&gt;</a> When <code>true</code>, closing this <code>ReadableStream</code> does not cause <code>transform.writable</code> to be closed.</li> <li>
<code>signal</code> <a href="globals#class-abortsignal" class="type">&lt;AbortSignal&gt;</a> Allows the transfer of data to be canceled using an <a href="globals#class-abortcontroller" class="type">&lt;AbortController&gt;</a>.</li> </ul> </li> <li>Returns: <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a> From <code>transform.readable</code>.</li> </ul> <p>Connects this <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a> to the pair of <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a> and <a href="webstreams#class-writablestream" class="type">&lt;WritableStream&gt;</a> provided in the <code>transform</code> argument such that the data from this <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a> is written in to <code>transform.writable</code>, possibly transformed, then pushed to <code>transform.readable</code>. Once the pipeline is configured, <code>transform.readable</code> is returned.</p> <p>Causes the <code>readableStream.locked</code> to be <code>true</code> while the pipe operation is active.</p> <p class="module-type">MJS modules</p>
<pre data-language="js">import {
  ReadableStream,
  TransformStream,
} from 'node:stream/web';

const stream = new ReadableStream({
  start(controller) {
    controller.enqueue('a');
  },
});

const transform = new TransformStream({
  transform(chunk, controller) {
    controller.enqueue(chunk.toUpperCase());
  }
});

const transformedStream = stream.pipeThrough(transform);

for await (const chunk of transformedStream)
  console.log(chunk);</pre>
<p class="module-type">CJS modules</p>
<pre data-language="js">const {
  ReadableStream,
  TransformStream,
} = require('node:stream/web');

const stream = new ReadableStream({
  start(controller) {
    controller.enqueue('a');
  },
});

const transform = new TransformStream({
  transform(chunk, controller) {
    controller.enqueue(chunk.toUpperCase());
  }
});

const transformedStream = stream.pipeThrough(transform);

(async () =&gt; {
  for await (const chunk of transformedStream)
    console.log(chunk);
})();</pre> <h5 id="readablestreampipetodestination-options">
<code>readableStream.pipeTo(destination, options)</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>
<code>destination</code> <a href="webstreams#class-writablestream" class="type">&lt;WritableStream&gt;</a> A <a href="webstreams#class-writablestream" class="type">&lt;WritableStream&gt;</a> to which this <code>ReadableStream</code>'s data will be written.</li> <li>
<code>options</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a> <ul> <li>
<code>preventAbort</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type" class="type">&lt;boolean&gt;</a> When <code>true</code>, errors in this <code>ReadableStream</code> will not cause <code>destination</code> to be aborted.</li> <li>
<code>preventCancel</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type" class="type">&lt;boolean&gt;</a> When <code>true</code>, errors in the <code>destination</code> will not cause this <code>ReadableStream</code> to be canceled.</li> <li>
<code>preventClose</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type" class="type">&lt;boolean&gt;</a> When <code>true</code>, closing this <code>ReadableStream</code> does not cause <code>destination</code> to be closed.</li> <li>
<code>signal</code> <a href="globals#class-abortsignal" class="type">&lt;AbortSignal&gt;</a> Allows the transfer of data to be canceled using an <a href="globals#class-abortcontroller" class="type">&lt;AbortController&gt;</a>.</li> </ul> </li> <li>Returns: A promise fulfilled with <code>undefined</code>
</li> </ul> <p>Causes the <code>readableStream.locked</code> to be <code>true</code> while the pipe operation is active.</p> <h5 id="readablestreamtee">
<code>readableStream.tee()</code>
</h5> <div class="api_metadata"> <details class="changelog"><summary>History</summary> <table> <tbody>
<tr>
<th>Version</th>
<th>Changes</th>
</tr> <tr>
<td>v18.10.0, v16.18.0</td> <td><p>Support teeing a readable byte stream.</p></td>
</tr> <tr>
<td>v16.5.0</td> <td><p><span>Added in: v16.5.0</span></p></td>
</tr> </tbody>
</table> </details> </div> <ul> <li>Returns: <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream[]&gt;</a>
</li> </ul> <p>Returns a pair of new <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a> instances to which this <code>ReadableStream</code>'s data will be forwarded. Each will receive the same data.</p> <p>Causes the <code>readableStream.locked</code> to be <code>true</code>.</p> <h5 id="readablestreamvaluesoptions">
<code>readableStream.values([options])</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>
<code>options</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a> <ul> <li>
<code>preventCancel</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type" class="type">&lt;boolean&gt;</a> When <code>true</code>, prevents the <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a> from being closed when the async iterator abruptly terminates. <strong>Default</strong>: <code>false</code>.</li> </ul> </li> </ul> <p>Creates and returns an async iterator usable for consuming this <code>ReadableStream</code>'s data.</p> <p>Causes the <code>readableStream.locked</code> to be <code>true</code> while the async iterator is active.</p> <pre data-language="js">import { Buffer } from 'node:buffer';

const stream = new ReadableStream(getSomeSource());

for await (const chunk of stream.values({ preventCancel: true }))
  console.log(Buffer.from(chunk).toString());</pre> <h5 id="async-iteration">Async Iteration
</h5> <p>The <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a> object supports the async iterator protocol using <code>for await</code> syntax.</p> <pre data-language="js">import { Buffer } from 'node:buffer';

const stream = new ReadableStream(getSomeSource());

for await (const chunk of stream)
  console.log(Buffer.from(chunk).toString());</pre> <p>The async iterator will consume the <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a> until it terminates.</p> <p>By default, if the async iterator exits early (via either a <code>break</code>, <code>return</code>, or a <code>throw</code>), the <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a> will be closed. To prevent automatic closing of the <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a>, use the <code>readableStream.values()</code> method to acquire the async iterator and set the <code>preventCancel</code> option to <code>true</code>.</p> <p>The <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a> must not be locked (that is, it must not have an existing active reader). During the async iteration, the <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a> will be locked.</p> <h5 id="transferring-with-postmessage">Transferring with <code>postMessage()</code>
</h5> <p>A <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a> instance can be transferred using a <a href="worker_threads#class-messageport" class="type">&lt;MessagePort&gt;</a>.</p> <pre data-language="js">const stream = new ReadableStream(getReadableSourceSomehow());

const { port1, port2 } = new MessageChannel();

port1.onmessage = ({ data }) =&gt; {
  data.getReader().read().then((chunk) =&gt; {
    console.log(chunk);
  });
};

port2.postMessage(stream, [stream]);</pre> <h4 id="class-readablestreamdefaultreader">Class: <code>ReadableStreamDefaultReader</code>
</h4> <div class="api_metadata"> <details class="changelog"><summary>History</summary> <table> <tbody>
<tr>
<th>Version</th>
<th>Changes</th>
</tr> <tr>
<td>v18.0.0</td> <td><p>This class is now exposed on the global object.</p></td>
</tr> <tr>
<td>v16.5.0</td> <td><p><span>Added in: v16.5.0</span></p></td>
</tr> </tbody>
</table> </details> </div> <p>By default, calling <code>readableStream.getReader()</code> with no arguments will return an instance of <code>ReadableStreamDefaultReader</code>. The default reader treats the chunks of data passed through the stream as opaque values, which allows the <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a> to work with generally any JavaScript value.</p> <h5 id="new-readablestreamdefaultreaderstream">
<code>new ReadableStreamDefaultReader(stream)</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>
<code>stream</code> <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a>
</li> </ul> <p>Creates a new <a href="webstreams#class-readablestreamdefaultreader" class="type">&lt;ReadableStreamDefaultReader&gt;</a> that is locked to the given <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a>.</p> <h5 id="readablestreamdefaultreadercancelreason">
<code>readableStreamDefaultReader.cancel([reason])</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>
<code>reason</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types" class="type">&lt;any&gt;</a>
</li> <li>Returns: A promise fulfilled with <code>undefined</code>.</li> </ul> <p>Cancels the <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a> and returns a promise that is fulfilled when the underlying stream has been canceled.</p> <h5 id="readablestreamdefaultreaderclosed">
<code>readableStreamDefaultReader.closed</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>Type: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" class="type">&lt;Promise&gt;</a> Fulfilled with <code>undefined</code> when the associated <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a> is closed or rejected if the stream errors or the reader's lock is released before the stream finishes closing.</li> </ul> <h5 id="readablestreamdefaultreaderread">
<code>readableStreamDefaultReader.read()</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>Returns: A promise fulfilled with an object: <ul> <li>
<code>value</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer" class="type">&lt;ArrayBuffer&gt;</a>
</li> <li>
<code>done</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type" class="type">&lt;boolean&gt;</a>
</li> </ul> </li> </ul> <p>Requests the next chunk of data from the underlying <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a> and returns a promise that is fulfilled with the data once it is available.</p> <h5 id="readablestreamdefaultreaderreleaselock">
<code>readableStreamDefaultReader.releaseLock()</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <p>Releases this reader's lock on the underlying <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a>.</p> <h4 id="class-readablestreambyobreader">Class: <code>ReadableStreamBYOBReader</code>
</h4> <div class="api_metadata"> <details class="changelog"><summary>History</summary> <table> <tbody>
<tr>
<th>Version</th>
<th>Changes</th>
</tr> <tr>
<td>v18.0.0</td> <td><p>This class is now exposed on the global object.</p></td>
</tr> <tr>
<td>v16.5.0</td> <td><p><span>Added in: v16.5.0</span></p></td>
</tr> </tbody>
</table> </details> </div> <p>The <code>ReadableStreamBYOBReader</code> is an alternative consumer for byte-oriented <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a>s (those that are created with <code>underlyingSource.type</code> set equal to <code>'bytes'</code> when the <code>ReadableStream</code> was created).</p> <p>The <code>BYOB</code> is short for "bring your own buffer". This is a pattern that allows for more efficient reading of byte-oriented data that avoids extraneous copying.</p> <pre data-language="js">import {
  open
} from 'node:fs/promises';

import {
  ReadableStream
} from 'node:stream/web';

import { Buffer } from 'node:buffer';

class Source {
  type = 'bytes';
  autoAllocateChunkSize = 1024;

  async start(controller) {
    this.file = await open(new URL(import.meta.url));
    this.controller = controller;
  }

  async pull(controller) {
    const view = controller.byobRequest?.view;
    const {
      bytesRead,
    } = await this.file.read({
      buffer: view,
      offset: view.byteOffset,
      length: view.byteLength
    });

    if (bytesRead === 0) {
      await this.file.close();
      this.controller.close();
    }
    controller.byobRequest.respond(bytesRead);
  }
}

const stream = new ReadableStream(new Source());

async function read(stream) {
  const reader = stream.getReader({ mode: 'byob' });

  const chunks = [];
  let result;
  do {
    result = await reader.read(Buffer.alloc(100));
    if (result.value !== undefined)
      chunks.push(Buffer.from(result.value));
  } while (!result.done);

  return Buffer.concat(chunks);
}

const data = await read(stream);
console.log(Buffer.from(data).toString());</pre> <h5 id="new-readablestreambyobreaderstream">
<code>new ReadableStreamBYOBReader(stream)</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>
<code>stream</code> <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a>
</li> </ul> <p>Creates a new <code>ReadableStreamBYOBReader</code> that is locked to the given <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a>.</p> <h5 id="readablestreambyobreadercancelreason">
<code>readableStreamBYOBReader.cancel([reason])</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>
<code>reason</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types" class="type">&lt;any&gt;</a>
</li> <li>Returns: A promise fulfilled with <code>undefined</code>.</li> </ul> <p>Cancels the <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a> and returns a promise that is fulfilled when the underlying stream has been canceled.</p> <h5 id="readablestreambyobreaderclosed">
<code>readableStreamBYOBReader.closed</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>Type: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" class="type">&lt;Promise&gt;</a> Fulfilled with <code>undefined</code> when the associated <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a> is closed or rejected if the stream errors or the reader's lock is released before the stream finishes closing.</li> </ul> <h5 id="readablestreambyobreaderreadview">
<code>readableStreamBYOBReader.read(view)</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>
<code>view</code> <a href="buffer#class-buffer" class="type">&lt;Buffer&gt;</a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray" class="type">&lt;TypedArray&gt;</a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView" class="type">&lt;DataView&gt;</a>
</li> <li>Returns: A promise fulfilled with an object: <ul> <li>
<code>value</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer" class="type">&lt;ArrayBuffer&gt;</a>
</li> <li>
<code>done</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type" class="type">&lt;boolean&gt;</a>
</li> </ul> </li> </ul> <p>Requests the next chunk of data from the underlying <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a> and returns a promise that is fulfilled with the data once it is available.</p> <p>Do not pass a pooled <a href="buffer#class-buffer" class="type">&lt;Buffer&gt;</a> object instance in to this method. Pooled <code>Buffer</code> objects are created using <code>Buffer.allocUnsafe()</code>, or <code>Buffer.from()</code>, or are often returned by various <code>node:fs</code> module callbacks. These types of <code>Buffer</code>s use a shared underlying <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer" class="type">&lt;ArrayBuffer&gt;</a> object that contains all of the data from all of the pooled <code>Buffer</code> instances. When a <code>Buffer</code>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray" class="type">&lt;TypedArray&gt;</a>, or <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView" class="type">&lt;DataView&gt;</a> is passed in to <code>readableStreamBYOBReader.read()</code>, the view's underlying <code>ArrayBuffer</code> is <em>detached</em>, invalidating all existing views that may exist on that <code>ArrayBuffer</code>. This can have disastrous consequences for your application.</p> <h5 id="readablestreambyobreaderreleaselock">
<code>readableStreamBYOBReader.releaseLock()</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <p>Releases this reader's lock on the underlying <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a>.</p> <h4 id="class-readablestreamdefaultcontroller">Class: <code>ReadableStreamDefaultController</code>
</h4> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <p>Every <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a> has a controller that is responsible for the internal state and management of the stream's queue. The <code>ReadableStreamDefaultController</code> is the default controller implementation for <code>ReadableStream</code>s that are not byte-oriented.</p> <h5 id="readablestreamdefaultcontrollerclose">
<code>readableStreamDefaultController.close()</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <p>Closes the <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a> to which this controller is associated.</p> <h5 id="readablestreamdefaultcontrollerdesiredsize">
<code>readableStreamDefaultController.desiredSize</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>Type: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a>
</li> </ul> <p>Returns the amount of data remaining to fill the <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a>'s queue.</p> <h5 id="readablestreamdefaultcontrollerenqueuechunk">
<code>readableStreamDefaultController.enqueue(chunk)</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>
<code>chunk</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types" class="type">&lt;any&gt;</a>
</li> </ul> <p>Appends a new chunk of data to the <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a>'s queue.</p> <h5 id="readablestreamdefaultcontrollererrorerror">
<code>readableStreamDefaultController.error(error)</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>
<code>error</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types" class="type">&lt;any&gt;</a>
</li> </ul> <p>Signals an error that causes the <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a> to error and close.</p> <h4 id="class-readablebytestreamcontroller">Class: <code>ReadableByteStreamController</code>
</h4> <div class="api_metadata"> <details class="changelog"><summary>History</summary> <table> <tbody>
<tr>
<th>Version</th>
<th>Changes</th>
</tr> <tr>
<td>v18.10.0</td> <td><p>Support handling a BYOB pull request from a released reader.</p></td>
</tr> <tr>
<td>v16.5.0</td> <td><p><span>Added in: v16.5.0</span></p></td>
</tr> </tbody>
</table> </details> </div> <p>Every <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a> has a controller that is responsible for the internal state and management of the stream's queue. The <code>ReadableByteStreamController</code> is for byte-oriented <code>ReadableStream</code>s.</p> <h5 id="readablebytestreamcontrollerbyobrequest">
<code>readableByteStreamController.byobRequest</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>Type: <a href="webstreams#class-readablestreambyobrequest" class="type">&lt;ReadableStreamBYOBRequest&gt;</a>
</li> </ul> <h5 id="readablebytestreamcontrollerclose">
<code>readableByteStreamController.close()</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <p>Closes the <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a> to which this controller is associated.</p> <h5 id="readablebytestreamcontrollerdesiredsize">
<code>readableByteStreamController.desiredSize</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>Type: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a>
</li> </ul> <p>Returns the amount of data remaining to fill the <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a>'s queue.</p> <h5 id="readablebytestreamcontrollerenqueuechunk">
<code>readableByteStreamController.enqueue(chunk)</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>
<code>chunk</code>: <a href="buffer#class-buffer" class="type">&lt;Buffer&gt;</a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray" class="type">&lt;TypedArray&gt;</a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView" class="type">&lt;DataView&gt;</a>
</li> </ul> <p>Appends a new chunk of data to the <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a>'s queue.</p> <h5 id="readablebytestreamcontrollererrorerror">
<code>readableByteStreamController.error(error)</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>
<code>error</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types" class="type">&lt;any&gt;</a>
</li> </ul> <p>Signals an error that causes the <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a> to error and close.</p> <h4 id="class-readablestreambyobrequest">Class: <code>ReadableStreamBYOBRequest</code>
</h4> <div class="api_metadata"> <details class="changelog"><summary>History</summary> <table> <tbody>
<tr>
<th>Version</th>
<th>Changes</th>
</tr> <tr>
<td>v18.0.0</td> <td><p>This class is now exposed on the global object.</p></td>
</tr> <tr>
<td>v16.5.0</td> <td><p><span>Added in: v16.5.0</span></p></td>
</tr> </tbody>
</table> </details> </div> <p>When using <code>ReadableByteStreamController</code> in byte-oriented streams, and when using the <code>ReadableStreamBYOBReader</code>, the <code>readableByteStreamController.byobRequest</code> property provides access to a <code>ReadableStreamBYOBRequest</code> instance that represents the current read request. The object is used to gain access to the <code>ArrayBuffer</code>/<code>TypedArray</code> that has been provided for the read request to fill, and provides methods for signaling that the data has been provided.</p> <h5 id="readablestreambyobrequestrespondbyteswritten">
<code>readableStreamBYOBRequest.respond(bytesWritten)</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>
<code>bytesWritten</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a>
</li> </ul> <p>Signals that a <code>bytesWritten</code> number of bytes have been written to <code>readableStreamBYOBRequest.view</code>.</p> <h5 id="readablestreambyobrequestrespondwithnewviewview">
<code>readableStreamBYOBRequest.respondWithNewView(view)</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>
<code>view</code> <a href="buffer#class-buffer" class="type">&lt;Buffer&gt;</a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray" class="type">&lt;TypedArray&gt;</a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView" class="type">&lt;DataView&gt;</a>
</li> </ul> <p>Signals that the request has been fulfilled with bytes written to a new <code>Buffer</code>, <code>TypedArray</code>, or <code>DataView</code>.</p> <h5 id="readablestreambyobrequestview">
<code>readableStreamBYOBRequest.view</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>Type: <a href="buffer#class-buffer" class="type">&lt;Buffer&gt;</a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray" class="type">&lt;TypedArray&gt;</a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView" class="type">&lt;DataView&gt;</a>
</li> </ul> <h4 id="class-writablestream">Class: <code>WritableStream</code>
</h4> <div class="api_metadata"> <details class="changelog"><summary>History</summary> <table> <tbody>
<tr>
<th>Version</th>
<th>Changes</th>
</tr> <tr>
<td>v18.0.0</td> <td><p>This class is now exposed on the global object.</p></td>
</tr> <tr>
<td>v16.5.0</td> <td><p><span>Added in: v16.5.0</span></p></td>
</tr> </tbody>
</table> </details> </div> <p>The <code>WritableStream</code> is a destination to which stream data is sent.</p> <pre data-language="js">import {
  WritableStream
} from 'node:stream/web';

const stream = new WritableStream({
  write(chunk) {
    console.log(chunk);
  }
});

await stream.getWriter().write('Hello World');</pre> <h5 id="new-writablestreamunderlyingsink-strategy">
<code>new WritableStream([underlyingSink[, strategy]])</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>
<code>underlyingSink</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a> <ul> <li>
<code>start</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" class="type">&lt;Function&gt;</a> A user-defined function that is invoked immediately when the <code>WritableStream</code> is created. <ul> <li>
<code>controller</code> <a href="webstreams#class-writablestreamdefaultcontroller" class="type">&lt;WritableStreamDefaultController&gt;</a>
</li> <li>Returns: <code>undefined</code> or a promise fulfilled with <code>undefined</code>.</li> </ul> </li> <li>
<code>write</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" class="type">&lt;Function&gt;</a> A user-defined function that is invoked when a chunk of data has been written to the <code>WritableStream</code>. <ul> <li>
<code>chunk</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types" class="type">&lt;any&gt;</a>
</li> <li>
<code>controller</code> <a href="webstreams#class-writablestreamdefaultcontroller" class="type">&lt;WritableStreamDefaultController&gt;</a>
</li> <li>Returns: A promise fulfilled with <code>undefined</code>.</li> </ul> </li> <li>
<code>close</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" class="type">&lt;Function&gt;</a> A user-defined function that is called when the <code>WritableStream</code> is closed. <ul> <li>Returns: A promise fulfilled with <code>undefined</code>.</li> </ul> </li> <li>
<code>abort</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" class="type">&lt;Function&gt;</a> A user-defined function that is called to abruptly close the <code>WritableStream</code>. <ul> <li>
<code>reason</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types" class="type">&lt;any&gt;</a>
</li> <li>Returns: A promise fulfilled with <code>undefined</code>.</li> </ul> </li> <li>
<code>type</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types" class="type">&lt;any&gt;</a> The <code>type</code> option is reserved for future use and <em>must</em> be undefined.</li> </ul> </li> <li>
<code>strategy</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a> <ul> <li>
<code>highWaterMark</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a> The maximum internal queue size before backpressure is applied.</li> <li>
<code>size</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" class="type">&lt;Function&gt;</a> A user-defined function used to identify the size of each chunk of data. <ul> <li>
<code>chunk</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types" class="type">&lt;any&gt;</a>
</li> <li>Returns: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a>
</li> </ul> </li> </ul> </li> </ul> <h5 id="writablestreamabortreason">
<code>writableStream.abort([reason])</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>
<code>reason</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types" class="type">&lt;any&gt;</a>
</li> <li>Returns: A promise fulfilled with <code>undefined</code>.</li> </ul> <p>Abruptly terminates the <code>WritableStream</code>. All queued writes will be canceled with their associated promises rejected.</p> <h5 id="writablestreamclose">
<code>writableStream.close()</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>Returns: A promise fulfilled with <code>undefined</code>.</li> </ul> <p>Closes the <code>WritableStream</code> when no additional writes are expected.</p> <h5 id="writablestreamgetwriter">
<code>writableStream.getWriter()</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>Returns: <a href="webstreams#class-writablestreamdefaultwriter" class="type">&lt;WritableStreamDefaultWriter&gt;</a>
</li> </ul> <p>Creates and creates a new writer instance that can be used to write data into the <code>WritableStream</code>.</p> <h5 id="writablestreamlocked">
<code>writableStream.locked</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>Type: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type" class="type">&lt;boolean&gt;</a>
</li> </ul> <p>The <code>writableStream.locked</code> property is <code>false</code> by default, and is switched to <code>true</code> while there is an active writer attached to this <code>WritableStream</code>.</p> <h5 id="transferring-with-postmessage_1">Transferring with postMessage()
</h5> <p>A <a href="webstreams#class-writablestream" class="type">&lt;WritableStream&gt;</a> instance can be transferred using a <a href="worker_threads#class-messageport" class="type">&lt;MessagePort&gt;</a>.</p> <pre data-language="js">const stream = new WritableStream(getWritableSinkSomehow());

const { port1, port2 } = new MessageChannel();

port1.onmessage = ({ data }) =&gt; {
  data.getWriter().write('hello');
};

port2.postMessage(stream, [stream]);</pre> <h4 id="class-writablestreamdefaultwriter">Class: <code>WritableStreamDefaultWriter</code>
</h4> <div class="api_metadata"> <details class="changelog"><summary>History</summary> <table> <tbody>
<tr>
<th>Version</th>
<th>Changes</th>
</tr> <tr>
<td>v18.0.0</td> <td><p>This class is now exposed on the global object.</p></td>
</tr> <tr>
<td>v16.5.0</td> <td><p><span>Added in: v16.5.0</span></p></td>
</tr> </tbody>
</table> </details> </div> <h5 id="new-writablestreamdefaultwriterstream">
<code>new WritableStreamDefaultWriter(stream)</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>
<code>stream</code> <a href="webstreams#class-writablestream" class="type">&lt;WritableStream&gt;</a>
</li> </ul> <p>Creates a new <code>WritableStreamDefaultWriter</code> that is locked to the given <code>WritableStream</code>.</p> <h5 id="writablestreamdefaultwriterabortreason">
<code>writableStreamDefaultWriter.abort([reason])</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>
<code>reason</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types" class="type">&lt;any&gt;</a>
</li> <li>Returns: A promise fulfilled with <code>undefined</code>.</li> </ul> <p>Abruptly terminates the <code>WritableStream</code>. All queued writes will be canceled with their associated promises rejected.</p> <h5 id="writablestreamdefaultwriterclose">
<code>writableStreamDefaultWriter.close()</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>Returns: A promise fulfilled with <code>undefined</code>.</li> </ul> <p>Closes the <code>WritableStream</code> when no additional writes are expected.</p> <h5 id="writablestreamdefaultwriterclosed">
<code>writableStreamDefaultWriter.closed</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>Type: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" class="type">&lt;Promise&gt;</a> Fulfilled with <code>undefined</code> when the associated <a href="webstreams#class-writablestream" class="type">&lt;WritableStream&gt;</a> is closed or rejected if the stream errors or the writer's lock is released before the stream finishes closing.</li> </ul> <h5 id="writablestreamdefaultwriterdesiredsize">
<code>writableStreamDefaultWriter.desiredSize</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>Type: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a>
</li> </ul> <p>The amount of data required to fill the <a href="webstreams#class-writablestream" class="type">&lt;WritableStream&gt;</a>'s queue.</p> <h5 id="writablestreamdefaultwriterready">
<code>writableStreamDefaultWriter.ready</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>type: A promise that is fulfilled with <code>undefined</code> when the writer is ready to be used.</li> </ul> <h5 id="writablestreamdefaultwriterreleaselock">
<code>writableStreamDefaultWriter.releaseLock()</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <p>Releases this writer's lock on the underlying <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a>.</p> <h5 id="writablestreamdefaultwriterwritechunk">
<code>writableStreamDefaultWriter.write([chunk])</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>
<code>chunk</code>: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types" class="type">&lt;any&gt;</a>
</li> <li>Returns: A promise fulfilled with <code>undefined</code>.</li> </ul> <p>Appends a new chunk of data to the <a href="webstreams#class-writablestream" class="type">&lt;WritableStream&gt;</a>'s queue.</p> <h4 id="class-writablestreamdefaultcontroller">Class: <code>WritableStreamDefaultController</code>
</h4> <div class="api_metadata"> <details class="changelog"><summary>History</summary> <table> <tbody>
<tr>
<th>Version</th>
<th>Changes</th>
</tr> <tr>
<td>v18.0.0</td> <td><p>This class is now exposed on the global object.</p></td>
</tr> <tr>
<td>v16.5.0</td> <td><p><span>Added in: v16.5.0</span></p></td>
</tr> </tbody>
</table> </details> </div> <p>The <code>WritableStreamDefaultController</code> manage's the <a href="webstreams#class-writablestream" class="type">&lt;WritableStream&gt;</a>'s internal state.</p> <h5 id="writablestreamdefaultcontrollererrorerror">
<code>writableStreamDefaultController.error(error)</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>
<code>error</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types" class="type">&lt;any&gt;</a>
</li> </ul> <p>Called by user-code to signal that an error has occurred while processing the <code>WritableStream</code> data. When called, the <a href="webstreams#class-writablestream" class="type">&lt;WritableStream&gt;</a> will be aborted, with currently pending writes canceled.</p> <h5 id="writablestreamdefaultcontrollersignal">
<code>writableStreamDefaultController.signal</code>
</h5> <ul> <li>Type: <a href="globals#class-abortsignal" class="type">&lt;AbortSignal&gt;</a> An <code>AbortSignal</code> that can be used to cancel pending write or close operations when a <a href="webstreams#class-writablestream" class="type">&lt;WritableStream&gt;</a> is aborted.</li> </ul> <h4 id="class-transformstream">Class: <code>TransformStream</code>
</h4> <div class="api_metadata"> <details class="changelog"><summary>History</summary> <table> <tbody>
<tr>
<th>Version</th>
<th>Changes</th>
</tr> <tr>
<td>v18.0.0</td> <td><p>This class is now exposed on the global object.</p></td>
</tr> <tr>
<td>v16.5.0</td> <td><p><span>Added in: v16.5.0</span></p></td>
</tr> </tbody>
</table> </details> </div> <p>A <code>TransformStream</code> consists of a <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a> and a <a href="webstreams#class-writablestream" class="type">&lt;WritableStream&gt;</a> that are connected such that the data written to the <code>WritableStream</code> is received, and potentially transformed, before being pushed into the <code>ReadableStream</code>'s queue.</p> <pre data-language="js">import {
  TransformStream
} from 'node:stream/web';

const transform = new TransformStream({
  transform(chunk, controller) {
    controller.enqueue(chunk.toUpperCase());
  }
});

await Promise.all([
  transform.writable.getWriter().write('A'),
  transform.readable.getReader().read(),
]);</pre> <h5 id="new-transformstreamtransformer-writablestrategy-readablestrategy">
<code>new TransformStream([transformer[, writableStrategy[, readableStrategy]]])</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>
<code>transformer</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a> <ul> <li>
<code>start</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" class="type">&lt;Function&gt;</a> A user-defined function that is invoked immediately when the <code>TransformStream</code> is created. <ul> <li>
<code>controller</code> <a href="webstreams#class-transformstreamdefaultcontroller" class="type">&lt;TransformStreamDefaultController&gt;</a>
</li> <li>Returns: <code>undefined</code> or a promise fulfilled with <code>undefined</code>
</li> </ul> </li> <li>
<code>transform</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" class="type">&lt;Function&gt;</a> A user-defined function that receives, and potentially modifies, a chunk of data written to <code>transformStream.writable</code>, before forwarding that on to <code>transformStream.readable</code>. <ul> <li>
<code>chunk</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types" class="type">&lt;any&gt;</a>
</li> <li>
<code>controller</code> <a href="webstreams#class-transformstreamdefaultcontroller" class="type">&lt;TransformStreamDefaultController&gt;</a>
</li> <li>Returns: A promise fulfilled with <code>undefined</code>.</li> </ul> </li> <li>
<code>flush</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" class="type">&lt;Function&gt;</a> A user-defined function that is called immediately before the writable side of the <code>TransformStream</code> is closed, signaling the end of the transformation process. <ul> <li>
<code>controller</code> <a href="webstreams#class-transformstreamdefaultcontroller" class="type">&lt;TransformStreamDefaultController&gt;</a>
</li> <li>Returns: A promise fulfilled with <code>undefined</code>.</li> </ul> </li> <li>
<code>readableType</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types" class="type">&lt;any&gt;</a> the <code>readableType</code> option is reserved for future use and <em>must</em> be <code>undefined</code>.</li> <li>
<code>writableType</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types" class="type">&lt;any&gt;</a> the <code>writableType</code> option is reserved for future use and <em>must</em> be <code>undefined</code>.</li> </ul> </li> <li>
<code>writableStrategy</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a> <ul> <li>
<code>highWaterMark</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a> The maximum internal queue size before backpressure is applied.</li> <li>
<code>size</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" class="type">&lt;Function&gt;</a> A user-defined function used to identify the size of each chunk of data. <ul> <li>
<code>chunk</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types" class="type">&lt;any&gt;</a>
</li> <li>Returns: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a>
</li> </ul> </li> </ul> </li> <li>
<code>readableStrategy</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a> <ul> <li>
<code>highWaterMark</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a> The maximum internal queue size before backpressure is applied.</li> <li>
<code>size</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" class="type">&lt;Function&gt;</a> A user-defined function used to identify the size of each chunk of data. <ul> <li>
<code>chunk</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types" class="type">&lt;any&gt;</a>
</li> <li>Returns: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a>
</li> </ul> </li> </ul> </li> </ul> <h5 id="transformstreamreadable">
<code>transformStream.readable</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>Type: <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a>
</li> </ul> <h5 id="transformstreamwritable">
<code>transformStream.writable</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>Type: <a href="webstreams#class-writablestream" class="type">&lt;WritableStream&gt;</a>
</li> </ul> <h5 id="transferring-with-postmessage_2">Transferring with postMessage()
</h5> <p>A <a href="webstreams#class-transformstream" class="type">&lt;TransformStream&gt;</a> instance can be transferred using a <a href="worker_threads#class-messageport" class="type">&lt;MessagePort&gt;</a>.</p> <pre data-language="js">const stream = new TransformStream();

const { port1, port2 } = new MessageChannel();

port1.onmessage = ({ data }) =&gt; {
  const { writable, readable } = data;
  // ...
};

port2.postMessage(stream, [stream]);</pre> <h4 id="class-transformstreamdefaultcontroller">Class: <code>TransformStreamDefaultController</code>
</h4> <div class="api_metadata"> <details class="changelog"><summary>History</summary> <table> <tbody>
<tr>
<th>Version</th>
<th>Changes</th>
</tr> <tr>
<td>v18.0.0</td> <td><p>This class is now exposed on the global object.</p></td>
</tr> <tr>
<td>v16.5.0</td> <td><p><span>Added in: v16.5.0</span></p></td>
</tr> </tbody>
</table> </details> </div> <p>The <code>TransformStreamDefaultController</code> manages the internal state of the <code>TransformStream</code>.</p> <h5 id="transformstreamdefaultcontrollerdesiredsize">
<code>transformStreamDefaultController.desiredSize</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>Type: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a>
</li> </ul> <p>The amount of data required to fill the readable side's queue.</p> <h5 id="transformstreamdefaultcontrollerenqueuechunk">
<code>transformStreamDefaultController.enqueue([chunk])</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>
<code>chunk</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types" class="type">&lt;any&gt;</a>
</li> </ul> <p>Appends a chunk of data to the readable side's queue.</p> <h5 id="transformstreamdefaultcontrollererrorreason">
<code>transformStreamDefaultController.error([reason])</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>
<code>reason</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types" class="type">&lt;any&gt;</a>
</li> </ul> <p>Signals to both the readable and writable side that an error has occurred while processing the transform data, causing both sides to be abruptly closed.</p> <h5 id="transformstreamdefaultcontrollerterminate">
<code>transformStreamDefaultController.terminate()</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <p>Closes the readable side of the transport and causes the writable side to be abruptly closed with an error.</p> <h4 id="class-bytelengthqueuingstrategy">Class: <code>ByteLengthQueuingStrategy</code>
</h4> <div class="api_metadata"> <details class="changelog"><summary>History</summary> <table> <tbody>
<tr>
<th>Version</th>
<th>Changes</th>
</tr> <tr>
<td>v18.0.0</td> <td><p>This class is now exposed on the global object.</p></td>
</tr> <tr>
<td>v16.5.0</td> <td><p><span>Added in: v16.5.0</span></p></td>
</tr> </tbody>
</table> </details> </div> <h5 id="new-bytelengthqueuingstrategyoptions">
<code>new ByteLengthQueuingStrategy(options)</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>
<code>options</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a> <ul> <li>
<code>highWaterMark</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a>
</li> </ul> </li> </ul> <h5 id="bytelengthqueuingstrategyhighwatermark">
<code>byteLengthQueuingStrategy.highWaterMark</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>Type: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a>
</li> </ul> <h5 id="bytelengthqueuingstrategysize">
<code>byteLengthQueuingStrategy.size</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>Type: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" class="type">&lt;Function&gt;</a> <ul> <li>
<code>chunk</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types" class="type">&lt;any&gt;</a>
</li> <li>Returns: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a>
</li> </ul> </li> </ul> <h4 id="class-countqueuingstrategy">Class: <code>CountQueuingStrategy</code>
</h4> <div class="api_metadata"> <details class="changelog"><summary>History</summary> <table> <tbody>
<tr>
<th>Version</th>
<th>Changes</th>
</tr> <tr>
<td>v18.0.0</td> <td><p>This class is now exposed on the global object.</p></td>
</tr> <tr>
<td>v16.5.0</td> <td><p><span>Added in: v16.5.0</span></p></td>
</tr> </tbody>
</table> </details> </div> <h5 id="new-countqueuingstrategyoptions">
<code>new CountQueuingStrategy(options)</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>
<code>options</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a> <ul> <li>
<code>highWaterMark</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a>
</li> </ul> </li> </ul> <h5 id="countqueuingstrategyhighwatermark">
<code>countQueuingStrategy.highWaterMark</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>Type: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a>
</li> </ul> <h5 id="countqueuingstrategysize">
<code>countQueuingStrategy.size</code>
</h5> <div class="api_metadata"> <span>Added in: v16.5.0</span> </div> <ul> <li>Type: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" class="type">&lt;Function&gt;</a> <ul> <li>
<code>chunk</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types" class="type">&lt;any&gt;</a>
</li> <li>Returns: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a>
</li> </ul> </li> </ul> <h4 id="class-textencoderstream">Class: <code>TextEncoderStream</code>
</h4> <div class="api_metadata"> <details class="changelog"><summary>History</summary> <table> <tbody>
<tr>
<th>Version</th>
<th>Changes</th>
</tr> <tr>
<td>v18.0.0</td> <td><p>This class is now exposed on the global object.</p></td>
</tr> <tr>
<td>v16.6.0</td> <td><p><span>Added in: v16.6.0</span></p></td>
</tr> </tbody>
</table> </details> </div> <h5 id="new-textencoderstream">
<code>new TextEncoderStream()</code>
</h5> <div class="api_metadata"> <span>Added in: v16.6.0</span> </div> <p>Creates a new <code>TextEncoderStream</code> instance.</p> <h5 id="textencoderstreamencoding">
<code>textEncoderStream.encoding</code>
</h5> <div class="api_metadata"> <span>Added in: v16.6.0</span> </div> <ul> <li>Type: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a>
</li> </ul> <p>The encoding supported by the <code>TextEncoderStream</code> instance.</p> <h5 id="textencoderstreamreadable">
<code>textEncoderStream.readable</code>
</h5> <div class="api_metadata"> <span>Added in: v16.6.0</span> </div> <ul> <li>Type: <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a>
</li> </ul> <h5 id="textencoderstreamwritable">
<code>textEncoderStream.writable</code>
</h5> <div class="api_metadata"> <span>Added in: v16.6.0</span> </div> <ul> <li>Type: <a href="webstreams#class-writablestream" class="type">&lt;WritableStream&gt;</a>
</li> </ul> <h4 id="class-textdecoderstream">Class: <code>TextDecoderStream</code>
</h4> <div class="api_metadata"> <details class="changelog"><summary>History</summary> <table> <tbody>
<tr>
<th>Version</th>
<th>Changes</th>
</tr> <tr>
<td>v18.0.0</td> <td><p>This class is now exposed on the global object.</p></td>
</tr> <tr>
<td>v16.6.0</td> <td><p><span>Added in: v16.6.0</span></p></td>
</tr> </tbody>
</table> </details> </div> <h5 id="new-textdecoderstreamencoding-options">
<code>new TextDecoderStream([encoding[, options]])</code>
</h5> <div class="api_metadata"> <span>Added in: v16.6.0</span> </div> <ul> <li>
<code>encoding</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> Identifies the <code>encoding</code> that this <code>TextDecoder</code> instance supports. <strong>Default:</strong> <code>'utf-8'</code>.</li> <li>
<code>options</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a> <ul> <li>
<code>fatal</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type" class="type">&lt;boolean&gt;</a> <code>true</code> if decoding failures are fatal.</li> <li>
<code>ignoreBOM</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type" class="type">&lt;boolean&gt;</a> When <code>true</code>, the <code>TextDecoderStream</code> will include the byte order mark in the decoded result. When <code>false</code>, the byte order mark will be removed from the output. This option is only used when <code>encoding</code> is <code>'utf-8'</code>, <code>'utf-16be'</code>, or <code>'utf-16le'</code>. <strong>Default:</strong> <code>false</code>.</li> </ul> </li> </ul> <p>Creates a new <code>TextDecoderStream</code> instance.</p> <h5 id="textdecoderstreamencoding">
<code>textDecoderStream.encoding</code>
</h5> <div class="api_metadata"> <span>Added in: v16.6.0</span> </div> <ul> <li>Type: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a>
</li> </ul> <p>The encoding supported by the <code>TextDecoderStream</code> instance.</p> <h5 id="textdecoderstreamfatal">
<code>textDecoderStream.fatal</code>
</h5> <div class="api_metadata"> <span>Added in: v16.6.0</span> </div> <ul> <li>Type: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type" class="type">&lt;boolean&gt;</a>
</li> </ul> <p>The value will be <code>true</code> if decoding errors result in a <code>TypeError</code> being thrown.</p> <h5 id="textdecoderstreamignorebom">
<code>textDecoderStream.ignoreBOM</code>
</h5> <div class="api_metadata"> <span>Added in: v16.6.0</span> </div> <ul> <li>Type: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type" class="type">&lt;boolean&gt;</a>
</li> </ul> <p>The value will be <code>true</code> if the decoding result will include the byte order mark.</p> <h5 id="textdecoderstreamreadable">
<code>textDecoderStream.readable</code>
</h5> <div class="api_metadata"> <span>Added in: v16.6.0</span> </div> <ul> <li>Type: <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a>
</li> </ul> <h5 id="textdecoderstreamwritable">
<code>textDecoderStream.writable</code>
</h5> <div class="api_metadata"> <span>Added in: v16.6.0</span> </div> <ul> <li>Type: <a href="webstreams#class-writablestream" class="type">&lt;WritableStream&gt;</a>
</li> </ul> <h4 id="class-compressionstream">Class: <code>CompressionStream</code>
</h4> <div class="api_metadata"> <details class="changelog"><summary>History</summary> <table> <tbody>
<tr>
<th>Version</th>
<th>Changes</th>
</tr> <tr>
<td>v18.0.0</td> <td><p>This class is now exposed on the global object.</p></td>
</tr> <tr>
<td>v17.0.0</td> <td><p><span>Added in: v17.0.0</span></p></td>
</tr> </tbody>
</table> </details> </div> <h5 id="new-compressionstreamformat">
<code>new CompressionStream(format)</code>
</h5> <div class="api_metadata"> <span>Added in: v17.0.0</span> </div> <ul> <li>
<code>format</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> One of either <code>'deflate'</code> or <code>'gzip'</code>.</li> </ul> <h5 id="compressionstreamreadable">
<code>compressionStream.readable</code>
</h5> <div class="api_metadata"> <span>Added in: v17.0.0</span> </div> <ul> <li>Type: <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a>
</li> </ul> <h5 id="compressionstreamwritable">
<code>compressionStream.writable</code>
</h5> <div class="api_metadata"> <span>Added in: v17.0.0</span> </div> <ul> <li>Type: <a href="webstreams#class-writablestream" class="type">&lt;WritableStream&gt;</a>
</li> </ul> <h4 id="class-decompressionstream">Class: <code>DecompressionStream</code>
</h4> <div class="api_metadata"> <details class="changelog"><summary>History</summary> <table> <tbody>
<tr>
<th>Version</th>
<th>Changes</th>
</tr> <tr>
<td>v18.0.0</td> <td><p>This class is now exposed on the global object.</p></td>
</tr> <tr>
<td>v17.0.0</td> <td><p><span>Added in: v17.0.0</span></p></td>
</tr> </tbody>
</table> </details> </div> <h5 id="new-decompressionstreamformat">
<code>new DecompressionStream(format)</code>
</h5> <div class="api_metadata"> <span>Added in: v17.0.0</span> </div> <ul> <li>
<code>format</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> One of either <code>'deflate'</code> or <code>'gzip'</code>.</li> </ul> <h5 id="decompressionstreamreadable">
<code>decompressionStream.readable</code>
</h5> <div class="api_metadata"> <span>Added in: v17.0.0</span> </div> <ul> <li>Type: <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a>
</li> </ul> <h5 id="decompressionstreamwritable">
<code>decompressionStream.writable</code>
</h5> <div class="api_metadata"> <span>Added in: v17.0.0</span> </div> <ul> <li>Type: <a href="webstreams#class-writablestream" class="type">&lt;WritableStream&gt;</a>
</li> </ul> <h4 id="utility-consumers">Utility Consumers
</h4> <div class="api_metadata"> <span>Added in: v16.7.0</span> </div> <p>The utility consumer functions provide common options for consuming streams.</p> <p>They are accessed using:</p> <p class="module-type">MJS modules</p>
<pre data-language="js">import {
  arrayBuffer,
  blob,
  buffer,
  json,
  text,
} from 'node:stream/consumers';</pre>
<p class="module-type">CJS modules</p>
<pre data-language="js">const {
  arrayBuffer,
  blob,
  buffer,
  json,
  text,
} = require('node:stream/consumers');</pre> <h5 id="streamconsumersarraybufferstream">
<code>streamConsumers.arrayBuffer(stream)</code>
</h5> <div class="api_metadata"> <span>Added in: v16.7.0</span> </div> <ul> <li>
<code>stream</code> <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a> | <a href="stream#class-streamreadable" class="type">&lt;stream.Readable&gt;</a> | <a href="https://tc39.github.io/ecma262/#sec-asynciterator-interface" class="type">&lt;AsyncIterator&gt;</a>
</li> <li>Returns: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" class="type">&lt;Promise&gt;</a> Fulfills with an <code>ArrayBuffer</code> containing the full contents of the stream.</li> </ul> <p class="module-type">MJS modules</p>
<pre data-language="js">import { buffer as arrayBuffer } from 'node:stream/consumers';
import { Readable } from 'node:stream';
import { TextEncoder } from 'node:util';

const encoder = new TextEncoder();
const dataArray = encoder.encode('hello world from consumers!');

const readable = Readable.from(dataArray);
const data = await arrayBuffer(readable);
console.log(`from readable: ${data.byteLength}`);</pre>
<p class="module-type">CJS modules</p>
<pre data-language="js">const { arrayBuffer } = require('node:stream/consumers');
const { Readable } = require('stream');
const { TextEncoder } = require('util');

const encoder = new TextEncoder();
const dataArray = encoder.encode(['hello world from consumers!']);
const readable = Readable.from(dataArray);
arrayBuffer(readable).then((data) =&gt; {
  console.log(`from readable: ${data.byteLength}`);
});</pre> <h5 id="streamconsumersblobstream">
<code>streamConsumers.blob(stream)</code>
</h5> <div class="api_metadata"> <span>Added in: v16.7.0</span> </div> <ul> <li>
<code>stream</code> <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a> | <a href="stream#class-streamreadable" class="type">&lt;stream.Readable&gt;</a> | <a href="https://tc39.github.io/ecma262/#sec-asynciterator-interface" class="type">&lt;AsyncIterator&gt;</a>
</li> <li>Returns: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" class="type">&lt;Promise&gt;</a> Fulfills with a <a href="buffer#class-blob" class="type">&lt;Blob&gt;</a> containing the full contents of the stream.</li> </ul> <p class="module-type">MJS modules</p>
<pre data-language="js">import { blob } from 'node:stream/consumers';

const dataBlob = new Blob(['hello world from consumers!']);

const readable = dataBlob.stream();
const data = await blob(readable);
console.log(`from readable: ${data.size}`);</pre>
<p class="module-type">CJS modules</p>
<pre data-language="js">const { blob } = require('node:stream/consumers');

const dataBlob = new Blob(['hello world from consumers!']);

const readable = dataBlob.stream();
blob(readable).then((data) =&gt; {
  console.log(`from readable: ${data.size}`);
});</pre> <h5 id="streamconsumersbufferstream">
<code>streamConsumers.buffer(stream)</code>
</h5> <div class="api_metadata"> <span>Added in: v16.7.0</span> </div> <ul> <li>
<code>stream</code> <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a> | <a href="stream#class-streamreadable" class="type">&lt;stream.Readable&gt;</a> | <a href="https://tc39.github.io/ecma262/#sec-asynciterator-interface" class="type">&lt;AsyncIterator&gt;</a>
</li> <li>Returns: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" class="type">&lt;Promise&gt;</a> Fulfills with a <a href="buffer#class-buffer" class="type">&lt;Buffer&gt;</a> containing the full contents of the stream.</li> </ul> <p class="module-type">MJS modules</p>
<pre data-language="js">import { buffer } from 'node:stream/consumers';
import { Readable } from 'node:stream';
import { Buffer } from 'node:buffer';

const dataBuffer = Buffer.from('hello world from consumers!');

const readable = Readable.from(dataBuffer);
const data = await buffer(readable);
console.log(`from readable: ${data.length}`);</pre>
<p class="module-type">CJS modules</p>
<pre data-language="js">const { buffer } = require('node:stream/consumers');
const { Readable } = require('node:stream');
const { Buffer } = require('node:buffer');

const dataBuffer = Buffer.from('hello world from consumers!');

const readable = Readable.from(dataBuffer);
buffer(readable).then((data) =&gt; {
  console.log(`from readable: ${data.length}`);
});</pre> <h5 id="streamconsumersjsonstream">
<code>streamConsumers.json(stream)</code>
</h5> <div class="api_metadata"> <span>Added in: v16.7.0</span> </div> <ul> <li>
<code>stream</code> <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a> | <a href="stream#class-streamreadable" class="type">&lt;stream.Readable&gt;</a> | <a href="https://tc39.github.io/ecma262/#sec-asynciterator-interface" class="type">&lt;AsyncIterator&gt;</a>
</li> <li>Returns: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" class="type">&lt;Promise&gt;</a> Fulfills with the contents of the stream parsed as a UTF-8 encoded string that is then passed through <code>JSON.parse()</code>.</li> </ul> <p class="module-type">MJS modules</p>
<pre data-language="js">import { json } from 'node:stream/consumers';
import { Readable } from 'node:stream';

const items = Array.from(
  {
    length: 100
  },
  () =&gt; ({
    message: 'hello world from consumers!'
  })
);

const readable = Readable.from(JSON.stringify(items));
const data = await json(readable);
console.log(`from readable: ${data.length}`);</pre>
<p class="module-type">CJS modules</p>
<pre data-language="js">const { json } = require('node:stream/consumers');
const { Readable } = require('node:stream');

const items = Array.from(
  {
    length: 100
  },
  () =&gt; ({
    message: 'hello world from consumers!'
  })
);

const readable = Readable.from(JSON.stringify(items));
json(readable).then((data) =&gt; {
  console.log(`from readable: ${data.length}`);
});</pre> <h5 id="streamconsumerstextstream">
<code>streamConsumers.text(stream)</code>
</h5> <div class="api_metadata"> <span>Added in: v16.7.0</span> </div> <ul> <li>
<code>stream</code> <a href="webstreams#class-readablestream" class="type">&lt;ReadableStream&gt;</a> | <a href="stream#class-streamreadable" class="type">&lt;stream.Readable&gt;</a> | <a href="https://tc39.github.io/ecma262/#sec-asynciterator-interface" class="type">&lt;AsyncIterator&gt;</a>
</li> <li>Returns: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" class="type">&lt;Promise&gt;</a> Fulfills with the contents of the stream parsed as a UTF-8 encoded string.</li> </ul> <p class="module-type">MJS modules</p>
<pre data-language="js">import { json, text, blob, buffer } from 'node:stream/consumers';
import { Readable } from 'node:stream';

const readable = Readable.from('Hello world from consumers!');
const data = await text(readable);
console.log(`from readable: ${data.length}`);</pre>
<p class="module-type">CJS modules</p>
<pre data-language="js">const { text } = require('node:stream/consumers');
const { Readable } = require('node:stream');

const readable = Readable.from('Hello world from consumers!');
text(readable).then((data) =&gt; {
  console.log(`from readable: ${data.length}`);
});</pre></section><div class="_attribution">
  <p class="_attribution-p">
     Joyent, Inc. and other Node contributors<br>Licensed under the MIT License.<br>Node.js is a trademark of Joyent, Inc. and is used with its permission.<br>We are not endorsed by or affiliated with Joyent.<br>
    <a href="https://nodejs.org/api/webstreams.html" class="_attribution-link">https://nodejs.org/api/webstreams.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
