
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Trace Events - Node.js - W3cubDocs</title>
  
  <meta name="description" content=" Source Code&#58; lib&#47;trace_events.js ">
  <meta name="keywords" content="trace, events, node, js">
  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/node/tracing.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-c8f743fc70bb84079c3cf4b71f5f99835529659c30689b2fd6193651a680f383ef1d96896f8966c7ca8a0160ffd557685bb8ad12820ec6002d60143812238086.css">
  <script type="text/javascript" src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js"></script>
  <script src="/json/node.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/node/" class="_nav-link" title="" style="margin-left:0;">Node.js</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _node">
				
				
<h2 id="trace-events">Trace events
</h2> 
<div class="api_stability api_stability_1">
<a href="https://nodejs.org/api/documentation.html#stability-index">Stability: 1</a> - Experimental</div>
 <p><strong>Source Code:</strong> <a href="https://github.com/nodejs/node/blob/v20.8.0/lib/trace_events.js">lib/trace_events.js</a></p> <p>The <code>node:trace_events</code> module provides a mechanism to centralize tracing information generated by V8, Node.js core, and userspace code.</p> <p>Tracing can be enabled with the <code>--trace-event-categories</code> command-line flag or by using the <code>node:trace_events</code> module. The <code>--trace-event-categories</code> flag accepts a list of comma-separated category names.</p> <p>The available categories are:</p> <ul> <li>
<code>node</code>: An empty placeholder.</li> <li>
<code>node.async_hooks</code>: Enables capture of detailed <a href="async_hooks"><code>async_hooks</code></a> trace data. The <a href="async_hooks"><code>async_hooks</code></a> events have a unique <code>asyncId</code> and a special <code>triggerId</code> <code>triggerAsyncId</code> property.</li> <li>
<code>node.bootstrap</code>: Enables capture of Node.js bootstrap milestones.</li> <li>
<code>node.console</code>: Enables capture of <code>console.time()</code> and <code>console.count()</code> output.</li> <li>
<code>node.threadpoolwork.sync</code>: Enables capture of trace data for threadpool synchronous operations, such as <code>blob</code>, <code>zlib</code>, <code>crypto</code> and <code>node_api</code>.</li> <li>
<code>node.threadpoolwork.async</code>: Enables capture of trace data for threadpool asynchronous operations, such as <code>blob</code>, <code>zlib</code>, <code>crypto</code> and <code>node_api</code>.</li> <li>
<code>node.dns.native</code>: Enables capture of trace data for DNS queries.</li> <li>
<code>node.net.native</code>: Enables capture of trace data for network.</li> <li>
<code>node.environment</code>: Enables capture of Node.js Environment milestones.</li> <li>
<code>node.fs.sync</code>: Enables capture of trace data for file system sync methods.</li> <li>
<code>node.fs_dir.sync</code>: Enables capture of trace data for file system sync directory methods.</li> <li>
<code>node.fs.async</code>: Enables capture of trace data for file system async methods.</li> <li>
<code>node.fs_dir.async</code>: Enables capture of trace data for file system async directory methods.</li> <li>
<code>node.perf</code>: Enables capture of <a href="perf_hooks">Performance API</a> measurements. <ul> <li>
<code>node.perf.usertiming</code>: Enables capture of only Performance API User Timing measures and marks.</li> <li>
<code>node.perf.timerify</code>: Enables capture of only Performance API timerify measurements.</li> </ul> </li> <li>
<code>node.promises.rejections</code>: Enables capture of trace data tracking the number of unhandled Promise rejections and handled-after-rejections.</li> <li>
<code>node.vm.script</code>: Enables capture of trace data for the <code>node:vm</code> module's <code>runInNewContext()</code>, <code>runInContext()</code>, and <code>runInThisContext()</code> methods.</li> <li>
<code>v8</code>: The <a href="v8">V8</a> events are GC, compiling, and execution related.</li> <li>
<code>node.http</code>: Enables capture of trace data for http request / response.</li> </ul> <p>By default the <code>node</code>, <code>node.async_hooks</code>, and <code>v8</code> categories are enabled.</p> <pre data-language="js">node --trace-event-categories v8,node,node.async_hooks server.js copy</pre> <p>Prior versions of Node.js required the use of the <code>--trace-events-enabled</code> flag to enable trace events. This requirement has been removed. However, the <code>--trace-events-enabled</code> flag <em>may</em> still be used and will enable the <code>node</code>, <code>node.async_hooks</code>, and <code>v8</code> trace event categories by default.</p> <pre data-language="js">node --trace-events-enabled

# is equivalent to

node --trace-event-categories v8,node,node.async_hooks copy</pre> <p>Alternatively, trace events may be enabled using the <code>node:trace_events</code> module:</p> <pre data-language="js">const trace_events = require('node:trace_events');
const tracing = trace_events.createTracing({ categories: ['node.perf'] });
tracing.enable();  // Enable trace event capture for the 'node.perf' category

// do work

tracing.disable();  // Disable trace event capture for the 'node.perf' category copy</pre> <p>Running Node.js with tracing enabled will produce log files that can be opened in the <a href="https://www.chromium.org/developers/how-tos/trace-event-profiling-tool"><code>chrome://tracing</code></a> tab of Chrome.</p> <p>The logging file is by default called <code>node_trace.${rotation}.log</code>, where <code>${rotation}</code> is an incrementing log-rotation id. The filepath pattern can be specified with <code>--trace-event-file-pattern</code> that accepts a template string that supports <code>${rotation}</code> and <code>${pid}</code>:</p> <pre data-language="js">node --trace-event-categories v8 --trace-event-file-pattern '${pid}-${rotation}.log' server.js copy</pre> <p>To guarantee that the log file is properly generated after signal events like <code>SIGINT</code>, <code>SIGTERM</code>, or <code>SIGBREAK</code>, make sure to have the appropriate handlers in your code, such as:</p> <pre data-language="js">process.on('SIGINT', function onSigint() {
  console.info('Received SIGINT.');
  process.exit(130);  // Or applicable exit code depending on OS and signal
}); copy</pre> <p>The tracing system uses the same time source as the one used by <code>process.hrtime()</code>. However the trace-event timestamps are expressed in microseconds, unlike <code>process.hrtime()</code> which returns nanoseconds.</p> <p>The features from this module are not available in <a href="worker_threads#class-worker"><code>Worker</code></a> threads.</p> <section><h3 id="the-nodetrace_events-module">The <code>node:trace_events</code> module
</h3> <div class="api_metadata"> <span>Added in: v10.0.0</span> </div> <h4 id="tracing-object">
<code>Tracing</code> object
</h4> <div class="api_metadata"> <span>Added in: v10.0.0</span> </div> <p>The <code>Tracing</code> object is used to enable or disable tracing for sets of categories. Instances are created using the <code>trace_events.createTracing()</code> method.</p> <p>When created, the <code>Tracing</code> object is disabled. Calling the <code>tracing.enable()</code> method adds the categories to the set of enabled trace event categories. Calling <code>tracing.disable()</code> will remove the categories from the set of enabled trace event categories.</p> <h5 id="tracingcategories">
<code>tracing.categories</code>
</h5> <div class="api_metadata"> <span>Added in: v10.0.0</span> </div> <ul> <li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a></li> </ul> <p>A comma-separated list of the trace event categories covered by this <code>Tracing</code> object.</p> <h5 id="tracingdisable">
<code>tracing.disable()</code>
</h5> <div class="api_metadata"> <span>Added in: v10.0.0</span> </div> <p>Disables this <code>Tracing</code> object.</p> <p>Only trace event categories <em>not</em> covered by other enabled <code>Tracing</code> objects and <em>not</em> specified by the <code>--trace-event-categories</code> flag will be disabled.</p> <pre data-language="js">const trace_events = require('node:trace_events');
const t1 = trace_events.createTracing({ categories: ['node', 'v8'] });
const t2 = trace_events.createTracing({ categories: ['node.perf', 'node'] });
t1.enable();
t2.enable();

// Prints 'node,node.perf,v8'
console.log(trace_events.getEnabledCategories());

t2.disable(); // Will only disable emission of the 'node.perf' category

// Prints 'node,v8'
console.log(trace_events.getEnabledCategories()); copy</pre> <h5 id="tracingenable">
<code>tracing.enable()</code>
</h5> <div class="api_metadata"> <span>Added in: v10.0.0</span> </div> <p>Enables this <code>Tracing</code> object for the set of categories covered by the <code>Tracing</code> object.</p> <h5 id="tracingenabled">
<code>tracing.enabled</code>
</h5> <div class="api_metadata"> <span>Added in: v10.0.0</span> </div> <ul> <li>
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type" class="type">&lt;boolean&gt;</a> <code>true</code> only if the <code>Tracing</code> object has been enabled.</li> </ul> <h4 id="trace_eventscreatetracingoptions">
<code>trace_events.createTracing(options)</code>
</h4> <div class="api_metadata"> <span>Added in: v10.0.0</span> </div> <ul> <li>
<code>options</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a> <ul> <li>
<code>categories</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string[]&gt;</a> An array of trace category names. Values included in the array are coerced to a string when possible. An error will be thrown if the value cannot be coerced.</li> </ul> </li> <li>Returns: <a href="tracing#tracing-object" class="type">&lt;Tracing&gt;</a>.</li> </ul> <p>Creates and returns a <code>Tracing</code> object for the given set of <code>categories</code>.</p> <pre data-language="js">const trace_events = require('node:trace_events');
const categories = ['node.perf', 'node.async_hooks'];
const tracing = trace_events.createTracing({ categories });
tracing.enable();
// do stuff
tracing.disable(); copy</pre> <h4 id="trace_eventsgetenabledcategories">
<code>trace_events.getEnabledCategories()</code>
</h4> <div class="api_metadata"> <span>Added in: v10.0.0</span> </div> <ul> <li>Returns: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a>
</li> </ul> <p>Returns a comma-separated list of all currently-enabled trace event categories. The current set of enabled trace event categories is determined by the <em>union</em> of all currently-enabled <code>Tracing</code> objects and any categories enabled using the <code>--trace-event-categories</code> flag.</p> <p>Given the file <code>test.js</code> below, the command <code>node --trace-event-categories node.perf test.js</code> will print <code>'node.async_hooks,node.perf'</code> to the console.</p> <pre data-language="js">const trace_events = require('node:trace_events');
const t1 = trace_events.createTracing({ categories: ['node.async_hooks'] });
const t2 = trace_events.createTracing({ categories: ['node.perf'] });
const t3 = trace_events.createTracing({ categories: ['v8'] });

t1.enable();
t2.enable();

console.log(trace_events.getEnabledCategories()); copy</pre> </section><section><h3 id="examples">Examples
</h3> <h4 id="collect-trace-events-data-by-inspector">Collect trace events data by inspector
</h4> <pre data-language="js">'use strict';

const { Session } = require('inspector');
const session = new Session();
session.connect();

function post(message, data) {
  return new Promise((resolve, reject) =&gt; {
    session.post(message, data, (err, result) =&gt; {
      if (err)
        reject(new Error(JSON.stringify(err)));
      else
        resolve(result);
    });
  });
}

async function collect() {
  const data = [];
  session.on('NodeTracing.dataCollected', (chunk) =&gt; data.push(chunk));
  session.on('NodeTracing.tracingComplete', () =&gt; {
    // done
  });
  const traceConfig = { includedCategories: ['v8'] };
  await post('NodeTracing.start', { traceConfig });
  // do something
  setTimeout(() =&gt; {
    post('NodeTracing.stop').then(() =&gt; {
      session.disconnect();
      console.log(data);
    });
  }, 1000);
}

collect(); copy</pre></section><div class="_attribution">
  <p class="_attribution-p">
    © Joyent, Inc. and other Node contributors<br>Licensed under the MIT License.<br>Node.js is a trademark of Joyent, Inc. and is used with its permission.<br>We are not endorsed by or affiliated with Joyent.<br>
    <a href="https://nodejs.org/api/tracing.html" class="_attribution-link">https://nodejs.org/api/tracing.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
