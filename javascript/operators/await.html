
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Await - JavaScript - W3cubDocs</title>
  
  <meta name="description" content=" This feature is well established and works across many devices and browser versions. It’s been available across browsers since April 2017. ">
  <meta name="keywords" content="await, javascript">
  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/javascript/operators/await.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-c8f743fc70bb84079c3cf4b71f5f99835529659c30689b2fd6193651a680f383ef1d96896f8966c7ca8a0160ffd557685bb8ad12820ec6002d60143812238086.css">
  <script type="text/javascript" src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js"></script>
  <script src="/json/javascript.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/javascript/" class="_nav-link" title="" style="margin-left:0;">JavaScript</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _mdn">
				
				
<header><h1>await</h1>
<details class="baseline-indicator high"><summary><h2>Baseline <span class="not-bold">Widely available</span>
</h2>

</summary><div class="extra">
<p>This feature is well established and works across many devices and browser versions. It’s been available across browsers since April 2017.</p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/blog/baseline-evolution-on-mdn/" data-glean="baseline_link_learn_more" target="_blank" class="learn-more">Learn more</a></li>
<li><a href="#browser_compatibility" data-glean="baseline_link_bcd_table">See full compatibility</a></li>
<li><a href="https://survey.alchemer.com/s3/7634825/MDN-baseline-feedback?page=%2Fen-US%2Fdocs%2FWeb%2FJavaScript%2FReference%2FOperators%2Fawait&amp;level=high" data-glean="baseline_link_feedback" class="feedback-link" target="_blank" rel="noreferrer">Report feedback</a></li>
</ul>
</div></details></header><div class="section-content"><p>The <code>await</code> operator is used to wait for a <a href="../global_objects/promise"><code>Promise</code></a> and get its fulfillment value. It can only be used inside an <a href="../statements/async_function">async function</a> or at the top level of a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules">module</a>.</p></div>
<section aria-labelledby="syntax"><h2 id="syntax">Syntax</h2>
<div class="section-content"><div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="Hz6v/D2IflKgJ3wWjVc53y0do6l9W6epEdanWTgmbxA=" data-language="js"><span class="token keyword">await</span> expression
</pre>
</div></div></section><section aria-labelledby="parameters"><h3 id="parameters">Parameters</h3>
<div class="section-content"><dl> <dt id="expression"><a href="#expression"><code>expression</code></a></dt> <dd> <p>A <a href="../global_objects/promise"><code>Promise</code></a>, a <a href="../global_objects/promise#thenables">thenable object</a>, or any value to wait for.</p> </dd> </dl></div></section><section aria-labelledby="return_value"><h3 id="return_value">Return value</h3>
<div class="section-content"><p>The fulfillment value of the promise or thenable object, or, if the expression is not thenable, the expression's own value.</p></div></section><section aria-labelledby="exceptions"><h3 id="exceptions">Exceptions</h3>
<div class="section-content"><p>Throws the rejection reason if the promise or thenable object is rejected.</p></div></section><section aria-labelledby="description"><h2 id="description">Description</h2>
<div class="section-content">
<p><code>await</code> is usually used to unwrap promises by passing a <a href="../global_objects/promise"><code>Promise</code></a> as the <code>expression</code>. Using <code>await</code> pauses the execution of its surrounding <code>async</code> function until the promise is settled (that is, fulfilled or rejected). When execution resumes, the value of the <code>await</code> expression becomes that of the fulfilled promise.</p> <p>If the promise is rejected, the <code>await</code> expression throws the rejected value. The function containing the <code>await</code> expression will <a href="#improving_stack_trace">appear in the stack trace</a> of the error. Otherwise, if the rejected promise is not awaited or is immediately returned, the caller function will not appear in the stack trace.</p> <p>The <code>expression</code> is resolved in the same way as <a href="../global_objects/promise/resolve"><code>Promise.resolve()</code></a>: it's always converted to a native <code>Promise</code> and then awaited. If the <code>expression</code> is a:</p> <ul> <li>Native <code>Promise</code> (which means <code>expression</code> belongs to <code>Promise</code> or a subclass, and <code>expression.constructor === Promise</code>): The promise is directly used and awaited natively, without calling <code>then()</code>.</li> <li>
<a href="../global_objects/promise#thenables">Thenable object</a> (including non-native promises, polyfill, proxy, child class, etc.): A new promise is constructed with the native <a href="../global_objects/promise/promise"><code>Promise()</code></a> constructor by calling the object's <code>then()</code> method and passing in a handler that calls the <code>resolve</code> callback.</li> <li>Non-thenable value: An already-fulfilled <code>Promise</code> is constructed and used.</li> </ul> <p>Even when the used promise is already fulfilled, the async function's execution still pauses until the next tick. In the meantime, the caller of the async function resumes execution. <a href="#control_flow_effects_of_await">See example below.</a></p> <p>Because <code>await</code> is only valid inside async functions and modules, which themselves are asynchronous and return promises, the <code>await</code> expression never blocks the main thread and only defers execution of code that actually depends on the result, i.e. anything after the <code>await</code> expression.</p>
</div></section><section aria-labelledby="examples"><h2 id="examples">Examples</h2>
</section><section aria-labelledby="awaiting_a_promise_to_be_fulfilled"><h3 id="awaiting_a_promise_to_be_fulfilled">Awaiting a promise to be fulfilled</h3>
<div class="section-content">
<p>If a <code>Promise</code> is passed to an <code>await</code> expression, it waits for the <code>Promise</code> to be fulfilled and returns the fulfilled value.</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="hMZZV89dTDMXfr0FzyP9dk8s4Kiafr2fFPU+Y0o0nk8=" data-language="js"><span class="token keyword">function</span> <span class="token function">resolveAfter2Seconds</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> x <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">resolveAfter2Seconds</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 10</span>
<span class="token punctuation">}</span>

<span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
</div>
</div></section><section aria-labelledby="thenable_objects"><h3 id="thenable_objects">Thenable objects</h3>
<div class="section-content">
<p><a href="../global_objects/promise#thenables">Thenable objects</a> are resolved just the same as actual <code>Promise</code> objects.</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="tjs9ZD/IYrSw4+2cPi5NHttePXNzJzizu+etWtXtD4s=" data-language="js"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> thenable <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> _reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">"resolved!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">await</span> thenable<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "resolved!"</span>
<span class="token punctuation">}</span>

<span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
</div> <p>They can also be rejected:</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="dx56cEnk4iwHPKP3sQpNq6lFOfF1tslTb2kzlXd/mr0=" data-language="js"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> thenable <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">"rejected!"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> thenable<span class="token punctuation">;</span> <span class="token comment">// Throws Error: rejected!</span>
<span class="token punctuation">}</span>

<span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
</div>
</div></section><section aria-labelledby="conversion_to_promise"><h3 id="conversion_to_promise">Conversion to promise</h3>
<div class="section-content">
<p>If the value is not a <code>Promise</code>, <code>await</code> converts the value to a resolved <code>Promise</code>, and waits for it. The awaited value's identity doesn't change as long as it doesn't have a <code>then</code> property that's callable.</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="AP6RLUU3sMRHyZISIi3qXYgFmBqvF8eoOi3HeQuo6t0=" data-language="js"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">f3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> y <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token number">20</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 20</span>

  <span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">await</span> obj<span class="token punctuation">)</span> <span class="token operator">===</span> obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token punctuation">}</span>

<span class="token function">f3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
</div>
</div></section><section aria-labelledby="handling_rejected_promises"><h3 id="handling_rejected_promises">Handling rejected promises</h3>
<div class="section-content">
<p>If the <code>Promise</code> is rejected, the rejected value is thrown.</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="Xeb+g+Gq9hIJzH1wP4BGaiCyrlKY6uQ7VSGncefGYlY=" data-language="js"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">f4</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> z <span class="token operator">=</span> <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 30</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token function">f4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
</div> <p>You can handle rejected promises without a <code>try</code> block by chaining a <a href="../global_objects/promise/catch"><code>catch()</code></a> handler before awaiting the promise.</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="zm1hVCUYw6dHeVGuKoGkD7emIqpXA6R/WMdLymZ0D+0=" data-language="js"><span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">promisedFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token string">"default response"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// response will be "default response" if the promise is rejected</span>
</pre>
</div> <p>This is built on the assumption that <code>promisedFunction()</code> never synchronously throws an error, but always returns a rejected promise. This is the case for most properly-designed promise-based functions, which usually look like:</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="GXnFXTrIAgTmYm7iQs+WEnmWLyo/YnzfPyEfxMFG5d8=" data-language="js"><span class="token keyword">function</span> <span class="token function">promisedFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Immediately return a promise to minimize chance of an error being thrown</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// do something async</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre>
</div> <p>However, if <code>promisedFunction()</code> does throw an error synchronously, the error won't be caught by the <code>catch()</code> handler. In this case, the <code>try...catch</code> statement is necessary.</p>
</div></section><section aria-labelledby="top_level_await"><h3 id="top_level_await">Top level await</h3>
<div class="section-content">
<p>You can use the <code>await</code> keyword on its own (outside of an async function) at the top level of a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules">module</a>. This means that modules with child modules that use <code>await</code> will wait for the child modules to execute before they themselves run, all while not blocking other child modules from loading.</p> <p>Here is an example of a simple module using the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API">Fetch API</a> and specifying await within the <a href="../statements/export"><code>export</code></a> statement. Any modules that include this will wait for the fetch to resolve before running any code.</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="zW9o/Kuynx6DcMSI4XNRQBLgPLYCNy8EmWnPOJaiFnE=" data-language="js"><span class="token comment">// fetch request</span>
<span class="token keyword">const</span> colors <span class="token operator">=</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"../data/colors.json"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">await</span> colors<span class="token punctuation">;</span>
</pre>
</div>
</div></section><section aria-labelledby="control_flow_effects_of_await"><h3 id="control_flow_effects_of_await">Control flow effects of await</h3>
<div class="section-content">
<p>When an <code>await</code> is encountered in code (either in an async function or in a module), the awaited expression is executed, while all code that depends on the expression's value is paused and pushed into the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Event_loop">microtask queue</a>. The main thread is then freed for the next task in the event loop. This happens even if the awaited value is an already-resolved promise or not a promise. For example, consider the following code:</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="+jEkoBZM3ySyoc60Zt6HHs0LvS1RijXVCW0RNpZA2ac=" data-language="js"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token string">"start"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token string">"middle"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token string">"end"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">foo</span><span class="token punctuation">(</span><span class="token string">"First"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token string">"Second"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// First start</span>
<span class="token comment">// First middle</span>
<span class="token comment">// First end</span>
<span class="token comment">// Second start</span>
<span class="token comment">// Second middle</span>
<span class="token comment">// Second end</span>
</pre>
</div> <p>In this case, the two async functions are synchronous in effect, because they don't contain any <code>await</code> expression. The three statements happen in the same tick. In promise terms, the function corresponds to:</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="x4W8P4xQIbaNNCMtVjcIpb7JBk3VX93Mbb9HZQixMic=" data-language="js"><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token string">"start"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token string">"middle"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token string">"end"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre>
</div> <p>However, as soon as there's one <code>await</code>, the function becomes asynchronous, and execution of following statements is deferred to the next tick.</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="hLF3InQtRcxpAR6mbv8Zkj+o6V3gOkpcHMyOv5TpKvs=" data-language="js"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token string">"start"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token string">"middle"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token string">"end"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">foo</span><span class="token punctuation">(</span><span class="token string">"First"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token string">"Second"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// First start</span>
<span class="token comment">// First middle</span>
<span class="token comment">// Second start</span>
<span class="token comment">// Second middle</span>
<span class="token comment">// First end</span>
<span class="token comment">// Second end</span>
</pre>
</div> <p>This corresponds to:</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="tdkTVCrSXIFLVtFDl4sKTcmCsRC4ZudIuKaKFt2+/X0=" data-language="js"><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token string">"start"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token string">"middle"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token string">"end"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre>
</div> <p>While the extra <code>then()</code> handler is not necessary, and the handler can be merged with the executor passed to the constructor, the <code>then()</code> handler's existence means the code will take one extra tick to complete. The same happens for <code>await</code>. Therefore, make sure to use <code>await</code> only when necessary (to unwrap promises into their values).</p> <p>Other microtasks can execute before the async function resumes. This example uses <a href="https://developer.mozilla.org/en-US/docs/Web/API/queueMicrotask"><code>queueMicrotask()</code></a> to demonstrate how the microtask queue is processed when each <code>await</code> expression is encountered.</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="LFI/KA2+eanfxA4V7sziu33lzfozAAXqp85r1Kz8KVw=" data-language="js"><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token function">queueMicrotask</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  i<span class="token operator">++</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"microtask"</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">queueMicrotask</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"async function start"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"async function resume"</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">await</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"async function end"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">queueMicrotask</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"queueMicrotask() after calling async function"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"script sync part end"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Logs:</span>
<span class="token comment">// async function start</span>
<span class="token comment">// script sync part end</span>
<span class="token comment">// microtask 1</span>
<span class="token comment">// async function resume 1</span>
<span class="token comment">// queueMicrotask() after calling async function</span>
<span class="token comment">// microtask 2</span>
<span class="token comment">// async function resume 2</span>
<span class="token comment">// microtask 3</span>
<span class="token comment">// async function end</span>
</pre>
</div> <p>In this example, the <code>test()</code> function is always called before the async function resumes, so the microtasks they each schedule are always executed in an intertwined fashion. On the other hand, because both <code>await</code> and <code>queueMicrotask()</code> schedule microtasks, the order of execution is always based on the order of scheduling. This is why the "queueMicrotask() after calling async function" log happens after the async function resumes for the first time.</p>
</div></section><section aria-labelledby="improving_stack_trace"><h3 id="improving_stack_trace">Improving stack trace</h3>
<div class="section-content">
<p>Sometimes, the <code>await</code> is omitted when a promise is directly returned from an async function.</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="RBdyFMbdhajcbt6RTm47mQK8/bcrtJMH5CWbvfdyRxU=" data-language="js"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">noAwait</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Some actions...</span>

  <span class="token keyword">return</span> <span class="token comment">/* await */</span> <span class="token function">lastAsyncTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre>
</div> <p>However, consider the case where <code>lastAsyncTask</code> asynchronously throws an error.</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="daC1qCqFOrjbTgM5oWWjiXSGFEFCRP5mKj4xnY7pu9k=" data-language="js"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">lastAsyncTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">"failed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">noAwait</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">lastAsyncTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">noAwait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Error: failed</span>
<span class="token comment">//    at lastAsyncTask</span>
</pre>
</div> <p>Only <code>lastAsyncTask</code> appears in the stack trace, because the promise is rejected after it has already been returned from <code>noAwait</code> — in some sense, the promise is unrelated to <code>noAwait</code>. To improve the stack trace, you can use <code>await</code> to unwrap the promise, so that the exception gets thrown into the current function. The exception will then be immediately wrapped into a new rejected promise, but during error creation, the caller will appear in the stack trace.</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="BNwt6AALJLnLhAY9L8hpBGJGugu2NRTTqCjv/i3GBbY=" data-language="js"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">lastAsyncTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">"failed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">withAwait</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">await</span> <span class="token function">lastAsyncTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">withAwait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Error: failed</span>
<span class="token comment">//    at lastAsyncTask</span>
<span class="token comment">//    at async withAwait</span>
</pre>
</div> <p>However, there's a little performance penalty coming with <code>return await</code> because the promise has to be unwrapped and wrapped again.</p>
</div></section><h2 id="specifications">Specifications</h2>
<div class="_table"><table class="standard-table">
<thead><tr><th scope="col">Specification</th></tr></thead>
<tbody><tr><td><a href="https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#sec-async-function-definitions">ECMAScript Language Specification <br><small># sec-async-function-definitions</small></a></td></tr></tbody>
</table></div>
<h2 id="browser_compatibility">Browser compatibility</h2>
<div class="_table"><table>
<thead>
<tr id="bct-browser-type">
<th></th>
<th colspan="6">Desktop</th>
<th colspan="6">Mobile</th>
<th colspan="2">Server</th>
</tr>
<tr id="bct-browsers">
<th></th>
<th>Chrome</th>
<th>Edge</th>
<th>Firefox</th>
<th>Opera</th>
<th>Safari</th>
<th>Chrome Android</th>
<th>Firefox for Android</th>
<th>Opera Android</th>
<th>Safari on IOS</th>
<th>Samsung Internet</th>
<th>WebView Android</th>
<th>Deno</th>
<th>Node.js</th>
</tr>
</thead>
<tbody>
<tr>
<th><code>await</code></th>
<td class="bc-supports-yes">55</td>
<td class="bc-supports-yes">14</td>
<td class="bc-supports-yes">52</td>
<td class="bc-supports-yes">42</td>
<td class="bc-supports-yes">10.1</td>
<td class="bc-supports-yes">55</td>
<td class="bc-supports-yes">52</td>
<td class="bc-supports-yes">42</td>
<td class="bc-supports-yes">10.3</td>
<td class="bc-supports-yes">6.0</td>
<td class="bc-supports-yes">55</td>
<td class="bc-supports-yes">1.0</td>
<td class="bc-supports-yes">7.6.0</td>
</tr>
<tr>
<th><code>top_level</code></th>
<td class="bc-supports-yes">89</td>
<td class="bc-supports-yes">89</td>
<td class="bc-supports-yes">89</td>
<td class="bc-supports-yes">75</td>
<td class="bc-supports-yes">15</td>
<td class="bc-supports-yes">89</td>
<td class="bc-supports-yes">89</td>
<td class="bc-supports-yes">63</td>
<td class="bc-supports-yes">15</td>
<td class="bc-supports-yes">15.0</td>
<td class="bc-supports-yes">89</td>
<td class="bc-supports-yes">1.0</td>
<td class="bc-supports-yes"><details><summary>14.8.0</summary>Not supported in CommonJS modules.</details></td>
</tr>
</tbody>
</table></div>
<section aria-labelledby="see_also"><h2 id="see_also">See also</h2>
<div class="section-content"><ul> <li><a href="../statements/async_function"><code>async function</code></a></li> <li><a href="async_function"><code>async function</code> expression</a></li> <li><a href="../global_objects/asyncfunction"><code>AsyncFunction</code></a></li> <li>
<a href="https://v8.dev/features/top-level-await" target="_blank">Top-level await</a> on v8.dev (2019)</li> </ul></div></section><div class="_attribution">
  <p class="_attribution-p">
    © 2005–2023 MDN contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
