
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>hs.webview.usercontent - Hammerspoon - W3cubDocs</title>
  
  <meta name="description" content="This module provides support for injecting custom JavaScript user content into your webviews and for JavaScript to post messages back to Hammerspoon &hellip;">
  <meta name="keywords" content="hs, webview, usercontent, hammerspoon">
  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/hammerspoon/hs.webview.usercontent.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-c8f743fc70bb84079c3cf4b71f5f99835529659c30689b2fd6193651a680f383ef1d96896f8966c7ca8a0160ffd557685bb8ad12820ec6002d60143812238086.css">
  <script type="text/javascript" src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js"></script>
  <script src="/json/hammerspoon.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/hammerspoon/" class="_nav-link" title="" style="margin-left:0;">Hammerspoon</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _hammerspoon">
				
				
<header> <h1>hs.webview.usercontent</h1> <p>This module provides support for injecting custom JavaScript user content into your webviews and for JavaScript to post messages back to Hammerspoon.</p> </header> <h3>API Overview</h3> <ul> <li>Constructors - API calls which return an object, typically one that offers API methods</li> <ul> <li><a href="#new">new</a></li> </ul> <li>Methods - API calls which can only be made on an object returned by a constructor</li> <ul> <li><a href="#injectScript">injectScript</a></li> <li><a href="#removeAllScripts">removeAllScripts</a></li> <li><a href="#setCallback">setCallback</a></li> <li><a href="#userScripts">userScripts</a></li> </ul> </ul> <h3>API Documentation</h3> <h4 class="documentation-section">Constructors</h4> <section id="new">  <h5><a href="#new">new</a></h5> <table> <tr> <th>Signature</th> <td><code>hs.webview.usercontent.new(name) -&gt; usercontentControllerObject</code></td> </tr> <tr> <th>Type</th> <td>Constructor</td> </tr> <tr> <th>Description</th> <td>
<p>Create a new user content controller for a webview and create the message port with the specified name for JavaScript message support.</p> </td> </tr> <tr> <th>Parameters</th> <td>
<ul> <li>name - the name of the message port which JavaScript in the webview can use to post messages to Hammerspoon.</li> </ul> </td> </tr> <tr> <th>Returns</th> <td>
<ul> <li>the usercontentControllerObject</li> </ul> </td> </tr> <tr> <th>Notes</th> <td>
<ul> <li>This object should be provided as the final argument to the <code>hs.webview.new</code> constructor in order to tie the webview to this content controller. All new windows which are created from this parent webview will also use this controller.</li> <li>See <code>hs.webview.usercontent:setCallback</code> for more information about the message port.</li> </ul> </td> </tr> <tr> <th>Source</th> <td><a href="https://github.com/Hammerspoon/hammerspoon/blob/master/extensions/webview/libwebview_usercontent.m#L34">extensions/webview/libwebview_usercontent.m line 34</a></td> </tr> </table> </section> <h4 class="documentation-section">Methods</h4> <section id="injectScript">  <h5><a href="#injectScript">injectScript</a></h5> <table> <tr> <th>Signature</th> <td><code>hs.webview.usercontent:injectScript(scriptTable) -&gt; usercontentControllerObject</code></td> </tr> <tr> <th>Type</th> <td>Method</td> </tr> <tr> <th>Description</th> <td>
<p>Add a script to be injected into webviews which use this user content controller.</p> </td> </tr> <tr> <th>Parameters</th> <td>
<ul> <li>scriptTable - a table containing the following keys which define the script and how it is to be injected:<ul> <li>source - the javascript which is injected (required)</li> <li>mainFrame - a boolean value which indicates whether this script is only injected for the main webview frame (true) or for all frames within the webview (false). Defaults to true.</li> <li>injectionTime - a string which indicates whether the script is injected at "documentStart" or "documentEnd". Defaults to "documentStart".</li> </ul> </li> </ul> </td> </tr> <tr> <th>Returns</th> <td>
<ul> <li>the usercontentControllerObject or nil if the script table was malformed in some way.</li> </ul> </td> </tr> <tr> <th>Source</th> <td><a href="https://github.com/Hammerspoon/hammerspoon/blob/master/extensions/webview/libwebview_usercontent.m#L59">extensions/webview/libwebview_usercontent.m line 59</a></td> </tr> </table> </section> <section id="removeAllScripts">  <h5><a href="#removeAllScripts">removeAllScripts</a></h5> <table> <tr> <th>Signature</th> <td><code>hs.webview.usercontent:removeAllScripts() -&gt; usercontentControllerObject</code></td> </tr> <tr> <th>Type</th> <td>Method</td> </tr> <tr> <th>Description</th> <td>
<p>Removes all user scripts currently defined for this user content controller.</p> </td> </tr> <tr> <th>Parameters</th> <td>
<ul> <li>None</li> </ul> </td> </tr> <tr> <th>Returns</th> <td>
<ul> <li>the usercontentControllerObject</li> </ul> </td> </tr> <tr> <th>Notes</th> <td>
<ul> <li>The WKUserContentController class only allows for removing all scripts. If you need finer control, make a copy of the current scripts with <code>hs.webview.usercontent.userScripts()</code> first so you can recreate the scripts you want to keep.</li> </ul> </td> </tr> <tr> <th>Source</th> <td><a href="https://github.com/Hammerspoon/hammerspoon/blob/master/extensions/webview/libwebview_usercontent.m#L111">extensions/webview/libwebview_usercontent.m line 111</a></td> </tr> </table> </section> <section id="setCallback">  <h5><a href="#setCallback">setCallback</a></h5> <table> <tr> <th>Signature</th> <td><code>hs.webview.usercontent:setCallback(fn) -&gt; usercontentControllerObject</code></td> </tr> <tr> <th>Type</th> <td>Method</td> </tr> <tr> <th>Description</th> <td>
<p>Set or remove the callback function to handle message posted to this user content's message port.</p> </td> </tr> <tr> <th>Parameters</th> <td>
<ul> <li>fn - The function which should receive messages posted to this user content's message port. Specify an explicit nil to disable the callback. The function should take one argument which will be the message posted and any returned value will be ignored.</li> </ul> </td> </tr> <tr> <th>Returns</th> <td>
<ul> <li>the usercontentControllerObject</li> </ul> </td> </tr> <tr> <th>Notes</th> <td>
<ul> <li>
<p>Within your (injected or served) JavaScript, you can post messages via the message port created with the constructor like this:</p> <p>try { webkit.messageHandlers.<em>name</em>&gt;.postMessage(<em>message-object</em>); } catch(err) { console.log('The controller does not exist yet'); }</p> </li> <li>
<p>Where <em>name</em> matches the name specified in the constructor and <em>message-object</em> is the object to post to the function. This object can be a number, string, date, array, dictionary(table), or nil.</p> </li> </ul> </td> </tr> <tr> <th>Source</th> <td><a href="https://github.com/Hammerspoon/hammerspoon/blob/master/extensions/webview/libwebview_usercontent.m#L133">extensions/webview/libwebview_usercontent.m line 133</a></td> </tr> </table> </section> <section id="userScripts">  <h5><a href="#userScripts">userScripts</a></h5> <table> <tr> <th>Signature</th> <td><code>hs.webview.usercontent:userScripts() -&gt; array</code></td> </tr> <tr> <th>Type</th> <td>Method</td> </tr> <tr> <th>Description</th> <td>
<p>Get a table containing all of the currently defined injection scripts for this user content controller</p> </td> </tr> <tr> <th>Parameters</th> <td>
<ul> <li>None</li> </ul> </td> </tr> <tr> <th>Returns</th> <td>
<ul> <li>An array of injected user scripts. Each entry in the array will be a table containing the following keys:<ul> <li>source - the javascript which is injected</li> <li>mainFrame - a boolean value which indicates whether this script is only injected for the main webview frame (true) or for all frames within the webview (false)</li> <li>injectionTime - a string which indicates whether the script is injected at "documentStart" or "documentEnd".</li> </ul> </li> </ul> </td> </tr> <tr> <th>Notes</th> <td>
<ul> <li>Because the WKUserContentController class only allows for removing all scripts, you can use this method to generate a list of all scripts, modify it, and then use it in a loop to reapply the scripts if you need to remove just a few scripts.</li> </ul> </td> </tr> <tr> <th>Source</th> <td><a href="https://github.com/Hammerspoon/hammerspoon/blob/master/extensions/webview/libwebview_usercontent.m#L86">extensions/webview/libwebview_usercontent.m line 86</a></td> </tr> </table> </section><div class="_attribution">
  <p class="_attribution-p">
    © 2014–2017 Hammerspoon contributors<br>Licensed under the MIT License.<br>
    <a href="https://www.hammerspoon.org/docs/hs.webview.usercontent.html" class="_attribution-link">https://www.hammerspoon.org/docs/hs.webview.usercontent.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
