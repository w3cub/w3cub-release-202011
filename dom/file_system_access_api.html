
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>File System Access API - Web APIs - W3cubDocs</title>
  
  <meta name="description" content=" Secure context&#58; This feature is available only in secure contexts (HTTPS), in some or all supporting browsers. ">
  <meta name="keywords" content="file, system, access, api, web, apis, dom">
  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/dom/file_system_access_api.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-9c7b0d969c0ce639a6c01c2badcdd81667c7c66206aa3d0fccc5cb0585fb1b912dab72ea882101d18010680927514b4b77b107282db8f756fbf63301fe9c88b0.css">
  <script type="text/javascript" src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js"></script>
  <script src="/json/dom.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/dom/" class="_nav-link" title="" style="margin-left:0;">Web APIs</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _mdn">
				
				
<h1>File System Access API</h1>
<div class="section-content">
<div class="notecard secure" id="sect1"><p><strong>Secure context:</strong> This feature is available only in <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts">secure contexts</a> (HTTPS), in some or all <a href="#browser_compatibility">supporting browsers</a>.</p></div> <p>The File System Access API allows read, write and file management capabilities.</p>
</div>
<h2 id="concepts_and_usage">Concepts and Usage</h2>
<div class="section-content">
<p>This API allows interaction with files on a user's local device, or on a user-accessible network file system. Core functionality of this API includes reading files, writing or saving files, and access to directory structure.</p> <p>Most of the interaction with files and directories is accomplished through handles. A parent <a href="filesystemhandle"><code>FileSystemHandle</code></a> class helps define two child classes: <a href="filesystemfilehandle"><code>FileSystemFileHandle</code></a> and <a href="filesystemdirectoryhandle"><code>FileSystemDirectoryHandle</code></a>, for files and directories respectively.</p> <p>The handles represent a file or directory on the user's system. You can first gain access to them by showing the user a file or directory picker using methods such as <a href="window/showopenfilepicker"><code>window.showOpenFilePicker()</code></a> and <a href="window/showdirectorypicker"><code>window.showDirectoryPicker()</code></a>. Once these are called, the file picker presents itself and the user selects either a file or directory. Once this happens successfully, a handle is returned.</p> <p>You can also gain access to file handles via:</p> <ul> <li>The <a href="datatransferitem/getasfilesystemhandle"><code>DataTransferItem.getAsFileSystemHandle()</code></a> method of the <a href="html_drag_and_drop_api">HTML Drag and Drop API</a>.</li> <li>The <a href="https://developer.chrome.com/en/articles/file-handling/" target="_blank">File Handling API</a>.</li> </ul> <p>Each handle provides its own functionality and there are a few differences depending on which one you are using (see the <a href="#interfaces">interfaces</a> section for specific details). You then can access file data, or information (including children) of the directory selected. This API opens up potential functionality the web has been lacking. Still, security has been of utmost concern when designing the API, and access to file/directory data is disallowed unless the user specifically permits it.</p> <div class="notecard note" id="sect2"> <p><strong>Note:</strong> The different exceptions that can be thrown when using the features of this API are listed on relevant pages as defined in the spec. However, the situation is made more complex by the interaction of the API and the underlying operating system. A proposal has been made to <a href="https://github.com/whatwg/fs/issues/57" target="_blank">list the error mappings in the spec</a>, which includes useful related information.</p> </div> <div class="notecard note" id="sect3"> <p><strong>Note:</strong> Objects based on <a href="filesystemhandle"><code>FileSystemHandle</code></a> can also be serialized into an <a href="indexeddb_api">IndexedDB</a> database instance, or transferred via <a href="window/postmessage"><code>postMessage()</code></a>.</p> </div>
</div>
<h3 id="origin_private_file_system">Origin private file system</h3>
<div class="section-content">
<p>The <a href="https://fs.spec.whatwg.org/#origin-private-file-system" target="_blank">origin private file system (OPFS)</a> is a storage endpoint private to the origin of the page, providing optional access to a special kind of file that is highly optimized for performance, for example, by offering in-place and exclusive write access to a file's content.</p> <p>Storing data in the OPFS is similar to storing data in any other browser-provided storage mechanism that's private to the origin of the page (for example the <a href="indexeddb_api">IndexedDB API</a>). This means that files in the OPFS differ from files selected using a picker in the following ways:</p> <ul> <li>Permission prompts are not required to access files in the OPFS.</li> <li>Clearing data for the site deletes the OPFS.</li> <li>The OPFS is subject to browser quota restrictions.</li> </ul> <p>Files can be manipulated inside the OPFS via a three-step process:</p> <ol> <li>The <a href="storagemanager/getdirectory"><code>StorageManager.getDirectory()</code></a> method, which is obtained using <a href="navigator/storage"><code>navigator.storage.getDirectory()</code></a> in a worker or the main thread, returns a reference to a <a href="filesystemdirectoryhandle"><code>FileSystemDirectoryHandle</code></a> object allowing access to a directory and its contents â€” this represents the root of the OPFS.</li> <li>The <a href="filesystemdirectoryhandle/getfilehandle"><code>FileSystemDirectoryHandle.getFileHandle()</code></a> method is invoked to return a <a href="filesystemfilehandle"><code>FileSystemFileHandle</code></a> object representing a handle to a specific file in the directory.</li> <li>The <a href="filesystemfilehandle/createsyncaccesshandle"><code>createSyncAccessHandle()</code></a> method is invoked on that file handle, and returns a <a href="filesystemsyncaccesshandle"><code>FileSystemSyncAccessHandle</code></a> object that can be used to read and write to the file. This is a high-performance handle for <em>synchronous</em> read/write operations (the other handle types are asynchronous). The synchronous nature of this class brings performance advantages intended for use in contexts where asynchronous operations come with high overhead (for example, <a href="https://developer.mozilla.org/en-US/docs/WebAssembly">WebAssembly</a>). Note that it is only usable inside dedicated <a href="web_workers_api">Web Workers</a>.</li> </ol> <p>While browsers typically implement this by persisting the contents of the OPFS to disk somewhere, it is not intended that the contents be easily user-accessible. While the browser might make it seem that there are files, they might be stored in a database or any other data structure. You cannot expect to find the created files matched one-to-one somewhere on the hard disk.</p> <div class="notecard note" id="sect4"> <p><strong>Note:</strong> Writes performed using <a href="filesystemsyncaccesshandle/write"><code>FileSystemSyncAccessHandle.write()</code></a> are in-place, meaning that changes are written to the actual underlying file at the same time as they are written to the writer. This is not the case with other writing mechanisms available in this API (e.g. <a href="filesystemfilehandle/createwritable"><code>FileSystemFileHandle.createWritable()</code></a>), where changes are not committed to disk until the writing stream is closed.</p> </div>
</div>
<h3 id="saving_files">Saving files</h3>
<div class="section-content">
<p>There is also "save" functionality:</p> <ul> <li>In the case of the asynchronous handles, use the <a href="filesystemwritablefilestream"><code>FileSystemWritableFileStream</code></a> interface. Once the data you'd like to save is in a format of <a href="blob"><code>Blob</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String"><code>String</code></a> object, string literal or <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer"><code>buffer</code></a>, you can open a stream and save the data to a file. This can be the existing file or a new file.</li> <li>In the case of the synchronous <a href="filesystemsyncaccesshandle"><code>FileSystemSyncAccessHandle</code></a>, you write changes to a file using the <a href="filesystemsyncaccesshandle/write"><code>write()</code></a> method. You can optionally also call <a href="filesystemsyncaccesshandle/flush"><code>flush()</code></a> if you need the changes committed to disk at a specific time (otherwise you can leave the underlying operating system to handle this when it sees fit, which should be OK in most cases).</li> </ul>
</div>
<h2 id="interfaces">Interfaces</h2>
<div class="section-content"><dl> <dt id="filesystemhandle"><a href="filesystemhandle"><code>FileSystemHandle</code></a></dt> <dd> <p>The <code>FileSystemHandle</code> interface is an object which represents an entry. Multiple handles can represent the same entry. For the most part you do not work with <code>FileSystemHandle</code> directly but rather its child interfaces <a href="filesystemfilehandle"><code>FileSystemFileHandle</code></a> and <a href="filesystemdirectoryhandle"><code>FileSystemDirectoryHandle</code></a>.</p> </dd> <dt id="filesystemfilehandle"><a href="filesystemfilehandle"><code>FileSystemFileHandle</code></a></dt> <dd> <p>Provides a handle to a file system entry.</p> </dd> <dt id="filesystemdirectoryhandle"><a href="filesystemdirectoryhandle"><code>FileSystemDirectoryHandle</code></a></dt> <dd> <p>provides a handle to a file system directory.</p> </dd> <dt id="filesystemsyncaccesshandle"><a href="filesystemsyncaccesshandle"><code>FileSystemSyncAccessHandle</code></a></dt> <dd> <p>Provides a synchronous handle to a file system entry, which operates in-place on a single file on disk. The synchronous nature of the file reads and writes allows for higher performance for critical methods in contexts where asynchronous operations come with high overhead, e.g., <a href="https://developer.mozilla.org/en-US/docs/WebAssembly">WebAssembly</a>. This class is only accessible inside dedicated <a href="web_workers_api">Web Workers</a> for files within the <a href="#origin_private_file_system">origin private file system</a>.</p> </dd> <dt id="filesystemwritablefilestream"><a href="filesystemwritablefilestream"><code>FileSystemWritableFileStream</code></a></dt> <dd> <p>is a <a href="writablestream"><code>WritableStream</code></a> object with additional convenience methods, which operates on a single file on disk.</p> </dd> </dl></div>
<h2 id="examples">Examples</h2>

<h3 id="accessing_files">Accessing files</h3>
<div class="section-content">
<p>The below code allows the user to choose a file from the file picker.</p> <div class="code-example"><pre data-language="js"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Open file picker and destructure the result the first handle</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>fileHandle<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> window<span class="token punctuation">.</span><span class="token function">showOpenFilePicker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> file <span class="token operator">=</span> <span class="token keyword">await</span> fileHandle<span class="token punctuation">.</span><span class="token function">getFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> file<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre></div> <p>The following asynchronous function presents a file picker and once a file is chosen, uses the <code>getFile()</code> method to retrieve the contents.</p> <div class="code-example"><pre data-language="js"><span class="token keyword">const</span> pickerOpts <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">types</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">description</span><span class="token operator">:</span> <span class="token string">"Images"</span><span class="token punctuation">,</span>
      <span class="token literal-property property">accept</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">"image/*"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">".png"</span><span class="token punctuation">,</span> <span class="token string">".gif"</span><span class="token punctuation">,</span> <span class="token string">".jpeg"</span><span class="token punctuation">,</span> <span class="token string">".jpg"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">excludeAcceptAllOption</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">multiple</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getTheFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Open file picker and destructure the result the first handle</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>fileHandle<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> window<span class="token punctuation">.</span><span class="token function">showOpenFilePicker</span><span class="token punctuation">(</span>pickerOpts<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// get file contents</span>
  <span class="token keyword">const</span> fileData <span class="token operator">=</span> <span class="token keyword">await</span> fileHandle<span class="token punctuation">.</span><span class="token function">getFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre></div>
</div>
<h3 id="accessing_directories">Accessing directories</h3>
<div class="section-content">
<p>The following example returns a directory handle with the specified name. If the directory does not exist, it is created.</p> <div class="code-example"><pre data-language="js"><span class="token keyword">const</span> dirName <span class="token operator">=</span> <span class="token string">"directoryToGetName"</span><span class="token punctuation">;</span>

<span class="token comment">// assuming we have a directory handle: 'currentDirHandle'</span>
<span class="token keyword">const</span> subDir <span class="token operator">=</span> currentDirHandle<span class="token punctuation">.</span><span class="token function">getDirectoryHandle</span><span class="token punctuation">(</span>dirName<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">create</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre></div> <p>The following asynchronous function uses <code>resolve()</code> to find the path to a chosen file, relative to a specified directory handle.</p> <div class="code-example"><pre data-language="js"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">returnPathDirectories</span><span class="token punctuation">(</span><span class="token parameter">directoryHandle</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Get a file handle by showing a file picker:</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>handle<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> self<span class="token punctuation">.</span><span class="token function">showOpenFilePicker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>handle<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// User cancelled, or otherwise failed to open a file.</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Check if handle exists inside directory our directory handle</span>
  <span class="token keyword">const</span> relativePaths <span class="token operator">=</span> <span class="token keyword">await</span> directoryHandle<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>handle<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>relativePaths <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Not inside directory handle</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// relativePaths is an array of names, giving the relative path</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> name <span class="token keyword">of</span> relativePaths<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// log each entry</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre></div>
</div>
<h3 id="writing_to_files">Writing to files</h3>
<div class="section-content">
<p>The following asynchronous function opens the save file picker, which returns a <a href="filesystemfilehandle"><code>FileSystemFileHandle</code></a> once a file is selected. A writable stream is then created using the <a href="filesystemfilehandle/createwritable"><code>FileSystemFileHandle.createWritable()</code></a> method.</p> <p>A user defined <a href="blob"><code>Blob</code></a> is then written to the stream which is subsequently closed.</p> <div class="code-example"><pre data-language="js"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">saveFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// create a new handle</span>
  <span class="token keyword">const</span> newHandle <span class="token operator">=</span> <span class="token keyword">await</span> window<span class="token punctuation">.</span><span class="token function">showSaveFilePicker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// create a FileSystemWritableFileStream to write to</span>
  <span class="token keyword">const</span> writableStream <span class="token operator">=</span> <span class="token keyword">await</span> newHandle<span class="token punctuation">.</span><span class="token function">createWritable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// write our file</span>
  <span class="token keyword">await</span> writableStream<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>imgBlob<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// close the file and write the contents to disk.</span>
  <span class="token keyword">await</span> writableStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre></div> <p>The following show different examples of options that can be passed into the <code>write()</code> method.</p> <div class="code-example"><pre data-language="js"><span class="token comment">// just pass in the data (no options)</span>
writableStream<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// writes the data to the stream from the determined position</span>
writableStream<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"write"</span><span class="token punctuation">,</span> position<span class="token punctuation">,</span> data <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// updates the current file cursor offset to the position specified</span>
writableStream<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"seek"</span><span class="token punctuation">,</span> position <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// resizes the file to be size bytes long</span>
writableStream<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"truncate"</span><span class="token punctuation">,</span> size <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre></div>
</div>
<h3 id="synchronously_reading_and_writing_files_in_opfs">Synchronously reading and writing files in OPFS</h3>
<div class="section-content">
<p>This example synchronously reads and writes a file to the <a href="#origin_private_file_system">origin private file system</a>.</p> <p>The following asynchronous event handler function is contained inside a Web Worker. On receiving a message from the main thread it:</p> <ul> <li>Creates a synchronous file access handle.</li> <li>Gets the size of the file and creates an <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer"><code>ArrayBuffer</code></a> to contain it.</li> <li>Reads the file contents into the buffer.</li> <li>Encodes the message and writes it to the end of the file.</li> <li>Persists the changes to disk and closes the access handle.</li> </ul> <div class="code-example"><pre data-language="js"><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// retrieve message sent to work from main script</span>
  <span class="token keyword">const</span> message <span class="token operator">=</span> e<span class="token punctuation">.</span>data<span class="token punctuation">;</span>

  <span class="token comment">// Get handle to draft file in OPFS</span>
  <span class="token keyword">const</span> root <span class="token operator">=</span> <span class="token keyword">await</span> navigator<span class="token punctuation">.</span>storage<span class="token punctuation">.</span><span class="token function">getDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> draftHandle <span class="token operator">=</span> <span class="token keyword">await</span> root<span class="token punctuation">.</span><span class="token function">getFileHandle</span><span class="token punctuation">(</span><span class="token string">"draft.txt"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">create</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Get sync access handle</span>
  <span class="token keyword">const</span> accessHandle <span class="token operator">=</span> <span class="token keyword">await</span> draftHandle<span class="token punctuation">.</span><span class="token function">createSyncAccessHandle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Get size of the file.</span>
  <span class="token keyword">const</span> fileSize <span class="token operator">=</span> accessHandle<span class="token punctuation">.</span><span class="token function">getSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Read file content to a buffer.</span>
  <span class="token keyword">const</span> buffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DataView</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ArrayBuffer</span><span class="token punctuation">(</span>fileSize<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> readBuffer <span class="token operator">=</span> accessHandle<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">at</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Write the message to the end of the file.</span>
  <span class="token keyword">const</span> encoder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TextEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> encodedMessage <span class="token operator">=</span> encoder<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> writeBuffer <span class="token operator">=</span> accessHandle<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>encodedMessage<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">at</span><span class="token operator">:</span> readBuffer <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Persist changes to disk.</span>
  accessHandle<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Always close FileSystemSyncAccessHandle if done.</span>
  accessHandle<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre></div> <div class="notecard note" id="sect5"> <p><strong>Note:</strong> In earlier versions of the spec, <a href="filesystemsyncaccesshandle/close"><code>close()</code></a>, <a href="filesystemsyncaccesshandle/flush"><code>flush()</code></a>, <a href="filesystemsyncaccesshandle/getsize"><code>getSize()</code></a>, and <a href="filesystemsyncaccesshandle/truncate"><code>truncate()</code></a> were unergonomically specified as asynchronous methods. This has now been <a href="https://github.com/whatwg/fs/issues/7" target="_blank">amended</a>, but some browsers still support the asynchronous versions.</p> </div>
</div>
<h2 id="specifications">Specifications</h2>
<div class="_table"><table class="standard-table">
<thead><tr><th scope="col">Specification</th></tr></thead>
<tbody>
<tr><td><a href="https://fs.spec.whatwg.org/#api-filesystemhandle">File System Standard <br><small># api-filesystemhandle</small></a></td></tr>
<tr><td><a href="https://fs.spec.whatwg.org/#api-filesystemfilehandle">File System Standard <br><small># api-filesystemfilehandle</small></a></td></tr>
</tbody>
</table></div>
<h2 id="browser_compatibility">Browser compatibility</h2>
<div class="_table"><table>
<thead>
<tr id="bct-browser-type">
<th></th>
<th colspan="6">Desktop</th>
<th colspan="6">Mobile</th>
</tr>
<tr id="bct-browsers">
<th></th>
<th>Chrome</th>
<th>Edge</th>
<th>Firefox</th>
<th>Internet Explorer</th>
<th>Opera</th>
<th>Safari</th>
<th>WebView Android</th>
<th>Chrome Android</th>
<th>Firefox for Android</th>
<th>Opera Android</th>
<th>Safari on IOS</th>
<th>Samsung Internet</th>
</tr>
</thead>
<tbody>
<tr>
<th><code>File_System_Access_API</code></th>
<td class="bc-supports-yes">86</td>
<td class="bc-supports-yes">86</td>
<td class="bc-supports-yes">111</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">72</td>
<td class="bc-supports-yes">15.2</td>
<td class="bc-supports-yes">86</td>
<td class="bc-supports-yes">86</td>
<td class="bc-supports-yes">111</td>
<td class="bc-supports-yes">61</td>
<td class="bc-supports-yes">15.2</td>
<td class="bc-supports-yes">14.0</td>
</tr>
<tr>
<th><code>createSyncAccessHandle</code></th>
<td class="bc-supports-yes">102</td>
<td class="bc-supports-yes">102</td>
<td class="bc-supports-yes">111</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">88</td>
<td class="bc-supports-yes">15.2</td>
<td class="bc-supports-yes">109</td>
<td class="bc-supports-yes">109</td>
<td class="bc-supports-yes">111</td>
<td class="bc-supports-yes">74</td>
<td class="bc-supports-yes">15.2</td>
<td class="bc-supports-no">No</td>
</tr>
<tr>
<th><code>createWritable</code></th>
<td class="bc-supports-yes">86</td>
<td class="bc-supports-yes">86</td>
<td class="bc-supports-yes">111</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">72</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">86</td>
<td class="bc-supports-yes">111</td>
<td class="bc-supports-yes">61</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">14.0</td>
</tr>
<tr>
<th><code>getFile</code></th>
<td class="bc-supports-yes">86</td>
<td class="bc-supports-yes">86</td>
<td class="bc-supports-yes">111</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">72</td>
<td class="bc-supports-yes">15.2</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">86</td>
<td class="bc-supports-yes">111</td>
<td class="bc-supports-yes">61</td>
<td class="bc-supports-yes">15.2</td>
<td class="bc-supports-yes">14.0</td>
</tr>
</tbody>
</table></div>
<div class="_table"><table>
<thead>
<tr id="bct-browser-type">
<th></th>
<th colspan="6">Desktop</th>
<th colspan="6">Mobile</th>
</tr>
<tr id="bct-browsers">
<th></th>
<th>Chrome</th>
<th>Edge</th>
<th>Firefox</th>
<th>Internet Explorer</th>
<th>Opera</th>
<th>Safari</th>
<th>WebView Android</th>
<th>Chrome Android</th>
<th>Firefox for Android</th>
<th>Opera Android</th>
<th>Safari on IOS</th>
<th>Samsung Internet</th>
</tr>
</thead>
<tbody>
<tr>
<th><code>File_System_Access_API</code></th>
<td class="bc-supports-yes">86</td>
<td class="bc-supports-yes">86</td>
<td class="bc-supports-yes">111</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">72</td>
<td class="bc-supports-yes">15.2</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">86</td>
<td class="bc-supports-yes">111</td>
<td class="bc-supports-yes">61</td>
<td class="bc-supports-yes">15.2</td>
<td class="bc-supports-yes">14.0</td>
</tr>
<tr>
<th><code>isSameEntry</code></th>
<td class="bc-supports-yes">86</td>
<td class="bc-supports-yes">86</td>
<td class="bc-supports-yes">111</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">72</td>
<td class="bc-supports-yes">15.2</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">86</td>
<td class="bc-supports-yes">111</td>
<td class="bc-supports-yes">61</td>
<td class="bc-supports-yes">15.2</td>
<td class="bc-supports-yes">14.0</td>
</tr>
<tr>
<th><code>kind</code></th>
<td class="bc-supports-yes">86</td>
<td class="bc-supports-yes">86</td>
<td class="bc-supports-yes">111</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">72</td>
<td class="bc-supports-yes">15.2</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">86</td>
<td class="bc-supports-yes">111</td>
<td class="bc-supports-yes">61</td>
<td class="bc-supports-yes">15.2</td>
<td class="bc-supports-yes">14.0</td>
</tr>
<tr>
<th><code>move</code></th>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">111</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">111</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
</tr>
<tr>
<th><code>name</code></th>
<td class="bc-supports-yes">86</td>
<td class="bc-supports-yes">86</td>
<td class="bc-supports-yes">111</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">72</td>
<td class="bc-supports-yes">15.2</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">86</td>
<td class="bc-supports-yes">111</td>
<td class="bc-supports-yes">61</td>
<td class="bc-supports-yes">15.2</td>
<td class="bc-supports-yes">14.0</td>
</tr>
<tr>
<th><code>queryPermission</code></th>
<td class="bc-supports-yes">86</td>
<td class="bc-supports-yes">86</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">72</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">86</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">61</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">14.0</td>
</tr>
<tr>
<th><code>remove</code></th>
<td class="bc-supports-yes">110</td>
<td class="bc-supports-yes">110</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">96</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">110</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">74</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
</tr>
<tr>
<th><code>requestPermission</code></th>
<td class="bc-supports-yes">86</td>
<td class="bc-supports-yes">86</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">72</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">86</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">61</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">14.0</td>
</tr>
</tbody>
</table></div>
<h3 id="api.filesystemhandle">api.FileSystemHandle</h3>
<p>BCD tables only load in the browser<noscript> with JavaScript enabled. Enable JavaScript to view data.</noscript></p>
<h3 id="api.filesystemfilehandle">api.FileSystemFileHandle</h3>
<p>BCD tables only load in the browser<noscript> with JavaScript enabled. Enable JavaScript to view data.</noscript></p>
<h2 id="see_also">See also</h2>
<div class="section-content"><ul> <li><a href="https://web.dev/file-system-access/" target="_blank">The File System Access API: simplifying access to local files</a></li> </ul></div>
<div class="_attribution">
  <p class="_attribution-p">
    Â© 2005â€“2023 MDN contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
