
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>SubtleCrypto.encrypt - Web APIs - W3cubDocs</title>
  
  <meta name="description" content=" Secure context&#58; This feature is available only in secure contexts (HTTPS), in some or all supporting browsers. ">
  <meta name="keywords" content="subtlecrypto, encrypt, method, web, apis, dom">
  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/dom/subtlecrypto/encrypt.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-c8f743fc70bb84079c3cf4b71f5f99835529659c30689b2fd6193651a680f383ef1d96896f8966c7ca8a0160ffd557685bb8ad12820ec6002d60143812238086.css">
  <script type="text/javascript" src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js"></script>
  <script src="/json/dom.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/dom/" class="_nav-link" title="" style="margin-left:0;">Web APIs</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _mdn">
				
				
<header><h1>SubtleCrypto: encrypt() method</h1></header><div class="section-content">
<div class="notecard secure" id="sect1"><p><strong>Secure context:</strong> This feature is available only in <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts">secure contexts</a> (HTTPS), in some or all <a href="#browser_compatibility">supporting browsers</a>.</p></div> <p>The <code>encrypt()</code> method of the <a href="../subtlecrypto"><code>SubtleCrypto</code></a> interface encrypts data.</p> <p> It takes as its arguments a <a href="https://developer.mozilla.org/en-US/docs/Glossary/Key">key</a> to encrypt with, some algorithm-specific parameters, and the data to encrypt (also known as "plaintext"). It returns a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise"><code>Promise</code></a> which will be fulfilled with the encrypted data (also known as "ciphertext"). </p>
</div>
<h2 id="syntax">Syntax</h2>
<div class="section-content"><div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="tZJz33GKZ12mmR3wvoYykydQgfBGFKWLONI6KA2alV4=" data-language="js"><span class="token function">encrypt</span><span class="token punctuation">(</span>algorithm<span class="token punctuation">,</span> key<span class="token punctuation">,</span> data<span class="token punctuation">)</span>
</pre>
</div></div>
<h3 id="parameters">Parameters</h3>
<div class="section-content"><dl> <dt id="algorithm"><a href="#algorithm"><code>algorithm</code></a></dt> <dd> <p>An object specifying the <a href="#supported_algorithms">algorithm</a> to be used and any extra parameters if required:</p> <ul> <li>To use <a href="#rsa-oaep">RSA-OAEP</a>, pass an <a href="../rsaoaepparams"><code>RsaOaepParams</code></a> object.</li> <li>To use <a href="#aes-ctr">AES-CTR</a>, pass an <a href="../aesctrparams"><code>AesCtrParams</code></a> object.</li> <li>To use <a href="#aes-cbc">AES-CBC</a>, pass an <a href="../aescbcparams"><code>AesCbcParams</code></a> object.</li> <li>To use <a href="#aes-gcm">AES-GCM</a>, pass an <a href="../aesgcmparams"><code>AesGcmParams</code></a> object.</li> </ul> </dd> <dt id="key"><a href="#key"><code>key</code></a></dt> <dd> <p>A <a href="../cryptokey"><code>CryptoKey</code></a> containing the key to be used for encryption.</p> </dd> <dt id="data"><a href="#data"><code>data</code></a></dt> <dd> <p> An <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer"><code>ArrayBuffer</code></a>, a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray"><code>TypedArray</code></a>, or a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView"><code>DataView</code></a> containing the data to be encrypted (also known as the <a href="https://developer.mozilla.org/en-US/docs/Glossary/Plaintext">plaintext</a>). </p> </dd> </dl></div>
<h3 id="return_value">Return value</h3>
<div class="section-content"><p>A <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise"><code>Promise</code></a> that fulfills with an <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer"><code>ArrayBuffer</code></a> containing the "ciphertext".</p></div>
<h3 id="exceptions">Exceptions</h3>
<div class="section-content">
<p>The promise is rejected when the following exceptions are encountered:</p> <dl> <dt id="invalidaccesserror">
<a href="#invalidaccesserror"><code>InvalidAccessError</code></a> <a href="../domexception"><code>DOMException</code></a>
</dt> <dd> <p>Raised when the requested operation is not valid for the provided key (e.g. invalid encryption algorithm, or invalid key for the specified encryption algorithm).</p> </dd> <dt id="operationerror">
<a href="#operationerror"><code>OperationError</code></a> <a href="../domexception"><code>DOMException</code></a>
</dt> <dd> <p>Raised when the operation failed for an operation-specific reason (e.g. algorithm parameters of invalid sizes, or AES-GCM plaintext longer than 2<sup>39</sup>−256 bytes).</p> </dd> </dl>
</div>
<h2 id="supported_algorithms">Supported algorithms</h2>
<div class="section-content">
<p>The Web Crypto API provides four algorithms that support the <code>encrypt()</code> and <code>decrypt()</code> operations.</p> <p>One of these algorithms — RSA-OAEP — is a <a href="https://developer.mozilla.org/en-US/docs/Glossary/Public-key_cryptography">public-key cryptosystem</a>.</p> <p> The other three encryption algorithms here are all <a href="https://developer.mozilla.org/en-US/docs/Glossary/Symmetric-key_cryptography">symmetric algorithms</a>, and they're all based on the same underlying cipher, AES (Advanced Encryption Standard). The difference between them is the <a href="https://developer.mozilla.org/en-US/docs/Glossary/Block_cipher_mode_of_operation">mode</a>. The Web Crypto API supports three different AES modes: </p> <ul> <li>CTR (Counter Mode)</li> <li>CBC (Cipher Block Chaining)</li> <li>GCM (Galois/Counter Mode)</li> </ul> <p> It's strongly recommended to use <em>authenticated encryption</em>, which includes checks that the ciphertext has not been modified by an attacker. Authentication helps protect against <em>chosen-ciphertext</em> attacks, in which an attacker can ask the system to decrypt arbitrary messages, and use the result to deduce information about the secret key. While it's possible to add authentication to CTR and CBC modes, they do not provide it by default and when implementing it manually one can easily make minor, but serious mistakes. GCM does provide built-in authentication, and for this reason it's often recommended over the other two AES modes. </p>
</div>
<h3 id="rsa-oaep">RSA-OAEP</h3>
<div class="section-content"><p>The RSA-OAEP public-key encryption system is specified in <a href="https://datatracker.ietf.org/doc/html/rfc3447" target="_blank">RFC 3447</a>.</p></div>
<h3 id="aes-ctr">AES-CTR</h3>
<div class="section-content">
<p>This represents AES in Counter Mode, as specified in <a href="https://csrc.nist.gov/publications/detail/sp/800-38a/final" target="_blank">NIST SP800-38A</a>.</p> <p> AES is a block cipher, meaning that it splits the message into blocks and encrypts it a block at a time. In CTR mode, every time a block of the message is encrypted, an extra block of data is mixed in. This extra block is called the "counter block". </p> <p>A given counter block value must never be used more than once with the same key:</p> <ul> <li>Given a message <em>n</em> blocks long, a different counter block must be used for every block.</li> <li>If the same key is used to encrypt more than one message, a different counter block must be used for all blocks across all messages.</li> </ul> <p>Typically this is achieved by splitting the initial counter block value into two concatenated parts:</p> <ul> <li>A <a href="https://en.wikipedia.org/wiki/Cryptographic_nonce" target="_blank">nonce</a> (that is, a number that may only be used once). The nonce part of the block stays the same for every block in the message. Each time a new message is to be encrypted, a new nonce is chosen. Nonces don't have to be secret, but they must not be reused with the same key.</li> <li>A counter. This part of the block gets incremented each time a block is encrypted.</li> </ul> <p>Essentially: the nonce should ensure that counter blocks are not reused from one message to the next, while the counter should ensure that counter blocks are not reused within a single message.</p> <div class="notecard note" id="sect2"> <p><strong>Note:</strong> See <a href="https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38a.pdf#%5B%7B%22num%22%3A70%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22Fit%22%7D%5D" target="_blank">Appendix B of the NIST SP800-38A standard</a> for more information.</p> </div>
</div>
<h3 id="aes-cbc">AES-CBC</h3>
<div class="section-content"><p>This represents AES in Cipher Block Chaining Mode, as specified in <a href="https://csrc.nist.gov/publications/detail/sp/800-38a/final" target="_blank">NIST SP800-38A</a>.</p></div>
<h3 id="aes-gcm">AES-GCM</h3>
<div class="section-content">
<p>This represents AES in Galois/Counter Mode, as specified in <a href="https://csrc.nist.gov/publications/detail/sp/800-38d/final" target="_blank">NIST SP800-38D</a>.</p> <p>One major difference between this mode and the others is that GCM is an "authenticated" mode, which means that it includes checks that the ciphertext has not been modified by an attacker.</p>
</div>
<h2 id="examples">Examples</h2>
<div class="section-content"><div class="notecard note" id="sect3"> <p><strong>Note:</strong> You can <a href="https://mdn.github.io/dom-examples/web-crypto/encrypt-decrypt/index.html" target="_blank">try the working examples</a> out on GitHub.</p> </div></div>
<h3 id="rsa-oaep_2">RSA-OAEP</h3>
<div class="section-content">
<p> This code fetches the contents of a text box, encodes it for encryption, and encrypts it with using RSA-OAEP. <a href="https://github.com/mdn/dom-examples/blob/main/web-crypto/encrypt-decrypt/rsa-oaep.js" target="_blank">See the complete code on GitHub.</a> </p> <div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="HwT/c8dHeNsyMD4926tBjpFQ4A927TuJJ3tJH1WD6gY=" data-language="js"><span class="token keyword">function</span> <span class="token function">getMessageEncoding</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> messageBox <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">".rsa-oaep #message"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> message <span class="token operator">=</span> messageBox<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
  <span class="token keyword">let</span> enc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TextEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> enc<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">encryptMessage</span><span class="token punctuation">(</span><span class="token parameter">publicKey</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> encoded <span class="token operator">=</span> <span class="token function">getMessageEncoding</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> window<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>subtle<span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"RSA-OAEP"</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    publicKey<span class="token punctuation">,</span>
    encoded<span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre>
</div>
</div>
<h3 id="aes-ctr_2">AES-CTR</h3>
<div class="section-content">
<p> This code fetches the contents of a text box, encodes it for encryption, and encrypts it using AES in CTR mode. <a href="https://github.com/mdn/dom-examples/blob/main/web-crypto/encrypt-decrypt/aes-ctr.js" target="_blank">See the complete code on GitHub.</a> </p> <div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="X+MJ27UmF1PFsXNZR8KyCViuey4pmOezNpBbGQo7IrM=" data-language="js"><span class="token keyword">function</span> <span class="token function">getMessageEncoding</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> messageBox <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">".aes-ctr #message"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> message <span class="token operator">=</span> messageBox<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
  <span class="token keyword">let</span> enc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TextEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> enc<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">encryptMessage</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> encoded <span class="token operator">=</span> <span class="token function">getMessageEncoding</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// counter will be needed for decryption</span>
  counter <span class="token operator">=</span> window<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span><span class="token function">getRandomValues</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> window<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>subtle<span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"AES-CTR"</span><span class="token punctuation">,</span>
      counter<span class="token punctuation">,</span>
      <span class="token literal-property property">length</span><span class="token operator">:</span> <span class="token number">64</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    key<span class="token punctuation">,</span>
    encoded<span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre>
</div> <div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="9pfBOhO4fzizFIciXoSPPUsJJXbUxN1sBJoqILARTIs=" data-language="js"><span class="token keyword">let</span> iv <span class="token operator">=</span> window<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span><span class="token function">getRandomValues</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> key <span class="token operator">=</span> window<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span><span class="token function">getRandomValues</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span><span class="token number">12345</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// crypto functions are wrapped in promises so we have to use await and make sure the function that</span>
<span class="token comment">// contains this code is an async function</span>
<span class="token comment">// encrypt function wants a cryptokey object</span>
<span class="token keyword">const</span> key_encoded <span class="token operator">=</span> <span class="token keyword">await</span> crypto<span class="token punctuation">.</span>subtle<span class="token punctuation">.</span><span class="token function">importKey</span><span class="token punctuation">(</span>
  <span class="token string">"raw"</span><span class="token punctuation">,</span>
  key<span class="token punctuation">.</span>buffer<span class="token punctuation">,</span>
  <span class="token string">"AES-CTR"</span><span class="token punctuation">,</span>
  <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">"encrypt"</span><span class="token punctuation">,</span> <span class="token string">"decrypt"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> encrypted_content <span class="token operator">=</span> <span class="token keyword">await</span> window<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>subtle<span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"AES-CTR"</span><span class="token punctuation">,</span>
    <span class="token literal-property property">counter</span><span class="token operator">:</span> iv<span class="token punctuation">,</span>
    <span class="token literal-property property">length</span><span class="token operator">:</span> <span class="token number">128</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  key_encoded<span class="token punctuation">,</span>
  data<span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Uint8Array</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>encrypted_content<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
</div>
</div>
<h3 id="aes-cbc_2">AES-CBC</h3>
<div class="section-content">
<p> This code fetches the contents of a text box, encodes it for encryption, and encrypts it using AES in CBC mode. <a href="https://github.com/mdn/dom-examples/blob/main/web-crypto/encrypt-decrypt/aes-cbc.js" target="_blank">See the complete code on GitHub.</a> </p> <div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="Em3jWivhtxpJ26KKDDcanX99M1RI+YyvFL+il1pfJLg=" data-language="js"><span class="token keyword">function</span> <span class="token function">getMessageEncoding</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> messageBox <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">".aes-cbc #message"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> message <span class="token operator">=</span> messageBox<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
  <span class="token keyword">let</span> enc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TextEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> enc<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">encryptMessage</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> encoded <span class="token operator">=</span> <span class="token function">getMessageEncoding</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// iv will be needed for decryption</span>
  iv <span class="token operator">=</span> window<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span><span class="token function">getRandomValues</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> window<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>subtle<span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"AES-CBC"</span><span class="token punctuation">,</span>
      <span class="token literal-property property">iv</span><span class="token operator">:</span> iv<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    key<span class="token punctuation">,</span>
    encoded<span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre>
</div>
</div>
<h3 id="aes-gcm_2">AES-GCM</h3>
<div class="section-content">
<p> This code fetches the contents of a text box, encodes it for encryption, and encrypts it using AES in GCM mode. <a href="https://github.com/mdn/dom-examples/blob/main/web-crypto/encrypt-decrypt/aes-gcm.js" target="_blank">See the complete code on GitHub.</a> </p> <div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="SdPw54ksqK3AYAO9TjpRtzmLYCeFX/J+u3DhPww3PCk=" data-language="js"><span class="token keyword">function</span> <span class="token function">getMessageEncoding</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> messageBox <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">".aes-gcm #message"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> message <span class="token operator">=</span> messageBox<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
  <span class="token keyword">const</span> enc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TextEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> enc<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">encryptMessage</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> encoded <span class="token operator">=</span> <span class="token function">getMessageEncoding</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// iv will be needed for decryption</span>
  <span class="token keyword">const</span> iv <span class="token operator">=</span> window<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span><span class="token function">getRandomValues</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> window<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>subtle<span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"AES-GCM"</span><span class="token punctuation">,</span> <span class="token literal-property property">iv</span><span class="token operator">:</span> iv <span class="token punctuation">}</span><span class="token punctuation">,</span>
    key<span class="token punctuation">,</span>
    encoded<span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre>
</div>
</div>
<h2 id="specifications">Specifications</h2>
<div class="_table"><table class="standard-table">
<thead><tr><th scope="col">Specification</th></tr></thead>
<tbody><tr><td><a href="https://w3c.github.io/webcrypto/#SubtleCrypto-method-encrypt">Web Cryptography API <br><small># SubtleCrypto-method-encrypt</small></a></td></tr></tbody>
</table></div>
<h2 id="browser_compatibility">Browser compatibility</h2>
<div class="_table"><table>
<thead>
<tr id="bct-browser-type">
<th></th>
<th colspan="6">Desktop</th>
<th colspan="6">Mobile</th>
</tr>
<tr id="bct-browsers">
<th></th>
<th>Chrome</th>
<th>Edge</th>
<th>Firefox</th>
<th>Internet Explorer</th>
<th>Opera</th>
<th>Safari</th>
<th>WebView Android</th>
<th>Chrome Android</th>
<th>Firefox for Android</th>
<th>Opera Android</th>
<th>Safari on IOS</th>
<th>Samsung Internet</th>
</tr>
</thead>
<tbody><tr>
<th><code>encrypt</code></th>
<td class="bc-supports-yes">37</td>
<td class="bc-supports-yes">79<details><summary>12–79</summary>Not supported: AES-CTR.</details>
</td>
<td class="bc-supports-yes">34</td>
<td class="bc-supports-yes"><details><summary>11</summary>Returns <code>CryptoOperation</code> instead of <code>Promise</code></details></td>
<td class="bc-supports-yes">24</td>
<td class="bc-supports-yes">7</td>
<td class="bc-supports-yes">37</td>
<td class="bc-supports-yes">37</td>
<td class="bc-supports-yes">34</td>
<td class="bc-supports-yes">24</td>
<td class="bc-supports-yes">7</td>
<td class="bc-supports-yes">3.0</td>
</tr></tbody>
</table></div>
<h2 id="see_also">See also</h2>
<div class="section-content"><ul> <li>
<a href="decrypt"><code>SubtleCrypto.decrypt()</code></a>.</li> <li>
<a href="https://datatracker.ietf.org/doc/html/rfc3447" target="_blank">RFC 3447</a> specifies RSAOAEP.</li> <li>
<a href="https://csrc.nist.gov/publications/detail/sp/800-38a/final" target="_blank">NIST SP800-38A</a> specifies CTR mode.</li> <li>
<a href="https://csrc.nist.gov/publications/detail/sp/800-38a/final" target="_blank">NIST SP800-38A</a> specifies CBC mode.</li> <li>
<a href="https://csrc.nist.gov/publications/detail/sp/800-38d/final" target="_blank">NIST SP800-38D</a> specifies GCM mode.</li> </ul></div>
<div class="_attribution">
  <p class="_attribution-p">
    © 2005–2023 MDN contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
