
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Web components.Using Custom Elements - Web APIs - W3cubDocs</title>
  
  <meta name="description" content="One of the key features of web components is the ability to create custom elements&#58; that is, HTML elements whose behavior is defined by the web &hellip;">
  <meta name="keywords" content="using, custom, elements, web, components, apis, dom">
  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/dom/web_components/using_custom_elements.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-c8f743fc70bb84079c3cf4b71f5f99835529659c30689b2fd6193651a680f383ef1d96896f8966c7ca8a0160ffd557685bb8ad12820ec6002d60143812238086.css">
  <script type="text/javascript" src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js"></script>
  <script src="/json/dom.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/dom/" class="_nav-link" title="" style="margin-left:0;">Web APIs</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _mdn">
				
				
<header><h1>Using custom elements</h1></header><div class="section-content">
<p>One of the key features of web components is the ability to create <em>custom elements</em>: that is, HTML elements whose behavior is defined by the web developer, that extend the set of elements available in the browser.</p> <p>This article introduces custom elements, and walks through some examples.</p>
</div>
<h2 id="types_of_custom_element">Types of custom element</h2>
<div class="section-content">
<p>There are two types of custom element:</p> <ul> <li>
<strong>Customized built-in elements</strong> inherit from standard HTML elements such as <a href="../htmlimageelement"><code>HTMLImageElement</code></a> or <a href="../htmlparagraphelement"><code>HTMLParagraphElement</code></a>. Their implementation customizes the behavior of the standard element.</li> <li>
<strong>Autonomous custom elements</strong> inherit from the HTML element base class <a href="../htmlelement"><code>HTMLElement</code></a>. You have to implement their behavior from scratch.</li> </ul>
</div>
<h2 id="implementing_a_custom_element">Implementing a custom element</h2>
<div class="section-content">
<p>A custom element is implemented as a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes">class</a> which extends <a href="../htmlelement"><code>HTMLElement</code></a> (in the case of automonous elements) or the interface you want to customize (in the case of customized built-in elements).</p> <p>Here's the implementation of a minimal custom element that customizes the <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/p"><code>&lt;p&gt;</code></a> element:</p> <div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="YXVXjQ02zE/g/KCQ7k/jOXQRiPq+LyQ4McSq7QS0U28=" data-language="js"><span class="token keyword">class</span> <span class="token class-name">WordCount</span> <span class="token keyword">extends</span> <span class="token class-name">HTMLParagraphElement</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// Element functionality written in here</span>
<span class="token punctuation">}</span>
</pre>
</div> <p>Here's the implementation of a minimal autonomous custom element:</p> <div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="cPAgW3wVGMcGiv4zh67Q4iXKJf7xdybJ7yqaZTgZOOM=" data-language="js"><span class="token keyword">class</span> <span class="token class-name">PopupInfo</span> <span class="token keyword">extends</span> <span class="token class-name">HTMLElement</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// Element functionality written in here</span>
<span class="token punctuation">}</span>
</pre>
</div> <p>In the class <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes/constructor">constructor</a>, you can set up initial state and default values, register event listeners and perhaps create a shadow root. At this point, you should not inspect the element's attributes or children, or add new attributes or children. See <a href="https://html.spec.whatwg.org/multipage/custom-elements.html#custom-element-conformance" target="_blank">Requirements for custom element constructors and reactions</a> for the complete set of requirements.</p>
</div>
<h3 id="custom_element_lifecycle_callbacks">Custom element lifecycle callbacks</h3>
<div class="section-content">
<p>Once your custom element is registered, the browser will call certain methods of your class when code in the page interacts with your custom element in certain ways. By providing an implementation of these methods, which the specification calls <em>lifecycle callbacks</em>, you can run code in response to these events.</p> <p>Custom element lifecycle callbacks include:</p> <ul> <li>
<code>connectedCallback()</code>: called each time the element is added to the document. The specification recommends that, as far as possible, developers should implement custom element setup in this callback rather than the constructor.</li> <li>
<code>disconnectedCallback()</code>: called each time the element is removed from the document.</li> <li>
<code>adoptedCallback()</code>: called each time the element is moved to a new document.</li> <li>
<code>attributeChangedCallback()</code>: called when attributes are changed, added, removed, or replaced. See <a href="#responding_to_attribute_changes">Responding to attribute changes</a> for more details about this callback.</li> </ul> <p>Here's a minimal custom element that logs these lifecycle events:</p> <div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="56gaOrQvvEqVA8on8o/C08P8vI4o382yNDQoN8KDLRs=" data-language="js"><span class="token comment">// Create a class for the element</span>
<span class="token keyword">class</span> <span class="token class-name">MyCustomElement</span> <span class="token keyword">extends</span> <span class="token class-name">HTMLElement</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> observedAttributes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"color"</span><span class="token punctuation">,</span> <span class="token string">"size"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Always call super first in constructor</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">connectedCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Custom element added to page."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">disconnectedCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Custom element removed from page."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">adoptedCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Custom element moved to new page."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">attributeChangedCallback</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> oldValue<span class="token punctuation">,</span> newValue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Attribute </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> has changed.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

customElements<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">"my-custom-element"</span><span class="token punctuation">,</span> MyCustomElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
</div>
</div>
<h2 id="registering_a_custom_element">Registering a custom element</h2>
<div class="section-content">
<p>To make a custom element available in a page, call the <a href="../customelementregistry/define"><code>define()</code></a> method of <a href="../window/customelements"><code>Window.customElements</code></a>.</p> <p>The <code>define()</code> method takes the following arguments:</p> <dl> <dt id="name"><a href="#name"><code>name</code></a></dt> <dd> <p>The name of the element. This must start with a lowercase letter, contain a hyphen, and satisfy certain other rules listed in the specification's <a href="https://html.spec.whatwg.org/multipage/custom-elements.html#valid-custom-element-name" target="_blank">definition of a valid name</a>.</p> </dd> <dt id="constructor"><a href="#constructor"><code>constructor</code></a></dt> <dd> <p>The custom element's constructor function.</p> </dd> <dt id="options"><a href="#options"><code>options</code></a></dt> <dd> <p>Only included for customized built-in elements, this is an object containing a single property <code>extends</code>, which is a string naming the built-in element to extend.</p> </dd> </dl> <p>For example, this code registers the <code>WordCount</code> customized built-in element:</p> <div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="KOH47sX3X/0I/C1+0Ae+KHes0GKq+RSrt9yFNFdwUQg=" data-language="js">customElements<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">"word-count"</span><span class="token punctuation">,</span> WordCount<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token string">"p"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
</div> <p>This code registers the <code>PopupInfo</code> autonomous custom element:</p> <div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="zb4OMwZkz9h+DItCthgzjmrxdSFggEwxN0REuNj2w8M=" data-language="js">customElements<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">"popup-info"</span><span class="token punctuation">,</span> PopupInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
</div>
</div>
<h2 id="using_a_custom_element">Using a custom element</h2>
<div class="section-content">
<p>Once you've defined and registered a custom element, you can use it in your code.</p> <p>To use a customized built-in element, use the built-in element but with the custom name as the value of the <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/is"><code>is</code></a> attribute:</p> <div class="code-example">
<p class="example-header"><span class="language-name">html</span></p>
<pre data-signature="2HWc9XXr7N6633Peud0V5KO5Agg7fFBZQXZH96uYCqM=" data-language="html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>word-count<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
</pre>
</div> <p>To use an autonomous custom element, use the custom name just like a built-in HTML element:</p> <div class="code-example">
<p class="example-header"><span class="language-name">html</span></p>
<pre data-signature="wbevHNH0yMoKt2Hs+jPVSNy0P+4puKutbxzxYg55Ynk=" data-language="html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>popup-info</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- content of the element --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>popup-info</span><span class="token punctuation">&gt;</span></span>
</pre>
</div>
</div>
<h2 id="responding_to_attribute_changes">Responding to attribute changes</h2>
<div class="section-content">
<p>Like built-in elements, custom elements can use HTML attributes to configure the element's behavior. To use attributes effectively, an element has to be able to respond to changes in an attribute's value. To do this, a custom element needs to add the following members to the class that implements the custom element:</p> <ul> <li>A static property named <code>observedAttributes</code>. This must be an array containing the names of all attributes for which the element needs change notifications.</li> <li>An implementation of the <code>attributeChangedCallback()</code> lifecycle callback.</li> </ul> <p>The <code>attributeChangedCallback()</code> callback is then called whenever an attribute whose name is listed in the element's <code>observedAttributes</code> property is added, modified, removed, or replaced.</p> <p>The callback is passed three arguments:</p> <ul> <li>The name of the attribute which changed.</li> <li>The attribute's old value.</li> <li>The attribute's new value.</li> </ul> <p>For example, this autonomous element will observe a <code>size</code> attribute, and log the old and new values when they change:</p> <div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="RwNu8OXCteHfgAKfTwXOipSzkXAoRx+3ThiVL6XtTTM=" data-language="js"><span class="token comment">// Create a class for the element</span>
<span class="token keyword">class</span> <span class="token class-name">MyCustomElement</span> <span class="token keyword">extends</span> <span class="token class-name">HTMLElement</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> observedAttributes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"size"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">attributeChangedCallback</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> oldValue<span class="token punctuation">,</span> newValue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
      <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Attribute </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> has changed from </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>oldValue<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>newValue<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

customElements<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">"my-custom-element"</span><span class="token punctuation">,</span> MyCustomElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
</div> <p>Note that if the element's HTML declaration includes an observed attribute, then <code>attributeChangedCallback()</code> will be called after the attribute is initialized, when the element's declaration is parsed for the first time. So in the following example, <code>attributeChangedCallback()</code> will be called when the DOM is parsed, even if the attribute is never changed again:</p> <div class="code-example">
<p class="example-header"><span class="language-name">html</span></p>
<pre data-signature="PWRNnGfvxGpk2L4+7RpTLp1gBOxb7bcQWofJfHJqv9Q=" data-language="html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-custom-element</span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-custom-element</span><span class="token punctuation">&gt;</span></span>
</pre>
</div> <p>For a complete example showing the use of <code>attributeChangedCallback()</code>, see <a href="#lifecycle_callbacks">Lifecycle callbacks</a> in this page.</p>
</div>
<h2 id="examples">Examples</h2>
<div class="section-content"><p>In the rest of this guide we'll look at a few example custom elements. You can find the source for all these examples, and more, in the <a href="https://github.com/mdn/web-components-examples" target="_blank">web-components-examples</a> repository, and you can see them all live at <a href="https://mdn.github.io/web-components-examples/" target="_blank">https://mdn.github.io/web-components-examples/</a>.</p></div>
<h3 id="an_autonomous_custom_element">An autonomous custom element</h3>
<div class="section-content">
<p>First, we'll look at an autonomous custom element. The <code>&lt;popup-info&gt;</code> custom element takes an image icon and a text string as attributes, and embeds the icon into the page. When the icon is focused, it displays the text in a pop up information box to provide further in-context information.</p> <ul> <li><a href="https://mdn.github.io/web-components-examples/popup-info-box-web-component" target="_blank">See the example running live</a></li> <li><a href="https://github.com/mdn/web-components-examples/tree/main/popup-info-box-web-component" target="_blank">See the source code</a></li> </ul> <p>To begin with, the JavaScript file defines a class called <code>PopupInfo</code>, which extends the <a href="../htmlelement"><code>HTMLElement</code></a> class.</p> <div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="P3bjih3AOWdS3AIFjHJVmTqpmQ5WgQ2NaGpRq0sNwHI=" data-language="js"><span class="token comment">// Create a class for the element</span>
<span class="token keyword">class</span> <span class="token class-name">PopupInfo</span> <span class="token keyword">extends</span> <span class="token class-name">HTMLElement</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Always call super first in constructor</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">connectedCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Create a shadow root</span>
    <span class="token keyword">const</span> shadow <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">attachShadow</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">"open"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Create spans</span>
    <span class="token keyword">const</span> wrapper <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"span"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    wrapper<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"class"</span><span class="token punctuation">,</span> <span class="token string">"wrapper"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> icon <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"span"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    icon<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"class"</span><span class="token punctuation">,</span> <span class="token string">"icon"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    icon<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"tabindex"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> info <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"span"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    info<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"class"</span><span class="token punctuation">,</span> <span class="token string">"info"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Take attribute content and put it inside the info span</span>
    <span class="token keyword">const</span> text <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">"data-text"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    info<span class="token punctuation">.</span>textContent <span class="token operator">=</span> text<span class="token punctuation">;</span>

    <span class="token comment">// Insert icon</span>
    <span class="token keyword">let</span> imgUrl<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">hasAttribute</span><span class="token punctuation">(</span><span class="token string">"img"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      imgUrl <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">"img"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      imgUrl <span class="token operator">=</span> <span class="token string">"img/default.png"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"img"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    img<span class="token punctuation">.</span>src <span class="token operator">=</span> imgUrl<span class="token punctuation">;</span>
    icon<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Create some CSS to apply to the shadow dom</span>
    <span class="token keyword">const</span> style <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"style"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>style<span class="token punctuation">.</span>isConnected<span class="token punctuation">)</span><span class="token punctuation">;</span>

    style<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
      .wrapper {
        position: relative;
      }

      .info {
        font-size: 0.8rem;
        width: 200px;
        display: inline-block;
        border: 1px solid black;
        padding: 10px;
        background: white;
        border-radius: 10px;
        opacity: 0;
        transition: 0.6s all;
        position: absolute;
        bottom: 20px;
        left: 10px;
        z-index: 3;
      }

      img {
        width: 1.2rem;
      }

      .icon:hover + .info, .icon:focus + .info {
        opacity: 1;
      }
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

    <span class="token comment">// Attach the created elements to the shadow dom</span>
    shadow<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>style<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>style<span class="token punctuation">.</span>isConnected<span class="token punctuation">)</span><span class="token punctuation">;</span>
    shadow<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
    wrapper<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>icon<span class="token punctuation">)</span><span class="token punctuation">;</span>
    wrapper<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre>
</div> <p>The class definition contains the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes/constructor"><code>constructor()</code></a> for the class, which always starts by calling <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/super"><code>super()</code></a> so that the correct prototype chain is established.</p> <p>Inside the method <code>connectedCallback()</code>, we define all the functionality the element will have when the element is connected to the DOM. In this case we attach a shadow root to the custom element, use some DOM manipulation to create the element's internal shadow DOM structure — which is then attached to the shadow root — and finally attach some CSS to the shadow root to style it. We don't do this work in the constructor because an element's attributes are unavailable until it is connected to the DOM.</p> <p>Finally, we register our custom element in the <code>CustomElementRegistry</code> using the <code>define()</code> method we mentioned earlier — in the parameters we specify the element name, and then the class name that defines its functionality:</p> <div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="zb4OMwZkz9h+DItCthgzjmrxdSFggEwxN0REuNj2w8M=" data-language="js">customElements<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">"popup-info"</span><span class="token punctuation">,</span> PopupInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
</div> <p>It is now available to use on our page. Over in our HTML, we use it like so:</p> <div class="code-example">
<p class="example-header"><span class="language-name">html</span></p>
<pre data-signature="cyYLkauXQ7LDgat6jIqGT9rYtXYTAUuALuLBFY388y4=" data-language="html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>popup-info</span>
  <span class="token attr-name">img</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>img/alt.png<span class="token punctuation">"</span></span>
  <span class="token attr-name">data-text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Your card validation code (CVC)
  is an extra security feature — it is the last 3 or 4 numbers on the
  back of your card.<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>popup-info</span><span class="token punctuation">&gt;</span></span>
</pre>
</div>
</div>
<h3 id="referencing_external_styles">Referencing external styles</h3>
<div class="section-content">
<p>In the above example we apply styles to the shadow DOM using a <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/style"><code>&lt;style&gt;</code></a> element, but you can reference an external stylesheet from a <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/link"><code>&lt;link&gt;</code></a> element instead. In this example we'll modify the <code>&lt;popup-info&gt;</code> custom element to use an external stylesheet.</p> <ul> <li><a href="https://mdn.github.io/web-components-examples/popup-info-box-external-stylesheet/" target="_blank">See the example running live</a></li> <li><a href="https://github.com/mdn/web-components-examples/blob/main/popup-info-box-external-stylesheet/" target="_blank">See the source code</a></li> </ul> <p>Here's the class definition:</p> <div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="epSYw8nXKm/zdkskmavz9oH7vLqrRSes79vGinyueXs=" data-language="js"><span class="token comment">// Create a class for the element</span>
<span class="token keyword">class</span> <span class="token class-name">PopupInfo</span> <span class="token keyword">extends</span> <span class="token class-name">HTMLElement</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Always call super first in constructor</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">connectedCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Create a shadow root</span>
    <span class="token keyword">const</span> shadow <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">attachShadow</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">"open"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Create spans</span>
    <span class="token keyword">const</span> wrapper <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"span"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    wrapper<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"class"</span><span class="token punctuation">,</span> <span class="token string">"wrapper"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> icon <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"span"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    icon<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"class"</span><span class="token punctuation">,</span> <span class="token string">"icon"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    icon<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"tabindex"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> info <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"span"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    info<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"class"</span><span class="token punctuation">,</span> <span class="token string">"info"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Take attribute content and put it inside the info span</span>
    <span class="token keyword">const</span> text <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">"data-text"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    info<span class="token punctuation">.</span>textContent <span class="token operator">=</span> text<span class="token punctuation">;</span>

    <span class="token comment">// Insert icon</span>
    <span class="token keyword">let</span> imgUrl<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">hasAttribute</span><span class="token punctuation">(</span><span class="token string">"img"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      imgUrl <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">"img"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      imgUrl <span class="token operator">=</span> <span class="token string">"img/default.png"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"img"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    img<span class="token punctuation">.</span>src <span class="token operator">=</span> imgUrl<span class="token punctuation">;</span>
    icon<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Apply external styles to the shadow dom</span>
    <span class="token keyword">const</span> linkElem <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"link"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    linkElem<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"rel"</span><span class="token punctuation">,</span> <span class="token string">"stylesheet"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    linkElem<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"href"</span><span class="token punctuation">,</span> <span class="token string">"style.css"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Attach the created elements to the shadow dom</span>
    shadow<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>linkElem<span class="token punctuation">)</span><span class="token punctuation">;</span>
    shadow<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
    wrapper<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>icon<span class="token punctuation">)</span><span class="token punctuation">;</span>
    wrapper<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre>
</div> <p>It's just like the original <code>&lt;popup-info&gt;</code> example, except that we link to an external stylesheet using a <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/link"><code>&lt;link&gt;</code></a> element, which we add to the shadow DOM.</p> <p>Note that <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/link"><code>&lt;link&gt;</code></a> elements do not block paint of the shadow root, so there may be a flash of unstyled content (FOUC) while the stylesheet loads.</p> <p>Many modern browsers implement an optimization for <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/style"><code>&lt;style&gt;</code></a> tags either cloned from a common node or that have identical text, to allow them to share a single backing stylesheet. With this optimization the performance of external and internal styles should be similar.</p>
</div>
<h3 id="customized_built-in_elements">Customized built-in elements</h3>
<div class="section-content">
<p>Now let's have a look at a customized built in element example. This example extends the built-in <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/ul"><code>&lt;ul&gt;</code></a> element to support expanding and collapsing the list items.</p> <ul> <li><a href="https://mdn.github.io/web-components-examples/expanding-list-web-component/" target="_blank">See the example running live</a></li> <li><a href="https://github.com/mdn/web-components-examples/tree/main/expanding-list-web-component" target="_blank">See the source code</a></li> </ul> <p>First of all, we define our element's class:</p> <div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="i2C2qKVR13SPhXp29mvBf+XK76rMZ1TbHMksTDutL4g=" data-language="js"><span class="token comment">// Create a class for the element</span>
<span class="token keyword">class</span> <span class="token class-name">ExpandingList</span> <span class="token keyword">extends</span> <span class="token class-name">HTMLUListElement</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Always call super first in constructor</span>
    <span class="token comment">// Return value from super() is a reference to this element</span>
    self <span class="token operator">=</span> <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">connectedCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Get ul and li elements that are a child of this custom ul element</span>
    <span class="token comment">// li elements can be containers if they have uls within them</span>
    <span class="token keyword">const</span> uls <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">"ul"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> lis <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">"li"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Hide all child uls</span>
    <span class="token comment">// These lists will be shown when the user clicks a higher level container</span>
    uls<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">ul</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      ul<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">"none"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Look through each li element in the ul</span>
    lis<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">li</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// If this li has a ul as a child, decorate it and add a click handler</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>li<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">"ul"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Add an attribute which can be used  by the style</span>
        <span class="token comment">// to show an open or closed icon</span>
        li<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"class"</span><span class="token punctuation">,</span> <span class="token string">"closed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Wrap the li element's text in a new span element</span>
        <span class="token comment">// so we can assign style and event handlers to the span</span>
        <span class="token keyword">const</span> childText <span class="token operator">=</span> li<span class="token punctuation">.</span>childNodes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> newSpan <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"span"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Copy text from li to span, set cursor style</span>
        newSpan<span class="token punctuation">.</span>textContent <span class="token operator">=</span> childText<span class="token punctuation">.</span>textContent<span class="token punctuation">;</span>
        newSpan<span class="token punctuation">.</span>style<span class="token punctuation">.</span>cursor <span class="token operator">=</span> <span class="token string">"pointer"</span><span class="token punctuation">;</span>

        <span class="token comment">// Add click handler to this span</span>
        newSpan<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token comment">// next sibling to the span should be the ul</span>
          <span class="token keyword">const</span> nextul <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>nextElementSibling<span class="token punctuation">;</span>

          <span class="token comment">// Toggle visible state and update class attribute on ul</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>nextul<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">==</span> <span class="token string">"block"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            nextul<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">"none"</span><span class="token punctuation">;</span>
            nextul<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"class"</span><span class="token punctuation">,</span> <span class="token string">"closed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            nextul<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">"block"</span><span class="token punctuation">;</span>
            nextul<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"class"</span><span class="token punctuation">,</span> <span class="token string">"open"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Add the span and remove the bare text node from the li</span>
        childText<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>newSpan<span class="token punctuation">,</span> childText<span class="token punctuation">)</span><span class="token punctuation">;</span>
        childText<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>childText<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre>
</div> <p>Note that this time we extend <a href="../htmlulistelement"><code>HTMLUListElement</code></a>, rather than <a href="../htmlelement"><code>HTMLElement</code></a>. This means that we get the default behavior of a list, and only have to implement our own customizations.</p> <p>As before, most of the code is in the <code>connectedCallback()</code> lifecycle callback.</p> <p>Next, we register the element using the <code>define()</code> method as before, except that this time it also includes an options object that details what element our custom element inherits from:</p> <div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="iIoWEKwnjQ0DYD/TqcAqvLrZzPr0No8NdOyk4DsCrjA=" data-language="js">customElements<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">"expanding-list"</span><span class="token punctuation">,</span> ExpandingList<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token string">"ul"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
</div> <p>Using the built-in element in a web document also looks somewhat different:</p> <div class="code-example">
<p class="example-header"><span class="language-name">html</span></p>
<pre data-signature="+XKUDU8n0ADXz21ipm5pPSVK9dUs6Et9IqV7lkZjt0g=" data-language="html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>expanding-list<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  …
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
</pre>
</div> <p>You use a <code>&lt;ul&gt;</code> element as normal, but specify the name of the custom element inside the <code>is</code> attribute.</p> <p>Note that in this case we must ensure that the script defining our custom element is executed after the DOM has been fully parsed, because <code>connectedCallback()</code> is called as soon as the expanding list is added to the DOM, and at that point its children have not been added yet, so the <code>querySelectorAll()</code> calls will not find any items. One way to ensure this is to add the <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/script#defer">defer</a> attribute to the line that includes the script:</p> <div class="code-example">
<p class="example-header"><span class="language-name">html</span></p>
<pre data-signature="pwJGh0si9BW4lh6oG2d7+dLLav4gqJF6m5G57bie3Pc=" data-language="html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>main.js<span class="token punctuation">"</span></span> <span class="token attr-name">defer</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</pre>
</div>
</div>
<h3 id="lifecycle_callbacks">Lifecycle callbacks</h3>
<div class="section-content">
<p>So far we've seen only one lifecycle callback in action: <code>connectedCallback()</code>. In the final example, <code>&lt;custom-square&gt;</code>, we'll see some of the others. The <code>&lt;custom-square&gt;</code> autonomous custom element draws a square whose size and color are determined by two attributes, named <code>"size"</code> and <code>"color"</code>.</p> <ul> <li><a href="https://mdn.github.io/web-components-examples/life-cycle-callbacks/" target="_blank">See the example running live</a></li> <li><a href="https://github.com/mdn/web-components-examples/tree/main/life-cycle-callbacks" target="_blank">See the source code</a></li> </ul> <p>In the class constructor, we attach a shadow DOM to the element, then attach empty <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/div"><code>&lt;div&gt;</code></a> and <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/style"><code>&lt;style&gt;</code></a> elements to the shadow root:</p> <div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="6C/0YQlOg/Kds9XPHFD3G1zE5l+8WeGUthIjH7THMNk=" data-language="js"><span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Always call super first in constructor</span>
  <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> shadow <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">attachShadow</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">"open"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> style <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"style"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  shadow<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>style<span class="token punctuation">)</span><span class="token punctuation">;</span>
  shadow<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>div<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre>
</div> <p>The key function in this example is <code>updateStyle()</code> — this takes an element, gets its shadow root, finds its <code>&lt;style&gt;</code> element, and adds <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/width"><code>width</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/height"><code>height</code></a>, and <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/background-color"><code>background-color</code></a> to the style.</p> <div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="5kqTVHF9gJqIZxbCiwEpRv6f+PXEfZ5VkYvgc9JRK/E=" data-language="js"><span class="token keyword">function</span> <span class="token function">updateStyle</span><span class="token punctuation">(</span><span class="token parameter">elem</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> shadow <span class="token operator">=</span> elem<span class="token punctuation">.</span>shadowRoot<span class="token punctuation">;</span>
  shadow<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"style"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    div {
      width: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>elem<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">"size"</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px;
      height: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>elem<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">"size"</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px;
      background-color: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>elem<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">"color"</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">;
    }
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre>
</div> <p>The actual updates are all handled by the lifecycle callbacks. The <code>connectedCallback()</code> runs each time the element is added to the DOM — here we run the <code>updateStyle()</code> function to make sure the square is styled as defined in its attributes:</p> <div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="CZuDNY9CkLLN1/PS8K3LZaxKq2wT1rUlSClb18gC56U=" data-language="js"><span class="token function">connectedCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Custom square element added to page."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">updateStyle</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre>
</div> <p>The <code>disconnectedCallback()</code> and <code>adoptedCallback()</code> callbacks log messages to the console to inform us when the element is either removed from the DOM, or moved to a different page:</p> <div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="25gc/lAzkDEyKRWN4ZrfTPkAOz/p4qGmJRb0LPHTRhM=" data-language="js"><span class="token function">disconnectedCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Custom square element removed from page."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">adoptedCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Custom square element moved to new page."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre>
</div> <p>The <code>attributeChangedCallback()</code> callback is run whenever one of the element's attributes is changed in some way. As you can see from its parameters, it is possible to act on attributes individually, looking at their name, and old and new attribute values. In this case however, we are just running the <code>updateStyle()</code> function again to make sure that the square's style is updated as per the new values:</p> <div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="W0aQuTRSQTZmHhgiI/D/sSV+4dhWh5kBkkk9B/4qAYM=" data-language="js"><span class="token function">attributeChangedCallback</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> oldValue<span class="token punctuation">,</span> newValue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Custom square element attributes changed."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">updateStyle</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre>
</div> <p>Note that to get the <code>attributeChangedCallback()</code> callback to fire when an attribute changes, you have to observe the attributes. This is done by specifying a <code>static get observedAttributes()</code> method inside the custom element class - this should return an array containing the names of the attributes you want to observe:</p> <div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="uJ4u2mzIlF1bVJT/+kY7q94m+QGDN2g5vllO/bFJHDU=" data-language="js"><span class="token keyword">static</span> <span class="token keyword">get</span> <span class="token function">observedAttributes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string">"color"</span><span class="token punctuation">,</span> <span class="token string">"size"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre>
</div>
</div>
<div class="_attribution">
  <p class="_attribution-p">
    © 2005–2023 MDN contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_components/Using_custom_elements" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/Web_components/Using_custom_elements</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
