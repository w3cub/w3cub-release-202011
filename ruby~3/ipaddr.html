
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>IPAddr - Ruby 3 - W3cubDocs</title>
  
  <meta name="description" content=" IPAddr provides a set of methods to manipulate an IP address. Both IPv4 and IPv6 are supported. ">
  <meta name="keywords" content="class, ipaddr, ruby, ruby~3">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/ruby~3/ipaddr.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-c2f2e7d1236e299f399a2d9bf4342fa70a8839fbe6eb79130546d6bf383b99636ffdf29c557090085d7c4ac34eeb5426851b42d2f4ec63cf218916cbd19aa876.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/ruby~3.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/ruby~3/" class="_nav-link" title="" style="margin-left:0;">Ruby 3</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _rdoc">
				
				
<h1 id="class-IPAddr" class="class"> class IPAddr </h1>
<dl class="meta">
<dt>Parent:</dt>
<dd class="meta-parent"><a href="object">Object</a></dd>
<dt>Included modules:</dt>
<dd class="meta-includes"><a class="include" href="comparable">Comparable</a></dd>
</dl> <section class="description"> <p><a href="ipaddr"><code>IPAddr</code></a> provides a set of methods to manipulate an IP address. Both IPv4 and IPv6 are supported.</p> <h2 id="class-IPAddr-label-Example">Example</h2> <pre class="ruby" data-language="ruby">require 'ipaddr'

ipaddr1 = IPAddr.new "3ffe:505:2::1"

p ipaddr1                   #=&gt; #&lt;IPAddr: IPv6:3ffe:0505:0002:0000:0000:0000:0000:0001/ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff&gt;

p ipaddr1.to_s              #=&gt; "3ffe:505:2::1"

ipaddr2 = ipaddr1.mask(48)  #=&gt; #&lt;IPAddr: IPv6:3ffe:0505:0002:0000:0000:0000:0000:0000/ffff:ffff:ffff:0000:0000:0000:0000:0000&gt;

p ipaddr2.to_s              #=&gt; "3ffe:505:2::"

ipaddr3 = IPAddr.new "192.168.2.0/24"

p ipaddr3                   #=&gt; #&lt;IPAddr: IPv4:192.168.2.0/255.255.255.0&gt;
</pre> </section> <section id="5Buntitled-5D" class="documentation-section"> <section class="constants-list"> <header> <h3>Constants</h3> </header> <dl> <dt id="IN4MASK">IN4MASK </dt>
<dd>
<p>32 bit mask for IPv4</p> </dd>
<dt id="IN6FORMAT">IN6FORMAT </dt>
<dd>
<p>Format string for IPv6</p> </dd>
<dt id="IN6MASK">IN6MASK </dt>
<dd>
<p>128 bit mask for IPv6</p> </dd>
<dt id="RE_IPV4ADDRLIKE">RE_IPV4ADDRLIKE </dt>
<dd>
<p><a href="regexp"><code>Regexp</code></a> <em>internally</em> used for parsing IPv4 address.</p> </dd>
<dt id="RE_IPV6ADDRLIKE_COMPRESSED">RE_IPV6ADDRLIKE_COMPRESSED </dt>
<dd>
<p><a href="regexp"><code>Regexp</code></a> <em>internally</em> used for parsing IPv6 address.</p> </dd>
<dt id="RE_IPV6ADDRLIKE_FULL">RE_IPV6ADDRLIKE_FULL </dt>
<dd>
<p><a href="regexp"><code>Regexp</code></a> <em>internally</em> used for parsing IPv6 address.</p> </dd>
</dl> </section> <section class="attribute-method-details"> <header> <h3>Attributes</h3> </header> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-family"> <span class="method-name">family</span><span class="attribute-access-type">[R]</span> </div> <div class="method-description"> <p>Returns the address family of this IP address.</p> </div> </div> </section> <section id="public-class-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Class Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-c-new"> <span class="method-name">new</span><span class="method-args">(addr = '::', family = Socket::AF_UNSPEC)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="new-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 557
def initialize(addr = '::', family = Socket::AF_UNSPEC)
  if !addr.kind_of?(String)
    case family
    when Socket::AF_INET, Socket::AF_INET6
      set(addr.to_i, family)
      @mask_addr = (family == Socket::AF_INET) ? IN4MASK : IN6MASK
      return
    when Socket::AF_UNSPEC
      raise AddressFamilyError, "address family must be specified"
    else
      raise AddressFamilyError, "unsupported address family: #{family}"
    end
  end
  prefix, prefixlen = addr.split('/')
  if prefix =~ /\A\[(.*)\]\z/i
    prefix = $1
    family = Socket::AF_INET6
  end
  # It seems AI_NUMERICHOST doesn't do the job.
  #Socket.getaddrinfo(left, nil, Socket::AF_INET6, Socket::SOCK_STREAM, nil,
  #                  Socket::AI_NUMERICHOST)
  @addr = @family = nil
  if family == Socket::AF_UNSPEC || family == Socket::AF_INET
    @addr = in_addr(prefix)
    if @addr
      @family = Socket::AF_INET
    end
  end
  if !@addr &amp;&amp; (family == Socket::AF_UNSPEC || family == Socket::AF_INET6)
    @addr = in6_addr(prefix)
    @family = Socket::AF_INET6
  end
  if family != Socket::AF_UNSPEC &amp;&amp; @family != family
    raise AddressFamilyError, "address family mismatch"
  end
  if prefixlen
    mask!(prefixlen)
  else
    @mask_addr = (@family == Socket::AF_INET) ? IN4MASK : IN6MASK
  end
rescue InvalidAddressError =&gt; e
  raise e.class, "#{e.message}: #{addr}"
end</pre> </div> <p>Creates a new ipaddr object either from a human readable IP address representation in string, or from a packed <a href="ipaddr#method-i-in_addr"><code>in_addr</code></a> value followed by an address family.</p> <p>In the former case, the following are the valid formats that will be recognized: “address”, “address/prefixlen” and “address/mask”, where IPv6 address may be enclosed in square brackets (`[' and `]'). If a prefixlen or a mask is specified, it returns a masked IP address. Although the address family is determined automatically from a specified string, you can specify one explicitly by the optional second argument.</p> <p>Otherwise an IP address is generated from a packed <a href="ipaddr#method-i-in_addr"><code>in_addr</code></a> value and an address family.</p> <p>The <a href="ipaddr"><code>IPAddr</code></a> class defines many methods and operators, and some of those, such as &amp;, |, include? and ==, accept a string, or a packed <a href="ipaddr#method-i-in_addr"><code>in_addr</code></a> value instead of an <a href="ipaddr"><code>IPAddr</code></a> object.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-new_ntoh"> <span class="method-name">new_ntoh</span><span class="method-args">(addr)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="new_ntoh-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 106
def self.new_ntoh(addr)
  return new(ntop(addr))
end</pre> </div> <p>Creates a new ipaddr containing the given network byte ordered string form of an IP address.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-ntop"> <span class="method-name">ntop</span><span class="method-args">(addr)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="ntop-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 112
def self.ntop(addr)
  case addr.size
  when 4
    s = addr.unpack('C4').join('.')
  when 16
    s = IN6FORMAT % addr.unpack('n8')
  else
    raise AddressFamilyError, "unsupported address family"
  end
  return s
end</pre> </div> <p>Convert a network byte ordered string form of an IP address into human readable form.</p>  </div> </div> </section> <section id="public-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Instance Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-i-26"> <span class="method-name">&amp;</span><span class="method-args">(other)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="26-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 125
def &amp;(other)
  return self.clone.set(@addr &amp; coerce_other(other).to_i)
end</pre> </div> <p>Returns a new ipaddr built by bitwise AND.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-3C-3C"> <span class="method-name">&lt;&lt;</span><span class="method-args">(num)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="3C-3C-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 140
def &lt;&lt;(num)
  return self.clone.set(addr_mask(@addr &lt;&lt; num))
end</pre> </div> <p>Returns a new ipaddr built by bitwise left shift.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-3C-3D-3E"> <span class="method-name">&lt;=&gt;</span><span class="method-args">(other)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="3C-3D-3E-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 391
def &lt;=&gt;(other)
  other = coerce_other(other)
rescue
  nil
else
  @addr &lt;=&gt; other.to_i if other.family == @family
end</pre> </div> <p>Compares the ipaddr with another.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-3D-3D"> <span class="method-name">==</span><span class="method-args">(other)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="3D-3D-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 150
def ==(other)
  other = coerce_other(other)
rescue
  false
else
  @family == other.family &amp;&amp; @addr == other.to_i
end</pre> </div> <p>Returns true if two ipaddrs are equal.</p>  </div> </div> <div class="method-detail method-alias"> <div class="method-heading" id="method-i-3D-3D-3D"> <span class="method-name">===</span><span class="method-args">(other)</span> </div>  <div class="aliases"> Alias for: <a href="ipaddr#method-i-include-3F">include?</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-3E-3E"> <span class="method-name">&gt;&gt;</span><span class="method-args">(num)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="3E-3E-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 135
def &gt;&gt;(num)
  return self.clone.set(@addr &gt;&gt; num)
end</pre> </div> <p>Returns a new ipaddr built by bitwise right-shift.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-eql-3F"> <span class="method-name">eql?</span><span class="method-args">(other)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="eql-3F-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 401
def eql?(other)
  return self.class == other.class &amp;&amp; self.hash == other.hash &amp;&amp; self == other
end</pre> </div> <p>Checks equality used by <a href="hash"><code>Hash</code></a>.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-hash"> <span class="method-name">hash</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="hash-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 406
def hash
  return ([@addr, @mask_addr].hash &lt;&lt; 1) | (ipv4? ? 0 : 1)
end</pre> </div> <p>Returns a hash value used by <a href="hash"><code>Hash</code></a>, <a href="set"><code>Set</code></a>, and <a href="array"><code>Array</code></a> classes</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-hton"> <span class="method-name">hton</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="hton-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 239
def hton
  case @family
  when Socket::AF_INET
    return [@addr].pack('N')
  when Socket::AF_INET6
    return (0..7).map { |i|
      (@addr &gt;&gt; (112 - 16 * i)) &amp; 0xffff
    }.pack('n8')
  else
    raise AddressFamilyError, "unsupported address family"
  end
end</pre> </div> <p>Returns a network byte ordered string form of the IP address.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-include-3F"> <span class="method-name">include?</span><span class="method-args">(other)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="include-3F-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 173
def include?(other)
  other = coerce_other(other)
  if ipv4_mapped?
    if (@mask_addr &gt;&gt; 32) != 0xffffffffffffffffffffffff
      return false
    end
    mask_addr = (@mask_addr &amp; IN4MASK)
    addr = (@addr &amp; IN4MASK)
    family = Socket::AF_INET
  else
    mask_addr = @mask_addr
    addr = @addr
    family = @family
  end
  if other.ipv4_mapped?
    other_addr = (other.to_i &amp; IN4MASK)
    other_family = Socket::AF_INET
  else
    other_addr = other.to_i
    other_family = other.family
  end

  if family != other_family
    return false
  end
  return ((addr &amp; mask_addr) == (other_addr &amp; mask_addr))
end</pre> </div> <p>Returns true if the given ipaddr is in the range.</p> <p>e.g.:</p> <pre class="ruby" data-language="ruby">require 'ipaddr'
net1 = IPAddr.new("192.168.2.0/24")
net2 = IPAddr.new("192.168.2.100")
net3 = IPAddr.new("192.168.3.0")
p net1.include?(net2)     #=&gt; true
p net1.include?(net3)     #=&gt; false
</pre>  </div> <div class="aliases"> Also aliased as: <a href="ipaddr#method-i-3D-3D-3D">===</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-inspect"> <span class="method-name">inspect</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="inspect-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 457
def inspect
  case @family
  when Socket::AF_INET
    af = "IPv4"
  when Socket::AF_INET6
    af = "IPv6"
  else
    raise AddressFamilyError, "unsupported address family"
  end
  return sprintf("#&lt;%s: %s:%s/%s&gt;", self.class.name,
                 af, _to_string(@addr), _to_string(@mask_addr))
end</pre> </div> <p>Returns a string containing a human-readable representation of the ipaddr. (“#&lt;IPAddr: family:address/mask&gt;”)</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-ip6_arpa"> <span class="method-name">ip6_arpa</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="ip6_arpa-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 370
def ip6_arpa
  if !ipv6?
    raise InvalidAddressError, "not an IPv6 address"
  end
  return _reverse + ".ip6.arpa"
end</pre> </div> <p>Returns a string for DNS reverse lookup compatible with RFC3172.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-ip6_int"> <span class="method-name">ip6_int</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="ip6_int-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 378
def ip6_int
  if !ipv6?
    raise InvalidAddressError, "not an IPv6 address"
  end
  return _reverse + ".ip6.int"
end</pre> </div> <p>Returns a string for DNS reverse lookup compatible with RFC1886.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-ipv4-3F"> <span class="method-name">ipv4?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="ipv4-3F-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 253
def ipv4?
  return @family == Socket::AF_INET
end</pre> </div> <p>Returns true if the ipaddr is an IPv4 address.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-ipv4_compat"> <span class="method-name">ipv4_compat</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="ipv4_compat-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 338
def ipv4_compat
  warn "IPAddr\##{__callee__} is obsolete", uplevel: 1 if $VERBOSE
  if !ipv4?
    raise InvalidAddressError, "not an IPv4 address"
  end
  return self.clone.set(@addr, Socket::AF_INET6)
end</pre> </div> <p>Returns a new ipaddr built by converting the native IPv4 address into an IPv4-compatible IPv6 address.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-ipv4_compat-3F"> <span class="method-name">ipv4_compat?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="ipv4_compat-3F-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 312
def ipv4_compat?
  warn "IPAddr\##{__callee__} is obsolete", uplevel: 1 if $VERBOSE
  _ipv4_compat?
end</pre> </div> <p>Returns true if the ipaddr is an IPv4-compatible IPv6 address.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-ipv4_mapped"> <span class="method-name">ipv4_mapped</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="ipv4_mapped-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 329
def ipv4_mapped
  if !ipv4?
    raise InvalidAddressError, "not an IPv4 address"
  end
  return self.clone.set(@addr | 0xffff00000000, Socket::AF_INET6)
end</pre> </div> <p>Returns a new ipaddr built by converting the native IPv4 address into an IPv4-mapped IPv6 address.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-ipv4_mapped-3F"> <span class="method-name">ipv4_mapped?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="ipv4_mapped-3F-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 307
def ipv4_mapped?
  return ipv6? &amp;&amp; (@addr &gt;&gt; 32) == 0xffff
end</pre> </div> <p>Returns true if the ipaddr is an IPv4-mapped IPv6 address.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-ipv6-3F"> <span class="method-name">ipv6?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="ipv6-3F-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 258
def ipv6?
  return @family == Socket::AF_INET6
end</pre> </div> <p>Returns true if the ipaddr is an IPv6 address.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-link_local-3F"> <span class="method-name">link_local?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="link_local-3F-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 295
def link_local?
  case @family
  when Socket::AF_INET
    @addr &amp; 0xffff0000 == 0xa9fe0000 # 169.254.0.0/16
  when Socket::AF_INET6
    @addr &amp; 0xffc0_0000_0000_0000_0000_0000_0000_0000 == 0xfe80_0000_0000_0000_0000_0000_0000_0000
  else
    raise AddressFamilyError, "unsupported address family"
  end
end</pre> </div> <p>Returns true if the ipaddr is a link-local address. IPv4 addresses in 169.254.0.0/16 reserved by RFC 3927 and Link-Local IPv6 Unicast Addresses in fe80::/10 reserved by RFC 4291 are considered link-local.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-loopback-3F"> <span class="method-name">loopback?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="loopback-3F-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 263
def loopback?
  case @family
  when Socket::AF_INET
    @addr &amp; 0xff000000 == 0x7f000000
  when Socket::AF_INET6
    @addr == 1
  else
    raise AddressFamilyError, "unsupported address family"
  end
end</pre> </div> <p>Returns true if the ipaddr is a loopback address.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-mask"> <span class="method-name">mask</span><span class="method-args">(prefixlen)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="mask-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 160
def mask(prefixlen)
  return self.clone.mask!(prefixlen)
end</pre> </div> <p>Returns a new ipaddr built by masking IP address with the given prefixlen/netmask. (e.g. 8, 64, “255.255.255.0”, etc.)</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-native"> <span class="method-name">native</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="native-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 349
def native
  if !ipv4_mapped? &amp;&amp; !_ipv4_compat?
    return self
  end
  return self.clone.set(@addr &amp; IN4MASK, Socket::AF_INET)
end</pre> </div> <p>Returns a new ipaddr built by converting the IPv6 address into a native IPv4 address. If the IP address is not an IPv4-mapped or IPv4-compatible IPv6 address, returns self.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-prefix"> <span class="method-name">prefix</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="prefix-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 427
def prefix
  case @family
  when Socket::AF_INET
    n = IN4MASK ^ @mask_addr
    i = 32
  when Socket::AF_INET6
    n = IN6MASK ^ @mask_addr
    i = 128
  else
    raise AddressFamilyError, "unsupported address family"
  end
  while n.positive?
    n &gt;&gt;= 1
    i -= 1
  end
  i
end</pre> </div> <p>Returns the prefix length in bits for the ipaddr.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-prefix-3D"> <span class="method-name">prefix=</span><span class="method-args">(prefix)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="prefix-3D-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 446
def prefix=(prefix)
  case prefix
  when Integer
    mask!(prefix)
  else
    raise InvalidPrefixError, "prefix must be an integer"
  end
end</pre> </div> <p>Sets the prefix length in bits</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-private-3F"> <span class="method-name">private?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="private-3F-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 278
def private?
  case @family
  when Socket::AF_INET
    @addr &amp; 0xff000000 == 0x0a000000 ||    # 10.0.0.0/8
      @addr &amp; 0xfff00000 == 0xac100000 ||  # 172.16.0.0/12
      @addr &amp; 0xffff0000 == 0xc0a80000     # 192.168.0.0/16
  when Socket::AF_INET6
    @addr &amp; 0xfe00_0000_0000_0000_0000_0000_0000_0000 == 0xfc00_0000_0000_0000_0000_0000_0000_0000
  else
    raise AddressFamilyError, "unsupported address family"
  end
end</pre> </div> <p>Returns true if the ipaddr is a private address. IPv4 addresses in 10.0.0.0/8, 172.16.0.0/12 and 192.168.0.0/16 as defined in RFC 1918 and IPv6 Unique Local Addresses in fc00::/7 as defined in RFC 4193 are considered private.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-reverse"> <span class="method-name">reverse</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="reverse-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 358
def reverse
  case @family
  when Socket::AF_INET
    return _reverse + ".in-addr.arpa"
  when Socket::AF_INET6
    return ip6_arpa
  else
    raise AddressFamilyError, "unsupported address family"
  end
end</pre> </div> <p>Returns a string for DNS reverse lookup. It returns a string in RFC3172 form for an IPv6 address.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-succ"> <span class="method-name">succ</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="succ-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 386
def succ
  return self.clone.set(@addr + 1, @family)
end</pre> </div> <p>Returns the successor to the ipaddr.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-to_i"> <span class="method-name">to_i</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="to_i-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 203
def to_i
  return @addr
end</pre> </div> <p>Returns the integer representation of the ipaddr.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-to_range"> <span class="method-name">to_range</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="to_range-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 411
def to_range
  begin_addr = (@addr &amp; @mask_addr)

  case @family
  when Socket::AF_INET
    end_addr = (@addr | (IN4MASK ^ @mask_addr))
  when Socket::AF_INET6
    end_addr = (@addr | (IN6MASK ^ @mask_addr))
  else
    raise AddressFamilyError, "unsupported address family"
  end

  return clone.set(begin_addr, @family)..clone.set(end_addr, @family)
end</pre> </div> <p>Creates a <a href="range"><code>Range</code></a> object for the network address.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-to_s"> <span class="method-name">to_s</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="to_s-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 208
def to_s
  str = to_string
  return str if ipv4?

  str.gsub!(/\b0{1,3}([\da-f]+)\b/i, '\1')
  loop do
    break if str.sub!(/\A0:0:0:0:0:0:0:0\z/, '::')
    break if str.sub!(/\b0:0:0:0:0:0:0\b/, ':')
    break if str.sub!(/\b0:0:0:0:0:0\b/, ':')
    break if str.sub!(/\b0:0:0:0:0\b/, ':')
    break if str.sub!(/\b0:0:0:0\b/, ':')
    break if str.sub!(/\b0:0:0\b/, ':')
    break if str.sub!(/\b0:0\b/, ':')
    break
  end
  str.sub!(/:{3,}/, '::')

  if /\A::(ffff:)?([\da-f]{1,4}):([\da-f]{1,4})\z/i =~ str
    str = sprintf('::%s%d.%d.%d.%d', $1, $2.hex / 256, $2.hex % 256, $3.hex / 256, $3.hex % 256)
  end

  str
end</pre> </div> <p>Returns a string containing the IP address representation.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-to_string"> <span class="method-name">to_string</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="to_string-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 234
def to_string
  return _to_string(@addr)
end</pre> </div> <p>Returns a string containing the IP address representation in canonical form.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-7C"> <span class="method-name">|</span><span class="method-args">(other)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="7C-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 130
def |(other)
  return self.clone.set(@addr | coerce_other(other).to_i)
end</pre> </div> <p>Returns a new ipaddr built by bitwise OR.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-~"> <span class="method-name">~</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="~-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 145
def ~
  return self.clone.set(addr_mask(~@addr))
end</pre> </div> <p>Returns a new ipaddr built by bitwise negation.</p>  </div> </div> </section> <section id="protected-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Protected Instance Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-i-mask-21"> <span class="method-name">mask!</span><span class="method-args">(mask)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="mask-21-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 496
def mask!(mask)
  case mask
  when String
    if mask =~ /\A\d+\z/
      prefixlen = mask.to_i
    else
      m = IPAddr.new(mask)
      if m.family != @family
        raise InvalidPrefixError, "address family is not same"
      end
      @mask_addr = m.to_i
      n = @mask_addr ^ m.instance_variable_get(:@mask_addr)
      unless ((n + 1) &amp; n).zero?
        raise InvalidPrefixError, "invalid mask #{mask}"
      end
      @addr &amp;= @mask_addr
      return self
    end
  else
    prefixlen = mask
  end
  case @family
  when Socket::AF_INET
    if prefixlen &lt; 0 || prefixlen &gt; 32
      raise InvalidPrefixError, "invalid length"
    end
    masklen = 32 - prefixlen
    @mask_addr = ((IN4MASK &gt;&gt; masklen) &lt;&lt; masklen)
  when Socket::AF_INET6
    if prefixlen &lt; 0 || prefixlen &gt; 128
      raise InvalidPrefixError, "invalid length"
    end
    masklen = 128 - prefixlen
    @mask_addr = ((IN6MASK &gt;&gt; masklen) &lt;&lt; masklen)
  else
    raise AddressFamilyError, "unsupported address family"
  end
  @addr = ((@addr &gt;&gt; masklen) &lt;&lt; masklen)
  return self
end</pre> </div> <p><a href="set"><code>Set</code></a> current netmask to given mask.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-set"> <span class="method-name">set</span><span class="method-args">(addr, *family)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="set-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 475
def set(addr, *family)
  case family[0] ? family[0] : @family
  when Socket::AF_INET
    if addr &lt; 0 || addr &gt; IN4MASK
      raise InvalidAddressError, "invalid address"
    end
  when Socket::AF_INET6
    if addr &lt; 0 || addr &gt; IN6MASK
      raise InvalidAddressError, "invalid address"
    end
  else
    raise AddressFamilyError, "unsupported address family"
  end
  @addr = addr
  if family[0]
    @family = family[0]
  end
  return self
end</pre> </div> <p><a href="set"><code>Set</code></a> +@addr+, the internal stored ip address, to given <code>addr</code>. The parameter <code>addr</code> is validated using the first <code>family</code> member, which is <code>Socket::AF_INET</code> or <code>Socket::AF_INET6</code>.</p>  </div> </div> </section> <section id="private-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Private Instance Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-i-_ipv4_compat-3F"> <span class="method-name">_ipv4_compat?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="_ipv4_compat-3F-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 317
def _ipv4_compat?
  if !ipv6? || (@addr &gt;&gt; 32) != 0
    return false
  end
  a = (@addr &amp; IN4MASK)
  return a != 0 &amp;&amp; a != 1
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-_reverse"> <span class="method-name">_reverse</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="_reverse-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 675
def _reverse
  case @family
  when Socket::AF_INET
    return (0..3).map { |i|
      (@addr &gt;&gt; (8 * i)) &amp; 0xff
    }.join('.')
  when Socket::AF_INET6
    return ("%.32x" % @addr).reverse!.gsub!(/.(?!$)/, '\&amp;.')
  else
    raise AddressFamilyError, "unsupported address family"
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-_to_string"> <span class="method-name">_to_string</span><span class="method-args">(addr)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="_to_string-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 688
def _to_string(addr)
  case @family
  when Socket::AF_INET
    return (0..3).map { |i|
      (addr &gt;&gt; (24 - 8 * i)) &amp; 0xff
    }.join('.')
  when Socket::AF_INET6
    return (("%.32x" % addr).gsub!(/.{4}(?!$)/, '\&amp;:'))
  else
    raise AddressFamilyError, "unsupported address family"
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-addr_mask"> <span class="method-name">addr_mask</span><span class="method-args">(addr)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="addr_mask-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 664
def addr_mask(addr)
  case @family
  when Socket::AF_INET
    return addr &amp; IN4MASK
  when Socket::AF_INET6
    return addr &amp; IN6MASK
  else
    raise AddressFamilyError, "unsupported address family"
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-coerce_other"> <span class="method-name">coerce_other</span><span class="method-args">(other)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="coerce_other-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 601
def coerce_other(other)
  case other
  when IPAddr
    other
  when String
    self.class.new(other)
  else
    self.class.new(other, @family)
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-in6_addr"> <span class="method-name">in6_addr</span><span class="method-args">(left)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="in6_addr-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 627
def in6_addr(left)
  case left
  when RE_IPV6ADDRLIKE_FULL
    if $2
      addr = in_addr($~[2,4])
      left = $1 + ':'
    else
      addr = 0
    end
    right = ''
  when RE_IPV6ADDRLIKE_COMPRESSED
    if $4
      left.count(':') &lt;= 6 or raise InvalidAddressError, "invalid address"
      addr = in_addr($~[4,4])
      left = $1
      right = $3 + '0:0'
    else
      left.count(':') &lt;= ($1.empty? || $2.empty? ? 8 : 7) or
        raise InvalidAddressError, "invalid address"
      left = $1
      right = $2
      addr = 0
    end
  else
    raise InvalidAddressError, "invalid address"
  end
  l = left.split(':')
  r = right.split(':')
  rest = 8 - l.size - r.size
  if rest &lt; 0
    return nil
  end
  (l + Array.new(rest, '0') + r).inject(0) { |i, s|
    i &lt;&lt; 16 | s.hex
  } | addr
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-in_addr"> <span class="method-name">in_addr</span><span class="method-args">(addr)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="in_addr-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 612
def in_addr(addr)
  case addr
  when Array
    octets = addr
  else
    m = RE_IPV4ADDRLIKE.match(addr) or return nil
    octets = m.captures
  end
  octets.inject(0) { |i, s|
    (n = s.to_i) &lt; 256 or raise InvalidAddressError, "invalid address"
    s.match(/\A0./) and raise InvalidAddressError, "zero-filled number in IPv4 address is ambiguous"
    i &lt;&lt; 8 | n
  }
end</pre> </div>  </div> </div> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    Ruby Core © 1993–2020 Yukihiro Matsumoto<br>Licensed under the Ruby License.<br>Ruby Standard Library © contributors<br>Licensed under their own licenses.<br>
    
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
