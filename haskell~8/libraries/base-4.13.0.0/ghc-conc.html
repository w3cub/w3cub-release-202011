
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>GHC.Conc - Haskell 8 - W3cubDocs</title>
  
  <meta name="description" content=" Basic concurrency stuff. ">
  <meta name="keywords" content="ghc, conc, haskell, haskell~8">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/haskell~8/libraries/base-4.13.0.0/ghc-conc.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e498cd0ebe8746846fec95b1a53ab3bb0fb7f47f794f0a38f44c98a1f0d03b21d777ae2c583732e44a5a890f6eacb79a5333545db9d5f3616091ba21ca17d916.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/haskell~8.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/haskell~8/" class="_nav-link" title="" style="margin-left:0;">Haskell 8</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _haskell">
				
				
<h1 class="caption">GHC.Conc</h1>
<div class="_haskell-api">
<table class="info">
<tr>
<th valign="top">Copyright</th>
<td>(c) The University of Glasgow 1994-2002</td>
</tr>
<tr>
<th>License</th>
<td>see libraries/base/LICENSE</td>
</tr>
<tr>
<th>Maintainer</th>
<td>cvs-ghc@haskell.org</td>
</tr>
<tr>
<th>Stability</th>
<td>internal</td>
</tr>
<tr>
<th>Portability</th>
<td>non-portable (GHC extensions)</td>
</tr>
<tr>
<th>Safe Haskell</th>
<td>Unsafe</td>
</tr>
<tr>
<th>Language</th>
<td>Haskell2010</td>
</tr>
</table>
<div id="table-of-contents"><div id="contents-list">
<h4 class="caption" onclick="window.scrollTo(0,0)">Contents</h4>
<ul>
<li><a href="#g:1">Forking and suchlike</a></li>
<li><a href="#g:2">Waiting</a></li>
<li><a href="#g:3">Allocation counter and limit</a></li>
<li><a href="#g:4">TVars</a></li>
<li><a href="#g:5">Miscellaneous</a></li>
</ul>
</div></div>
<div id="description">
<h4 class="caption">Description</h4>
<p>Basic concurrency stuff.</p>
</div>
<p class="src">data <a id="t:ThreadId" class="def">ThreadId</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#ThreadId" class="link">Source</a> </p>
<p>A <code><a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a></code> is an abstract type representing a handle to a thread. <code><a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a></code> is an instance of <code><a href="data-eq#t:Eq" title="Data.Eq">Eq</a></code>, <code><a href="data-ord#t:Ord" title="Data.Ord">Ord</a></code> and <code><a href="text-show#t:Show" title="Text.Show">Show</a></code>, where the <code><a href="data-ord#t:Ord" title="Data.Ord">Ord</a></code> instance implements an arbitrary total ordering over <code><a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a></code>s. The <code><a href="text-show#t:Show" title="Text.Show">Show</a></code> instance lets you convert an arbitrary-valued <code><a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a></code> to string form; showing a <code><a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a></code> value is occasionally useful when debugging or diagnosing the behaviour of a concurrent program.</p>
<p><em>Note</em>: in GHC, if you have a <code><a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a></code>, you essentially have a pointer to the thread itself. This means the thread itself can't be garbage collected until you drop the <code><a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a></code>. This misfeature will hopefully be corrected at a later date.</p>
<div class="subs constructors">
<h4 class="caption">Constructors</h4>
<table><tr>
<td class="src">
<a id="v:ThreadId" class="def">ThreadId</a> <a href="ghc-exts#t:ThreadId-35-" title="GHC.Exts">ThreadId#</a>
</td>
<td class="doc empty"> </td>
</tr></table>
</div>
<div class="subs instances">
<h5 class="instances details-toggle-control details-toggle" data-details-id="i:ThreadId">Instances</h5>
<details id="i:ThreadId" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table>
<tr>
<td class="src clearfix">
 <a href="data-eq#t:Eq" title="Data.Eq">Eq</a> <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> </td>
<td class="doc"><p><span class="version">Since: base-4.2.0.0</span></p></td>
</tr>
<tr><td colspan="2"><details id="i:id:ThreadId:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="ghc-conc-sync">GHC.Conc.Sync</a></p> <div class="subs methods">
<h4 class="caption">Methods</h4>
<p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> -&gt; <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> -&gt; <a href="data-bool#t:Bool" title="Data.Bool">Bool</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/ghc-prim-0.5.3/src/GHC-Classes.html#%3D%3D" class="link">Source</a> </p>
<p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> -&gt; <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> -&gt; <a href="data-bool#t:Bool" title="Data.Bool">Bool</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/ghc-prim-0.5.3/src/GHC-Classes.html#%2F%3D" class="link">Source</a> </p>
</div></details></td></tr>
<tr>
<td class="src clearfix">
 <a href="data-ord#t:Ord" title="Data.Ord">Ord</a> <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> </td>
<td class="doc"><p><span class="version">Since: base-4.2.0.0</span></p></td>
</tr>
<tr><td colspan="2"><details id="i:id:ThreadId:Ord:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="ghc-conc-sync">GHC.Conc.Sync</a></p> <div class="subs methods">
<h4 class="caption">Methods</h4>
<p class="src"><a href="#v:compare">compare</a> :: <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> -&gt; <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> -&gt; <a href="data-ord#t:Ordering" title="Data.Ord">Ordering</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/ghc-prim-0.5.3/src/GHC-Classes.html#compare" class="link">Source</a> </p>
<p class="src"><a href="#v:-60-">(&lt;)</a> :: <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> -&gt; <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> -&gt; <a href="data-bool#t:Bool" title="Data.Bool">Bool</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/ghc-prim-0.5.3/src/GHC-Classes.html#%3C" class="link">Source</a> </p>
<p class="src"><a href="#v:-60--61-">(&lt;=)</a> :: <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> -&gt; <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> -&gt; <a href="data-bool#t:Bool" title="Data.Bool">Bool</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/ghc-prim-0.5.3/src/GHC-Classes.html#%3C%3D" class="link">Source</a> </p>
<p class="src"><a href="#v:-62-">(&gt;)</a> :: <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> -&gt; <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> -&gt; <a href="data-bool#t:Bool" title="Data.Bool">Bool</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/ghc-prim-0.5.3/src/GHC-Classes.html#%3E" class="link">Source</a> </p>
<p class="src"><a href="#v:-62--61-">(&gt;=)</a> :: <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> -&gt; <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> -&gt; <a href="data-bool#t:Bool" title="Data.Bool">Bool</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/ghc-prim-0.5.3/src/GHC-Classes.html#%3E%3D" class="link">Source</a> </p>
<p class="src"><a href="#v:max">max</a> :: <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> -&gt; <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> -&gt; <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/ghc-prim-0.5.3/src/GHC-Classes.html#max" class="link">Source</a> </p>
<p class="src"><a href="#v:min">min</a> :: <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> -&gt; <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> -&gt; <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/ghc-prim-0.5.3/src/GHC-Classes.html#min" class="link">Source</a> </p>
</div></details></td></tr>
<tr>
<td class="src clearfix">
 <a href="text-show#t:Show" title="Text.Show">Show</a> <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> </td>
<td class="doc"><p><span class="version">Since: base-4.2.0.0</span></p></td>
</tr>
<tr><td colspan="2"><details id="i:id:ThreadId:Show:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="ghc-conc-sync">GHC.Conc.Sync</a></p> <div class="subs methods">
<h4 class="caption">Methods</h4>
<p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="data-int#t:Int" title="Data.Int">Int</a> -&gt; <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> -&gt; <a href="text-show#t:ShowS" title="Text.Show">ShowS</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Show.html#showsPrec" class="link">Source</a> </p>
<p class="src"><a href="#v:show">show</a> :: <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> -&gt; <a href="data-string#t:String" title="Data.String">String</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Show.html#show" class="link">Source</a> </p>
<p class="src"><a href="#v:showList">showList</a> :: [<a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a>] -&gt; <a href="text-show#t:ShowS" title="Text.Show">ShowS</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Show.html#showList" class="link">Source</a> </p>
</div></details></td></tr>
</table></details>
</div>
<a href="#g:1" id="g:1"><h2>Forking and suchlike</h2></a><p class="src"><a id="v:forkIO" class="def">forkIO</a> :: <a href="system-io#t:IO" title="System.IO">IO</a> () -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#forkIO" class="link">Source</a> </p>
<p>Creates a new thread to run the <code><a href="system-io#t:IO" title="System.IO">IO</a></code> computation passed as the first argument, and returns the <code><a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a></code> of the newly created thread.</p>
<p>The new thread will be a lightweight, <em>unbound</em> thread. Foreign calls made by this thread are not guaranteed to be made by any particular OS thread; if you need foreign calls to be made by a particular OS thread, then use <code><a href="control-concurrent#v:forkOS" title="Control.Concurrent">forkOS</a></code> instead.</p>
<p>The new thread inherits the <em>masked</em> state of the parent (see <code><a href="control-exception#v:mask" title="Control.Exception">mask</a></code>).</p>
<p>The newly created thread has an exception handler that discards the exceptions <code><a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/Control-Exception-Base.html#t:BlockedIndefinitelyOnMVar" title="Control.Exception.Base">BlockedIndefinitelyOnMVar</a></code>, <code><a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/Control-Exception-Base.html#t:BlockedIndefinitelyOnSTM" title="Control.Exception.Base">BlockedIndefinitelyOnSTM</a></code>, and <code><a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/Control-Exception-Base.html#v:ThreadKilled" title="Control.Exception.Base">ThreadKilled</a></code>, and passes all other exceptions to the uncaught exception handler.</p>
<p class="src"><a id="v:forkIOWithUnmask" class="def">forkIOWithUnmask</a> :: ((forall a. <a href="system-io#t:IO" title="System.IO">IO</a> a -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> a) -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> ()) -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#forkIOWithUnmask" class="link">Source</a> </p>
<p>Like <code><a href="ghc-conc#v:forkIO" title="GHC.Conc">forkIO</a></code>, but the child thread is passed a function that can be used to unmask asynchronous exceptions. This function is typically used in the following way</p>
<pre> ... mask_ $ forkIOWithUnmask $ \unmask -&gt;
                catch (unmask ...) handler</pre>
<p>so that the exception handler in the child thread is established with asynchronous exceptions masked, meanwhile the main body of the child thread is executed in the unmasked state.</p>
<p>Note that the unmask function passed to the child thread should only be used in that thread; the behaviour is undefined if it is invoked in a different thread.</p>
<p><span class="version">Since: base-4.4.0.0</span></p>
<p class="src"><a id="v:forkOn" class="def">forkOn</a> :: <a href="data-int#t:Int" title="Data.Int">Int</a> -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> () -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#forkOn" class="link">Source</a> </p>
<p>Like <code><a href="ghc-conc#v:forkIO" title="GHC.Conc">forkIO</a></code>, but lets you specify on which capability the thread should run. Unlike a <code><a href="ghc-conc#v:forkIO" title="GHC.Conc">forkIO</a></code> thread, a thread created by <code><a href="ghc-conc#v:forkOn" title="GHC.Conc">forkOn</a></code> will stay on the same capability for its entire lifetime (<code><a href="ghc-conc#v:forkIO" title="GHC.Conc">forkIO</a></code> threads can migrate between capabilities according to the scheduling policy). <code><a href="ghc-conc#v:forkOn" title="GHC.Conc">forkOn</a></code> is useful for overriding the scheduling policy when you know in advance how best to distribute the threads.</p>
<p>The <code><a href="data-int#t:Int" title="Data.Int">Int</a></code> argument specifies a <em>capability number</em> (see <code><a href="ghc-conc#v:getNumCapabilities" title="GHC.Conc">getNumCapabilities</a></code>). Typically capabilities correspond to physical processors, but the exact behaviour is implementation-dependent. The value passed to <code><a href="ghc-conc#v:forkOn" title="GHC.Conc">forkOn</a></code> is interpreted modulo the total number of capabilities as returned by <code><a href="ghc-conc#v:getNumCapabilities" title="GHC.Conc">getNumCapabilities</a></code>.</p>
<p>GHC note: the number of capabilities is specified by the <code>+RTS -N</code> option when the program is started. Capabilities can be fixed to actual processor cores with <code>+RTS -qa</code> if the underlying operating system supports that, although in practice this is usually unnecessary (and may actually degrade performance in some cases - experimentation is recommended).</p>
<p><span class="version">Since: base-4.4.0.0</span></p>
<p class="src"><a id="v:forkOnWithUnmask" class="def">forkOnWithUnmask</a> :: <a href="data-int#t:Int" title="Data.Int">Int</a> -&gt; ((forall a. <a href="system-io#t:IO" title="System.IO">IO</a> a -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> a) -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> ()) -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#forkOnWithUnmask" class="link">Source</a> </p>
<p>Like <code><a href="ghc-conc#v:forkIOWithUnmask" title="GHC.Conc">forkIOWithUnmask</a></code>, but the child thread is pinned to the given CPU, as with <code><a href="ghc-conc#v:forkOn" title="GHC.Conc">forkOn</a></code>.</p>
<p><span class="version">Since: base-4.4.0.0</span></p>
<p class="src"><a id="v:numCapabilities" class="def">numCapabilities</a> :: <a href="data-int#t:Int" title="Data.Int">Int</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#numCapabilities" class="link">Source</a> </p>
<p>the value passed to the <code>+RTS -N</code> flag. This is the number of Haskell threads that can run truly simultaneously at any given time, and is typically set to the number of physical processor cores on the machine.</p>
<p>Strictly speaking it is better to use <code><a href="ghc-conc#v:getNumCapabilities" title="GHC.Conc">getNumCapabilities</a></code>, because the number of capabilities might vary at runtime.</p>
<p class="src"><a id="v:getNumCapabilities" class="def">getNumCapabilities</a> :: <a href="system-io#t:IO" title="System.IO">IO</a> <a href="data-int#t:Int" title="Data.Int">Int</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#getNumCapabilities" class="link">Source</a> </p>
<p>Returns the number of Haskell threads that can run truly simultaneously (on separate physical processors) at any given time. To change this value, use <code><a href="ghc-conc#v:setNumCapabilities" title="GHC.Conc">setNumCapabilities</a></code>.</p>
<p><span class="version">Since: base-4.4.0.0</span></p>
<p class="src"><a id="v:setNumCapabilities" class="def">setNumCapabilities</a> :: <a href="data-int#t:Int" title="Data.Int">Int</a> -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> () <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#setNumCapabilities" class="link">Source</a> </p>
<p>Set the number of Haskell threads that can run truly simultaneously (on separate physical processors) at any given time. The number passed to <code><a href="ghc-conc#v:forkOn" title="GHC.Conc">forkOn</a></code> is interpreted modulo this value. The initial value is given by the <code>+RTS -N</code> runtime flag.</p>
<p>This is also the number of threads that will participate in parallel garbage collection. It is strongly recommended that the number of capabilities is not set larger than the number of physical processor cores, and it may often be beneficial to leave one or more cores free to avoid contention with other processes in the machine.</p>
<p><span class="version">Since: base-4.5.0.0</span></p>
<p class="src"><a id="v:getNumProcessors" class="def">getNumProcessors</a> :: <a href="system-io#t:IO" title="System.IO">IO</a> <a href="data-int#t:Int" title="Data.Int">Int</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#getNumProcessors" class="link">Source</a> </p>
<p>Returns the number of CPUs that the machine has</p>
<p><span class="version">Since: base-4.5.0.0</span></p>
<p class="src"><a id="v:numSparks" class="def">numSparks</a> :: <a href="system-io#t:IO" title="System.IO">IO</a> <a href="data-int#t:Int" title="Data.Int">Int</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#numSparks" class="link">Source</a> </p>
<p>Returns the number of sparks currently in the local spark pool</p>
<p class="src"><a id="v:childHandler" class="def">childHandler</a> :: <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/Control-Exception-Base.html#t:SomeException" title="Control.Exception.Base">SomeException</a> -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> () <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#childHandler" class="link">Source</a> </p>
<p class="src"><a id="v:myThreadId" class="def">myThreadId</a> :: <a href="system-io#t:IO" title="System.IO">IO</a> <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#myThreadId" class="link">Source</a> </p>
<p>Returns the <code><a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a></code> of the calling thread (GHC only).</p>
<p class="src"><a id="v:killThread" class="def">killThread</a> :: <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> () <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#killThread" class="link">Source</a> </p>
<p><code><a href="ghc-conc#v:killThread" title="GHC.Conc">killThread</a></code> raises the <code><a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/Control-Exception-Base.html#v:ThreadKilled" title="Control.Exception.Base">ThreadKilled</a></code> exception in the given thread (GHC only).</p>
<pre>killThread tid = throwTo tid ThreadKilled</pre>
<p class="src"><a id="v:throwTo" class="def">throwTo</a> :: <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/Control-Exception-Base.html#t:Exception" title="Control.Exception.Base">Exception</a> e =&gt; <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> -&gt; e -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> () <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#throwTo" class="link">Source</a> </p>
<p><code><a href="ghc-conc#v:throwTo" title="GHC.Conc">throwTo</a></code> raises an arbitrary exception in the target thread (GHC only).</p>
<p>Exception delivery synchronizes between the source and target thread: <code><a href="ghc-conc#v:throwTo" title="GHC.Conc">throwTo</a></code> does not return until the exception has been raised in the target thread. The calling thread can thus be certain that the target thread has received the exception. Exception delivery is also atomic with respect to other exceptions. Atomicity is a useful property to have when dealing with race conditions: e.g. if there are two threads that can kill each other, it is guaranteed that only one of the threads will get to kill the other.</p>
<p>Whatever work the target thread was doing when the exception was raised is not lost: the computation is suspended until required by another thread.</p>
<p>If the target thread is currently making a foreign call, then the exception will not be raised (and hence <code><a href="ghc-conc#v:throwTo" title="GHC.Conc">throwTo</a></code> will not return) until the call has completed. This is the case regardless of whether the call is inside a <code><a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/Control-Exception-Base.html#v:mask" title="Control.Exception.Base">mask</a></code> or not. However, in GHC a foreign call can be annotated as <code>interruptible</code>, in which case a <code><a href="ghc-conc#v:throwTo" title="GHC.Conc">throwTo</a></code> will cause the RTS to attempt to cause the call to return; see the GHC documentation for more details.</p>
<p>Important note: the behaviour of <code><a href="ghc-conc#v:throwTo" title="GHC.Conc">throwTo</a></code> differs from that described in the paper "Asynchronous exceptions in Haskell" (<a href="http://research.microsoft.com/~simonpj/Papers/asynch-exns.htm">http://research.microsoft.com/~simonpj/Papers/asynch-exns.htm</a>). In the paper, <code><a href="ghc-conc#v:throwTo" title="GHC.Conc">throwTo</a></code> is non-blocking; but the library implementation adopts a more synchronous design in which <code><a href="ghc-conc#v:throwTo" title="GHC.Conc">throwTo</a></code> does not return until the exception is received by the target thread. The trade-off is discussed in Section 9 of the paper. Like any blocking operation, <code><a href="ghc-conc#v:throwTo" title="GHC.Conc">throwTo</a></code> is therefore interruptible (see Section 5.3 of the paper). Unlike other interruptible operations, however, <code><a href="ghc-conc#v:throwTo" title="GHC.Conc">throwTo</a></code> is <em>always</em> interruptible, even if it does not actually block.</p>
<p>There is no guarantee that the exception will be delivered promptly, although the runtime will endeavour to ensure that arbitrary delays don't occur. In GHC, an exception can only be raised when a thread reaches a <em>safe point</em>, where a safe point is where memory allocation occurs. Some loops do not perform any memory allocation inside the loop and therefore cannot be interrupted by a <code><a href="ghc-conc#v:throwTo" title="GHC.Conc">throwTo</a></code>.</p>
<p>If the target of <code><a href="ghc-conc#v:throwTo" title="GHC.Conc">throwTo</a></code> is the calling thread, then the behaviour is the same as <code><a href="control-exception#v:throwIO" title="Control.Exception">throwIO</a></code>, except that the exception is thrown as an asynchronous exception. This means that if there is an enclosing pure computation, which would be the case if the current IO operation is inside <code><a href="system-io-unsafe#v:unsafePerformIO" title="System.IO.Unsafe">unsafePerformIO</a></code> or <code><a href="system-io-unsafe#v:unsafeInterleaveIO" title="System.IO.Unsafe">unsafeInterleaveIO</a></code>, that computation is not permanently replaced by the exception, but is suspended as if it had received an asynchronous exception.</p>
<p>Note that if <code><a href="ghc-conc#v:throwTo" title="GHC.Conc">throwTo</a></code> is called with the current thread as the target, the exception will be thrown even if the thread is currently inside <code><a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/Control-Exception-Base.html#v:mask" title="Control.Exception.Base">mask</a></code> or <code><a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/Control-Exception-Base.html#v:uninterruptibleMask" title="Control.Exception.Base">uninterruptibleMask</a></code>.</p>
<p class="src"><a id="v:par" class="def">par</a> :: a -&gt; b -&gt; b <span class="fixity">infixr 0</span> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#par" class="link">Source</a> </p>
<p class="src"><a id="v:pseq" class="def">pseq</a> :: a -&gt; b -&gt; b <span class="fixity">infixr 0</span> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#pseq" class="link">Source</a> </p>
<p class="src"><a id="v:runSparks" class="def">runSparks</a> :: <a href="system-io#t:IO" title="System.IO">IO</a> () <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#runSparks" class="link">Source</a> </p>
<p>Internal function used by the RTS to run sparks.</p>
<p class="src"><a id="v:yield" class="def">yield</a> :: <a href="system-io#t:IO" title="System.IO">IO</a> () <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#yield" class="link">Source</a> </p>
<p>The <code><a href="ghc-conc#v:yield" title="GHC.Conc">yield</a></code> action allows (forces, in a co-operative multitasking implementation) a context-switch to any other currently runnable threads (if any), and is occasionally useful when implementing concurrency abstractions.</p>
<p class="src"><a id="v:labelThread" class="def">labelThread</a> :: <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> -&gt; <a href="data-string#t:String" title="Data.String">String</a> -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> () <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#labelThread" class="link">Source</a> </p>
<p><code><a href="ghc-conc#v:labelThread" title="GHC.Conc">labelThread</a></code> stores a string as identifier for this thread if you built a RTS with debugging support. This identifier will be used in the debugging output to make distinction of different threads easier (otherwise you only have the thread state object's address in the heap).</p>
<p>Other applications like the graphical Concurrent Haskell Debugger (<a href="http://www.informatik.uni-kiel.de/~fhu/chd/">http://www.informatik.uni-kiel.de/~fhu/chd/</a>) may choose to overload <code><a href="ghc-conc#v:labelThread" title="GHC.Conc">labelThread</a></code> for their purposes as well.</p>
<p class="src"><a id="v:mkWeakThreadId" class="def">mkWeakThreadId</a> :: <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> (<a href="system-mem-weak#t:Weak" title="System.Mem.Weak">Weak</a> <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a>) <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#mkWeakThreadId" class="link">Source</a> </p>
<p>Make a weak pointer to a <code><a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a></code>. It can be important to do this if you want to hold a reference to a <code><a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a></code> while still allowing the thread to receive the <code>BlockedIndefinitely</code> family of exceptions (e.g. <code><a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/Control-Exception-Base.html#t:BlockedIndefinitelyOnMVar" title="Control.Exception.Base">BlockedIndefinitelyOnMVar</a></code>). Holding a normal <code><a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a></code> reference will prevent the delivery of <code>BlockedIndefinitely</code> exceptions because the reference could be used as the target of <code><a href="ghc-conc#v:throwTo" title="GHC.Conc">throwTo</a></code> at any time, which would unblock the thread.</p>
<p>Holding a <code>Weak ThreadId</code>, on the other hand, will not prevent the thread from receiving <code>BlockedIndefinitely</code> exceptions. It is still possible to throw an exception to a <code>Weak ThreadId</code>, but the caller must use <code>deRefWeak</code> first to determine whether the thread still exists.</p>
<p><span class="version">Since: base-4.6.0.0</span></p>
<p class="src">data <a id="t:ThreadStatus" class="def">ThreadStatus</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#ThreadStatus" class="link">Source</a> </p>
<p>The current status of a thread</p>
<div class="subs constructors">
<h4 class="caption">Constructors</h4>
<table>
<tr>
<td class="src"><a id="v:ThreadRunning" class="def">ThreadRunning</a></td>
<td class="doc"><p>the thread is currently runnable or running</p></td>
</tr>
<tr>
<td class="src"><a id="v:ThreadFinished" class="def">ThreadFinished</a></td>
<td class="doc"><p>the thread has finished</p></td>
</tr>
<tr>
<td class="src">
<a id="v:ThreadBlocked" class="def">ThreadBlocked</a> <a href="ghc-conc#t:BlockReason" title="GHC.Conc">BlockReason</a>
</td>
<td class="doc"><p>the thread is blocked on some resource</p></td>
</tr>
<tr>
<td class="src"><a id="v:ThreadDied" class="def">ThreadDied</a></td>
<td class="doc"><p>the thread received an uncaught exception</p></td>
</tr>
</table>
</div>
<div class="subs instances">
<h5 class="instances details-toggle-control details-toggle" data-details-id="i:ThreadStatus">Instances</h5>
<details id="i:ThreadStatus" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table>
<tr>
<td class="src clearfix">
 <a href="data-eq#t:Eq" title="Data.Eq">Eq</a> <a href="ghc-conc#t:ThreadStatus" title="GHC.Conc">ThreadStatus</a> </td>
<td class="doc"><p><span class="version">Since: base-4.3.0.0</span></p></td>
</tr>
<tr><td colspan="2"><details id="i:id:ThreadStatus:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="ghc-conc-sync">GHC.Conc.Sync</a></p> <div class="subs methods">
<h4 class="caption">Methods</h4>
<p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="ghc-conc#t:ThreadStatus" title="GHC.Conc">ThreadStatus</a> -&gt; <a href="ghc-conc#t:ThreadStatus" title="GHC.Conc">ThreadStatus</a> -&gt; <a href="data-bool#t:Bool" title="Data.Bool">Bool</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/ghc-prim-0.5.3/src/GHC-Classes.html#%3D%3D" class="link">Source</a> </p>
<p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="ghc-conc#t:ThreadStatus" title="GHC.Conc">ThreadStatus</a> -&gt; <a href="ghc-conc#t:ThreadStatus" title="GHC.Conc">ThreadStatus</a> -&gt; <a href="data-bool#t:Bool" title="Data.Bool">Bool</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/ghc-prim-0.5.3/src/GHC-Classes.html#%2F%3D" class="link">Source</a> </p>
</div></details></td></tr>
<tr>
<td class="src clearfix">
 <a href="data-ord#t:Ord" title="Data.Ord">Ord</a> <a href="ghc-conc#t:ThreadStatus" title="GHC.Conc">ThreadStatus</a> </td>
<td class="doc"><p><span class="version">Since: base-4.3.0.0</span></p></td>
</tr>
<tr><td colspan="2"><details id="i:id:ThreadStatus:Ord:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="ghc-conc-sync">GHC.Conc.Sync</a></p> <div class="subs methods">
<h4 class="caption">Methods</h4>
<p class="src"><a href="#v:compare">compare</a> :: <a href="ghc-conc#t:ThreadStatus" title="GHC.Conc">ThreadStatus</a> -&gt; <a href="ghc-conc#t:ThreadStatus" title="GHC.Conc">ThreadStatus</a> -&gt; <a href="data-ord#t:Ordering" title="Data.Ord">Ordering</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/ghc-prim-0.5.3/src/GHC-Classes.html#compare" class="link">Source</a> </p>
<p class="src"><a href="#v:-60-">(&lt;)</a> :: <a href="ghc-conc#t:ThreadStatus" title="GHC.Conc">ThreadStatus</a> -&gt; <a href="ghc-conc#t:ThreadStatus" title="GHC.Conc">ThreadStatus</a> -&gt; <a href="data-bool#t:Bool" title="Data.Bool">Bool</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/ghc-prim-0.5.3/src/GHC-Classes.html#%3C" class="link">Source</a> </p>
<p class="src"><a href="#v:-60--61-">(&lt;=)</a> :: <a href="ghc-conc#t:ThreadStatus" title="GHC.Conc">ThreadStatus</a> -&gt; <a href="ghc-conc#t:ThreadStatus" title="GHC.Conc">ThreadStatus</a> -&gt; <a href="data-bool#t:Bool" title="Data.Bool">Bool</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/ghc-prim-0.5.3/src/GHC-Classes.html#%3C%3D" class="link">Source</a> </p>
<p class="src"><a href="#v:-62-">(&gt;)</a> :: <a href="ghc-conc#t:ThreadStatus" title="GHC.Conc">ThreadStatus</a> -&gt; <a href="ghc-conc#t:ThreadStatus" title="GHC.Conc">ThreadStatus</a> -&gt; <a href="data-bool#t:Bool" title="Data.Bool">Bool</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/ghc-prim-0.5.3/src/GHC-Classes.html#%3E" class="link">Source</a> </p>
<p class="src"><a href="#v:-62--61-">(&gt;=)</a> :: <a href="ghc-conc#t:ThreadStatus" title="GHC.Conc">ThreadStatus</a> -&gt; <a href="ghc-conc#t:ThreadStatus" title="GHC.Conc">ThreadStatus</a> -&gt; <a href="data-bool#t:Bool" title="Data.Bool">Bool</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/ghc-prim-0.5.3/src/GHC-Classes.html#%3E%3D" class="link">Source</a> </p>
<p class="src"><a href="#v:max">max</a> :: <a href="ghc-conc#t:ThreadStatus" title="GHC.Conc">ThreadStatus</a> -&gt; <a href="ghc-conc#t:ThreadStatus" title="GHC.Conc">ThreadStatus</a> -&gt; <a href="ghc-conc#t:ThreadStatus" title="GHC.Conc">ThreadStatus</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/ghc-prim-0.5.3/src/GHC-Classes.html#max" class="link">Source</a> </p>
<p class="src"><a href="#v:min">min</a> :: <a href="ghc-conc#t:ThreadStatus" title="GHC.Conc">ThreadStatus</a> -&gt; <a href="ghc-conc#t:ThreadStatus" title="GHC.Conc">ThreadStatus</a> -&gt; <a href="ghc-conc#t:ThreadStatus" title="GHC.Conc">ThreadStatus</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/ghc-prim-0.5.3/src/GHC-Classes.html#min" class="link">Source</a> </p>
</div></details></td></tr>
<tr>
<td class="src clearfix">
 <a href="text-show#t:Show" title="Text.Show">Show</a> <a href="ghc-conc#t:ThreadStatus" title="GHC.Conc">ThreadStatus</a> </td>
<td class="doc"><p><span class="version">Since: base-4.3.0.0</span></p></td>
</tr>
<tr><td colspan="2"><details id="i:id:ThreadStatus:Show:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="ghc-conc-sync">GHC.Conc.Sync</a></p> <div class="subs methods">
<h4 class="caption">Methods</h4>
<p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="data-int#t:Int" title="Data.Int">Int</a> -&gt; <a href="ghc-conc#t:ThreadStatus" title="GHC.Conc">ThreadStatus</a> -&gt; <a href="text-show#t:ShowS" title="Text.Show">ShowS</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Show.html#showsPrec" class="link">Source</a> </p>
<p class="src"><a href="#v:show">show</a> :: <a href="ghc-conc#t:ThreadStatus" title="GHC.Conc">ThreadStatus</a> -&gt; <a href="data-string#t:String" title="Data.String">String</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Show.html#show" class="link">Source</a> </p>
<p class="src"><a href="#v:showList">showList</a> :: [<a href="ghc-conc#t:ThreadStatus" title="GHC.Conc">ThreadStatus</a>] -&gt; <a href="text-show#t:ShowS" title="Text.Show">ShowS</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Show.html#showList" class="link">Source</a> </p>
</div></details></td></tr>
</table></details>
</div>
<p class="src">data <a id="t:BlockReason" class="def">BlockReason</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#BlockReason" class="link">Source</a> </p>
<div class="subs constructors">
<h4 class="caption">Constructors</h4>
<table>
<tr>
<td class="src"><a id="v:BlockedOnMVar" class="def">BlockedOnMVar</a></td>
<td class="doc"><p>blocked on <code><a href="control-concurrent-mvar#t:MVar" title="Control.Concurrent.MVar">MVar</a></code></p></td>
</tr>
<tr>
<td class="src"><a id="v:BlockedOnBlackHole" class="def">BlockedOnBlackHole</a></td>
<td class="doc"><p>blocked on a computation in progress by another thread</p></td>
</tr>
<tr>
<td class="src"><a id="v:BlockedOnException" class="def">BlockedOnException</a></td>
<td class="doc"><p>blocked in <code><a href="ghc-conc#v:throwTo" title="GHC.Conc">throwTo</a></code></p></td>
</tr>
<tr>
<td class="src"><a id="v:BlockedOnSTM" class="def">BlockedOnSTM</a></td>
<td class="doc"><p>blocked in <code><a href="ghc-conc#v:retry" title="GHC.Conc">retry</a></code> in an STM transaction</p></td>
</tr>
<tr>
<td class="src"><a id="v:BlockedOnForeignCall" class="def">BlockedOnForeignCall</a></td>
<td class="doc"><p>currently in a foreign call</p></td>
</tr>
<tr>
<td class="src"><a id="v:BlockedOnOther" class="def">BlockedOnOther</a></td>
<td class="doc"><p>blocked on some other resource. Without <code>-threaded</code>, I/O and <code><a href="control-concurrent#v:threadDelay" title="Control.Concurrent">threadDelay</a></code> show up as <code><a href="ghc-conc#v:BlockedOnOther" title="GHC.Conc">BlockedOnOther</a></code>, with <code>-threaded</code> they show up as <code><a href="ghc-conc#v:BlockedOnMVar" title="GHC.Conc">BlockedOnMVar</a></code>.</p></td>
</tr>
</table>
</div>
<div class="subs instances">
<h5 class="instances details-toggle-control details-toggle" data-details-id="i:BlockReason">Instances</h5>
<details id="i:BlockReason" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table>
<tr>
<td class="src clearfix">
 <a href="data-eq#t:Eq" title="Data.Eq">Eq</a> <a href="ghc-conc#t:BlockReason" title="GHC.Conc">BlockReason</a> </td>
<td class="doc"><p><span class="version">Since: base-4.3.0.0</span></p></td>
</tr>
<tr><td colspan="2"><details id="i:id:BlockReason:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="ghc-conc-sync">GHC.Conc.Sync</a></p> <div class="subs methods">
<h4 class="caption">Methods</h4>
<p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="ghc-conc#t:BlockReason" title="GHC.Conc">BlockReason</a> -&gt; <a href="ghc-conc#t:BlockReason" title="GHC.Conc">BlockReason</a> -&gt; <a href="data-bool#t:Bool" title="Data.Bool">Bool</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/ghc-prim-0.5.3/src/GHC-Classes.html#%3D%3D" class="link">Source</a> </p>
<p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="ghc-conc#t:BlockReason" title="GHC.Conc">BlockReason</a> -&gt; <a href="ghc-conc#t:BlockReason" title="GHC.Conc">BlockReason</a> -&gt; <a href="data-bool#t:Bool" title="Data.Bool">Bool</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/ghc-prim-0.5.3/src/GHC-Classes.html#%2F%3D" class="link">Source</a> </p>
</div></details></td></tr>
<tr>
<td class="src clearfix">
 <a href="data-ord#t:Ord" title="Data.Ord">Ord</a> <a href="ghc-conc#t:BlockReason" title="GHC.Conc">BlockReason</a> </td>
<td class="doc"><p><span class="version">Since: base-4.3.0.0</span></p></td>
</tr>
<tr><td colspan="2"><details id="i:id:BlockReason:Ord:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="ghc-conc-sync">GHC.Conc.Sync</a></p> <div class="subs methods">
<h4 class="caption">Methods</h4>
<p class="src"><a href="#v:compare">compare</a> :: <a href="ghc-conc#t:BlockReason" title="GHC.Conc">BlockReason</a> -&gt; <a href="ghc-conc#t:BlockReason" title="GHC.Conc">BlockReason</a> -&gt; <a href="data-ord#t:Ordering" title="Data.Ord">Ordering</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/ghc-prim-0.5.3/src/GHC-Classes.html#compare" class="link">Source</a> </p>
<p class="src"><a href="#v:-60-">(&lt;)</a> :: <a href="ghc-conc#t:BlockReason" title="GHC.Conc">BlockReason</a> -&gt; <a href="ghc-conc#t:BlockReason" title="GHC.Conc">BlockReason</a> -&gt; <a href="data-bool#t:Bool" title="Data.Bool">Bool</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/ghc-prim-0.5.3/src/GHC-Classes.html#%3C" class="link">Source</a> </p>
<p class="src"><a href="#v:-60--61-">(&lt;=)</a> :: <a href="ghc-conc#t:BlockReason" title="GHC.Conc">BlockReason</a> -&gt; <a href="ghc-conc#t:BlockReason" title="GHC.Conc">BlockReason</a> -&gt; <a href="data-bool#t:Bool" title="Data.Bool">Bool</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/ghc-prim-0.5.3/src/GHC-Classes.html#%3C%3D" class="link">Source</a> </p>
<p class="src"><a href="#v:-62-">(&gt;)</a> :: <a href="ghc-conc#t:BlockReason" title="GHC.Conc">BlockReason</a> -&gt; <a href="ghc-conc#t:BlockReason" title="GHC.Conc">BlockReason</a> -&gt; <a href="data-bool#t:Bool" title="Data.Bool">Bool</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/ghc-prim-0.5.3/src/GHC-Classes.html#%3E" class="link">Source</a> </p>
<p class="src"><a href="#v:-62--61-">(&gt;=)</a> :: <a href="ghc-conc#t:BlockReason" title="GHC.Conc">BlockReason</a> -&gt; <a href="ghc-conc#t:BlockReason" title="GHC.Conc">BlockReason</a> -&gt; <a href="data-bool#t:Bool" title="Data.Bool">Bool</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/ghc-prim-0.5.3/src/GHC-Classes.html#%3E%3D" class="link">Source</a> </p>
<p class="src"><a href="#v:max">max</a> :: <a href="ghc-conc#t:BlockReason" title="GHC.Conc">BlockReason</a> -&gt; <a href="ghc-conc#t:BlockReason" title="GHC.Conc">BlockReason</a> -&gt; <a href="ghc-conc#t:BlockReason" title="GHC.Conc">BlockReason</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/ghc-prim-0.5.3/src/GHC-Classes.html#max" class="link">Source</a> </p>
<p class="src"><a href="#v:min">min</a> :: <a href="ghc-conc#t:BlockReason" title="GHC.Conc">BlockReason</a> -&gt; <a href="ghc-conc#t:BlockReason" title="GHC.Conc">BlockReason</a> -&gt; <a href="ghc-conc#t:BlockReason" title="GHC.Conc">BlockReason</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/ghc-prim-0.5.3/src/GHC-Classes.html#min" class="link">Source</a> </p>
</div></details></td></tr>
<tr>
<td class="src clearfix">
 <a href="text-show#t:Show" title="Text.Show">Show</a> <a href="ghc-conc#t:BlockReason" title="GHC.Conc">BlockReason</a> </td>
<td class="doc"><p><span class="version">Since: base-4.3.0.0</span></p></td>
</tr>
<tr><td colspan="2"><details id="i:id:BlockReason:Show:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="ghc-conc-sync">GHC.Conc.Sync</a></p> <div class="subs methods">
<h4 class="caption">Methods</h4>
<p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="data-int#t:Int" title="Data.Int">Int</a> -&gt; <a href="ghc-conc#t:BlockReason" title="GHC.Conc">BlockReason</a> -&gt; <a href="text-show#t:ShowS" title="Text.Show">ShowS</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Show.html#showsPrec" class="link">Source</a> </p>
<p class="src"><a href="#v:show">show</a> :: <a href="ghc-conc#t:BlockReason" title="GHC.Conc">BlockReason</a> -&gt; <a href="data-string#t:String" title="Data.String">String</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Show.html#show" class="link">Source</a> </p>
<p class="src"><a href="#v:showList">showList</a> :: [<a href="ghc-conc#t:BlockReason" title="GHC.Conc">BlockReason</a>] -&gt; <a href="text-show#t:ShowS" title="Text.Show">ShowS</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Show.html#showList" class="link">Source</a> </p>
</div></details></td></tr>
</table></details>
</div>
<p class="src"><a id="v:threadStatus" class="def">threadStatus</a> :: <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> <a href="ghc-conc#t:ThreadStatus" title="GHC.Conc">ThreadStatus</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#threadStatus" class="link">Source</a> </p>
<p class="src"><a id="v:threadCapability" class="def">threadCapability</a> :: <a href="ghc-conc#t:ThreadId" title="GHC.Conc">ThreadId</a> -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> (<a href="data-int#t:Int" title="Data.Int">Int</a>, <a href="data-bool#t:Bool" title="Data.Bool">Bool</a>) <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#threadCapability" class="link">Source</a> </p>
<p>Returns the number of the capability on which the thread is currently running, and a boolean indicating whether the thread is locked to that capability or not. A thread is locked to a capability if it was created with <code>forkOn</code>.</p>
<p><span class="version">Since: base-4.4.0.0</span></p>
<p class="src"><a id="v:newStablePtrPrimMVar" class="def">newStablePtrPrimMVar</a> :: <a href="control-concurrent-mvar#t:MVar" title="Control.Concurrent.MVar">MVar</a> () -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> (<a href="foreign-stableptr#t:StablePtr" title="Foreign.StablePtr">StablePtr</a> <a href="ghc-conc#t:PrimMVar" title="GHC.Conc">PrimMVar</a>) <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#newStablePtrPrimMVar" class="link">Source</a> </p>
<p>Make a StablePtr that can be passed to the C function <code>hs_try_putmvar()</code>. The RTS wants a <code><a href="foreign-stableptr#t:StablePtr" title="Foreign.StablePtr">StablePtr</a></code> to the underlying <code><a href="ghc-exts#t:MVar-35-" title="GHC.Exts">MVar#</a></code>, but a <code><a href="ghc-exts#t:StablePtr-35-" title="GHC.Exts">StablePtr#</a></code> can only refer to lifted types, so we have to cheat by coercing.</p>
<p class="src">data <a id="t:PrimMVar" class="def">PrimMVar</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#PrimMVar" class="link">Source</a> </p>
<a href="#g:2" id="g:2"><h2>Waiting</h2></a><p class="src"><a id="v:threadDelay" class="def">threadDelay</a> :: <a href="data-int#t:Int" title="Data.Int">Int</a> -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> () <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-IO.html#threadDelay" class="link">Source</a> </p>
<p>Suspends the current thread for a given number of microseconds (GHC only).</p>
<p>There is no guarantee that the thread will be rescheduled promptly when the delay has expired, but the thread will never continue to run <em>earlier</em> than specified.</p>
<p class="src"><a id="v:registerDelay" class="def">registerDelay</a> :: <a href="data-int#t:Int" title="Data.Int">Int</a> -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> (<a href="ghc-conc#t:TVar" title="GHC.Conc">TVar</a> <a href="data-bool#t:Bool" title="Data.Bool">Bool</a>) <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-IO.html#registerDelay" class="link">Source</a> </p>
<p>Switch the value of returned <code><a href="ghc-conc#t:TVar" title="GHC.Conc">TVar</a></code> from initial value <code><a href="data-bool#v:False" title="Data.Bool">False</a></code> to <code><a href="data-bool#v:True" title="Data.Bool">True</a></code> after a given number of microseconds. The caveats associated with <code><a href="ghc-conc#v:threadDelay" title="GHC.Conc">threadDelay</a></code> also apply.</p>
<p class="src"><a id="v:threadWaitRead" class="def">threadWaitRead</a> :: <a href="system-posix-types#t:Fd" title="System.Posix.Types">Fd</a> -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> () <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-IO.html#threadWaitRead" class="link">Source</a> </p>
<p>Block the current thread until data is available to read on the given file descriptor (GHC only).</p>
<p>This will throw an <code><a href="prelude#v:IOError" title="Prelude">IOError</a></code> if the file descriptor was closed while this thread was blocked. To safely close a file descriptor that has been used with <code><a href="ghc-conc#v:threadWaitRead" title="GHC.Conc">threadWaitRead</a></code>, use <code><a href="ghc-conc#v:closeFdWith" title="GHC.Conc">closeFdWith</a></code>.</p>
<p class="src"><a id="v:threadWaitWrite" class="def">threadWaitWrite</a> :: <a href="system-posix-types#t:Fd" title="System.Posix.Types">Fd</a> -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> () <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-IO.html#threadWaitWrite" class="link">Source</a> </p>
<p>Block the current thread until data can be written to the given file descriptor (GHC only).</p>
<p>This will throw an <code><a href="prelude#v:IOError" title="Prelude">IOError</a></code> if the file descriptor was closed while this thread was blocked. To safely close a file descriptor that has been used with <code><a href="ghc-conc#v:threadWaitWrite" title="GHC.Conc">threadWaitWrite</a></code>, use <code><a href="ghc-conc#v:closeFdWith" title="GHC.Conc">closeFdWith</a></code>.</p>
<p class="src"><a id="v:threadWaitReadSTM" class="def">threadWaitReadSTM</a> :: <a href="system-posix-types#t:Fd" title="System.Posix.Types">Fd</a> -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> (<a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> (), <a href="system-io#t:IO" title="System.IO">IO</a> ()) <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-IO.html#threadWaitReadSTM" class="link">Source</a> </p>
<p>Returns an STM action that can be used to wait for data to read from a file descriptor. The second returned value is an IO action that can be used to deregister interest in the file descriptor.</p>
<p class="src"><a id="v:threadWaitWriteSTM" class="def">threadWaitWriteSTM</a> :: <a href="system-posix-types#t:Fd" title="System.Posix.Types">Fd</a> -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> (<a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> (), <a href="system-io#t:IO" title="System.IO">IO</a> ()) <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-IO.html#threadWaitWriteSTM" class="link">Source</a> </p>
<p>Returns an STM action that can be used to wait until data can be written to a file descriptor. The second returned value is an IO action that can be used to deregister interest in the file descriptor.</p>
<p class="src"><a id="v:closeFdWith" class="def">closeFdWith</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-IO.html#closeFdWith" class="link">Source</a> </p>
<div class="subs arguments">
<h4 class="caption">Arguments</h4>
<table>
<tr>
<td class="src">:: (<a href="system-posix-types#t:Fd" title="System.Posix.Types">Fd</a> -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> ())</td>
<td class="doc"><p>Low-level action that performs the real close.</p></td>
</tr>
<tr>
<td class="src">-&gt; <a href="system-posix-types#t:Fd" title="System.Posix.Types">Fd</a>
</td>
<td class="doc"><p>File descriptor to close.</p></td>
</tr>
<tr>
<td class="src">-&gt; <a href="system-io#t:IO" title="System.IO">IO</a> ()</td>
<td class="doc empty"> </td>
</tr>
</table>
</div>
<p>Close a file descriptor in a concurrency-safe way (GHC only). If you are using <code><a href="ghc-conc#v:threadWaitRead" title="GHC.Conc">threadWaitRead</a></code> or <code><a href="ghc-conc#v:threadWaitWrite" title="GHC.Conc">threadWaitWrite</a></code> to perform blocking I/O, you <em>must</em> use this function to close file descriptors, or blocked threads may not be woken.</p>
<p>Any threads that are blocked on the file descriptor via <code><a href="ghc-conc#v:threadWaitRead" title="GHC.Conc">threadWaitRead</a></code> or <code><a href="ghc-conc#v:threadWaitWrite" title="GHC.Conc">threadWaitWrite</a></code> will be unblocked by having IO exceptions thrown.</p>
<a href="#g:3" id="g:3"><h2>Allocation counter and limit</h2></a><p class="src"><a id="v:setAllocationCounter" class="def">setAllocationCounter</a> :: <a href="data-int#t:Int64" title="Data.Int">Int64</a> -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> () <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#setAllocationCounter" class="link">Source</a> </p>
<p>Every thread has an allocation counter that tracks how much memory has been allocated by the thread. The counter is initialized to zero, and <code><a href="ghc-conc#v:setAllocationCounter" title="GHC.Conc">setAllocationCounter</a></code> sets the current value. The allocation counter counts *down*, so in the absence of a call to <code><a href="ghc-conc#v:setAllocationCounter" title="GHC.Conc">setAllocationCounter</a></code> its value is the negation of the number of bytes of memory allocated by the thread.</p>
<p>There are two things that you can do with this counter:</p>
<ul>
<li>Use it as a simple profiling mechanism, with <code><a href="ghc-conc#v:getAllocationCounter" title="GHC.Conc">getAllocationCounter</a></code>.</li>
<li>Use it as a resource limit. See <code><a href="ghc-conc#v:enableAllocationLimit" title="GHC.Conc">enableAllocationLimit</a></code>.</li>
</ul>
<p>Allocation accounting is accurate only to about 4Kbytes.</p>
<p><span class="version">Since: base-4.8.0.0</span></p>
<p class="src"><a id="v:getAllocationCounter" class="def">getAllocationCounter</a> :: <a href="system-io#t:IO" title="System.IO">IO</a> <a href="data-int#t:Int64" title="Data.Int">Int64</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#getAllocationCounter" class="link">Source</a> </p>
<p>Return the current value of the allocation counter for the current thread.</p>
<p><span class="version">Since: base-4.8.0.0</span></p>
<p class="src"><a id="v:enableAllocationLimit" class="def">enableAllocationLimit</a> :: <a href="system-io#t:IO" title="System.IO">IO</a> () <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#enableAllocationLimit" class="link">Source</a> </p>
<p>Enables the allocation counter to be treated as a limit for the current thread. When the allocation limit is enabled, if the allocation counter counts down below zero, the thread will be sent the <code><a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/Control-Exception-Base.html#t:AllocationLimitExceeded" title="Control.Exception.Base">AllocationLimitExceeded</a></code> asynchronous exception. When this happens, the counter is reinitialised (by default to 100K, but tunable with the <code>+RTS -xq</code> option) so that it can handle the exception and perform any necessary clean up. If it exhausts this additional allowance, another <code><a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/Control-Exception-Base.html#t:AllocationLimitExceeded" title="Control.Exception.Base">AllocationLimitExceeded</a></code> exception is sent, and so forth. Like other asynchronous exceptions, the <code><a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/Control-Exception-Base.html#t:AllocationLimitExceeded" title="Control.Exception.Base">AllocationLimitExceeded</a></code> exception is deferred while the thread is inside <code><a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/Control-Exception-Base.html#v:mask" title="Control.Exception.Base">mask</a></code> or an exception handler in <code><a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/Control-Exception-Base.html#v:catch" title="Control.Exception.Base">catch</a></code>.</p>
<p>Note that memory allocation is unrelated to <em>live memory</em>, also known as <em>heap residency</em>. A thread can allocate a large amount of memory and retain anything between none and all of it. It is better to think of the allocation limit as a limit on <em>CPU time</em>, rather than a limit on memory.</p>
<p>Compared to using timeouts, allocation limits don't count time spent blocked or in foreign calls.</p>
<p><span class="version">Since: base-4.8.0.0</span></p>
<p class="src"><a id="v:disableAllocationLimit" class="def">disableAllocationLimit</a> :: <a href="system-io#t:IO" title="System.IO">IO</a> () <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#disableAllocationLimit" class="link">Source</a> </p>
<p>Disable allocation limit processing for the current thread.</p>
<p><span class="version">Since: base-4.8.0.0</span></p>
<a href="#g:4" id="g:4"><h2>TVars</h2></a><p class="src">newtype <a id="t:STM" class="def">STM</a> a <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#STM" class="link">Source</a> </p>
<p>A monad supporting atomic memory transactions.</p>
<div class="subs constructors">
<h4 class="caption">Constructors</h4>
<table><tr>
<td class="src">
<a id="v:STM" class="def">STM</a> (<a href="ghc-exts#t:State-35-" title="GHC.Exts">State#</a> <a href="control-monad-st-safe#t:RealWorld" title="Control.Monad.ST.Safe">RealWorld</a> -&gt; (# <a href="ghc-exts#t:State-35-" title="GHC.Exts">State#</a> <a href="control-monad-st-safe#t:RealWorld" title="Control.Monad.ST.Safe">RealWorld</a>, a #))</td>
<td class="doc empty"> </td>
</tr></table>
</div>
<div class="subs instances">
<h5 class="instances details-toggle-control details-toggle" data-details-id="i:STM">Instances</h5>
<details id="i:STM" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table>
<tr>
<td class="src clearfix">
 <a href="control-monad#t:Monad" title="Control.Monad">Monad</a> <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> </td>
<td class="doc"><p><span class="version">Since: base-4.3.0.0</span></p></td>
</tr>
<tr><td colspan="2"><details id="i:id:STM:Monad:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="ghc-conc-sync">GHC.Conc.Sync</a></p> <div class="subs methods">
<h4 class="caption">Methods</h4>
<p class="src"><a href="#v:-62--62--61-">(&gt;&gt;=)</a> :: <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> a -&gt; (a -&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> b) -&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> b <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Base.html#%3E%3E%3D" class="link">Source</a> </p>
<p class="src"><a href="#v:-62--62-">(&gt;&gt;)</a> :: <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> a -&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> b -&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> b <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Base.html#%3E%3E" class="link">Source</a> </p>
<p class="src"><a href="#v:return">return</a> :: a -&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> a <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Base.html#return" class="link">Source</a> </p>
</div></details></td></tr>
<tr>
<td class="src clearfix">
 <a href="data-functor#t:Functor" title="Data.Functor">Functor</a> <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> </td>
<td class="doc"><p><span class="version">Since: base-4.3.0.0</span></p></td>
</tr>
<tr><td colspan="2"><details id="i:id:STM:Functor:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="ghc-conc-sync">GHC.Conc.Sync</a></p> <div class="subs methods">
<h4 class="caption">Methods</h4>
<p class="src"><a href="#v:fmap">fmap</a> :: (a -&gt; b) -&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> a -&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> b <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Base.html#fmap" class="link">Source</a> </p>
<p class="src"><a href="#v:-60--36-">(&lt;$)</a> :: a -&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> b -&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> a <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Base.html#%3C%24" class="link">Source</a> </p>
</div></details></td></tr>
<tr>
<td class="src clearfix">
 <a href="control-applicative#t:Applicative" title="Control.Applicative">Applicative</a> <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> </td>
<td class="doc"><p><span class="version">Since: base-4.8.0.0</span></p></td>
</tr>
<tr><td colspan="2"><details id="i:id:STM:Applicative:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="ghc-conc-sync">GHC.Conc.Sync</a></p> <div class="subs methods">
<h4 class="caption">Methods</h4>
<p class="src"><a href="#v:pure">pure</a> :: a -&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> a <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Base.html#pure" class="link">Source</a> </p>
<p class="src"><a href="#v:-60--42--62-">(&lt;*&gt;)</a> :: <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> (a -&gt; b) -&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> a -&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> b <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Base.html#%3C%2A%3E" class="link">Source</a> </p>
<p class="src"><a href="#v:liftA2">liftA2</a> :: (a -&gt; b -&gt; c) -&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> a -&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> b -&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> c <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Base.html#liftA2" class="link">Source</a> </p>
<p class="src"><a href="#v:-42--62-">(*&gt;)</a> :: <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> a -&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> b -&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> b <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Base.html#%2A%3E" class="link">Source</a> </p>
<p class="src"><a href="#v:-60--42-">(&lt;*)</a> :: <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> a -&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> b -&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> a <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Base.html#%3C%2A" class="link">Source</a> </p>
</div></details></td></tr>
<tr>
<td class="src clearfix">
 <a href="control-monad#t:MonadPlus" title="Control.Monad">MonadPlus</a> <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> </td>
<td class="doc"><p><span class="version">Since: base-4.3.0.0</span></p></td>
</tr>
<tr><td colspan="2"><details id="i:id:STM:MonadPlus:4"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="ghc-conc-sync">GHC.Conc.Sync</a></p> <div class="subs methods">
<h4 class="caption">Methods</h4>
<p class="src"><a href="#v:mzero">mzero</a> :: <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> a <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Base.html#mzero" class="link">Source</a> </p>
<p class="src"><a href="#v:mplus">mplus</a> :: <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> a -&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> a -&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> a <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Base.html#mplus" class="link">Source</a> </p>
</div></details></td></tr>
<tr>
<td class="src clearfix">
 <a href="control-applicative#t:Alternative" title="Control.Applicative">Alternative</a> <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> </td>
<td class="doc"><p><span class="version">Since: base-4.8.0.0</span></p></td>
</tr>
<tr><td colspan="2"><details id="i:id:STM:Alternative:5"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="ghc-conc-sync">GHC.Conc.Sync</a></p> <div class="subs methods">
<h4 class="caption">Methods</h4>
<p class="src"><a href="#v:empty">empty</a> :: <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> a <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Base.html#empty" class="link">Source</a> </p>
<p class="src"><a href="#v:-60--124--62-">(&lt;|&gt;)</a> :: <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> a -&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> a -&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> a <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Base.html#%3C%7C%3E" class="link">Source</a> </p>
<p class="src"><a href="#v:some">some</a> :: <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> a -&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> [a] <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Base.html#some" class="link">Source</a> </p>
<p class="src"><a href="#v:many">many</a> :: <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> a -&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> [a] <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Base.html#many" class="link">Source</a> </p>
</div></details></td></tr>
</table></details>
</div>
<p class="src"><a id="v:atomically" class="def">atomically</a> :: <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> a -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> a <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#atomically" class="link">Source</a> </p>
<p>Perform a series of STM actions atomically.</p>
<p>Using <code><a href="ghc-conc#v:atomically" title="GHC.Conc">atomically</a></code> inside an <code><a href="system-io-unsafe#v:unsafePerformIO" title="System.IO.Unsafe">unsafePerformIO</a></code> or <code><a href="system-io-unsafe#v:unsafeInterleaveIO" title="System.IO.Unsafe">unsafeInterleaveIO</a></code> subverts some of guarantees that STM provides. It makes it possible to run a transaction inside of another transaction, depending on when the thunk is evaluated. If a nested transaction is attempted, an exception is thrown by the runtime. It is possible to safely use <code><a href="ghc-conc#v:atomically" title="GHC.Conc">atomically</a></code> inside <code><a href="system-io-unsafe#v:unsafePerformIO" title="System.IO.Unsafe">unsafePerformIO</a></code> or <code><a href="system-io-unsafe#v:unsafeInterleaveIO" title="System.IO.Unsafe">unsafeInterleaveIO</a></code>, but the typechecker does not rule out programs that may attempt nested transactions, meaning that the programmer must take special care to prevent these.</p>
<p>However, there are functions for creating transactional variables that can always be safely called in <code><a href="system-io-unsafe#v:unsafePerformIO" title="System.IO.Unsafe">unsafePerformIO</a></code>. See: <code><a href="ghc-conc#v:newTVarIO" title="GHC.Conc">newTVarIO</a></code>, <code><a href="control-concurrent-stm-tchan#v:newTChanIO" title="Control.Concurrent.STM.TChan">newTChanIO</a></code>, <code><a href="control-concurrent-stm-tchan#v:newBroadcastTChanIO" title="Control.Concurrent.STM.TChan">newBroadcastTChanIO</a></code>, <code><a href="control-concurrent-stm-tqueue#v:newTQueueIO" title="Control.Concurrent.STM.TQueue">newTQueueIO</a></code>, <code><a href="control-concurrent-stm-tbqueue#v:newTBQueueIO" title="Control.Concurrent.STM.TBQueue">newTBQueueIO</a></code>, and <code><a href="control-concurrent-stm-tmvar#v:newTMVarIO" title="Control.Concurrent.STM.TMVar">newTMVarIO</a></code>.</p>
<p>Using <code><a href="system-io-unsafe#v:unsafePerformIO" title="System.IO.Unsafe">unsafePerformIO</a></code> inside of <code><a href="ghc-conc#v:atomically" title="GHC.Conc">atomically</a></code> is also dangerous but for different reasons. See <code><a href="ghc-conc#v:unsafeIOToSTM" title="GHC.Conc">unsafeIOToSTM</a></code> for more on this.</p>
<p class="src"><a id="v:retry" class="def">retry</a> :: <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> a <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#retry" class="link">Source</a> </p>
<p>Retry execution of the current memory transaction because it has seen values in <code><a href="ghc-conc#t:TVar" title="GHC.Conc">TVar</a></code>s which mean that it should not continue (e.g. the <code><a href="ghc-conc#t:TVar" title="GHC.Conc">TVar</a></code>s represent a shared buffer that is now empty). The implementation may block the thread until one of the <code><a href="ghc-conc#t:TVar" title="GHC.Conc">TVar</a></code>s that it has read from has been updated. (GHC only)</p>
<p class="src"><a id="v:orElse" class="def">orElse</a> :: <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> a -&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> a -&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> a <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#orElse" class="link">Source</a> </p>
<p>Compose two alternative STM actions (GHC only).</p>
<p>If the first action completes without retrying then it forms the result of the <code><a href="ghc-conc#v:orElse" title="GHC.Conc">orElse</a></code>. Otherwise, if the first action retries, then the second action is tried in its place. If both actions retry then the <code><a href="ghc-conc#v:orElse" title="GHC.Conc">orElse</a></code> as a whole retries.</p>
<p class="src"><a id="v:throwSTM" class="def">throwSTM</a> :: <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/Control-Exception-Base.html#t:Exception" title="Control.Exception.Base">Exception</a> e =&gt; e -&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> a <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#throwSTM" class="link">Source</a> </p>
<p>A variant of <code><a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/Control-Exception-Base.html#v:throw" title="Control.Exception.Base">throw</a></code> that can only be used within the <code><a href="ghc-conc#t:STM" title="GHC.Conc">STM</a></code> monad.</p>
<p>Throwing an exception in <code>STM</code> aborts the transaction and propagates the exception. If the exception is caught via <code><a href="ghc-conc#v:catchSTM" title="GHC.Conc">catchSTM</a></code>, only the changes enclosed by the catch are rolled back; changes made outside of <code><a href="ghc-conc#v:catchSTM" title="GHC.Conc">catchSTM</a></code> persist.</p>
<p>If the exception is not caught inside of the <code><a href="ghc-conc#t:STM" title="GHC.Conc">STM</a></code>, it is re-thrown by <code><a href="ghc-conc#v:atomically" title="GHC.Conc">atomically</a></code>, and the entire <code><a href="ghc-conc#t:STM" title="GHC.Conc">STM</a></code> is rolled back.</p>
<p>Although <code><a href="ghc-conc#v:throwSTM" title="GHC.Conc">throwSTM</a></code> has a type that is an instance of the type of <code><a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/Control-Exception-Base.html#v:throw" title="Control.Exception.Base">throw</a></code>, the two functions are subtly different:</p>
<pre>throw e    `seq` x  ===&gt; throw e
throwSTM e `seq` x  ===&gt; x</pre>
<p>The first example will cause the exception <code>e</code> to be raised, whereas the second one won't. In fact, <code><a href="ghc-conc#v:throwSTM" title="GHC.Conc">throwSTM</a></code> will only cause an exception to be raised when it is used within the <code><a href="ghc-conc#t:STM" title="GHC.Conc">STM</a></code> monad. The <code><a href="ghc-conc#v:throwSTM" title="GHC.Conc">throwSTM</a></code> variant should be used in preference to <code><a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/Control-Exception-Base.html#v:throw" title="Control.Exception.Base">throw</a></code> to raise an exception within the <code><a href="ghc-conc#t:STM" title="GHC.Conc">STM</a></code> monad because it guarantees ordering with respect to other <code><a href="ghc-conc#t:STM" title="GHC.Conc">STM</a></code> operations, whereas <code><a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/Control-Exception-Base.html#v:throw" title="Control.Exception.Base">throw</a></code> does not.</p>
<p class="src"><a id="v:catchSTM" class="def">catchSTM</a> :: <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/Control-Exception-Base.html#t:Exception" title="Control.Exception.Base">Exception</a> e =&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> a -&gt; (e -&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> a) -&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> a <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#catchSTM" class="link">Source</a> </p>
<p>Exception handling within STM actions.</p>
<p><code><a href="ghc-conc#v:catchSTM" title="GHC.Conc">catchSTM</a> m f</code> catches any exception thrown by <code>m</code> using <code><a href="ghc-conc#v:throwSTM" title="GHC.Conc">throwSTM</a></code>, using the function <code>f</code> to handle the exception. If an exception is thrown, any changes made by <code>m</code> are rolled back, but changes prior to <code>m</code> persist.</p>
<p class="src">data <a id="t:TVar" class="def">TVar</a> a <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#TVar" class="link">Source</a> </p>
<p>Shared memory locations that support atomic memory transactions.</p>
<div class="subs constructors">
<h4 class="caption">Constructors</h4>
<table><tr>
<td class="src">
<a id="v:TVar" class="def">TVar</a> (<a href="ghc-exts#t:TVar-35-" title="GHC.Exts">TVar#</a> <a href="control-monad-st-safe#t:RealWorld" title="Control.Monad.ST.Safe">RealWorld</a> a)</td>
<td class="doc empty"> </td>
</tr></table>
</div>
<div class="subs instances">
<h5 class="instances details-toggle-control details-toggle" data-details-id="i:TVar">Instances</h5>
<details id="i:TVar" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table>
<tr>
<td class="src clearfix">
 <a href="data-eq#t:Eq" title="Data.Eq">Eq</a> (<a href="ghc-conc#t:TVar" title="GHC.Conc">TVar</a> a) </td>
<td class="doc"><p><span class="version">Since: base-4.8.0.0</span></p></td>
</tr>
<tr><td colspan="2"><details id="i:id:TVar:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="ghc-conc-sync">GHC.Conc.Sync</a></p> <div class="subs methods">
<h4 class="caption">Methods</h4>
<p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="ghc-conc#t:TVar" title="GHC.Conc">TVar</a> a -&gt; <a href="ghc-conc#t:TVar" title="GHC.Conc">TVar</a> a -&gt; <a href="data-bool#t:Bool" title="Data.Bool">Bool</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/ghc-prim-0.5.3/src/GHC-Classes.html#%3D%3D" class="link">Source</a> </p>
<p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="ghc-conc#t:TVar" title="GHC.Conc">TVar</a> a -&gt; <a href="ghc-conc#t:TVar" title="GHC.Conc">TVar</a> a -&gt; <a href="data-bool#t:Bool" title="Data.Bool">Bool</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/ghc-prim-0.5.3/src/GHC-Classes.html#%2F%3D" class="link">Source</a> </p>
</div></details></td></tr>
</table></details>
</div>
<p class="src"><a id="v:newTVar" class="def">newTVar</a> :: a -&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> (<a href="ghc-conc#t:TVar" title="GHC.Conc">TVar</a> a) <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#newTVar" class="link">Source</a> </p>
<p>Create a new <code><a href="ghc-conc#t:TVar" title="GHC.Conc">TVar</a></code> holding a value supplied</p>
<p class="src"><a id="v:newTVarIO" class="def">newTVarIO</a> :: a -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> (<a href="ghc-conc#t:TVar" title="GHC.Conc">TVar</a> a) <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#newTVarIO" class="link">Source</a> </p>
<p><code>IO</code> version of <code><a href="ghc-conc#v:newTVar" title="GHC.Conc">newTVar</a></code>. This is useful for creating top-level <code><a href="ghc-conc#t:TVar" title="GHC.Conc">TVar</a></code>s using <code><a href="system-io-unsafe#v:unsafePerformIO" title="System.IO.Unsafe">unsafePerformIO</a></code>, because using <code><a href="ghc-conc#v:atomically" title="GHC.Conc">atomically</a></code> inside <code><a href="system-io-unsafe#v:unsafePerformIO" title="System.IO.Unsafe">unsafePerformIO</a></code> isn't possible.</p>
<p class="src"><a id="v:readTVar" class="def">readTVar</a> :: <a href="ghc-conc#t:TVar" title="GHC.Conc">TVar</a> a -&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> a <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#readTVar" class="link">Source</a> </p>
<p>Return the current value stored in a <code><a href="ghc-conc#t:TVar" title="GHC.Conc">TVar</a></code>.</p>
<p class="src"><a id="v:readTVarIO" class="def">readTVarIO</a> :: <a href="ghc-conc#t:TVar" title="GHC.Conc">TVar</a> a -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> a <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#readTVarIO" class="link">Source</a> </p>
<p>Return the current value stored in a <code><a href="ghc-conc#t:TVar" title="GHC.Conc">TVar</a></code>. This is equivalent to</p>
<pre> readTVarIO = atomically . readTVar</pre>
<p>but works much faster, because it doesn't perform a complete transaction, it just reads the current value of the <code><a href="ghc-conc#t:TVar" title="GHC.Conc">TVar</a></code>.</p>
<p class="src"><a id="v:writeTVar" class="def">writeTVar</a> :: <a href="ghc-conc#t:TVar" title="GHC.Conc">TVar</a> a -&gt; a -&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> () <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#writeTVar" class="link">Source</a> </p>
<p>Write the supplied value into a <code><a href="ghc-conc#t:TVar" title="GHC.Conc">TVar</a></code>.</p>
<p class="src"><a id="v:unsafeIOToSTM" class="def">unsafeIOToSTM</a> :: <a href="system-io#t:IO" title="System.IO">IO</a> a -&gt; <a href="ghc-conc#t:STM" title="GHC.Conc">STM</a> a <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#unsafeIOToSTM" class="link">Source</a> </p>
<p>Unsafely performs IO in the STM monad. Beware: this is a highly dangerous thing to do.</p>
<ul>
<li>The STM implementation will often run transactions multiple times, so you need to be prepared for this if your IO has any side effects.</li>
<li>The STM implementation will abort transactions that are known to be invalid and need to be restarted. This may happen in the middle of <code><a href="ghc-conc#v:unsafeIOToSTM" title="GHC.Conc">unsafeIOToSTM</a></code>, so make sure you don't acquire any resources that need releasing (exception handlers are ignored when aborting the transaction). That includes doing any IO using Handles, for example. Getting this wrong will probably lead to random deadlocks.</li>
<li>The transaction may have seen an inconsistent view of memory when the IO runs. Invariants that you expect to be true throughout your program may not be true inside a transaction, due to the way transactions are implemented. Normally this wouldn't be visible to the programmer, but using <code><a href="ghc-conc#v:unsafeIOToSTM" title="GHC.Conc">unsafeIOToSTM</a></code> can expose it.</li>
</ul>
<a href="#g:5" id="g:5"><h2>Miscellaneous</h2></a><p class="src"><a id="v:withMVar" class="def">withMVar</a> :: <a href="control-concurrent-mvar#t:MVar" title="Control.Concurrent.MVar">MVar</a> a -&gt; (a -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> b) -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> b <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#withMVar" class="link">Source</a> </p>
<p>Provide an <code><a href="system-io#t:IO" title="System.IO">IO</a></code> action with the current value of an <code><a href="control-concurrent-mvar#t:MVar" title="Control.Concurrent.MVar">MVar</a></code>. The <code><a href="control-concurrent-mvar#t:MVar" title="Control.Concurrent.MVar">MVar</a></code> will be empty for the duration that the action is running.</p>
<p class="src">type <a id="t:Signal" class="def">Signal</a> = <a href="foreign-c-types#t:CInt" title="Foreign.C.Types">CInt</a> <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Signal.html#Signal" class="link">Source</a> </p>
<p class="src">type <a id="t:HandlerFun" class="def">HandlerFun</a> = <a href="foreign-foreignptr-safe#t:ForeignPtr" title="Foreign.ForeignPtr.Safe">ForeignPtr</a> <a href="data-word#t:Word8" title="Data.Word">Word8</a> -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> () <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Signal.html#HandlerFun" class="link">Source</a> </p>
<p class="src"><a id="v:setHandler" class="def">setHandler</a> :: <a href="ghc-conc#t:Signal" title="GHC.Conc">Signal</a> -&gt; <a href="data-maybe#t:Maybe" title="Data.Maybe">Maybe</a> (<a href="ghc-conc#t:HandlerFun" title="GHC.Conc">HandlerFun</a>, <a href="data-dynamic#t:Dynamic" title="Data.Dynamic">Dynamic</a>) -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> (<a href="data-maybe#t:Maybe" title="Data.Maybe">Maybe</a> (<a href="ghc-conc#t:HandlerFun" title="GHC.Conc">HandlerFun</a>, <a href="data-dynamic#t:Dynamic" title="Data.Dynamic">Dynamic</a>)) <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Signal.html#setHandler" class="link">Source</a> </p>
<p class="src"><a id="v:runHandlers" class="def">runHandlers</a> :: <a href="foreign-foreignptr-safe#t:ForeignPtr" title="Foreign.ForeignPtr.Safe">ForeignPtr</a> <a href="data-word#t:Word8" title="Data.Word">Word8</a> -&gt; <a href="ghc-conc#t:Signal" title="GHC.Conc">Signal</a> -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> () <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Signal.html#runHandlers" class="link">Source</a> </p>
<p class="src"><a id="v:ensureIOManagerIsRunning" class="def">ensureIOManagerIsRunning</a> :: <a href="system-io#t:IO" title="System.IO">IO</a> () <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-IO.html#ensureIOManagerIsRunning" class="link">Source</a> </p>
<p class="src"><a id="v:ioManagerCapabilitiesChanged" class="def">ioManagerCapabilitiesChanged</a> :: <a href="system-io#t:IO" title="System.IO">IO</a> () <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-IO.html#ioManagerCapabilitiesChanged" class="link">Source</a> </p>
<p class="src"><a id="v:setUncaughtExceptionHandler" class="def">setUncaughtExceptionHandler</a> :: (<a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/Control-Exception-Base.html#t:SomeException" title="Control.Exception.Base">SomeException</a> -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> ()) -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> () <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#setUncaughtExceptionHandler" class="link">Source</a> </p>
<p class="src"><a id="v:getUncaughtExceptionHandler" class="def">getUncaughtExceptionHandler</a> :: <a href="system-io#t:IO" title="System.IO">IO</a> (<a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/Control-Exception-Base.html#t:SomeException" title="Control.Exception.Base">SomeException</a> -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> ()) <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#getUncaughtExceptionHandler" class="link">Source</a> </p>
<p class="src"><a id="v:reportError" class="def">reportError</a> :: <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/Control-Exception-Base.html#t:SomeException" title="Control.Exception.Base">SomeException</a> -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> () <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#reportError" class="link">Source</a> </p>
<p class="src"><a id="v:reportStackOverflow" class="def">reportStackOverflow</a> :: <a href="system-io#t:IO" title="System.IO">IO</a> () <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#reportStackOverflow" class="link">Source</a> </p>
<p class="src"><a id="v:reportHeapOverflow" class="def">reportHeapOverflow</a> :: <a href="system-io#t:IO" title="System.IO">IO</a> () <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/src/GHC-Conc-Sync.html#reportHeapOverflow" class="link">Source</a> </p>
</div>
<div class="_attribution">
  <p class="_attribution-p">
     The University of Glasgow and others<br>Licensed under a BSD-style license (see top of the page).<br>
    <a href="https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/GHC-Conc.html" class="_attribution-link">https://downloads.haskell.org/~ghc/8.8.3/docs/html/libraries/base-4.13.0.0/GHC-Conc.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
