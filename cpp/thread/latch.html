
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Std&#58;&#58;latch - C++ - W3cubDocs</title>
  
  <meta name="description" content="The latch class is a downward counter of type std&#58;&#58;ptrdiff_t which can be used to synchronize threads. The value of the counter is &hellip;">
  <meta name="keywords" content="std, latch, c++, cpp">
  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/cpp/thread/latch.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-9c7b0d969c0ce639a6c01c2badcdd81667c7c66206aa3d0fccc5cb0585fb1b912dab72ea882101d18010680927514b4b77b107282db8f756fbf63301fe9c88b0.css">
  <script type="text/javascript" src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js"></script>
  <script src="/json/cpp.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/cpp/" class="_nav-link" title="" style="margin-left:0;">C++</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _cppref">
				
				
<h1 id="firstHeading" class="firstHeading">std::latch</h1>            <table class="t-dcl-begin"> <tr class="t-dsc-header"> <th> Defined in header <code><a href="../header/latch" title="cpp/header/latch">&lt;latch&gt;</a></code> </th> <th> </th> <th> </th> </tr> <tr class="t-dcl t-since-cxx20"> <td> <pre data-language="cpp">class latch;</pre>
</td> <td class="t-dcl-nopad"> </td> <td> <span class="t-mark-rev t-since-cxx20">(since C++20)</span> </td> </tr>  </table> <p>The <code>latch</code> class is a downward counter of type <code><a href="../types/ptrdiff_t" title="cpp/types/ptrdiff t">std::ptrdiff_t</a></code> which can be used to synchronize threads. The value of the counter is initialized on creation. Threads may block on the latch until the counter is decremented to zero. There is no possibility to increase or reset the counter, which makes the latch a single-use barrier.</p>
<p>Concurrent invocations of the member functions of <code>std::latch</code>, except for the destructor, do not introduce data races.</p>
<p>Unlike <code><a href="barrier" title="cpp/thread/barrier">std::barrier</a></code>, <code>std::latch</code> can be decremented by a participating thread more than once.</p>
<h3 id="Member_functions"> Member functions</h3> <table class="t-dsc-begin"> <tr class="t-dsc"> <td> <div><a href="latch/latch" title="cpp/thread/latch/latch"> <span class="t-lines"><span>(constructor)</span></span></a></div> </td> <td> constructs a <code>latch</code> <br> <span class="t-mark">(public member function)</span>  </td>
</tr> <tr class="t-dsc"> <td> <div><a href="latch/~latch" title="cpp/thread/latch/~latch"> <span class="t-lines"><span>(destructor)</span></span></a></div> </td> <td> destroys the <code>latch</code> <br> <span class="t-mark">(public member function)</span>  </td>
</tr> <tr class="t-dsc"> <td> <div><span class="t-lines"><span>operator=</span></span></div>
<div><span class="t-lines"><span><span class="t-cmark">[deleted]</span></span></span></div> </td> <td> <code>latch</code> is not assignable <br> <span class="t-mark">(public member function)</span> </td>
</tr> <tr class="t-dsc"> <td> <div><a href="latch/count_down" title="cpp/thread/latch/count down"> <span class="t-lines"><span>count_down</span></span></a></div> </td> <td> decrements the counter in a non-blocking manner <br> <span class="t-mark">(public member function)</span>  </td>
</tr> <tr class="t-dsc"> <td> <div><a href="latch/try_wait" title="cpp/thread/latch/try wait"> <span class="t-lines"><span>try_wait</span></span></a></div> </td> <td> tests if the internal counter equals zero <br> <span class="t-mark">(public member function)</span>  </td>
</tr> <tr class="t-dsc"> <td> <div><a href="latch/wait" title="cpp/thread/latch/wait"> <span class="t-lines"><span>wait</span></span></a></div> </td> <td> blocks until the counter reaches zero <br> <span class="t-mark">(public member function)</span>  </td>
</tr> <tr class="t-dsc"> <td> <div><a href="latch/arrive_and_wait" title="cpp/thread/latch/arrive and wait"> <span class="t-lines"><span>arrive_and_wait</span></span></a></div> </td> <td> decrements the counter and blocks until it reaches zero <br> <span class="t-mark">(public member function)</span>  </td>
</tr> <tr> <td colspan="2"> <h5 id="Constants">  Constants </h5> </td>
</tr> <tr class="t-dsc"> <td> <div><a href="latch/max" title="cpp/thread/latch/max"> <span class="t-lines"><span>max</span></span></a></div>
<div><span class="t-lines"><span><span class="t-cmark">[static]</span></span></span></div> </td> <td> the maximum value of counter supported by the implementation <br> <span class="t-mark">(public static member function)</span>  </td>
</tr> </table> <h3 id="Notes"> Notes</h3> <table class="wikitable ftm-begin"> <tr> <th>
<a href="../utility/feature_test" title="cpp/utility/feature test">Feature-test</a> macro </th>
</tr> <tr> <td>
<a href="../feature_test#Library_features" title="cpp/feature test"><code>__cpp_lib_latch</code></a> </td>
</tr>
</table> <h3 id="Example"> Example</h3> <div class="t-example"> <div class="cpp source-cpp"><pre data-language="cpp">#include &lt;functional&gt;
#include &lt;iostream&gt;
#include &lt;latch&gt;
#include &lt;string&gt;
#include &lt;thread&gt;
 
int main() {
  struct job {
    const std::string name;
    std::string product{"not worked"};
    std::thread action{};
  } jobs[] = {{"annika"}, {"buru"}, {"chuck"}};
 
  std::latch work_done{std::size(jobs)};
  std::latch start_clean_up{1};
 
  auto work = [&amp;](job&amp; my_job) {
    my_job.product = my_job.name + " worked";
    work_done.count_down();
    start_clean_up.wait();
    my_job.product = my_job.name + " cleaned";
  };
 
  std::cout &lt;&lt; "Work starting... ";
  for (auto&amp; job : jobs) {
    job.action = std::thread{work, std::ref(job)};
  }
  work_done.wait();
  std::cout &lt;&lt; "done:\n";
  for (auto const&amp; job : jobs) {
    std::cout &lt;&lt; "  " &lt;&lt; job.product &lt;&lt; '\n';
  }
 
  std::cout &lt;&lt; "Workers cleaning up... ";
  start_clean_up.count_down();
  for (auto&amp; job : jobs) {
    job.action.join();
  }
  std::cout &lt;&lt; "done:\n";
  for (auto const&amp; job : jobs) {
    std::cout &lt;&lt; "  " &lt;&lt; job.product &lt;&lt; '\n';
  }
}</pre></div> <p>Output:</p>
<div class="text source-text"><pre data-language="c">Work starting... done:
  annika worked
  buru worked
  chuck worked
Workers cleaning up... done:
  annika cleaned
  buru cleaned
  chuck cleaned</pre></div> </div> <h3 id="See_also"> See also</h3> <table class="t-dsc-begin"> <tr class="t-dsc"> <td> <div><a href="barrier" title="cpp/thread/barrier"> <span class="t-lines"><span>barrier</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx20">(C++20)</span></span></span></div> </td> <td> reusable thread barrier <br> <span class="t-mark">(class template)</span>  </td>
</tr> </table>           <div class="_attribution">
  <p class="_attribution-p">
    Â© cppreference.com<br>Licensed under the Creative Commons Attribution-ShareAlike Unported License v3.0.<br>
    <a href="https://en.cppreference.com/w/cpp/thread/latch" class="_attribution-link">https://en.cppreference.com/w/cpp/thread/latch</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
