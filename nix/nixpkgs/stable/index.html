
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Nixpkgs Stable - Nix - W3cubDocs</title>
  
  <meta name="description" content=" Located at lib&#47;asserts.nix&#58;19 in &#60;nixpkgs&#62;. ">
  <meta name="keywords" content="nixpkgs, stable, nix">
  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/nix/nixpkgs/stable/">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-f16eecbe420d8b2925d31ffbb21d05646497ecbd9515f08ffe69e9bba7332f5657accc7003c7f6c72cb4a132171acf171b359ae3bae4ae5660ddfb1718f88c67.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/nix.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/nix/" class="_nav-link" title="" style="margin-left:0;">Nix</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _simple">
				
				
<section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-asserts-assertMsg"><code class="function">lib.asserts.assertMsg</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">assertMsg :: Bool -&gt; String -&gt; Bool</code> </h5></div>
</div></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/asserts.nix#L19" target="_top" shape="rect">lib/asserts.nix:19</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p>
<p> Print a trace message if <code class="literal">pred</code> is false. </p>
<p> Intended to be used to augment asserts with helpful error messages. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">pred</code> </span></dt>
<dd><p> Condition under which the <code class="varname">msg</code> should <span class="emphasis"><em>not</em></span> be printed. </p></dd>
<dt><span class="term"> <code class="varname">msg</code> </span></dt>
<dd><p> Message to print. </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  Printing when the predicate is false</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
assert lib.asserts.assertMsg ("foo" == "bar") "foo is not bar, silly"
stderr&gt; trace: foo is not bar, silly
stderr&gt; assert failed
</pre></div>
</div>
<br class="example-break" clear="none"></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-asserts-assertOneOf"><code class="function">lib.asserts.assertOneOf</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">assertOneOf :: String -&gt; String -&gt;
      StringList -&gt; Bool</code> </h5></div>
</div></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/asserts.nix#L36" target="_top" shape="rect">lib/asserts.nix:36</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p>
<p> Specialized <code class="function">asserts.assertMsg</code> for checking if <code class="varname">val</code> is one of the elements of <code class="varname">xs</code>. Useful for checking enums. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">name</code> </span></dt>
<dd><p> The name of the variable the user entered <code class="varname">val</code> into, for inclusion in the error message. </p></dd>
<dt><span class="term"> <code class="varname">val</code> </span></dt>
<dd><p> The value of what the user provided, to be compared against the values in <code class="varname">xs</code>. </p></dd>
<dt><span class="term"> <code class="varname">xs</code> </span></dt>
<dd><p> The list of valid values. </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  Ensuring a user provided a possible value</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
let sslLibrary = "bearssl";
in lib.asserts.assertOneOf "sslLibrary" sslLibrary [ "openssl" "libressl" ];
=&gt; false
stderr&gt; trace: sslLibrary must be one of "openssl", "libressl", but is: "bearssl"
        </pre></div>
</div>
<br class="example-break" clear="none"></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-attrset-attrByPath"><code class="function">lib.attrset.attrByPath</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">attrByPath :: [String] -&gt; Any -&gt; AttrSet -&gt; Any</code> </h5></div>
</div></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/attrsets.nix#L24" target="_top" shape="rect">lib/attrsets.nix:24</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p>
<p> Return an attribute from within nested attribute sets. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">attrPath</code> </span></dt>
<dd><p> A list of strings representing the path through the nested attribute set <code class="varname">set</code>. </p></dd>
<dt><span class="term"> <code class="varname">default</code> </span></dt>
<dd><p> Default value if <code class="varname">attrPath</code> does not resolve to an existing value. </p></dd>
<dt><span class="term"> <code class="varname">set</code> </span></dt>
<dd><p> The nested attributeset to select values from. </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  Extracting a value from a nested attribute set</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
let set = { a = { b = 3; }; };
in lib.attrsets.attrByPath [ "a" "b" ] 0 set
=&gt; 3
</pre></div>
</div>
<br class="example-break" clear="none"><div class="example">
<p class="title"><strong>Example:  No value at the path, instead using the default</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
lib.attrsets.attrByPath [ "a" "b" ] 0 {}
=&gt; 0
</pre></div>
</div>
<br class="example-break" clear="none"></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-attrsets-hasAttrByPath"><code class="function">lib.attrsets.hasAttrByPath</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">hasAttrByPath :: [String] -&gt; AttrSet -&gt; Bool</code> </h5></div>
</div></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/attrsets.nix#L42" target="_top" shape="rect">lib/attrsets.nix:42</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p>
<p> Determine if an attribute exists within a nested attribute set. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">attrPath</code> </span></dt>
<dd><p> A list of strings representing the path through the nested attribute set <code class="varname">set</code>. </p></dd>
<dt><span class="term"> <code class="varname">set</code> </span></dt>
<dd><p> The nested attributeset to check. </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  A nested value does exist inside a set</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
lib.attrsets.hasAttrByPath
  [ "a" "b" "c" "d" ]
  { a = { b = { c = { d = 123; }; }; }; }
=&gt; true
</pre></div>
</div>
<br class="example-break" clear="none"></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-attrsets-setAttrByPath"><code class="function">lib.attrsets.setAttrByPath</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">setAttrByPath :: [String] -&gt; Any -&gt; AttrSet</code> </h5></div>
</div></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/attrsets.nix#L57" target="_top" shape="rect">lib/attrsets.nix:57</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p>
<p> Create a new attribute set with <code class="varname">value</code> set at the nested attribute location specified in <code class="varname">attrPath</code>. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">attrPath</code> </span></dt>
<dd><p> A list of strings representing the path through the nested attribute set. </p></dd>
<dt><span class="term"> <code class="varname">value</code> </span></dt>
<dd><p> The value to set at the location described by <code class="varname">attrPath</code>. </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  Creating a new nested attribute set</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
lib.attrsets.setAttrByPath [ "a" "b" ] 3
=&gt; { a = { b = 3; }; }
</pre></div>
</div>
<br class="example-break" clear="none"></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-attrsets-getAttrFromPath"><code class="function">lib.attrsets.getAttrFromPath</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">getAttrFromPath :: [String] -&gt; AttrSet -&gt; Value</code> </h5></div>
</div></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/attrsets.nix#L76" target="_top" shape="rect">lib/attrsets.nix:76</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p>
<p> Like <a class="xref" href="#function-library-lib.attrsets.attrByPath" title="5.1.2.1. lib.attrset.attrByPath" shape="rect">Section 5.1.2.1, “<code class="function">lib.attrset.attrByPath</code>”</a> except without a default, and it will throw if the value doesn't exist. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">attrPath</code> </span></dt>
<dd><p> A list of strings representing the path through the nested attribute set <code class="varname">set</code>. </p></dd>
<dt><span class="term"> <code class="varname">set</code> </span></dt>
<dd><p> The nested attribute set to find the value in. </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  Succesfully getting a value from an attribute set</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
lib.attrsets.getAttrFromPath [ "a" "b" ] { a = { b = 3; }; }
=&gt; 3
</pre></div>
</div>
<br class="example-break" clear="none"><div class="example">
<p class="title"><strong>Example:  Throwing after failing to get a value from an attribute set</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
lib.attrsets.getAttrFromPath [ "x" "y" ] { }
=&gt; error: cannot find attribute `x.y'
</pre></div>
</div>
<br class="example-break" clear="none"></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-attrsets-attrVals"><code class="function">lib.attrsets.attrVals</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">attrVals :: [String] -&gt; AttrSet -&gt; [Any]</code> </h5></div>
</div></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/attrsets.nix#L184" target="_top" shape="rect">lib/attrsets.nix:184</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p>
<p> Return the specified attributes from a set. All values must exist. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">nameList</code> </span></dt>
<dd><p> The list of attributes to fetch from <code class="varname">set</code>. Each attribute name must exist on the attrbitue set. </p></dd>
<dt><span class="term"> <code class="varname">set</code> </span></dt>
<dd><p> The set to get attribute values from. </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  Getting several values from an attribute set</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
lib.attrsets.attrVals [ "a" "b" "c" ] { a = 1; b = 2; c = 3; }
=&gt; [ 1 2 3 ]
</pre></div>
</div>
<br class="example-break" clear="none"><div class="example">
<p class="title"><strong>Example:  Getting missing values from an attribute set</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
lib.attrsets.attrVals [ "d" ] { }
error: attribute 'd' missing
</pre></div>
</div>
<br class="example-break" clear="none"></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-attrsets-attrValues"><code class="function">lib.attrsets.attrValues</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">attrValues :: AttrSet -&gt; [Any]</code> </h5></div>
</div></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/attrsets.nix#L194" target="_top" shape="rect">lib/attrsets.nix:194</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p>
<p> Get all the attribute values from an attribute set. </p>
<p> Provides a backwards-compatible interface of <code class="function">builtins.attrValues</code> for Nix version older than 1.8. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">attrs</code> </span></dt>
<dd><p> The attribute set. </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  </strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
lib.attrsets.attrValues { a = 1; b = 2; c = 3; }
=&gt; [ 1 2 3 ]
</pre></div>
</div>
<br class="example-break" clear="none"></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-attrsets-catAttrs"><code class="function">lib.attrsets.catAttrs</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">catAttrs :: String -&gt; [AttrSet] -&gt; [Any]</code> </h5></div>
</div></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/attrsets.nix#L213" target="_top" shape="rect">lib/attrsets.nix:213</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p>
<p> Collect each attribute named `attr' from the list of attribute sets, <code class="varname">sets</code>. Sets that don't contain the named attribute are ignored. </p>
<p> Provides a backwards-compatible interface of <code class="function">builtins.catAttrs</code> for Nix version older than 1.9. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">attr</code> </span></dt>
<dd><p> Attribute name to select from each attribute set in <code class="varname">sets</code>. </p></dd>
<dt><span class="term"> <code class="varname">sets</code> </span></dt>
<dd><p> The list of attribute sets to select <code class="varname">attr</code> from. </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  Collect an attribute from a list of attribute sets.</strong></p>
<div class="example-contents">
<p> Attribute sets which don't have the attribute are ignored. </p>
<pre class="programlisting" xml:space="preserve" data-language="nix">
catAttrs "a" [{a = 1;} {b = 0;} {a = 2;}]
=&gt; [ 1 2 ]
      </pre>
</div>
</div>
<br class="example-break" clear="none"></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-attrsets-filterAttrs"><code class="function">lib.attrsets.filterAttrs</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">filterAttrs :: (String -&gt; Any -&gt; Bool) -&gt; AttrSet -&gt; AttrSet</code> </h5></div>
</div></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/attrsets.nix#L224" target="_top" shape="rect">lib/attrsets.nix:224</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p>
<p> Filter an attribute set by removing all attributes for which the given predicate return false. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">pred</code> </span></dt>
<dd>
<p> <code class="literal">String -&gt; Any -&gt; Bool</code> </p>
<p> Predicate which returns true to include an attribute, or returns false to exclude it. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">name</code> </span></dt>
<dd><p> The attribute's name </p></dd>
<dt><span class="term"> <code class="varname">value</code> </span></dt>
<dd><p> The attribute's value </p></dd>
</dl></div>
<p> Returns <code class="literal">true</code> to include the attribute, <code class="literal">false</code> to exclude the attribute. </p>
</dd>
<dt><span class="term"> <code class="varname">set</code> </span></dt>
<dd><p> The attribute set to filter </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  Filtering an attributeset</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
filterAttrs (n: v: n == "foo") { foo = 1; bar = 2; }
=&gt; { foo = 1; }
</pre></div>
</div>
<br class="example-break" clear="none"></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-attrsets-filterAttrsRecursive"><code class="function">lib.attrsets.filterAttrsRecursive</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">filterAttrsRecursive :: (String -&gt; Any -&gt; Bool) -&gt; AttrSet -&gt; AttrSet</code> </h5></div>
</div></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/attrsets.nix#L235" target="_top" shape="rect">lib/attrsets.nix:235</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p>
<p> Filter an attribute set recursively by removing all attributes for which the given predicate return false. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">pred</code> </span></dt>
<dd>
<p> <code class="literal">String -&gt; Any -&gt; Bool</code> </p>
<p> Predicate which returns true to include an attribute, or returns false to exclude it. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">name</code> </span></dt>
<dd><p> The attribute's name </p></dd>
<dt><span class="term"> <code class="varname">value</code> </span></dt>
<dd><p> The attribute's value </p></dd>
</dl></div>
<p> Returns <code class="literal">true</code> to include the attribute, <code class="literal">false</code> to exclude the attribute. </p>
</dd>
<dt><span class="term"> <code class="varname">set</code> </span></dt>
<dd><p> The attribute set to filter </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  Recursively filtering an attribute set</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
lib.attrsets.filterAttrsRecursive
  (n: v: v != null)
  {
    levelA = {
      example = "hi";
      levelB = {
        hello = "there";
        this-one-is-present = {
          this-is-excluded = null;
        };
      };
      this-one-is-also-excluded = null;
    };
    also-excluded = null;
  }
=&gt; {
     levelA = {
       example = "hi";
       levelB = {
         hello = "there";
         this-one-is-present = { };
       };
     };
   }
     </pre></div>
</div>
<br class="example-break" clear="none"></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-attrsets-foldAttrs"><code class="function">lib.attrsets.foldAttrs</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">foldAttrs :: (Any -&gt; Any -&gt; Any) -&gt; Any -&gt; [AttrSets] -&gt; Any</code> </h5></div>
</div></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/attrsets.nix#L254" target="_top" shape="rect">lib/attrsets.nix:254</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p>
<p> Apply fold function to values grouped by key. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">op</code> </span></dt>
<dd>
<p> <code class="literal">Any -&gt; Any -&gt; Any</code> </p>
<p> Given a value <code class="varname">val</code> and a collector <code class="varname">col</code>, combine the two. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">val</code> </span></dt>
<dd><p> An attribute's value </p></dd>
<dt><span class="term"> <code class="varname">col</code> </span></dt>
<dd><p> The result of previous <code class="function">op</code> calls with other values and <code class="function">nul</code>. </p></dd>
</dl></div>
</dd>
<dt><span class="term"> <code class="varname">nul</code> </span></dt>
<dd><p> The null-value, the starting value. </p></dd>
<dt><span class="term"> <code class="varname">list_of_attrs</code> </span></dt>
<dd><p> A list of attribute sets to fold together by key. </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  Combining an attribute of lists in to one attribute set</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
lib.attrsets.foldAttrs
  (n: a: [n] ++ a) []
  [
    { a = 2; b = 7; }
    { a = 3; }
    { b = 6; }
  ]
=&gt; { a = [ 2 3 ]; b = [ 7 6 ]; }
</pre></div>
</div>
<br class="example-break" clear="none"></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-attrsets-collect"><code class="function">lib.attrsets.collect</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">collect :: (Any -&gt; Bool) -&gt; AttrSet -&gt; [Any]</code> </h5></div>
</div></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/attrsets.nix#L278" target="_top" shape="rect">lib/attrsets.nix:278</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p>
<p> Recursively collect sets that verify a given predicate named <code class="varname">pred</code> from the set <code class="varname">attrs</code>. The recursion stops when <code class="varname">pred</code> returns <code class="literal">true</code>. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">pred</code> </span></dt>
<dd>
<p> <code class="literal">Any -&gt; Bool</code> </p>
<p> Given an attribute's value, determine if recursion should stop. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">value</code> </span></dt>
<dd><p> The attribute set value. </p></dd>
</dl></div>
</dd>
<dt><span class="term"> <code class="varname">attrs</code> </span></dt>
<dd><p> The attribute set to recursively collect. </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  Collecting all lists from an attribute set</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
lib.attrsets.collect isList { a = { b = ["b"]; }; c = [1]; }
=&gt; [["b"] [1]]
</pre></div>
</div>
<br class="example-break" clear="none"><div class="example">
<p class="title"><strong>Example:  Collecting all attribute-sets which contain the outPath attribute name.</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
collect (x: x ? outPath)
  { a = { outPath = "a/"; }; b = { outPath = "b/"; }; }
=&gt; [{ outPath = "a/"; } { outPath = "b/"; }]
</pre></div>
</div>
<br class="example-break" clear="none"></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-attrsets-nameValuePair"><code class="function">lib.attrsets.nameValuePair</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">nameValuePair :: String -&gt; Any -&gt; AttrSet</code> </h5></div>
</div></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/attrsets.nix#L312" target="_top" shape="rect">lib/attrsets.nix:312</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p>
<p> Utility function that creates a <code class="literal">{name, value}</code> pair as expected by <code class="function">builtins.listToAttrs</code>. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">name</code> </span></dt>
<dd><p> The attribute name. </p></dd>
<dt><span class="term"> <code class="varname">value</code> </span></dt>
<dd><p> The attribute value. </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  Creating a name value pair</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
nameValuePair "some" 6
=&gt; { name = "some"; value = 6; }
</pre></div>
</div>
<br class="example-break" clear="none"></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-attrsets-mapAttrs"><code class="function">lib.attrsets.mapAttrs</code></h2></div>

</div></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/attrsets.nix#L325" target="_top" shape="rect">lib/attrsets.nix:325</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p>
<p> Apply a function to each element in an attribute set, creating a new attribute set. </p>
<p> Provides a backwards-compatible interface of <code class="function">builtins.mapAttrs</code> for Nix version older than 2.1. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">fn</code> </span></dt>
<dd>
<p> <code class="literal">String -&gt; Any -&gt; Any</code> </p>
<p> Given an attribute's name and value, return a new value. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">name</code> </span></dt>
<dd><p> The name of the attribute. </p></dd>
<dt><span class="term"> <code class="varname">value</code> </span></dt>
<dd><p> The attribute's value. </p></dd>
</dl></div>
</dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  Modifying each value of an attribute set</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
lib.attrsets.mapAttrs
  (name: value: name + "-" + value)
  { x = "foo"; y = "bar"; }
=&gt; { x = "x-foo"; y = "y-bar"; }
</pre></div>
</div>
<br class="example-break" clear="none"></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-attrsets-mapAttrs-"><code class="function">lib.attrsets.mapAttrs'</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">mapAttrs' :: (String -&gt; Any -&gt; { name = String; value = Any }) -&gt; AttrSet -&gt; AttrSet</code> </h5></div>
</div></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/attrsets.nix#L339" target="_top" shape="rect">lib/attrsets.nix:339</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p>
<p> Like <code class="function">mapAttrs</code>, but allows the name of each attribute to be changed in addition to the value. The applied function should return both the new name and value as a <code class="function">nameValuePair</code>. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">fn</code> </span></dt>
<dd>
<p> <code class="literal">String -&gt; Any -&gt; { name = String; value = Any }</code> </p>
<p> Given an attribute's name and value, return a new <a class="link" href="#function-library-lib.attrsets.nameValuePair" title="5.1.2.12. lib.attrsets.nameValuePair" shape="rect">name value pair</a>. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">name</code> </span></dt>
<dd><p> The name of the attribute. </p></dd>
<dt><span class="term"> <code class="varname">value</code> </span></dt>
<dd><p> The attribute's value. </p></dd>
</dl></div>
</dd>
<dt><span class="term"> <code class="varname">set</code> </span></dt>
<dd><p> The attribute set to map over. </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  Change the name and value of each attribute of an attribute set</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
lib.attrsets.mapAttrs' (name: value: lib.attrsets.nameValuePair ("foo_" + name) ("bar-" + value))
   { x = "a"; y = "b"; }
=&gt; { foo_x = "bar-a"; foo_y = "bar-b"; }

    </pre></div>
</div>
<br class="example-break" clear="none"></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-attrsets-mapAttrsToList"><code class="function">lib.attrsets.mapAttrsToList</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">mapAttrsToList :: (String -&gt; Any -&gt; Any) -&gt;
   AttrSet -&gt; [Any]</code> </h5></div>
</div></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/attrsets.nix#L355" target="_top" shape="rect">lib/attrsets.nix:355</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p>
<p> Call <code class="varname">fn</code> for each attribute in the given <code class="varname">set</code> and return the result in a list. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">fn</code> </span></dt>
<dd>
<p> <code class="literal">String -&gt; Any -&gt; Any</code> </p>
<p> Given an attribute's name and value, return a new value. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">name</code> </span></dt>
<dd><p> The name of the attribute. </p></dd>
<dt><span class="term"> <code class="varname">value</code> </span></dt>
<dd><p> The attribute's value. </p></dd>
</dl></div>
</dd>
<dt><span class="term"> <code class="varname">set</code> </span></dt>
<dd><p> The attribute set to map over. </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  Combine attribute values and names in to a list</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
lib.attrsets.mapAttrsToList (name: value: "${name}=${value}")
   { x = "a"; y = "b"; }
=&gt; [ "x=a" "y=b" ]
</pre></div>
</div>
<br class="example-break" clear="none"></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-attrsets-mapAttrsRecursive"><code class="function">lib.attrsets.mapAttrsRecursive</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">mapAttrsRecursive :: ([String] &gt; Any -&gt; Any) -&gt; AttrSet -&gt; AttrSet</code> </h5></div>
</div></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/attrsets.nix#L372" target="_top" shape="rect">lib/attrsets.nix:372</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p>
<p> Like <code class="function">mapAttrs</code>, except that it recursively applies itself to attribute sets. Also, the first argument of the argument function is a <span class="emphasis"><em>list</em></span> of the names of the containing attributes. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">f</code> </span></dt>
<dd>
<p> <code class="literal">[ String ] -&gt; Any -&gt; Any</code> </p>
<p> Given a list of attribute names and value, return a new value. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">name_path</code> </span></dt>
<dd>
<p> The list of attribute names to this value. </p>
<p> For example, the <code class="varname">name_path</code> for the <code class="literal">example</code> string in the attribute set <code class="literal">{ foo = { bar = "example"; }; }</code> is <code class="literal">[ "foo" "bar" ]</code>. </p>
</dd>
<dt><span class="term"> <code class="varname">value</code> </span></dt>
<dd><p> The attribute's value. </p></dd>
</dl></div>
</dd>
<dt><span class="term"> <code class="varname">set</code> </span></dt>
<dd><p> The attribute set to recursively map over. </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  A contrived example of using lib.attrsets.mapAttrsRecursive</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
mapAttrsRecursive
  (path: value: concatStringsSep "-" (path ++ [value]))
  {
    n = {
      a = "A";
      m = {
        b = "B";
        c = "C";
      };
    };
    d = "D";
  }
=&gt; {
     n = {
       a = "n-a-A";
       m = {
         b = "n-m-b-B";
         c = "n-m-c-C";
       };
     };
     d = "d-D";
   }
    </pre></div>
</div>
<br class="example-break" clear="none"></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-attrsets-mapAttrsRecursiveCond"><code class="function">lib.attrsets.mapAttrsRecursiveCond</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">mapAttrsRecursiveCond :: (AttrSet -&gt; Bool) -&gt; ([ String ] -&gt; Any -&gt; Any) -&gt; AttrSet -&gt; AttrSet</code> </h5></div>
</div></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/attrsets.nix#L393" target="_top" shape="rect">lib/attrsets.nix:393</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p>
<p> Like <code class="function">mapAttrsRecursive</code>, but it takes an additional predicate function that tells it whether to recursive into an attribute set. If it returns false, <code class="function">mapAttrsRecursiveCond</code> does not recurse, but does apply the map function. It is returns true, it does recurse, and does not apply the map function. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">cond</code> </span></dt>
<dd>
<p> <code class="literal">(AttrSet -&gt; Bool)</code> </p>
<p> Determine if <code class="function">mapAttrsRecursive</code> should recurse deeper in to the attribute set. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">attributeset</code> </span></dt>
<dd><p> An attribute set. </p></dd>
</dl></div>
</dd>
<dt><span class="term"> <code class="varname">f</code> </span></dt>
<dd>
<p> <code class="literal">[ String ] -&gt; Any -&gt; Any</code> </p>
<p> Given a list of attribute names and value, return a new value. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">name_path</code> </span></dt>
<dd>
<p> The list of attribute names to this value. </p>
<p> For example, the <code class="varname">name_path</code> for the <code class="literal">example</code> string in the attribute set <code class="literal">{ foo = { bar = "example"; }; }</code> is <code class="literal">[ "foo" "bar" ]</code>. </p>
</dd>
<dt><span class="term"> <code class="varname">value</code> </span></dt>
<dd><p> The attribute's value. </p></dd>
</dl></div>
</dd>
<dt><span class="term"> <code class="varname">set</code> </span></dt>
<dd><p> The attribute set to recursively map over. </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  Only convert attribute values to JSON if the containing attribute set is marked for recursion</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
lib.attrsets.mapAttrsRecursiveCond
  ({ recurse ? false, ... }: recurse)
  (name: value: builtins.toJSON value)
  {
    dorecur = {
      recurse = true;
      hello = "there";
    };
    dontrecur = {
      converted-to- = "json";
    };
  }
=&gt; {
     dorecur = {
       hello = "\"there\"";
       recurse = "true";
     };
     dontrecur = "{\"converted-to\":\"json\"}";
   }
    </pre></div>
</div>
<br class="example-break" clear="none"></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-attrsets-genAttrs"><code class="function">lib.attrsets.genAttrs</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">genAttrs :: [ String ] -&gt; (String -&gt; Any) -&gt; AttrSet</code> </h5></div>
</div></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/attrsets.nix#L413" target="_top" shape="rect">lib/attrsets.nix:413</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p>
<p> Generate an attribute set by mapping a function over a list of attribute names. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">names</code> </span></dt>
<dd><p> Names of values in the resulting attribute set. </p></dd>
<dt><span class="term"> <code class="varname">f</code> </span></dt>
<dd>
<p> <code class="literal">String -&gt; Any</code> </p>
<p> Takes the name of the attribute and return the attribute's value. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">name</code> </span></dt>
<dd><p> The name of the attribute to generate a value for. </p></dd>
</dl></div>
</dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  Generate an attrset based on names only</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
lib.attrsets.genAttrs [ "foo" "bar" ] (name: "x_${name}")
=&gt; { foo = "x_foo"; bar = "x_bar"; }
     </pre></div>
</div>
<br class="example-break" clear="none"></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-attrsets-isDerivation"><code class="function">lib.attrsets.isDerivation</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">isDerivation :: Any -&gt; Bool</code> </h5></div>
</div></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/attrsets.nix#L427" target="_top" shape="rect">lib/attrsets.nix:427</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p>
<p> Check whether the argument is a derivation. Any set with <code class="code">{ type = "derivation"; }</code> counts as a derivation. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">value</code> </span></dt>
<dd><p> The value which is possibly a derivation. </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  A package is a derivation</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
lib.attrsets.isDerivation (import &lt;nixpkgs&gt; {}).ruby
=&gt; true
     </pre></div>
</div>
<br class="example-break" clear="none"><div class="example">
<p class="title"><strong>Example:  Anything else is not a derivation</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
lib.attrsets.isDerivation "foobar"
=&gt; false
     </pre></div>
</div>
<br class="example-break" clear="none"></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-attrsets-toDerivation"><code class="function">lib.attrsets.toDerivation</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">toDerivation :: Path -&gt; Derivation</code> </h5></div>
</div></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/attrsets.nix#L430" target="_top" shape="rect">lib/attrsets.nix:430</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p>
<p> Converts a store path to a fake derivation. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">path</code> </span></dt>
<dd><p> A store path to convert to a derivation. </p></dd>
</dl></div></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-attrsets-optionalAttrs"><code class="function">lib.attrsets.optionalAttrs</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">optionalAttrs :: Bool -&gt; AttrSet</code> </h5></div>
</div></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/attrsets.nix#L453" target="_top" shape="rect">lib/attrsets.nix:453</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p>
<p> Conditionally return an attribute set or an empty attribute set. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">cond</code> </span></dt>
<dd><p> Condition under which the <code class="varname">as</code> attribute set is returned. </p></dd>
<dt><span class="term"> <code class="varname">as</code> </span></dt>
<dd><p> The attribute set to return if <code class="varname">cond</code> is true. </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  Return the provided attribute set when cond is true</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
lib.attrsets.optionalAttrs true { my = "set"; }
=&gt; { my = "set"; }
     </pre></div>
</div>
<br class="example-break" clear="none"><div class="example">
<p class="title"><strong>Example:  Return an empty attribute set when cond is false</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
lib.attrsets.optionalAttrs false { my = "set"; }
=&gt; { }
     </pre></div>
</div>
<br class="example-break" clear="none"></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-attrsets-zipAttrsWithNames"><code class="function">lib.attrsets.zipAttrsWithNames</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">zipAttrsWithNames :: [ String ] -&gt; (String -&gt; [ Any ] -&gt; Any) -&gt; [ AttrSet ] -&gt; AttrSet</code> </h5></div>
</div></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/attrsets.nix#L463" target="_top" shape="rect">lib/attrsets.nix:463</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p>
<p> Merge sets of attributes and use the function <code class="varname">f</code> to merge attribute values where the attribute name is in <code class="varname">names</code>. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">names</code> </span></dt>
<dd><p> A list of attribute names to zip. </p></dd>
<dt><span class="term"> <code class="varname">f</code> </span></dt>
<dd>
<p> <code class="literal">(String -&gt; [ Any ] -&gt; Any</code> </p>
<p> Accepts an attribute name, all the values, and returns a combined value. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">name</code> </span></dt>
<dd><p> The name of the attribute each value came from. </p></dd>
<dt><span class="term"> <code class="varname">vs</code> </span></dt>
<dd><p> A list of values collected from the list of attribute sets. </p></dd>
</dl></div>
</dd>
<dt><span class="term"> <code class="varname">sets</code> </span></dt>
<dd><p> A list of attribute sets to zip together. </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  Summing a list of attribute sets of numbers</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
lib.attrsets.zipAttrsWithNames
  [ "a" "b" ]
  (name: vals: "${name} ${toString (builtins.foldl' (a: b: a + b) 0 vals)}")
  [
    { a = 1; b = 1; c = 1; }
    { a = 10; }
    { b = 100; }
    { c = 1000; }
  ]
=&gt; { a = "a 11"; b = "b 101"; }
     </pre></div>
</div>
<br class="example-break" clear="none"></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-attrsets-zipAttrsWith"><code class="function">lib.attrsets.zipAttrsWith</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">zipAttrsWith :: (String -&gt; [ Any ] -&gt; Any) -&gt; [ AttrSet ] -&gt; AttrSet</code> </h5></div>
</div></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/attrsets.nix#L478" target="_top" shape="rect">lib/attrsets.nix:478</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p>
<p> Merge sets of attributes and use the function <code class="varname">f</code> to merge attribute values. Similar to <a class="xref" href="#function-library-lib.attrsets.zipAttrsWithNames" title="5.1.2.22. lib.attrsets.zipAttrsWithNames" shape="rect">Section 5.1.2.22, “<code class="function">lib.attrsets.zipAttrsWithNames</code>”</a> where all key names are passed for <code class="varname">names</code>. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">f</code> </span></dt>
<dd>
<p> <code class="literal">(String -&gt; [ Any ] -&gt; Any</code> </p>
<p> Accepts an attribute name, all the values, and returns a combined value. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">name</code> </span></dt>
<dd><p> The name of the attribute each value came from. </p></dd>
<dt><span class="term"> <code class="varname">vs</code> </span></dt>
<dd><p> A list of values collected from the list of attribute sets. </p></dd>
</dl></div>
</dd>
<dt><span class="term"> <code class="varname">sets</code> </span></dt>
<dd><p> A list of attribute sets to zip together. </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  Summing a list of attribute sets of numbers</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
lib.attrsets.zipAttrsWith
  (name: vals: "${name} ${toString (builtins.foldl' (a: b: a + b) 0 vals)}")
  [
    { a = 1; b = 1; c = 1; }
    { a = 10; }
    { b = 100; }
    { c = 1000; }
  ]
=&gt; { a = "a 11"; b = "b 101"; c = "c 1001"; }
     </pre></div>
</div>
<br class="example-break" clear="none"></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-attrsets-zipAttrs"><code class="function">lib.attrsets.zipAttrs</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">zipAttrs :: [ AttrSet ] -&gt; AttrSet</code> </h5></div>
</div></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/attrsets.nix#L486" target="_top" shape="rect">lib/attrsets.nix:486</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p>
<p> Merge sets of attributes and combine each attribute value in to a list. Similar to <a class="xref" href="#function-library-lib.attrsets.zipAttrsWith" title="5.1.2.23. lib.attrsets.zipAttrsWith" shape="rect">Section 5.1.2.23, “<code class="function">lib.attrsets.zipAttrsWith</code>”</a> where the merge function returns a list of all values. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">sets</code> </span></dt>
<dd><p> A list of attribute sets to zip together. </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  Combining a list of attribute sets</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
lib.attrsets.zipAttrs
  [
    { a = 1; b = 1; c = 1; }
    { a = 10; }
    { b = 100; }
    { c = 1000; }
  ]
=&gt; { a = [ 1 10 ]; b = [ 1 100 ]; c = [ 1 1000 ]; }
     </pre></div>
</div>
<br class="example-break" clear="none"></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-attrsets-recursiveUpdateUntil"><code class="function">lib.attrsets.recursiveUpdateUntil</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">recursiveUpdateUntil :: ( [ String ] -&gt; AttrSet -&gt; AttrSet -&gt; Bool ) -&gt; AttrSet -&gt; AttrSet -&gt; AttrSet</code> </h5></div>
</div></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/attrsets.nix#L516" target="_top" shape="rect">lib/attrsets.nix:516</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p>
<p> Does the same as the update operator <code class="literal">//</code> except that attributes are merged until the given predicate is verified. The predicate should accept 3 arguments which are the path to reach the attribute, a part of the first attribute set and a part of the second attribute set. When the predicate is verified, the value of the first attribute set is replaced by the value of the second attribute set. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">pred</code> </span></dt>
<dd>
<p> <code class="literal">[ String ] -&gt; AttrSet -&gt; AttrSet -&gt; Bool</code> </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">path</code> </span></dt>
<dd><p> The path to the values in the left and right hand sides. </p></dd>
<dt><span class="term"> <code class="varname">l</code> </span></dt>
<dd><p> The left hand side value. </p></dd>
<dt><span class="term"> <code class="varname">r</code> </span></dt>
<dd><p> The right hand side value. </p></dd>
</dl></div>
</dd>
<dt><span class="term"> <code class="varname">lhs</code> </span></dt>
<dd><p> The left hand attribute set of the merge. </p></dd>
<dt><span class="term"> <code class="varname">rhs</code> </span></dt>
<dd><p> The right hand attribute set of the merge. </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  Recursively merging two attribute sets</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
lib.attrsets.recursiveUpdateUntil (path: l: r: path == ["foo"])
  {
    # first attribute set
    foo.bar = 1;
    foo.baz = 2;
    bar = 3;
  }
  {
    #second attribute set
    foo.bar = 1;
    foo.quz = 2;
    baz = 4;
  }
=&gt; {
  foo.bar = 1; # 'foo.*' from the second set
  foo.quz = 2; #
  bar = 3;     # 'bar' from the first set
  baz = 4;     # 'baz' from the second set
}
     </pre></div>
</div>
<br class="example-break" clear="none"></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-attrsets-recursiveUpdate"><code class="function">lib.attrsets.recursiveUpdate</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">recursiveUpdate :: AttrSet -&gt; AttrSet -&gt; AttrSet</code> </h5></div>
</div></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/attrsets.nix#L547" target="_top" shape="rect">lib/attrsets.nix:547</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p>
<p> A recursive variant of the update operator <code class="literal">//</code>. The recursion stops when one of the attribute values is not an attribute set, in which case the right hand side value takes precedence over the left hand side value. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">lhs</code> </span></dt>
<dd><p> The left hand attribute set of the merge. </p></dd>
<dt><span class="term"> <code class="varname">rhs</code> </span></dt>
<dd><p> The right hand attribute set of the merge. </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  Recursively merging two attribute sets</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
recursiveUpdate
  {
    boot.loader.grub.enable = true;
    boot.loader.grub.device = "/dev/hda";
  }
  {
    boot.loader.grub.device = "";
  }
=&gt; {
  boot.loader.grub.enable = true;
  boot.loader.grub.device = "";
}
</pre></div>
</div>
<br class="example-break" clear="none"></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-attrsets-recurseIntoAttrs"><code class="function">lib.attrsets.recurseIntoAttrs</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">recurseIntoAttrs :: AttrSet -&gt; AttrSet</code> </h5></div>
</div></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/attrsets.nix#L617" target="_top" shape="rect">lib/attrsets.nix:617</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p>
<p> Make various Nix tools consider the contents of the resulting attribute set when looking for what to build, find, etc. </p>
<p> This function only affects a single attribute set; it does not apply itself recursively for nested attribute sets. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">attrs</code> </span></dt>
<dd><p> An attribute set to scan for derivations. </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  Making Nix look inside an attribute set</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
{ pkgs ? import &lt;nixpkgs&gt; {} }:
{
  myTools = pkgs.lib.recurseIntoAttrs {
    inherit (pkgs) hello figlet;
  };
}
</pre></div>
</div>
<br class="example-break" clear="none"></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-attrsets-cartesianProductOfSets"><code class="function">lib.attrsets.cartesianProductOfSets</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">cartesianProductOfSets :: AttrSet -&gt; [ AttrSet ]</code> </h5></div>
</div></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/attrsets.nix#L297" target="_top" shape="rect">lib/attrsets.nix:297</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p>
<p> Return the cartesian product of attribute set value combinations. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">set</code> </span></dt>
<dd><p> An attribute set with attributes that carry lists of values. </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  Creating the cartesian product of a list of attribute values</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
cartesianProductOfSets { a = [ 1 2 ]; b = [ 10 20 ]; }
=&gt; [
     { a = 1; b = 10; }
     { a = 1; b = 20; }
     { a = 2; b = 10; }
     { a = 2; b = 20; }
   ]
</pre></div>
</div>
<br class="example-break" clear="none"></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-concatStrings"><code class="function">lib.strings.concatStrings</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">concatStrings :: [string] -&gt; string</code> </h5></div>
</div></div>
<p> Concatenate a list of strings. </p>
<div class="example">
<p class="title"><strong>Example:  lib.strings.concatStrings usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
concatStrings ["foo" "bar"]
=&gt; "foobar"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L44" target="_top" shape="rect">lib/strings.nix:44</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-concatMapStrings"><code class="function">lib.strings.concatMapStrings</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">concatMapStrings :: (a -&gt; string) -&gt; [a] -&gt; string</code> </h5></div>
</div></div>
<p> Map a function over a list and concatenate the resulting strings. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">f</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">list</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.concatMapStrings usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
concatMapStrings (x: "a" + x) ["foo" "bar"]
=&gt; "afooabar"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L54" target="_top" shape="rect">lib/strings.nix:54</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-concatImapStrings"><code class="function">lib.strings.concatImapStrings</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">concatImapStrings :: (int -&gt; a -&gt; string) -&gt; [a] -&gt; string</code> </h5></div>
</div></div>
<p> Like `concatMapStrings` except that the f functions also gets the position as a parameter. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">f</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">list</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.concatImapStrings usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
concatImapStrings (pos: x: "${toString pos}-${x}") ["foo" "bar"]
=&gt; "1-foo2-bar"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L65" target="_top" shape="rect">lib/strings.nix:65</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-intersperse"><code class="function">lib.strings.intersperse</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">intersperse :: a -&gt; [a] -&gt; [a]</code> </h5></div>
</div></div>
<p> Place an element between each element of a list </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">separator</code> </span></dt>
<dd><p> Separator to add between elements </p></dd>
<dt><span class="term"> <code class="varname">list</code> </span></dt>
<dd><p> Input list </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.intersperse usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
intersperse "/" ["usr" "local" "bin"]
=&gt; ["usr" "/" "local" "/" "bin"].
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L75" target="_top" shape="rect">lib/strings.nix:75</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-concatStringsSep"><code class="function">lib.strings.concatStringsSep</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">concatStringsSep :: string -&gt; [string] -&gt; string</code> </h5></div>
</div></div>
<p> Concatenate a list of strings with a separator between each element </p>
<div class="example">
<p class="title"><strong>Example:  lib.strings.concatStringsSep usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
concatStringsSep "/" ["usr" "local" "bin"]
=&gt; "usr/local/bin"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L92" target="_top" shape="rect">lib/strings.nix:92</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-concatMapStringsSep"><code class="function">lib.strings.concatMapStringsSep</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">concatMapStringsSep :: string -&gt; (a -&gt; string) -&gt; [a] -&gt; string</code> </h5></div>
</div></div>
<p> Maps a function over a list of strings and then concatenates the result with the specified separator interspersed between elements. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">sep</code> </span></dt>
<dd><p> Separator to add between elements </p></dd>
<dt><span class="term"> <code class="varname">f</code> </span></dt>
<dd><p> Function to map over the list </p></dd>
<dt><span class="term"> <code class="varname">list</code> </span></dt>
<dd><p> List of input strings </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.concatMapStringsSep usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
concatMapStringsSep "-" (x: toUpper x)  ["foo" "bar" "baz"]
=&gt; "FOO-BAR-BAZ"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L105" target="_top" shape="rect">lib/strings.nix:105</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-concatImapStringsSep"><code class="function">lib.strings.concatImapStringsSep</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">concatIMapStringsSep :: string -&gt; (int -&gt; a -&gt; string) -&gt; [a] -&gt; string</code> </h5></div>
</div></div>
<p> Same as `concatMapStringsSep`, but the mapping function additionally receives the position of its argument. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">sep</code> </span></dt>
<dd><p> Separator to add between elements </p></dd>
<dt><span class="term"> <code class="varname">f</code> </span></dt>
<dd><p> Function that receives elements and their positions </p></dd>
<dt><span class="term"> <code class="varname">list</code> </span></dt>
<dd><p> List of input strings </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.concatImapStringsSep usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
concatImapStringsSep "-" (pos: x: toString (x / pos)) [ 6 6 6 ]
=&gt; "6-3-2"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L122" target="_top" shape="rect">lib/strings.nix:122</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-makeSearchPath"><code class="function">lib.strings.makeSearchPath</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">makeSearchPath :: string -&gt; [string] -&gt; string</code> </h5></div>
</div></div>
<p> Construct a Unix-style, colon-separated search path consisting of the given `subDir` appended to each of the given paths. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">subDir</code> </span></dt>
<dd><p> Directory name to append </p></dd>
<dt><span class="term"> <code class="varname">paths</code> </span></dt>
<dd><p> List of base paths </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.makeSearchPath usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
makeSearchPath "bin" ["/root" "/usr" "/usr/local"]
=&gt; "/root/bin:/usr/bin:/usr/local/bin"
makeSearchPath "bin" [""]
=&gt; "/bin"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L141" target="_top" shape="rect">lib/strings.nix:141</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-makeSearchPathOutput"><code class="function">lib.strings.makeSearchPathOutput</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">string -&gt; string -&gt; [package] -&gt; string</code> </h5></div>
</div></div>
<p> Construct a Unix-style search path by appending the given `subDir` to the specified `output` of each of the packages. If no output by the given name is found, fallback to `.out` and then to the default. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">output</code> </span></dt>
<dd><p> Package output to use </p></dd>
<dt><span class="term"> <code class="varname">subDir</code> </span></dt>
<dd><p> Directory name to append </p></dd>
<dt><span class="term"> <code class="varname">pkgs</code> </span></dt>
<dd><p> List of packages </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.makeSearchPathOutput usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
makeSearchPathOutput "dev" "bin" [ pkgs.openssl pkgs.zlib ]
=&gt; "/nix/store/9rz8gxhzf8sw4kf2j2f1grr49w8zx5vj-openssl-1.0.1r-dev/bin:/nix/store/wwh7mhwh269sfjkm6k5665b5kgp7jrk2-zlib-1.2.8/bin"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L159" target="_top" shape="rect">lib/strings.nix:159</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-strings-makeLibraryPath"><code class="function">lib.strings.makeLibraryPath</code></h2></div></div></div>
<p> Construct a library search path (such as RPATH) containing the libraries for a set of packages </p>
<div class="example">
<p class="title"><strong>Example:  lib.strings.makeLibraryPath usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
makeLibraryPath [ "/usr" "/usr/local" ]
=&gt; "/usr/lib:/usr/local/lib"
pkgs = import &lt;nixpkgs&gt; { }
makeLibraryPath [ pkgs.openssl pkgs.zlib ]
=&gt; "/nix/store/9rz8gxhzf8sw4kf2j2f1grr49w8zx5vj-openssl-1.0.1r/lib:/nix/store/wwh7mhwh269sfjkm6k5665b5kgp7jrk2-zlib-1.2.8/lib"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L177" target="_top" shape="rect">lib/strings.nix:177</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-strings-makeBinPath"><code class="function">lib.strings.makeBinPath</code></h2></div></div></div>
<p> Construct a binary search path (such as $PATH) containing the binaries for a set of packages. </p>
<div class="example">
<p class="title"><strong>Example:  lib.strings.makeBinPath usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
makeBinPath ["/root" "/usr" "/usr/local"]
=&gt; "/root/bin:/usr/bin:/usr/local/bin"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L186" target="_top" shape="rect">lib/strings.nix:186</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-optionalString"><code class="function">lib.strings.optionalString</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">optionalString :: bool -&gt; string -&gt; string</code> </h5></div>
</div></div>
<p> Depending on the boolean `cond', return either the given string or the empty string. Useful to concatenate against a bigger string. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">cond</code> </span></dt>
<dd><p> Condition </p></dd>
<dt><span class="term"> <code class="varname">string</code> </span></dt>
<dd><p> String to return if condition is true </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.optionalString usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
optionalString true "some-string"
=&gt; "some-string"
optionalString false "some-string"
=&gt; ""
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L199" target="_top" shape="rect">lib/strings.nix:199</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-hasPrefix"><code class="function">lib.strings.hasPrefix</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">hasPrefix :: string -&gt; string -&gt; bool</code> </h5></div>
</div></div>
<p> Determine whether a string has given prefix. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">pref</code> </span></dt>
<dd><p> Prefix to check for </p></dd>
<dt><span class="term"> <code class="varname">str</code> </span></dt>
<dd><p> Input string </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.hasPrefix usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
hasPrefix "foo" "foobar"
=&gt; true
hasPrefix "foo" "barfoo"
=&gt; false
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L215" target="_top" shape="rect">lib/strings.nix:215</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-hasSuffix"><code class="function">lib.strings.hasSuffix</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">hasSuffix :: string -&gt; string -&gt; bool</code> </h5></div>
</div></div>
<p> Determine whether a string has given suffix. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">suffix</code> </span></dt>
<dd><p> Suffix to check for </p></dd>
<dt><span class="term"> <code class="varname">content</code> </span></dt>
<dd><p> Input string </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.hasSuffix usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
hasSuffix "foo" "foobar"
=&gt; false
hasSuffix "foo" "barfoo"
=&gt; true
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L231" target="_top" shape="rect">lib/strings.nix:231</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-hasInfix"><code class="function">lib.strings.hasInfix</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">hasInfix :: string -&gt; string -&gt; bool</code> </h5></div>
</div></div>
<p> Determine whether a string contains the given infix </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">infix</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">content</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.hasInfix usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
hasInfix "bc" "abcd"
=&gt; true
hasInfix "ab" "abcd"
=&gt; true
hasInfix "cd" "abcd"
=&gt; true
hasInfix "foo" "abcd"
=&gt; false
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L256" target="_top" shape="rect">lib/strings.nix:256</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-stringToCharacters"><code class="function">lib.strings.stringToCharacters</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">stringToCharacters :: string -&gt; [string]</code> </h5></div>
</div></div>
<p> Convert a string to a list of characters (i.e. singleton strings). This allows you to, e.g., map a function over each character. However, note that this will likely be horribly inefficient; Nix is not a general purpose programming language. Complex string manipulations should, if appropriate, be done in a derivation. Also note that Nix treats strings as a list of bytes and thus doesn't handle unicode. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">s</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.stringToCharacters usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
stringToCharacters ""
=&gt; [ ]
stringToCharacters "abc"
=&gt; [ "a" "b" "c" ]
stringToCharacters "💩"
=&gt; [ "�" "�" "�" "�" ]
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L277" target="_top" shape="rect">lib/strings.nix:277</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-stringAsChars"><code class="function">lib.strings.stringAsChars</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">stringAsChars :: (string -&gt; string) -&gt; string -&gt; string</code> </h5></div>
</div></div>
<p> Manipulate a string character by character and replace them by strings before concatenating the results. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">f</code> </span></dt>
<dd><p> Function to map over each individual character </p></dd>
<dt><span class="term"> <code class="varname">s</code> </span></dt>
<dd><p> Input string </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.stringAsChars usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
stringAsChars (x: if x == "a" then "i" else x) "nax"
=&gt; "nix"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L289" target="_top" shape="rect">lib/strings.nix:289</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-escape"><code class="function">lib.strings.escape</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">escape :: [string] -&gt; string -&gt; string</code> </h5></div>
</div></div>
<p> Escape occurrence of the elements of `list` in `string` by prefixing it with a backslash. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">list</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.escape usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
escape ["(" ")"] "(foo)"
=&gt; "\\(foo\\)"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L306" target="_top" shape="rect">lib/strings.nix:306</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-escapeShellArg"><code class="function">lib.strings.escapeShellArg</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">escapeShellArg :: string -&gt; string</code> </h5></div>
</div></div>
<p> Quote string to be used safely within the Bourne shell. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">arg</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.escapeShellArg usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
escapeShellArg "esc'ape\nme"
=&gt; "'esc'\\''ape\nme'"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L316" target="_top" shape="rect">lib/strings.nix:316</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-escapeShellArgs"><code class="function">lib.strings.escapeShellArgs</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">escapeShellArgs :: [string] -&gt; string</code> </h5></div>
</div></div>
<p> Quote all arguments to be safely passed to the Bourne shell. </p>
<div class="example">
<p class="title"><strong>Example:  lib.strings.escapeShellArgs usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
escapeShellArgs ["one" "two three" "four'five"]
=&gt; "'one' 'two three' 'four'\\''five'"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L326" target="_top" shape="rect">lib/strings.nix:326</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-isValidPosixName"><code class="function">lib.strings.isValidPosixName</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">string -&gt; bool</code> </h5></div>
</div></div>
<p> Test whether the given name is a valid POSIX shell variable name. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">name</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.isValidPosixName usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
isValidPosixName "foo_bar000"
=&gt; true
isValidPosixName "0-bad.jpg"
=&gt; false
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L338" target="_top" shape="rect">lib/strings.nix:338</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-toShellVar"><code class="function">lib.strings.toShellVar</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">string -&gt; (string | listOf string | attrsOf string) -&gt; string</code> </h5></div>
</div></div>
<p> Translate a Nix value into a shell variable declaration, with proper escaping. </p>
<p> The value can be a string (mapped to a regular variable), a list of strings (mapped to a Bash-style array) or an attribute set of strings (mapped to a Bash-style associative array). Note that "string" includes string-coercible values like paths or derivations. </p>
<p> Strings are translated into POSIX sh-compatible code; lists and attribute sets assume a shell that understands Bash syntax (e.g. Bash or ZSH). </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">name</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">value</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.toShellVar usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
''
${toShellVar "foo" "some string"}
[[ "$foo" == "some string" ]]
''
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L358" target="_top" shape="rect">lib/strings.nix:358</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-toShellVars"><code class="function">lib.strings.toShellVars</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">attrsOf (string | listOf string | attrsOf string) -&gt; string</code> </h5></div>
</div></div>
<p> Translate an attribute set into corresponding shell variable declarations using `toShellVar`. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">vars</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.toShellVars usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
let
foo = "value";
bar = foo;
in ''
${toShellVars { inherit foo bar; }}
[[ "$foo" == "$bar" ]]
''
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L386" target="_top" shape="rect">lib/strings.nix:386</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-escapeNixString"><code class="function">lib.strings.escapeNixString</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">string -&gt; string</code> </h5></div>
</div></div>
<p> Turn a string into a Nix expression representing that string </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">s</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.escapeNixString usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
escapeNixString "hello\${}\n"
=&gt; "\"hello\\\${}\\n\""
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L396" target="_top" shape="rect">lib/strings.nix:396</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-escapeRegex"><code class="function">lib.strings.escapeRegex</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">string -&gt; string</code> </h5></div>
</div></div>
<p> Turn a string into an exact regular expression </p>
<div class="example">
<p class="title"><strong>Example:  lib.strings.escapeRegex usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
escapeRegex "[^a-z]*"
=&gt; "\\[\\^a-z]\\*"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L406" target="_top" shape="rect">lib/strings.nix:406</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-escapeNixIdentifier"><code class="function">lib.strings.escapeNixIdentifier</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">string -&gt; string</code> </h5></div>
</div></div>
<p> Quotes a string if it can't be used as an identifier directly. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">s</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.escapeNixIdentifier usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
escapeNixIdentifier "hello"
=&gt; "hello"
escapeNixIdentifier "0abc"
=&gt; "\"0abc\""
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L418" target="_top" shape="rect">lib/strings.nix:418</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-escapeXML"><code class="function">lib.strings.escapeXML</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">string -&gt; string</code> </h5></div>
</div></div>
<p> Escapes a string such that it is safe to include verbatim in an XML document. </p>
<div class="example">
<p class="title"><strong>Example:  lib.strings.escapeXML usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
escapeXML ''"test" 'test' &lt; &amp; &gt;''
=&gt; "&amp;quot;test&amp;quot; &amp;apos;test&amp;apos; &amp;lt; &amp;amp; &amp;gt;"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L432" target="_top" shape="rect">lib/strings.nix:432</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-toLower"><code class="function">lib.strings.toLower</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">toLower :: string -&gt; string</code> </h5></div>
</div></div>
<p> Converts an ASCII string to lower-case. </p>
<div class="example">
<p class="title"><strong>Example:  lib.strings.toLower usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
toLower "HOME"
=&gt; "home"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L462" target="_top" shape="rect">lib/strings.nix:462</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-toUpper"><code class="function">lib.strings.toUpper</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">toUpper :: string -&gt; string</code> </h5></div>
</div></div>
<p> Converts an ASCII string to upper-case. </p>
<div class="example">
<p class="title"><strong>Example:  lib.strings.toUpper usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
toUpper "home"
=&gt; "HOME"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L472" target="_top" shape="rect">lib/strings.nix:472</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-strings-addContextFrom"><code class="function">lib.strings.addContextFrom</code></h2></div></div></div>
<p> Appends string context from another string. This is an implementation detail of Nix. </p>
<p> Strings in Nix carry an invisible `context` which is a list of strings representing store paths. If the string is later used in a derivation attribute, the derivation will properly populate the inputDrvs and inputSrcs. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">a</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">b</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.addContextFrom usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
pkgs = import &lt;nixpkgs&gt; { };
addContextFrom pkgs.coreutils "bar"
=&gt; "bar"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L487" target="_top" shape="rect">lib/strings.nix:487</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-strings-splitString"><code class="function">lib.strings.splitString</code></h2></div></div></div>
<p> Cut a string with a separator and produces a list of strings which were separated by this separator. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">_sep</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">_s</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.splitString usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
splitString "." "foo.bar.baz"
=&gt; [ "foo" "bar" "baz" ]
splitString "/" "/usr/local/bin"
=&gt; [ "" "usr" "local" "bin" ]
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L498" target="_top" shape="rect">lib/strings.nix:498</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-removePrefix"><code class="function">lib.strings.removePrefix</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">string -&gt; string -&gt; string</code> </h5></div>
</div></div>
<p> Return a string without the specified prefix, if the prefix matches. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">prefix</code> </span></dt>
<dd><p> Prefix to remove if it matches </p></dd>
<dt><span class="term"> <code class="varname">str</code> </span></dt>
<dd><p> Input string </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.removePrefix usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
removePrefix "foo." "foo.bar.baz"
=&gt; "bar.baz"
removePrefix "xxx" "foo.bar.baz"
=&gt; "foo.bar.baz"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L516" target="_top" shape="rect">lib/strings.nix:516</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-removeSuffix"><code class="function">lib.strings.removeSuffix</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">string -&gt; string -&gt; string</code> </h5></div>
</div></div>
<p> Return a string without the specified suffix, if the suffix matches. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">suffix</code> </span></dt>
<dd><p> Suffix to remove if it matches </p></dd>
<dt><span class="term"> <code class="varname">str</code> </span></dt>
<dd><p> Input string </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.removeSuffix usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
removeSuffix "front" "homefront"
=&gt; "home"
removeSuffix "xxx" "homefront"
=&gt; "homefront"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L540" target="_top" shape="rect">lib/strings.nix:540</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-strings-versionOlder"><code class="function">lib.strings.versionOlder</code></h2></div></div></div>
<p> Return true if string v1 denotes a version older than v2. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">v1</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">v2</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.versionOlder usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
versionOlder "1.1" "1.2"
=&gt; true
versionOlder "1.1" "1.1"
=&gt; false
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L562" target="_top" shape="rect">lib/strings.nix:562</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-strings-versionAtLeast"><code class="function">lib.strings.versionAtLeast</code></h2></div></div></div>
<p> Return true if string v1 denotes a version equal to or newer than v2. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">v1</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">v2</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.versionAtLeast usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
versionAtLeast "1.1" "1.0"
=&gt; true
versionAtLeast "1.1" "1.1"
=&gt; true
versionAtLeast "1.1" "1.2"
=&gt; false
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L574" target="_top" shape="rect">lib/strings.nix:574</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-strings-getName"><code class="function">lib.strings.getName</code></h2></div></div></div>
<p> This function takes an argument that's either a derivation or a derivation's "name" attribute and extracts the name part from that argument. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">x</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.getName usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
getName "youtube-dl-2016.01.01"
=&gt; "youtube-dl"
getName pkgs.youtube-dl
=&gt; "youtube-dl"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L586" target="_top" shape="rect">lib/strings.nix:586</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-strings-getVersion"><code class="function">lib.strings.getVersion</code></h2></div></div></div>
<p> This function takes an argument that's either a derivation or a derivation's "name" attribute and extracts the version part from that argument. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">x</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.getVersion usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
getVersion "youtube-dl-2016.01.01"
=&gt; "2016.01.01"
getVersion pkgs.youtube-dl
=&gt; "2016.01.01"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L603" target="_top" shape="rect">lib/strings.nix:603</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-strings-nameFromURL"><code class="function">lib.strings.nameFromURL</code></h2></div></div></div>
<p> Extract name with version from URL. Ask for separator which is supposed to start extension. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">url</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">sep</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.nameFromURL usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
nameFromURL "https://nixos.org/releases/nix/nix-1.7/nix-1.7-x86_64-linux.tar.bz2" "-"
=&gt; "nix"
nameFromURL "https://nixos.org/releases/nix/nix-1.7/nix-1.7-x86_64-linux.tar.bz2" "_"
=&gt; "nix-1.7-x86"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L619" target="_top" shape="rect">lib/strings.nix:619</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-strings-enableFeature"><code class="function">lib.strings.enableFeature</code></h2></div></div></div>
<p> Create an --{enable,disable}-&lt;feat&gt; string that can be passed to standard GNU Autoconf scripts. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">enable</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">feat</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.enableFeature usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
enableFeature true "shared"
=&gt; "--enable-shared"
enableFeature false "shared"
=&gt; "--disable-shared"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L635" target="_top" shape="rect">lib/strings.nix:635</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-strings-enableFeatureAs"><code class="function">lib.strings.enableFeatureAs</code></h2></div></div></div>
<p> Create an --{enable-&lt;feat&gt;=&lt;value&gt;,disable-&lt;feat&gt;} string that can be passed to standard GNU Autoconf scripts. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">enable</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">feat</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">value</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.enableFeatureAs usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
enableFeatureAs true "shared" "foo"
=&gt; "--enable-shared=foo"
enableFeatureAs false "shared" (throw "ignored")
=&gt; "--disable-shared"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L648" target="_top" shape="rect">lib/strings.nix:648</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-strings-withFeature"><code class="function">lib.strings.withFeature</code></h2></div></div></div>
<p> Create an --{with,without}-&lt;feat&gt; string that can be passed to standard GNU Autoconf scripts. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">with_</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">feat</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.withFeature usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
withFeature true "shared"
=&gt; "--with-shared"
withFeature false "shared"
=&gt; "--without-shared"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L659" target="_top" shape="rect">lib/strings.nix:659</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-strings-withFeatureAs"><code class="function">lib.strings.withFeatureAs</code></h2></div></div></div>
<p> Create an --{with-&lt;feat&gt;=&lt;value&gt;,without-&lt;feat&gt;} string that can be passed to standard GNU Autoconf scripts. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">with_</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">feat</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">value</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.withFeatureAs usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
withFeatureAs true "shared" "foo"
=&gt; "--with-shared=foo"
withFeatureAs false "shared" (throw "ignored")
=&gt; "--without-shared"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L672" target="_top" shape="rect">lib/strings.nix:672</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-fixedWidthString"><code class="function">lib.strings.fixedWidthString</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">fixedWidthString :: int -&gt; string -&gt; string -&gt; string</code> </h5></div>
</div></div>
<p> Create a fixed width string with additional prefix to match required width. </p>
<p> This function will fail if the input string is longer than the requested length. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">width</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">filler</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">str</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.fixedWidthString usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
fixedWidthString 5 "0" (toString 15)
=&gt; "00015"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L686" target="_top" shape="rect">lib/strings.nix:686</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-strings-fixedWidthNumber"><code class="function">lib.strings.fixedWidthNumber</code></h2></div></div></div>
<p> Format a number adding leading zeroes up to fixed width. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">width</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">n</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.fixedWidthNumber usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
fixedWidthNumber 5 15
=&gt; "00015"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L703" target="_top" shape="rect">lib/strings.nix:703</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-strings-floatToString"><code class="function">lib.strings.floatToString</code></h2></div></div></div>
<p> Convert a float to a string, but emit a warning when precision is lost during the conversion </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">float</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.floatToString usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
floatToString 0.000001
=&gt; "0.000001"
floatToString 0.0000001
=&gt; trace: warning: Imprecise conversion from float to string 0.000000
"0.000000"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L715" target="_top" shape="rect">lib/strings.nix:715</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-strings-isCoercibleToString"><code class="function">lib.strings.isCoercibleToString</code></h2></div></div></div>
<p> Check whether a value can be coerced to a string </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">x</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L722" target="_top" shape="rect">lib/strings.nix:722</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-strings-isStorePath"><code class="function">lib.strings.isStorePath</code></h2></div></div></div>
<p> Check whether a value is a store path. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">x</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.isStorePath usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
isStorePath "/nix/store/d945ibfx9x185xf04b890y4f9g3cbb63-python-2.7.11/bin/python"
=&gt; false
isStorePath "/nix/store/d945ibfx9x185xf04b890y4f9g3cbb63-python-2.7.11"
=&gt; true
isStorePath pkgs.python
=&gt; true
isStorePath [] || isStorePath 42 || isStorePath {} || …
=&gt; false
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L740" target="_top" shape="rect">lib/strings.nix:740</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-toInt"><code class="function">lib.strings.toInt</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">string -&gt; int</code> </h5></div>
</div></div>
<p> Parse a string as an int. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">str</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.toInt usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
toInt "1337"
=&gt; 1337
toInt "-4"
=&gt; -4
toInt "3.14"
=&gt; error: floating point JSON numbers are not supported
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L761" target="_top" shape="rect">lib/strings.nix:761</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-strings-readPathsFromFile"><code class="function">lib.strings.readPathsFromFile</code></h2></div></div></div>
<p> Read a list of paths from `file`, relative to the `rootPath`. Lines beginning with `#` are treated as comments and ignored. Whitespace is significant. </p>
<p> NOTE: This function is not performant and should be avoided. </p>
<div class="example">
<p class="title"><strong>Example:  lib.strings.readPathsFromFile usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
readPathsFromFile /prefix
./pkgs/development/libraries/qt-5/5.4/qtbase/series
=&gt; [ "/prefix/dlopen-resolv.patch" "/prefix/tzdir.patch"
"/prefix/dlopen-libXcursor.patch" "/prefix/dlopen-openssl.patch"
"/prefix/dlopen-dbus.patch" "/prefix/xdg-config-dirs.patch"
"/prefix/nix-profiles-library-paths.patch"
"/prefix/compose-search-path.patch" ]
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L782" target="_top" shape="rect">lib/strings.nix:782</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-fileContents"><code class="function">lib.strings.fileContents</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">fileContents :: path -&gt; string</code> </h5></div>
</div></div>
<p> Read the contents of a file removing the trailing \n </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">file</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.fileContents usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
$ echo "1.0" &gt; ./version

fileContents ./version
=&gt; "1.0"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L802" target="_top" shape="rect">lib/strings.nix:802</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-sanitizeDerivationName"><code class="function">lib.strings.sanitizeDerivationName</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">sanitizeDerivationName :: String -&gt; String</code> </h5></div>
</div></div>
<p> Creates a valid derivation name from a potentially invalid one. </p>
<div class="example">
<p class="title"><strong>Example:  lib.strings.sanitizeDerivationName usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
sanitizeDerivationName "../hello.bar # foo"
=&gt; "-hello.bar-foo"
sanitizeDerivationName ""
=&gt; "unknown"
sanitizeDerivationName pkgs.hello
=&gt; "-nix-store-2g75chlbpxlrqn15zlby2dfh8hr9qwbk-hello-2.10"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L817" target="_top" shape="rect">lib/strings.nix:817</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-levenshtein"><code class="function">lib.strings.levenshtein</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">levenshtein :: string -&gt; string -&gt; int</code> </h5></div>
</div></div>
<p> Computes the Levenshtein distance between two strings. Complexity O(n*m) where n and m are the lengths of the strings. Algorithm adjusted from https://stackoverflow.com/a/9750974/6605742 </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">a</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">b</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.strings.levenshtein usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
levenshtein "foo" "foo"
=&gt; 0
levenshtein "book" "hook"
=&gt; 1
levenshtein "hello" "Heyo"
=&gt; 3
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L856" target="_top" shape="rect">lib/strings.nix:856</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-strings-commonPrefixLength"><code class="function">lib.strings.commonPrefixLength</code></h2></div></div></div>
<p> Returns the length of the prefix common to both strings. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">a</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">b</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L877" target="_top" shape="rect">lib/strings.nix:877</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-strings-commonSuffixLength"><code class="function">lib.strings.commonSuffixLength</code></h2></div></div></div>
<p> Returns the length of the suffix common to both strings. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">a</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">b</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L885" target="_top" shape="rect">lib/strings.nix:885</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-strings-levenshteinAtMost"><code class="function">lib.strings.levenshteinAtMost</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">levenshteinAtMost :: int -&gt; string -&gt; string -&gt; bool</code> </h5></div>
</div></div>
<p> Returns whether the levenshtein distance between two strings is at most some value Complexity is O(min(n,m)) for k &lt;= 2 and O(n*m) otherwise </p>
<div class="example">
<p class="title"><strong>Example:  lib.strings.levenshteinAtMost usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
levenshteinAtMost 0 "foo" "foo"
=&gt; true
levenshteinAtMost 1 "foo" "boa"
=&gt; false
levenshteinAtMost 2 "foo" "boa"
=&gt; true
levenshteinAtMost 2 "This is a sentence" "this is a sentense."
=&gt; false
levenshteinAtMost 3 "This is a sentence" "this is a sentense."
=&gt; true
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/strings.nix#L909" target="_top" shape="rect">lib/strings.nix:909</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-trivial-id"><code class="function">lib.trivial.id</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">id :: a -&gt; a</code> </h5></div>
</div></div>
<p> The identity function For when you need a function that does “nothing”. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">x</code> </span></dt>
<dd><p> The value to return </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L12" target="_top" shape="rect">lib/trivial.nix:12</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-trivial-const"><code class="function">lib.trivial.const</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">const :: a -&gt; b -&gt; a</code> </h5></div>
</div></div>
<p> The constant function </p>
<p> Ignores the second argument. If called with only one argument, constructs a function that always returns a static value. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">x</code> </span></dt>
<dd><p> Value to return </p></dd>
<dt><span class="term"> <code class="varname">y</code> </span></dt>
<dd><p> Value to ignore </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.trivial.const usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
let f = const 5; in f 10
=&gt; 5
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L26" target="_top" shape="rect">lib/trivial.nix:26</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-trivial-pipe"><code class="function">lib.trivial.pipe</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">pipe :: a -&gt; [&lt;functions&gt;] -&gt; &lt;return type of last function&gt;</code> </h5></div>
</div></div>
<p> Pipes a value through a list of functions, left to right. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">val</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">functions</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.trivial.pipe usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
pipe 2 [
(x: x + 2)  # 2 + 2 = 4
(x: x * 2)  # 4 * 2 = 8
]
=&gt; 8

# ideal to do text transformations
pipe [ "a/b" "a/c" ] [

# create the cp command
(map (file: ''cp "${src}/${file}" $out\n''))

# concatenate all commands into one string
lib.concatStrings

# make that string into a nix derivation
(pkgs.runCommand "copy-to-out" {})

]
=&gt; &lt;drv which copies all files to $out&gt;

The output type of each function has to be the input type
of the next function, and the last function returns the
final value.
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L61" target="_top" shape="rect">lib/trivial.nix:61</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-trivial-concat"><code class="function">lib.trivial.concat</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">concat :: [a] -&gt; [a] -&gt; [a]</code> </h5></div>
</div></div>
<p> Concatenate two lists </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">x</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">y</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.trivial.concat usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
concat [ 1 2 ] [ 3 4 ]
=&gt; [ 1 2 3 4 ]
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L80" target="_top" shape="rect">lib/trivial.nix:80</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-trivial-or"><code class="function">lib.trivial.or</code></h2></div></div></div>
<p> boolean “or” </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">x</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">y</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L83" target="_top" shape="rect">lib/trivial.nix:83</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-trivial-and"><code class="function">lib.trivial.and</code></h2></div></div></div>
<p> boolean “and” </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">x</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">y</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L86" target="_top" shape="rect">lib/trivial.nix:86</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-trivial-bitAnd"><code class="function">lib.trivial.bitAnd</code></h2></div></div></div>
<p> bitwise “and” </p>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L89" target="_top" shape="rect">lib/trivial.nix:89</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-trivial-bitOr"><code class="function">lib.trivial.bitOr</code></h2></div></div></div>
<p> bitwise “or” </p>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L94" target="_top" shape="rect">lib/trivial.nix:94</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-trivial-bitXor"><code class="function">lib.trivial.bitXor</code></h2></div></div></div>
<p> bitwise “xor” </p>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L99" target="_top" shape="rect">lib/trivial.nix:99</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-trivial-bitNot"><code class="function">lib.trivial.bitNot</code></h2></div></div></div>
<p> bitwise “not” </p>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L104" target="_top" shape="rect">lib/trivial.nix:104</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-trivial-boolToString"><code class="function">lib.trivial.boolToString</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">boolToString :: bool -&gt; string</code> </h5></div>
</div></div>
<p> Convert a boolean to a string. </p>
<p> This function uses the strings "true" and "false" to represent boolean values. Calling `toString` on a bool instead returns "1" and "" (sic!). </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">b</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L114" target="_top" shape="rect">lib/trivial.nix:114</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-trivial-mergeAttrs"><code class="function">lib.trivial.mergeAttrs</code></h2></div></div></div>
<p> Merge two attribute sets shallowly, right side trumps left </p>
<p> mergeAttrs :: attrs -&gt; attrs -&gt; attrs </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">x</code> </span></dt>
<dd><p> Left attribute set </p></dd>
<dt><span class="term"> <code class="varname">y</code> </span></dt>
<dd><p> Right attribute set (higher precedence for equal keys) </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.trivial.mergeAttrs usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
mergeAttrs { a = 1; b = 2; } { b = 3; c = 4; }
=&gt; { a = 1; b = 3; c = 4; }
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L124" target="_top" shape="rect">lib/trivial.nix:124</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-trivial-flip"><code class="function">lib.trivial.flip</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">flip :: (a -&gt; b -&gt; c) -&gt; (b -&gt; a -&gt; c)</code> </h5></div>
</div></div>
<p> Flip the order of the arguments of a binary function. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">f</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">a</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">b</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.trivial.flip usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
flip concat [1] [2]
=&gt; [ 2 1 ]
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L138" target="_top" shape="rect">lib/trivial.nix:138</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-trivial-mapNullable"><code class="function">lib.trivial.mapNullable</code></h2></div></div></div>
<p> Apply function if the supplied argument is non-null. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">f</code> </span></dt>
<dd><p> Function to call </p></dd>
<dt><span class="term"> <code class="varname">a</code> </span></dt>
<dd><p> Argument to check for null before passing it to `f` </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.trivial.mapNullable usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
mapNullable (x: x+1) null
=&gt; null
mapNullable (x: x+1) 22
=&gt; 23
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L148" target="_top" shape="rect">lib/trivial.nix:148</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-trivial-version"><code class="function">lib.trivial.version</code></h2></div></div></div>
<p> Returns the current full nixpkgs version number. </p>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L164" target="_top" shape="rect">lib/trivial.nix:164</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-trivial-release"><code class="function">lib.trivial.release</code></h2></div></div></div>
<p> Returns the current nixpkgs release number as string. </p>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L167" target="_top" shape="rect">lib/trivial.nix:167</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-trivial-oldestSupportedRelease"><code class="function">lib.trivial.oldestSupportedRelease</code></h2></div></div></div>
<p> The latest release that is supported, at the time of release branch-off, if applicable. </p>
<p> Ideally, out-of-tree modules should be able to evaluate cleanly with all supported Nixpkgs versions (master, release and old release until EOL). So if possible, deprecation warnings should take effect only when all out-of-tree expressions/libs/modules can upgrade to the new way without losing support for supported Nixpkgs versions. </p>
<p> This release number allows deprecation warnings to be implemented such that they take effect as soon as the oldest release reaches end of life. </p>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L180" target="_top" shape="rect">lib/trivial.nix:180</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-trivial-isInOldestRelease"><code class="function">lib.trivial.isInOldestRelease</code></h2></div></div></div>
<p> Whether a feature is supported in all supported releases (at the time of release branch-off, if applicable). See `oldestSupportedRelease`. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">release</code> </span></dt>
<dd><p> Release number of feature introduction as an integer, e.g. 2111 for 21.11. Set it to the upcoming release, matching the nixpkgs/.version file. </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L186" target="_top" shape="rect">lib/trivial.nix:186</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-trivial-codeName"><code class="function">lib.trivial.codeName</code></h2></div></div></div>
<p> Returns the current nixpkgs release code name. </p>
<p> On each release the first letter is bumped and a new animal is chosen starting with that new letter. </p>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L198" target="_top" shape="rect">lib/trivial.nix:198</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-trivial-versionSuffix"><code class="function">lib.trivial.versionSuffix</code></h2></div></div></div>
<p> Returns the current nixpkgs version suffix as string. </p>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L201" target="_top" shape="rect">lib/trivial.nix:201</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-trivial-revisionWithDefault"><code class="function">lib.trivial.revisionWithDefault</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">revisionWithDefault :: string -&gt; string</code> </h5></div>
</div></div>
<p> Attempts to return the the current revision of nixpkgs and returns the supplied default value otherwise. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">default</code> </span></dt>
<dd><p> Default value to return if revision can not be determined </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L212" target="_top" shape="rect">lib/trivial.nix:212</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-trivial-inNixShell"><code class="function">lib.trivial.inNixShell</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">inNixShell :: bool</code> </h5></div>
</div></div>
<p> Determine whether the function is being called from inside a Nix shell. </p>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L230" target="_top" shape="rect">lib/trivial.nix:230</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-trivial-min"><code class="function">lib.trivial.min</code></h2></div></div></div>
<p> Return minimum of two numbers. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">x</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">y</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L236" target="_top" shape="rect">lib/trivial.nix:236</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-trivial-max"><code class="function">lib.trivial.max</code></h2></div></div></div>
<p> Return maximum of two numbers. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">x</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">y</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L239" target="_top" shape="rect">lib/trivial.nix:239</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-trivial-mod"><code class="function">lib.trivial.mod</code></h2></div></div></div>
<p> Integer modulus </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">base</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">int</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.trivial.mod usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
mod 11 10
=&gt; 1
mod 1 10
=&gt; 1
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L249" target="_top" shape="rect">lib/trivial.nix:249</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-trivial-compare"><code class="function">lib.trivial.compare</code></h2></div></div></div>
<p> C-style comparisons </p>
<p> a &lt; b, compare a b =&gt; -1 a == b, compare a b =&gt; 0 a &gt; b, compare a b =&gt; 1 </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">a</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">b</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L260" target="_top" shape="rect">lib/trivial.nix:260</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-trivial-splitByAndCompare"><code class="function">lib.trivial.splitByAndCompare</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">(a -&gt; bool) -&gt; (a -&gt; a -&gt; int) -&gt; (a -&gt; a -&gt; int) -&gt; (a -&gt; a -&gt; int)</code> </h5></div>
</div></div>
<p> Split type into two subtypes by predicate `p`, take all elements of the first subtype to be less than all the elements of the second subtype, compare elements of a single subtype with `yes` and `no` respectively. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">p</code> </span></dt>
<dd><p> Predicate </p></dd>
<dt><span class="term"> <code class="varname">yes</code> </span></dt>
<dd><p> Comparison function if predicate holds for both values </p></dd>
<dt><span class="term"> <code class="varname">no</code> </span></dt>
<dd><p> Comparison function if predicate holds for neither value </p></dd>
<dt><span class="term"> <code class="varname">a</code> </span></dt>
<dd><p> First value to compare </p></dd>
<dt><span class="term"> <code class="varname">b</code> </span></dt>
<dd><p> Second value to compare </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.trivial.splitByAndCompare usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
let cmp = splitByAndCompare (hasPrefix "foo") compare compare; in

cmp "a" "z" =&gt; -1
cmp "fooa" "fooz" =&gt; -1

cmp "f" "a" =&gt; 1
cmp "fooa" "a" =&gt; -1
# while
compare "fooa" "a" =&gt; 1
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L285" target="_top" shape="rect">lib/trivial.nix:285</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-trivial-importJSON"><code class="function">lib.trivial.importJSON</code></h2></div></div></div>
<p> Reads a JSON file. </p>
<p> Type :: path -&gt; any </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">path</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L305" target="_top" shape="rect">lib/trivial.nix:305</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-trivial-importTOML"><code class="function">lib.trivial.importTOML</code></h2></div></div></div>
<p> Reads a TOML file. </p>
<p> Type :: path -&gt; any </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">path</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L312" target="_top" shape="rect">lib/trivial.nix:312</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-trivial-warn"><code class="function">lib.trivial.warn</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">string -&gt; a -&gt; a</code> </h5></div>
</div></div>
<p> Print a warning before returning the second argument. This function behaves like `builtins.trace`, but requires a string message and formats it as a warning, including the `warning: ` prefix. </p>
<p> To get a call stack trace and abort evaluation, set the environment variable `NIX_ABORT_ON_WARN=true` and set the Nix options `--option pure-eval false --show-trace` </p>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L340" target="_top" shape="rect">lib/trivial.nix:340</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-trivial-warnIf"><code class="function">lib.trivial.warnIf</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">bool -&gt; string -&gt; a -&gt; a</code> </h5></div>
</div></div>
<p> Like warn, but only warn when the first argument is `true`. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">cond</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">msg</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L350" target="_top" shape="rect">lib/trivial.nix:350</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-trivial-warnIfNot"><code class="function">lib.trivial.warnIfNot</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">bool -&gt; string -&gt; a -&gt; a</code> </h5></div>
</div></div>
<p> Like warnIf, but negated (warn if the first argument is `false`). </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">cond</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">msg</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L357" target="_top" shape="rect">lib/trivial.nix:357</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-trivial-throwIfNot"><code class="function">lib.trivial.throwIfNot</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">bool -&gt; string -&gt; a -&gt; a</code> </h5></div>
</div></div>
<p> Like the `assert b; e` expression, but with a custom error message and without the semicolon. </p>
<p> If true, return the identity function, `r: r`. </p>
<p> If false, throw the error message. </p>
<p> Calls can be juxtaposed using function application, as `(r: r) a = a`, so `(r: r) (r: r) a = a`, and so forth. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">cond</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">msg</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.trivial.throwIfNot usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">

throwIfNot (lib.isList overlays) "The overlays argument to nixpkgs must be a list."
lib.foldr (x: throwIfNot (lib.isFunction x) "All overlays passed to nixpkgs must be functions.") (r: r) overlays
pkgs
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L379" target="_top" shape="rect">lib/trivial.nix:379</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-trivial-throwIf"><code class="function">lib.trivial.throwIf</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">bool -&gt; string -&gt; a -&gt; a</code> </h5></div>
</div></div>
<p> Like throwIfNot, but negated (throw if the first argument is `true`). </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">cond</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">msg</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L386" target="_top" shape="rect">lib/trivial.nix:386</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-trivial-checkListOfEnum"><code class="function">lib.trivial.checkListOfEnum</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">String -&gt; List ComparableVal -&gt; List ComparableVal -&gt; a -&gt; a</code> </h5></div>
</div></div>
<p> Check if the elements in a list are valid values from a enum, returning the identity function, or throwing an error message otherwise. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">msg</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">valid</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">given</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.trivial.checkListOfEnum usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
let colorVariants = ["bright" "dark" "black"]
in checkListOfEnum "color variants" [ "standard" "light" "dark" ] colorVariants;
=&gt;
error: color variants: bright, black unexpected; valid ones: standard, light, dark

</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L398" target="_top" shape="rect">lib/trivial.nix:398</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-trivial-setFunctionArgs"><code class="function">lib.trivial.setFunctionArgs</code></h2></div></div></div>
<p> Add metadata about expected function arguments to a function. The metadata should match the format given by builtins.functionArgs, i.e. a set from expected argument to a bool representing whether that argument has a default or not. setFunctionArgs : (a → b) → Map String Bool → (a → b) </p>
<p> This function is necessary because you can't dynamically create a function of the { a, b ? foo, ... }: format, but some facilities like callPackage expect to be able to query expected arguments. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">f</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">args</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L421" target="_top" shape="rect">lib/trivial.nix:421</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-trivial-functionArgs"><code class="function">lib.trivial.functionArgs</code></h2></div></div></div>
<p> Extract the expected function arguments from a function. This works both with nix-native { a, b ? foo, ... }: style functions and functions with args set with 'setFunctionArgs'. It has the same return type and semantics as builtins.functionArgs. setFunctionArgs : (a → b) → Map String Bool. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">f</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L433" target="_top" shape="rect">lib/trivial.nix:433</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-trivial-isFunction"><code class="function">lib.trivial.isFunction</code></h2></div></div></div>
<p> Check whether something is a function or something annotated with function args. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">f</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L441" target="_top" shape="rect">lib/trivial.nix:441</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-trivial-toFunction"><code class="function">lib.trivial.toFunction</code></h2></div></div></div>
<p> Turns any non-callable values into constant functions. Returns callable values as is. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">v</code> </span></dt>
<dd><p> Any value </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.trivial.toFunction usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">

nix-repl&gt; lib.toFunction 1 2
1

nix-repl&gt; lib.toFunction (x: x + 1) 2
3
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L456" target="_top" shape="rect">lib/trivial.nix:456</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-trivial-toHexString"><code class="function">lib.trivial.toHexString</code></h2></div></div></div>
<p> Convert the given positive integer to a string of its hexadecimal representation. For example: </p>
<p> toHexString 0 =&gt; "0" </p>
<p> toHexString 16 =&gt; "10" </p>
<p> toHexString 250 =&gt; "FA" </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">i</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L472" target="_top" shape="rect">lib/trivial.nix:472</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-trivial-toBaseDigits"><code class="function">lib.trivial.toBaseDigits</code></h2></div></div></div>
<p> `toBaseDigits base i` converts the positive integer i to a list of its digits in the given base. For example: </p>
<p> toBaseDigits 10 123 =&gt; [ 1 2 3 ] </p>
<p> toBaseDigits 2 6 =&gt; [ 1 1 0 ] </p>
<p> toBaseDigits 16 250 =&gt; [ 15 10 ] </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">base</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">i</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/trivial.nix#L498" target="_top" shape="rect">lib/trivial.nix:498</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-lists-singleton"><code class="function">lib.lists.singleton</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">singleton :: a -&gt; [a]</code> </h5></div>
</div></div>
<p> Create a list consisting of a single element. `singleton x` is sometimes more convenient with respect to indentation than `[x]` when x spans multiple lines. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">x</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.lists.singleton usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
singleton "foo"
=&gt; [ "foo" ]
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L23" target="_top" shape="rect">lib/lists.nix:23</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-lists-forEach"><code class="function">lib.lists.forEach</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">forEach :: [a] -&gt; (a -&gt; b) -&gt; [b]</code> </h5></div>
</div></div>
<p> Apply the function to each element in the list. Same as `map`, but arguments flipped. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">xs</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">f</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.lists.forEach usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
forEach [ 1 2 ] (x:
toString x
)
=&gt; [ "1" "2" ]
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L36" target="_top" shape="rect">lib/lists.nix:36</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-lists-foldr"><code class="function">lib.lists.foldr</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b</code> </h5></div>
</div></div>
<p> “right fold” a binary function `op` between successive elements of `list` with `nul' as the starting value, i.e., `foldr op nul [x_1 x_2 ... x_n] == op x_1 (op x_2 ... (op x_n nul))`. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">op</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">nul</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">list</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.lists.foldr usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
concat = foldr (a: b: a + b) "z"
concat [ "a" "b" "c" ]
=&gt; "abcz"
# different types
strange = foldr (int: str: toString (int + 1) + str) "a"
strange [ 1 2 3 4 ]
=&gt; "2345a"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L53" target="_top" shape="rect">lib/lists.nix:53</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-lists-fold"><code class="function">lib.lists.fold</code></h2></div></div></div>
<p> `fold` is an alias of `foldr` for historic reasons </p>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L64" target="_top" shape="rect">lib/lists.nix:64</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-lists-foldl"><code class="function">lib.lists.foldl</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">foldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b</code> </h5></div>
</div></div>
<p> “left fold”, like `foldr`, but from the left: `foldl op nul [x_1 x_2 ... x_n] == op (... (op (op nul x_1) x_2) ... x_n)`. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">op</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">nul</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">list</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.lists.foldl usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
lconcat = foldl (a: b: a + b) "z"
lconcat [ "a" "b" "c" ]
=&gt; "zabc"
# different types
lstrange = foldl (str: int: str + toString (int + 1)) "a"
lstrange [ 1 2 3 4 ]
=&gt; "a2345"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L81" target="_top" shape="rect">lib/lists.nix:81</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-lists-foldl-"><code class="function">lib.lists.foldl'</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">foldl' :: (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b</code> </h5></div>
</div></div>
<p> Strict version of `foldl`. </p>
<p> The difference is that evaluation is forced upon access. Usually used with small whole results (in contrast with lazily-generated list or large lists where only a part is consumed.) </p>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L97" target="_top" shape="rect">lib/lists.nix:97</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-lists-imap0"><code class="function">lib.lists.imap0</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">imap0 :: (int -&gt; a -&gt; b) -&gt; [a] -&gt; [b]</code> </h5></div>
</div></div>
<p> Map with index starting from 0 </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">f</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">list</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.lists.imap0 usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
imap0 (i: v: "${v}-${toString i}") ["a" "b"]
=&gt; [ "a-0" "b-1" ]
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L107" target="_top" shape="rect">lib/lists.nix:107</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-lists-imap1"><code class="function">lib.lists.imap1</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">imap1 :: (int -&gt; a -&gt; b) -&gt; [a] -&gt; [b]</code> </h5></div>
</div></div>
<p> Map with index starting from 1 </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">f</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">list</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.lists.imap1 usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
imap1 (i: v: "${v}-${toString i}") ["a" "b"]
=&gt; [ "a-1" "b-2" ]
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L117" target="_top" shape="rect">lib/lists.nix:117</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-lists-concatMap"><code class="function">lib.lists.concatMap</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">concatMap :: (a -&gt; [b]) -&gt; [a] -&gt; [b]</code> </h5></div>
</div></div>
<p> Map and concatenate the result. </p>
<div class="example">
<p class="title"><strong>Example:  lib.lists.concatMap usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
concatMap (x: [x] ++ ["z"]) ["a" "b"]
=&gt; [ "a" "z" "b" "z" ]
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L127" target="_top" shape="rect">lib/lists.nix:127</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-lists-flatten"><code class="function">lib.lists.flatten</code></h2></div></div></div>
<p> Flatten the argument into a single list; that is, nested lists are spliced into the top-level lists. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">x</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.lists.flatten usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
flatten [1 [2 [3] 4] 5]
=&gt; [1 2 3 4 5]
flatten 1
=&gt; [1]
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L138" target="_top" shape="rect">lib/lists.nix:138</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-lists-remove"><code class="function">lib.lists.remove</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">remove :: a -&gt; [a] -&gt; [a]</code> </h5></div>
</div></div>
<p> Remove elements equal to 'e' from a list. Useful for buildInputs. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">e</code> </span></dt>
<dd><p> Element to remove from the list </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.lists.remove usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
remove 3 [ 1 3 4 3 ]
=&gt; [ 1 4 ]
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L151" target="_top" shape="rect">lib/lists.nix:151</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-lists-findSingle"><code class="function">lib.lists.findSingle</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">findSingle :: (a -&gt; bool) -&gt; a -&gt; a -&gt; [a] -&gt; a</code> </h5></div>
</div></div>
<p> Find the sole element in the list matching the specified predicate, returns `default` if no such element exists, or `multiple` if there are multiple matching elements. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">pred</code> </span></dt>
<dd><p> Predicate </p></dd>
<dt><span class="term"> <code class="varname">default</code> </span></dt>
<dd><p> Default value to return if element was not found. </p></dd>
<dt><span class="term"> <code class="varname">multiple</code> </span></dt>
<dd><p> Default value to return if more than one element was found </p></dd>
<dt><span class="term"> <code class="varname">list</code> </span></dt>
<dd><p> Input list </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.lists.findSingle usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
findSingle (x: x == 3) "none" "multiple" [ 1 3 3 ]
=&gt; "multiple"
findSingle (x: x == 3) "none" "multiple" [ 1 3 ]
=&gt; 3
findSingle (x: x == 3) "none" "multiple" [ 1 9 ]
=&gt; "none"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L169" target="_top" shape="rect">lib/lists.nix:169</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-lists-findFirst"><code class="function">lib.lists.findFirst</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">findFirst :: (a -&gt; bool) -&gt; a -&gt; [a] -&gt; a</code> </h5></div>
</div></div>
<p> Find the first element in the list matching the specified predicate or return `default` if no such element exists. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">pred</code> </span></dt>
<dd><p> Predicate </p></dd>
<dt><span class="term"> <code class="varname">default</code> </span></dt>
<dd><p> Default value to return </p></dd>
<dt><span class="term"> <code class="varname">list</code> </span></dt>
<dd><p> Input list </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.lists.findFirst usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
findFirst (x: x &gt; 3) 7 [ 1 6 4 ]
=&gt; 6
findFirst (x: x &gt; 9) 7 [ 1 6 4 ]
=&gt; 7
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L194" target="_top" shape="rect">lib/lists.nix:194</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-lists-any"><code class="function">lib.lists.any</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">any :: (a -&gt; bool) -&gt; [a] -&gt; bool</code> </h5></div>
</div></div>
<p> Return true if function `pred` returns true for at least one element of `list`. </p>
<div class="example">
<p class="title"><strong>Example:  lib.lists.any usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
any isString [ 1 "a" { } ]
=&gt; true
any isString [ 1 { } ]
=&gt; false
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L215" target="_top" shape="rect">lib/lists.nix:215</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-lists-all"><code class="function">lib.lists.all</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">all :: (a -&gt; bool) -&gt; [a] -&gt; bool</code> </h5></div>
</div></div>
<p> Return true if function `pred` returns true for all elements of `list`. </p>
<div class="example">
<p class="title"><strong>Example:  lib.lists.all usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
all (x: x &lt; 3) [ 1 2 ]
=&gt; true
all (x: x &lt; 3) [ 1 2 3 ]
=&gt; false
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L228" target="_top" shape="rect">lib/lists.nix:228</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-lists-count"><code class="function">lib.lists.count</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">count :: (a -&gt; bool) -&gt; [a] -&gt; int</code> </h5></div>
</div></div>
<p> Count how many elements of `list` match the supplied predicate function. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">pred</code> </span></dt>
<dd><p> Predicate </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.lists.count usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
count (x: x == 3) [ 3 2 3 4 6 ]
=&gt; 2
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L239" target="_top" shape="rect">lib/lists.nix:239</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-lists-optional"><code class="function">lib.lists.optional</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">optional :: bool -&gt; a -&gt; [a]</code> </h5></div>
</div></div>
<p> Return a singleton list or an empty list, depending on a boolean value. Useful when building lists with optional elements (e.g. `++ optional (system == "i686-linux") firefox'). </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">cond</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">elem</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.lists.optional usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
optional true "foo"
=&gt; [ "foo" ]
optional false "foo"
=&gt; [ ]
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L255" target="_top" shape="rect">lib/lists.nix:255</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-lists-optionals"><code class="function">lib.lists.optionals</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">optionals :: bool -&gt; [a] -&gt; [a]</code> </h5></div>
</div></div>
<p> Return a list or an empty list, depending on a boolean value. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">cond</code> </span></dt>
<dd><p> Condition </p></dd>
<dt><span class="term"> <code class="varname">elems</code> </span></dt>
<dd><p> List to return if condition is true </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.lists.optionals usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
optionals true [ 2 3 ]
=&gt; [ 2 3 ]
optionals false [ 2 3 ]
=&gt; [ ]
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L267" target="_top" shape="rect">lib/lists.nix:267</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-lists-toList"><code class="function">lib.lists.toList</code></h2></div></div></div>
<p> If argument is a list, return it; else, wrap it in a singleton list. If you're using this, you should almost certainly reconsider if there isn't a more "well-typed" approach. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">x</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.lists.toList usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
toList [ 1 2 ]
=&gt; [ 1 2 ]
toList "hi"
=&gt; [ "hi "]
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L284" target="_top" shape="rect">lib/lists.nix:284</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-lists-range"><code class="function">lib.lists.range</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">range :: int -&gt; int -&gt; [int]</code> </h5></div>
</div></div>
<p> Return a list of integers from `first' up to and including `last'. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">first</code> </span></dt>
<dd><p> First integer in the range </p></dd>
<dt><span class="term"> <code class="varname">last</code> </span></dt>
<dd><p> Last integer in the range </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.lists.range usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
range 2 4
=&gt; [ 2 3 4 ]
range 3 2
=&gt; [ ]
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L296" target="_top" shape="rect">lib/lists.nix:296</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-lists-partition"><code class="function">lib.lists.partition</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">(a -&gt; bool) -&gt; [a] -&gt; { right :: [a], wrong :: [a] }</code> </h5></div>
</div></div>
<p> Splits the elements of a list in two lists, `right` and `wrong`, depending on the evaluation of a predicate. </p>
<div class="example">
<p class="title"><strong>Example:  lib.lists.partition usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
partition (x: x &gt; 2) [ 5 1 2 3 4 ]
=&gt; { right = [ 5 3 4 ]; wrong = [ 1 2 ]; }
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L315" target="_top" shape="rect">lib/lists.nix:315</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-lists-groupBy-"><code class="function">lib.lists.groupBy'</code></h2></div></div></div>
<p> Splits the elements of a list into many lists, using the return value of a predicate. Predicate should return a string which becomes keys of attrset `groupBy' returns. </p>
<p> `groupBy'` allows to customise the combining function and initial value </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">op</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">nul</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">pred</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">lst</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.lists.groupBy' usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
groupBy (x: boolToString (x &gt; 2)) [ 5 1 2 3 4 ]
=&gt; { true = [ 5 3 4 ]; false = [ 1 2 ]; }
groupBy (x: x.name) [ {name = "icewm"; script = "icewm &amp;";}
{name = "xfce";  script = "xfce4-session &amp;";}
{name = "icewm"; script = "icewmbg &amp;";}
{name = "mate";  script = "gnome-session &amp;";}
]
=&gt; { icewm = [ { name = "icewm"; script = "icewm &amp;"; }
{ name = "icewm"; script = "icewmbg &amp;"; } ];
mate  = [ { name = "mate";  script = "gnome-session &amp;"; } ];
xfce  = [ { name = "xfce";  script = "xfce4-session &amp;"; } ];
}

groupBy' builtins.add 0 (x: boolToString (x &gt; 2)) [ 5 1 2 3 4 ]
=&gt; { true = 12; false = 3; }
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L344" target="_top" shape="rect">lib/lists.nix:344</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-lists-zipListsWith"><code class="function">lib.lists.zipListsWith</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">zipListsWith :: (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]</code> </h5></div>
</div></div>
<p> Merges two lists of the same size together. If the sizes aren't the same the merging stops at the shortest. How both lists are merged is defined by the first argument. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">f</code> </span></dt>
<dd><p> Function to zip elements of both lists </p></dd>
<dt><span class="term"> <code class="varname">fst</code> </span></dt>
<dd><p> First list </p></dd>
<dt><span class="term"> <code class="varname">snd</code> </span></dt>
<dd><p> Second list </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.lists.zipListsWith usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
zipListsWith (a: b: a + b) ["h" "l"] ["e" "o"]
=&gt; ["he" "lo"]
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L364" target="_top" shape="rect">lib/lists.nix:364</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-lists-zipLists"><code class="function">lib.lists.zipLists</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">zipLists :: [a] -&gt; [b] -&gt; [{ fst :: a, snd :: b}]</code> </h5></div>
</div></div>
<p> Merges two lists of the same size together. If the sizes aren't the same the merging stops at the shortest. </p>
<div class="example">
<p class="title"><strong>Example:  lib.lists.zipLists usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
zipLists [ 1 2 ] [ "a" "b" ]
=&gt; [ { fst = 1; snd = "a"; } { fst = 2; snd = "b"; } ]
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L383" target="_top" shape="rect">lib/lists.nix:383</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-lists-reverseList"><code class="function">lib.lists.reverseList</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">reverseList :: [a] -&gt; [a]</code> </h5></div>
</div></div>
<p> Reverse the order of the elements of a list. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">xs</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.lists.reverseList usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">

reverseList [ "b" "o" "j" ]
=&gt; [ "j" "o" "b" ]
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L394" target="_top" shape="rect">lib/lists.nix:394</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-lists-listDfs"><code class="function">lib.lists.listDfs</code></h2></div></div></div>
<p> Depth-First Search (DFS) for lists `list != []`. </p>
<p> `before a b == true` means that `b` depends on `a` (there's an edge from `b` to `a`). </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">stopOnCycles</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">before</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">list</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.lists.listDfs usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
listDfs true hasPrefix [ "/home/user" "other" "/" "/home" ]
== { minimal = "/";                  # minimal element
visited = [ "/home/user" ];     # seen elements (in reverse order)
rest    = [ "/home" "other" ];  # everything else
}

listDfs true hasPrefix [ "/home/user" "other" "/" "/home" "/" ]
== { cycle   = "/";                  # cycle encountered at this element
loops   = [ "/" ];              # and continues to these elements
visited = [ "/" "/home/user" ]; # elements leading to the cycle (in reverse order)
rest    = [ "/home" "other" ];  # everything else
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L416" target="_top" shape="rect">lib/lists.nix:416</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-lists-toposort"><code class="function">lib.lists.toposort</code></h2></div></div></div>
<p> Sort a list based on a partial ordering using DFS. This implementation is O(N^2), if your ordering is linear, use `sort` instead. </p>
<p> `before a b == true` means that `b` should be after `a` in the result. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">before</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">list</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.lists.toposort usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">

toposort hasPrefix [ "/home/user" "other" "/" "/home" ]
== { result = [ "/" "/home" "/home/user" "other" ]; }

toposort hasPrefix [ "/home/user" "other" "/" "/home" "/" ]
== { cycle = [ "/home/user" "/" "/" ]; # path leading to a cycle
loops = [ "/" ]; }                # loops back to these elements

toposort hasPrefix [ "other" "/home/user" "/home" "/" ]
== { result = [ "other" "/" "/home" "/home/user" ]; }

toposort (a: b: a &lt; b) [ 3 2 1 ] == { result = [ 1 2 3 ]; }
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L455" target="_top" shape="rect">lib/lists.nix:455</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-lists-sort"><code class="function">lib.lists.sort</code></h2></div></div></div>
<p> Sort a list based on a comparator function which compares two elements and returns true if the first argument is strictly below the second argument. The returned list is sorted in an increasing order. The implementation does a quick-sort. </p>
<div class="example">
<p class="title"><strong>Example:  lib.lists.sort usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
sort (a: b: a &lt; b) [ 5 3 7 ]
=&gt; [ 3 5 7 ]
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L483" target="_top" shape="rect">lib/lists.nix:483</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-lists-compareLists"><code class="function">lib.lists.compareLists</code></h2></div></div></div>
<p> Compare two lists element-by-element. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">cmp</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">a</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">b</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.lists.compareLists usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
compareLists compare [] []
=&gt; 0
compareLists compare [] [ "a" ]
=&gt; -1
compareLists compare [ "a" ] []
=&gt; 1
compareLists compare [ "a" "b" ] [ "a" "c" ]
=&gt; 1
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L512" target="_top" shape="rect">lib/lists.nix:512</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-lists-naturalSort"><code class="function">lib.lists.naturalSort</code></h2></div></div></div>
<p> Sort list using "Natural sorting". Numeric portions of strings are sorted in numeric order. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">lst</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.lists.naturalSort usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
naturalSort ["disk11" "disk8" "disk100" "disk9"]
=&gt; ["disk8" "disk9" "disk11" "disk100"]
naturalSort ["10.46.133.149" "10.5.16.62" "10.54.16.25"]
=&gt; ["10.5.16.62" "10.46.133.149" "10.54.16.25"]
naturalSort ["v0.2" "v0.15" "v0.0.9"]
=&gt; [ "v0.0.9" "v0.2" "v0.15" ]
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L535" target="_top" shape="rect">lib/lists.nix:535</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-lists-take"><code class="function">lib.lists.take</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">take :: int -&gt; [a] -&gt; [a]</code> </h5></div>
</div></div>
<p> Return the first (at most) N elements of a list. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">count</code> </span></dt>
<dd><p> Number of elements to take </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.lists.take usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
take 2 [ "a" "b" "c" "d" ]
=&gt; [ "a" "b" ]
take 2 [ ]
=&gt; [ ]
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L553" target="_top" shape="rect">lib/lists.nix:553</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-lists-drop"><code class="function">lib.lists.drop</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">drop :: int -&gt; [a] -&gt; [a]</code> </h5></div>
</div></div>
<p> Remove the first (at most) N elements of a list. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">count</code> </span></dt>
<dd><p> Number of elements to drop </p></dd>
<dt><span class="term"> <code class="varname">list</code> </span></dt>
<dd><p> Input list </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.lists.drop usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
drop 2 [ "a" "b" "c" "d" ]
=&gt; [ "c" "d" ]
drop 2 [ ]
=&gt; [ ]
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L567" target="_top" shape="rect">lib/lists.nix:567</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-lists-sublist"><code class="function">lib.lists.sublist</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">sublist :: int -&gt; int -&gt; [a] -&gt; [a]</code> </h5></div>
</div></div>
<p> Return a list consisting of at most `count` elements of `list`, starting at index `start`. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">start</code> </span></dt>
<dd><p> Index at which to start the sublist </p></dd>
<dt><span class="term"> <code class="varname">count</code> </span></dt>
<dd><p> Number of elements to take </p></dd>
<dt><span class="term"> <code class="varname">list</code> </span></dt>
<dd><p> Input list </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.lists.sublist usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
sublist 1 3 [ "a" "b" "c" "d" "e" ]
=&gt; [ "b" "c" "d" ]
sublist 1 3 [ ]
=&gt; [ ]
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L584" target="_top" shape="rect">lib/lists.nix:584</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-lists-last"><code class="function">lib.lists.last</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">last :: [a] -&gt; a</code> </h5></div>
</div></div>
<p> Return the last element of a list. </p>
<p> This function throws an error if the list is empty. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">list</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.lists.last usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
last [ 1 2 3 ]
=&gt; 3
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L608" target="_top" shape="rect">lib/lists.nix:608</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-lists-init"><code class="function">lib.lists.init</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">init :: [a] -&gt; [a]</code> </h5></div>
</div></div>
<p> Return all elements but the last. </p>
<p> This function throws an error if the list is empty. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">list</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.lists.init usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
init [ 1 2 3 ]
=&gt; [ 1 2 ]
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L622" target="_top" shape="rect">lib/lists.nix:622</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-lists-crossLists"><code class="function">lib.lists.crossLists</code></h2></div></div></div>
<p> Return the image of the cross product of some lists by a function. </p>
<div class="example">
<p class="title"><strong>Example:  lib.lists.crossLists usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
crossLists (x:y: "${toString x}${toString y}") [[1 2] [3 4]]
=&gt; [ "13" "14" "23" "24" ]
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L633" target="_top" shape="rect">lib/lists.nix:633</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-lists-unique"><code class="function">lib.lists.unique</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">unique :: [a] -&gt; [a]</code> </h5></div>
</div></div>
<p> Remove duplicate elements from the list. O(n^2) complexity. </p>
<div class="example">
<p class="title"><strong>Example:  lib.lists.unique usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
unique [ 3 2 3 4 ]
=&gt; [ 3 2 4 ]
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L646" target="_top" shape="rect">lib/lists.nix:646</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-lists-intersectLists"><code class="function">lib.lists.intersectLists</code></h2></div></div></div>
<p> Intersects list 'e' and another list. O(nm) complexity. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">e</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.lists.intersectLists usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
intersectLists [ 1 2 3 ] [ 6 3 2 ]
=&gt; [ 3 2 ]
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L654" target="_top" shape="rect">lib/lists.nix:654</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-lists-subtractLists"><code class="function">lib.lists.subtractLists</code></h2></div></div></div>
<p> Subtracts list 'e' from another list. O(nm) complexity. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">e</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.lists.subtractLists usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
subtractLists [ 3 2 ] [ 1 2 3 4 5 3 ]
=&gt; [ 1 4 5 ]
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L662" target="_top" shape="rect">lib/lists.nix:662</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-lists-mutuallyExclusive"><code class="function">lib.lists.mutuallyExclusive</code></h2></div></div></div>
<p> Test if two lists have no common element. It should be slightly more efficient than (intersectLists a b == []) </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">a</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">b</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/lists.nix#L667" target="_top" shape="rect">lib/lists.nix:667</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-debug-traceIf"><code class="function">lib.debug.traceIf</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">traceIf :: bool -&gt; string -&gt; a -&gt; a</code> </h5></div>
</div></div>
<p> Conditionally trace the supplied message, based on a predicate. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">pred</code> </span></dt>
<dd><p> Predicate to check </p></dd>
<dt><span class="term"> <code class="varname">msg</code> </span></dt>
<dd><p> Message that should be traced </p></dd>
<dt><span class="term"> <code class="varname">x</code> </span></dt>
<dd><p> Value to return </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.debug.traceIf usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
traceIf true "hello" 3
trace: hello
=&gt; 3
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/debug.nix#L51" target="_top" shape="rect">lib/debug.nix:51</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-debug-traceValFn"><code class="function">lib.debug.traceValFn</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">traceValFn :: (a -&gt; b) -&gt; a -&gt; a</code> </h5></div>
</div></div>
<p> Trace the supplied value after applying a function to it, and return the original value. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">f</code> </span></dt>
<dd><p> Function to apply </p></dd>
<dt><span class="term"> <code class="varname">x</code> </span></dt>
<dd><p> Value to trace and return </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.debug.traceValFn usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
traceValFn (v: "mystring ${v}") "foo"
trace: mystring foo
=&gt; "foo"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/debug.nix#L69" target="_top" shape="rect">lib/debug.nix:69</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-debug-traceVal"><code class="function">lib.debug.traceVal</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">traceVal :: a -&gt; a</code> </h5></div>
</div></div>
<p> Trace the supplied value and return it. </p>
<div class="example">
<p class="title"><strong>Example:  lib.debug.traceVal usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
traceVal 42
# trace: 42
=&gt; 42
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/debug.nix#L84" target="_top" shape="rect">lib/debug.nix:84</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-debug-traceSeq"><code class="function">lib.debug.traceSeq</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">traceSeq :: a -&gt; b -&gt; b</code> </h5></div>
</div></div>
<p> `builtins.trace`, but the value is `builtins.deepSeq`ed first. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">x</code> </span></dt>
<dd><p> The value to trace </p></dd>
<dt><span class="term"> <code class="varname">y</code> </span></dt>
<dd><p> The value to return </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.debug.traceSeq usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
trace { a.b.c = 3; } null
trace: { a = &lt;CODE&gt;; }
=&gt; null
traceSeq { a.b.c = 3; } null
trace: { a = { b = { c = 3; }; }; }
=&gt; null
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/debug.nix#L98" target="_top" shape="rect">lib/debug.nix:98</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-debug-traceSeqN"><code class="function">lib.debug.traceSeqN</code></h2></div></div></div>
<p> Like `traceSeq`, but only evaluate down to depth n. This is very useful because lots of `traceSeq` usages lead to an infinite recursion. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">depth</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">x</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">y</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.debug.traceSeqN usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
traceSeqN 2 { a.b.c = 3; } null
trace: { a = { b = {…}; }; }
=&gt; null
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/debug.nix#L113" target="_top" shape="rect">lib/debug.nix:113</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-debug-traceValSeqFn"><code class="function">lib.debug.traceValSeqFn</code></h2></div></div></div>
<p> A combination of `traceVal` and `traceSeq` that applies a provided function to the value to be traced after `deepSeq`ing it. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">f</code> </span></dt>
<dd><p> Function to apply </p></dd>
<dt><span class="term"> <code class="varname">v</code> </span></dt>
<dd><p> Value to trace </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/debug.nix#L130" target="_top" shape="rect">lib/debug.nix:130</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-debug-traceValSeq"><code class="function">lib.debug.traceValSeq</code></h2></div></div></div>
<p> A combination of `traceVal` and `traceSeq`. </p>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/debug.nix#L137" target="_top" shape="rect">lib/debug.nix:137</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-debug-traceValSeqNFn"><code class="function">lib.debug.traceValSeqNFn</code></h2></div></div></div>
<p> A combination of `traceVal` and `traceSeqN` that applies a provided function to the value to be traced. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">f</code> </span></dt>
<dd><p> Function to apply </p></dd>
<dt><span class="term"> <code class="varname">depth</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">v</code> </span></dt>
<dd><p> Value to trace </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/debug.nix#L141" target="_top" shape="rect">lib/debug.nix:141</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-debug-traceValSeqN"><code class="function">lib.debug.traceValSeqN</code></h2></div></div></div>
<p> A combination of `traceVal` and `traceSeqN`. </p>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/debug.nix#L149" target="_top" shape="rect">lib/debug.nix:149</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-debug-traceFnSeqN"><code class="function">lib.debug.traceFnSeqN</code></h2></div></div></div>
<p> Trace the input and output of a function `f` named `name`, both down to `depth`. </p>
<p> This is useful for adding around a function call, to see the before/after of values as they are transformed. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">depth</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">name</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">f</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">v</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.debug.traceFnSeqN usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
traceFnSeqN 2 "id" (x: x) { a.b.c = 3; }
trace: { fn = "id"; from = { a.b = {…}; }; to = { a.b = {…}; }; }
=&gt; { a.b.c = 3; }
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/debug.nix#L162" target="_top" shape="rect">lib/debug.nix:162</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-debug-runTests"><code class="function">lib.debug.runTests</code></h2></div></div></div>
<p> Evaluate a set of tests. A test is an attribute set `{expr, expected}`, denoting an expression and its expected result. The result is a list of failed tests, each represented as `{name, expected, actual}`, denoting the attribute name of the failing test and its expected and actual results. </p>
<p> Used for regression testing of the functions in lib; see tests.nix for an example. Only tests having names starting with "test" are run. </p>
<p> Add attr { tests = ["testName"]; } to run these tests only. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">tests</code> </span></dt>
<dd><p> Tests to run </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/debug.nix#L188" target="_top" shape="rect">lib/debug.nix:188</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-debug-testAllTrue"><code class="function">lib.debug.testAllTrue</code></h2></div></div></div>
<p> Create a test assuming that list elements are `true`. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">expr</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.debug.testAllTrue usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
{ testX = allTrue [ true ]; }
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/debug.nix#L204" target="_top" shape="rect">lib/debug.nix:204</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-options-isOption"><code class="function">lib.options.isOption</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">isOption :: a -&gt; bool</code> </h5></div>
</div></div>
<p> Returns true when the given argument is an option </p>
<div class="example">
<p class="title"><strong>Example:  lib.options.isOption usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
isOption 1             // =&gt; false
isOption (mkOption {}) // =&gt; true
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/options.nix#L50" target="_top" shape="rect">lib/options.nix:50</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-options-mkOption"><code class="function">lib.options.mkOption</code></h2></div></div></div>
<p> Creates an Option attribute set. mkOption accepts an attribute set with the following keys: </p>
<p> All keys default to `null` when not given. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">pattern</code> </span></dt>
<dd>
<p> Structured function argument </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">default</code> </span></dt>
<dd><p> Default value used when no definition is given in the configuration. </p></dd>
<dt><span class="term"> <code class="varname">defaultText</code> </span></dt>
<dd><p> Textual representation of the default, for the manual. </p></dd>
<dt><span class="term"> <code class="varname">example</code> </span></dt>
<dd><p> Example value used in the manual. </p></dd>
<dt><span class="term"> <code class="varname">description</code> </span></dt>
<dd><p> String describing the option. </p></dd>
<dt><span class="term"> <code class="varname">relatedPackages</code> </span></dt>
<dd><p> Related packages used in the manual (see `genRelatedPackages` in ../nixos/lib/make-options-doc/default.nix). </p></dd>
<dt><span class="term"> <code class="varname">type</code> </span></dt>
<dd><p> Option type, providing type-checking and value merging. </p></dd>
<dt><span class="term"> <code class="varname">apply</code> </span></dt>
<dd><p> Function that converts the option value to something else. </p></dd>
<dt><span class="term"> <code class="varname">internal</code> </span></dt>
<dd><p> Whether the option is for NixOS developers only. </p></dd>
<dt><span class="term"> <code class="varname">visible</code> </span></dt>
<dd><p> Whether the option shows up in the manual. Default: true. Use false to hide the option and any sub-options from submodules. Use "shallow" to hide only sub-options. </p></dd>
<dt><span class="term"> <code class="varname">readOnly</code> </span></dt>
<dd><p> Whether the option can be set only once </p></dd>
</dl></div>
</dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.options.mkOption usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
mkOption { }  // =&gt; { _type = "option"; }
mkOption { default = "foo"; } // =&gt; { _type = "option"; default = "foo"; }
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/options.nix#L60" target="_top" shape="rect">lib/options.nix:60</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-options-mkEnableOption"><code class="function">lib.options.mkEnableOption</code></h2></div></div></div>
<p> Creates an Option attribute set for a boolean value option i.e an option to be toggled on or off: </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">name</code> </span></dt>
<dd><p> Name for the created option </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.options.mkEnableOption usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
mkEnableOption "foo"
=&gt; { _type = "option"; default = false; description = "Whether to enable foo."; example = true; type = { ... }; }
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/options.nix#L92" target="_top" shape="rect">lib/options.nix:92</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-options-mkPackageOption"><code class="function">lib.options.mkPackageOption</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">mkPackageOption :: pkgs -&gt; string -&gt; { default :: [string], example :: null | string | [string] } -&gt; optionThe package is specified as a list of strings representing its attribute path in nixpkgs.Because of this, you need to pass nixpkgs itself as the first argument.The second argument is the name of the option, used in the description "The &lt;name&gt; package to use.".You can also pass an example value, either a literal string or a package's attribute path.You can omit the default path if the name of the option is also attribute path in nixpkgs.</code> </h5></div>
</div></div>
<p> Creates an Option attribute set for an option that specifies the package a module should use for some purpose. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">pkgs</code> </span></dt>
<dd><p> Package set (a specific version of nixpkgs) </p></dd>
<dt><span class="term"> <code class="varname">name</code> </span></dt>
<dd><p> Name for the package, shown in option description </p></dd>
<dt><span class="term"> <code class="varname">pattern</code> </span></dt>
<dd>
<p> Structured function argument </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">default</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">example</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
</dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.options.mkPackageOption usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
mkPackageOption pkgs "hello" { }
=&gt; { _type = "option"; default = «derivation /nix/store/3r2vg51hlxj3cx5vscp0vkv60bqxkaq0-hello-2.10.drv»; defaultText = { ... }; description = "The hello package to use."; type = { ... }; }


mkPackageOption pkgs "GHC" {
default = [ "ghc" ];
example = "pkgs.haskell.package.ghc922.ghc.withPackages (hkgs: [ hkgs.primes ])";
}
=&gt; { _type = "option"; default = «derivation /nix/store/jxx55cxsjrf8kyh3fp2ya17q99w7541r-ghc-8.10.7.drv»; defaultText = { ... }; description = "The GHC package to use."; example = { ... }; type = { ... }; }
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/options.nix#L127" target="_top" shape="rect">lib/options.nix:127</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-options-mkSinkUndeclaredOptions"><code class="function">lib.options.mkSinkUndeclaredOptions</code></h2></div></div></div>
<p> This option accepts anything, but it does not produce any result. </p>
<p> This is useful for sharing a module across different module sets without having to implement similar features as long as the values of the options are not accessed. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">attrs</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/options.nix#L149" target="_top" shape="rect">lib/options.nix:149</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-options-mergeEqualOption"><code class="function">lib.options.mergeEqualOption</code></h2></div></div></div>
<p> "Merge" option definitions by checking that they all have the same value. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">loc</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">defs</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/options.nix#L182" target="_top" shape="rect">lib/options.nix:182</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-options-getValues"><code class="function">lib.options.getValues</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">getValues :: [ { value :: a } ] -&gt; [a]</code> </h5></div>
</div></div>
<p> Extracts values of all "value" keys of the given list. </p>
<div class="example">
<p class="title"><strong>Example:  lib.options.getValues usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
getValues [ { value = 1; } { value = 2; } ] // =&gt; [ 1 2 ]
getValues [ ]                               // =&gt; [ ]
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/options.nix#L202" target="_top" shape="rect">lib/options.nix:202</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-options-getFiles"><code class="function">lib.options.getFiles</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">getFiles :: [ { file :: a } ] -&gt; [a]</code> </h5></div>
</div></div>
<p> Extracts values of all "file" keys of the given list </p>
<div class="example">
<p class="title"><strong>Example:  lib.options.getFiles usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
getFiles [ { file = "file1"; } { file = "file2"; } ] // =&gt; [ "file1" "file2" ]
getFiles [ ]                                         // =&gt; [ ]
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/options.nix#L212" target="_top" shape="rect">lib/options.nix:212</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-options-scrubOptionValue"><code class="function">lib.options.scrubOptionValue</code></h2></div></div></div>
<p> This function recursively removes all derivation attributes from `x` except for the `name` attribute. </p>
<p> This is to make the generation of `options.xml` much more efficient: the XML representation of derivations is very large (on the order of megabytes) and is not actually used by the manual generator. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">x</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/options.nix#L255" target="_top" shape="rect">lib/options.nix:255</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-options-literalExpression"><code class="function">lib.options.literalExpression</code></h2></div></div></div>
<p> For use in the `defaultText` and `example` option attributes. Causes the given string to be rendered verbatim in the documentation as Nix code. This is necessary for complex values, e.g. functions, or values that depend on other values or packages. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">text</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/options.nix#L268" target="_top" shape="rect">lib/options.nix:268</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-options-literalDocBook"><code class="function">lib.options.literalDocBook</code></h2></div></div></div>
<p> For use in the `defaultText` and `example` option attributes. Causes the given DocBook text to be inserted verbatim in the documentation, for when a `literalExpression` would be too hard to read. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">text</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/options.nix#L279" target="_top" shape="rect">lib/options.nix:279</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-options-showOption"><code class="function">lib.options.showOption</code></h2></div></div></div>
<p> Convert an option, described as a list of the option parts in to a safe, human readable version. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">parts</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.options.showOption usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
(showOption ["foo" "bar" "baz"]) == "foo.bar.baz"
(showOption ["foo" "bar.baz" "tux"]) == "foo.bar.baz.tux"

Placeholders will not be quoted as they are not actual values:
(showOption ["foo" "*" "bar"]) == "foo.*.bar"
(showOption ["foo" "&lt;name&gt;" "bar"]) == "foo.&lt;name&gt;.bar"

Unlike attributes, options can also start with numbers:
(showOption ["windowManager" "2bwm" "enable"]) == "windowManager.2bwm.enable"
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/options.nix#L299" target="_top" shape="rect">lib/options.nix:299</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-sources-pathType"><code class="function">lib.sources.pathType</code></h2></div></div></div>
<p> Returns the type of a path: regular (for file), symlink, or directory. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">path</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/sources.nix#L265" target="_top" shape="rect">lib/sources.nix:265</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-sources-pathIsDirectory"><code class="function">lib.sources.pathIsDirectory</code></h2></div></div></div>
<p> Returns true if the path exists and is a directory, false otherwise. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">path</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/sources.nix#L265" target="_top" shape="rect">lib/sources.nix:265</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-sources-pathIsRegularFile"><code class="function">lib.sources.pathIsRegularFile</code></h2></div></div></div>
<p> Returns true if the path exists and is a regular file, false otherwise. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">path</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/sources.nix#L265" target="_top" shape="rect">lib/sources.nix:265</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-sources-cleanSourceFilter"><code class="function">lib.sources.cleanSourceFilter</code></h2></div></div></div>
<p> A basic filter for `cleanSourceWith` that removes directories of version control system, backup files (*~) and some generated files. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">name</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">type</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/sources.nix#L265" target="_top" shape="rect">lib/sources.nix:265</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-sources-cleanSource"><code class="function">lib.sources.cleanSource</code></h2></div></div></div>
<p> Filters a source tree removing version control files and directories using cleanSourceFilter. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">src</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.sources.cleanSource usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
cleanSource ./.
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/sources.nix#L265" target="_top" shape="rect">lib/sources.nix:265</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-sources-cleanSourceWith"><code class="function">lib.sources.cleanSourceWith</code></h2></div></div></div>
<p> Like `builtins.filterSource`, except it will compose with itself, allowing you to chain multiple calls together without any intermediate copies being put in the nix store. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">pattern</code> </span></dt>
<dd>
<p> Structured function argument </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">src</code> </span></dt>
<dd><p> A path or cleanSourceWith result to filter and/or rename. </p></dd>
<dt><span class="term"> <code class="varname">filter</code> </span></dt>
<dd><p> Optional with default value: constant true (include everything) </p></dd>
<dt><span class="term"> <code class="varname">name</code> </span></dt>
<dd><p> Optional name to use as part of the store path. </p></dd>
</dl></div>
</dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.sources.cleanSourceWith usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
lib.cleanSourceWith {
filter = f;
src = lib.cleanSourceWith {
filter = g;
src = ./.;
};
}
# Succeeds!

builtins.filterSource f (builtins.filterSource g ./.)
# Fails!
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/sources.nix#L265" target="_top" shape="rect">lib/sources.nix:265</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-sources-trace"><code class="function">lib.sources.trace</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">sources.trace :: sourceLike -&gt; Source</code> </h5></div>
</div></div>
<p> Add logging to a source, for troubleshooting the filtering behavior. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">src</code> </span></dt>
<dd><p> Source to debug. The returned source will behave like this source, but also log its filter invocations. </p></dd>
</dl></div>
<p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/sources.nix#L265" target="_top" shape="rect">lib/sources.nix:265</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-sources-sourceByRegex"><code class="function">lib.sources.sourceByRegex</code></h2></div></div></div>
<p> Filter sources by a list of regular expressions. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">src</code> </span></dt>
<dd><p> Function argument </p></dd>
<dt><span class="term"> <code class="varname">regexes</code> </span></dt>
<dd><p> Function argument </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.sources.sourceByRegex usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">src = sourceByRegex ./my-subproject [".*\.py$" "^database.sql$"]
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/sources.nix#L265" target="_top" shape="rect">lib/sources.nix:265</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div>
<div><h2 class="title" id="lib-sources-sourceFilesBySuffices"><code class="function">lib.sources.sourceFilesBySuffices</code></h2></div>
<div><h5 class="subtitle">
<code class="literal">sourceLike -&gt; [String] -&gt; Source</code> </h5></div>
</div></div>
<p> Get all files ending with the specified suffices from the given source directory or its descendants, omitting files that do not match any suffix. The result of the example below will include files like `./dir/module.c` and `./dir/subdir/doc.xml` if present. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="varname">src</code> </span></dt>
<dd><p> Path or source containing the files to be returned </p></dd>
<dt><span class="term"> <code class="varname">exts</code> </span></dt>
<dd><p> A list of file suffix strings </p></dd>
</dl></div>
<div class="example">
<p class="title"><strong>Example:  lib.sources.sourceFilesBySuffices usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">
sourceFilesBySuffices ./. [ ".xml" ".c" ]
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/sources.nix#L265" target="_top" shape="rect">lib/sources.nix:265</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 class="title" id="lib-sources-commitIdFromGitRepo"><code class="function">lib.sources.commitIdFromGitRepo</code></h2></div></div></div>
<p> Get the commit id of a git repo. </p>
<div class="example">
<p class="title"><strong>Example:  lib.sources.commitIdFromGitRepo usage example</strong></p>
<div class="example-contents"><pre class="programlisting" xml:space="preserve" data-language="nix">commitIdFromGitRepo &lt;nixpkgs/.git&gt;
</pre></div>
</div>
<br class="example-break" clear="none"><p> Located at <a class="link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/sources.nix#L265" target="_top" shape="rect">lib/sources.nix:265</a> in <code class="literal">&lt;nixpkgs&gt;</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 id="fetchurl" class="title" style="clear: both">
<code class="literal">pkgs.fetchurl</code> and <code class="literal">pkgs.fetchzip</code>
</h2></div></div></div>
<p> Two basic fetchers are <code class="literal">fetchurl</code> and <code class="literal">fetchzip</code>. Both of these have two required arguments, a URL and a hash. The hash is typically <code class="literal">sha256</code>, although many more hash algorithms are supported. Nixpkgs contributors are currently recommended to use <code class="literal">sha256</code>. This hash will be used by Nix to identify your source. A typical usage of <code class="literal">fetchurl</code> is provided below. </p>
<pre class="programlisting" xml:space="preserve" data-language="nix">
{ stdenv, fetchurl }:

stdenv.mkDerivation {
  name = "hello";
  src = fetchurl {
    url = "http://www.example.org/hello.tar.gz";
    sha256 = "1111111111111111111111111111111111111111111111111111";
  };
}
</pre>
<p> The main difference between <code class="literal">fetchurl</code> and <code class="literal">fetchzip</code> is in how they store the contents. <code class="literal">fetchurl</code> will store the unaltered contents of the URL within the Nix store. <code class="literal">fetchzip</code> on the other hand, will decompress the archive for you, making files and directories directly accessible in the future. <code class="literal">fetchzip</code> can only be used with archives. Despite the name, <code class="literal">fetchzip</code> is not limited to .zip files and can also be used with any tarball. </p>
<p> <code class="literal">fetchpatch</code> works very similarly to <code class="literal">fetchurl</code> with the same arguments expected. It expects patch files as a source and performs normalization on them before computing the checksum. For example, it will remove comments or other unstable parts that are sometimes added by version control systems and can change over time. </p>
<p> Most other fetchers return a directory rather than a single file. </p></section><section class="section"><div class="titlepage"><div><div><h2 id="fetchsvn" class="title" style="clear: both"><code class="literal">pkgs.fetchsvn</code></h2></div></div></div>
<p> Used with Subversion. Expects <code class="literal">url</code> to a Subversion directory, <code class="literal">rev</code>, and <code class="literal">sha256</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 id="fetchgit" class="title" style="clear: both"><code class="literal">pkgs.fetchgit</code></h2></div></div></div>
<p> Used with Git. Expects <code class="literal">url</code> to a Git repo, <code class="literal">rev</code>, and <code class="literal">sha256</code>. <code class="literal">rev</code> in this case can be full the git commit id (SHA1 hash) or a tag name like <code class="literal">refs/tags/v1.0</code>. </p>
<p> Additionally, the following optional arguments can be given: <code class="literal">fetchSubmodules = true</code> makes <code class="literal">fetchgit</code> also fetch the submodules of a repository. If <code class="literal">deepClone</code> is set to true, the entire repository is cloned as opposing to just creating a shallow clone. <code class="literal">deepClone = true</code> also implies <code class="literal">leaveDotGit = true</code> which means that the <code class="literal">.git</code> directory of the clone won’t be removed after checkout. </p>
<p> If only parts of the repository are needed, <code class="literal">sparseCheckout</code> can be used. This will prevent git from fetching unnecessary blobs from server, see <a class="link" href="https://git-scm.com/docs/git-sparse-checkout" target="_top" shape="rect">git sparse-checkout</a> and <a class="link" href="https://git-scm.com/docs/git-clone#Documentation/git-clone.txt---filterltfilter-specgt" target="_top" shape="rect">git clone –filter</a> for more information: </p>
<pre class="programlisting" xml:space="preserve" data-language="nix">
{ stdenv, fetchgit }:

stdenv.mkDerivation {
  name = "hello";
  src = fetchgit {
    url = "https://...";
    sparseCheckout = ''
      path/to/be/included
      another/path
    '';
    sha256 = "0000000000000000000000000000000000000000000000000000";
  };
}
</pre></section><section class="section"><div class="titlepage"><div><div><h2 id="fetchfossil" class="title" style="clear: both"><code class="literal">pkgs.fetchfossil</code></h2></div></div></div>
<p> Used with Fossil. Expects <code class="literal">url</code> to a Fossil archive, <code class="literal">rev</code>, and <code class="literal">sha256</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 id="fetchcvs" class="title" style="clear: both"><code class="literal">pkgs.fetchcvs</code></h2></div></div></div>
<p> Used with CVS. Expects <code class="literal">cvsRoot</code>, <code class="literal">tag</code>, and <code class="literal">sha256</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 id="fetchhg" class="title" style="clear: both"><code class="literal">pkgs.fetchhg</code></h2></div></div></div>
<p> Used with Mercurial. Expects <code class="literal">url</code>, <code class="literal">rev</code>, and <code class="literal">sha256</code>. </p>
<p> A number of fetcher functions wrap part of <code class="literal">fetchurl</code> and <code class="literal">fetchzip</code>. They are mainly convenience functions intended for commonly used destinations of source code in Nixpkgs. These wrapper fetchers are listed below. </p></section><section class="section"><div class="titlepage"><div><div><h2 id="fetchfromgitea" class="title" style="clear: both"><code class="literal">pkgs.fetchFromGitea</code></h2></div></div></div>
<p> <code class="literal">fetchFromGitea</code> expects five arguments. <code class="literal">domain</code> is the gitea server name. <code class="literal">owner</code> is a string corresponding to the Gitea user or organization that controls this repository. <code class="literal">repo</code> corresponds to the name of the software repository. These are located at the top of every Gitea HTML page as <code class="literal">owner</code>/<code class="literal">repo</code>. <code class="literal">rev</code> corresponds to the Git commit hash or tag (e.g <code class="literal">v1.0</code>) that will be downloaded from Git. Finally, <code class="literal">sha256</code> corresponds to the hash of the extracted directory. Again, other hash algorithms are also available but <code class="literal">sha256</code> is currently preferred. </p></section><section class="section"><div class="titlepage"><div><div><h2 id="fetchfromgithub" class="title" style="clear: both"><code class="literal">pkgs.fetchFromGitHub</code></h2></div></div></div>
<p> <code class="literal">fetchFromGitHub</code> expects four arguments. <code class="literal">owner</code> is a string corresponding to the GitHub user or organization that controls this repository. <code class="literal">repo</code> corresponds to the name of the software repository. These are located at the top of every GitHub HTML page as <code class="literal">owner</code>/<code class="literal">repo</code>. <code class="literal">rev</code> corresponds to the Git commit hash or tag (e.g <code class="literal">v1.0</code>) that will be downloaded from Git. Finally, <code class="literal">sha256</code> corresponds to the hash of the extracted directory. Again, other hash algorithms are also available, but <code class="literal">sha256</code> is currently preferred. </p>
<p> <code class="literal">fetchFromGitHub</code> uses <code class="literal">fetchzip</code> to download the source archive generated by GitHub for the specified revision. If <code class="literal">leaveDotGit</code>, <code class="literal">deepClone</code> or <code class="literal">fetchSubmodules</code> are set to <code class="literal">true</code>, <code class="literal">fetchFromGitHub</code> will use <code class="literal">fetchgit</code> instead. Refer to its section for documentation of these options. </p></section><section class="section"><div class="titlepage"><div><div><h2 id="fetchfromgitlab" class="title" style="clear: both"><code class="literal">pkgs.fetchFromGitLab</code></h2></div></div></div>
<p> This is used with GitLab repositories. The arguments expected are very similar to <code class="literal">fetchFromGitHub</code> above. </p></section><section class="section"><div class="titlepage"><div><div><h2 id="fetchfromgitiles" class="title" style="clear: both"><code class="literal">pkgs.fetchFromGitiles</code></h2></div></div></div>
<p> This is used with Gitiles repositories. The arguments expected are similar to <code class="literal">fetchgit</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 id="fetchfrombitbucket" class="title" style="clear: both"><code class="literal">pkgs.fetchFromBitbucket</code></h2></div></div></div>
<p> This is used with BitBucket repositories. The arguments expected are very similar to fetchFromGitHub above. </p></section><section class="section"><div class="titlepage"><div><div><h2 id="fetchfromsavannah" class="title" style="clear: both"><code class="literal">pkgs.fetchFromSavannah</code></h2></div></div></div>
<p> This is used with Savannah repositories. The arguments expected are very similar to <code class="literal">fetchFromGitHub</code> above. </p></section><section class="section"><div class="titlepage"><div><div><h2 id="fetchfromrepoorcz" class="title" style="clear: both"><code class="literal">pkgs.fetchFromRepoOrCz</code></h2></div></div></div>
<p> This is used with repo.or.cz repositories. The arguments expected are very similar to <code class="literal">fetchFromGitHub</code> above. </p></section><section class="section"><div class="titlepage"><div><div><h2 id="fetchfromsourcehut" class="title" style="clear: both"><code class="literal">pkgs.fetchFromSourcehut</code></h2></div></div></div>
<p> This is used with sourcehut repositories. Similar to <code class="literal">fetchFromGitHub</code> above, it expects <code class="literal">owner</code>, <code class="literal">repo</code>, <code class="literal">rev</code> and <code class="literal">sha256</code>, but don’t forget the tilde (~) in front of the username! Expected arguments also include <code class="literal">vc</code> (<span class="quote">“<span class="quote">git</span>”</span> (default) or <span class="quote">“<span class="quote">hg</span>”</span>), <code class="literal">domain</code> and <code class="literal">fetchSubmodules</code>. </p>
<p> If <code class="literal">fetchSubmodules</code> is <code class="literal">true</code>, <code class="literal">fetchFromSourcehut</code> uses <code class="literal">fetchgit</code> or <code class="literal">fetchhg</code> with <code class="literal">fetchSubmodules</code> or <code class="literal">fetchSubrepos</code> set to <code class="literal">true</code>, respectively. Otherwise, the fetcher uses <code class="literal">fetchzip</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 id="trivial-builder-runCommand" class="title" style="clear: both"><code class="literal">pkgs.runCommand</code></h2></div></div></div>
<p> This takes three arguments, <code class="literal">name</code>, <code class="literal">env</code>, and <code class="literal">buildCommand</code>. <code class="literal">name</code> is just the name that Nix will append to the store path in the same way that <code class="literal">stdenv.mkDerivation</code> uses its <code class="literal">name</code> attribute. <code class="literal">env</code> is an attribute set specifying environment variables that will be set for this derivation. These attributes are then passed to the wrapped <code class="literal">stdenv.mkDerivation</code>. <code class="literal">buildCommand</code> specifies the commands that will be run to create this derivation. Note that you will need to create <code class="literal">$out</code> for Nix to register the command as successful. </p>
<p> An example of using <code class="literal">runCommand</code> is provided below. </p>
<pre class="programlisting" xml:space="preserve" data-language="nix">
(import &lt;nixpkgs&gt; {}).runCommand "my-example" {} ''
  echo My example command is running

  mkdir $out

  echo I can write data to the Nix store &gt; $out/message

  echo I can also run basic commands like:

  echo ls
  ls

  echo whoami
  whoami

  echo date
  date
''
</pre></section><section class="section"><div class="titlepage"><div><div><h2 id="trivial-builder-runCommandCC" class="title" style="clear: both"><code class="literal">pkgs.runCommandCC</code></h2></div></div></div>
<p> This works just like <code class="literal">runCommand</code>. The only difference is that it also provides a C compiler in <code class="literal">buildCommand</code>’s environment. To minimize your dependencies, you should only use this if you are sure you will need a C compiler as part of running your command. </p></section><section class="section"><div class="titlepage"><div><div><h2 id="trivial-builder-runCommandLocal" class="title" style="clear: both"><code class="literal">pkgs.runCommandLocal</code></h2></div></div></div>
<p> Variant of <code class="literal">runCommand</code> that forces the derivation to be built locally, it is not substituted. This is intended for very cheap commands (&lt;1s execution time). It saves on the network round-trip and can speed up a build. </p>
<aside class="admonition-block -note" role="note"><div class="title">Note</div>
<p> This sets <a class="link" href="https://nixos.org/nix/manual/#adv-attr-allowSubstitutes" target="_top" shape="rect"><code class="literal">allowSubstitutes</code> to <code class="literal">false</code></a>, so only use <code class="literal">runCommandLocal</code> if you are certain the user will always have a builder for the <code class="literal">system</code> of the derivation. This should be true for most trivial use cases (e.g., just copying some files to a different location or adding symlinks) because there the <code class="literal">system</code> is usually the same as <code class="literal">builtins.currentSystem</code>. </p></aside></section><section class="section"><div class="titlepage"><div><div><h2 id="trivial-builder-writeText" class="title" style="clear: both">
<code class="literal">pkgs.writeTextFile</code>, <code class="literal">pkgs.writeText</code>, <code class="literal">pkgs.writeTextDir</code>, <code class="literal">pkgs.writeScript</code>, <code class="literal">pkgs.writeScriptBin</code>
</h2></div></div></div>
<p> These functions write <code class="literal">text</code> to the Nix store. This is useful for creating scripts from Nix expressions. <code class="literal">writeTextFile</code> takes an attribute set and expects two arguments, <code class="literal">name</code> and <code class="literal">text</code>. <code class="literal">name</code> corresponds to the name used in the Nix store path. <code class="literal">text</code> will be the contents of the file. You can also set <code class="literal">executable</code> to true to make this file have the executable bit set. </p>
<p> Many more commands wrap <code class="literal">writeTextFile</code> including <code class="literal">writeText</code>, <code class="literal">writeTextDir</code>, <code class="literal">writeScript</code>, and <code class="literal">writeScriptBin</code>. These are convenience functions over <code class="literal">writeTextFile</code>. </p>
<p> Here are a few examples: </p>
<pre class="programlisting" xml:space="preserve" data-language="nix">
# Writes my-file to /nix/store/&lt;store path&gt;
writeTextFile {
  name = "my-file";
  text = ''
    Contents of File
  '';
}
# See also the `writeText` helper function below.

# Writes executable my-file to /nix/store/&lt;store path&gt;/bin/my-file
writeTextFile {
  name = "my-file";
  text = ''
    Contents of File
  '';
  executable = true;
  destination = "/bin/my-file";
}
# Writes contents of file to /nix/store/&lt;store path&gt;
writeText "my-file"
  ''
  Contents of File
  '';
# Writes contents of file to /nix/store/&lt;store path&gt;/share/my-file
writeTextDir "share/my-file"
  ''
  Contents of File
  '';
# Writes my-file to /nix/store/&lt;store path&gt; and makes executable
writeScript "my-file"
  ''
  Contents of File
  '';
# Writes my-file to /nix/store/&lt;store path&gt;/bin/my-file and makes executable.
writeScriptBin "my-file"
  ''
  Contents of File
  '';
# Writes my-file to /nix/store/&lt;store path&gt; and makes executable.
writeShellScript "my-file"
  ''
  Contents of File
  '';
# Writes my-file to /nix/store/&lt;store path&gt;/bin/my-file and makes executable.
writeShellScriptBin "my-file"
  ''
  Contents of File
  '';
</pre></section><section class="section"><div class="titlepage"><div><div><h2 id="trivial-builder-concatText" class="title" style="clear: both">
<code class="literal">pkgs.concatTextFile</code>, <code class="literal">pkgs.concatText</code>, <code class="literal">pkgs.concatScript</code>
</h2></div></div></div>
<p> These functions concatenate <code class="literal">files</code> to the Nix store in a single file. This is useful for configuration files structured in lines of text. <code class="literal">concatTextFile</code> takes an attribute set and expects two arguments, <code class="literal">name</code> and <code class="literal">files</code>. <code class="literal">name</code> corresponds to the name used in the Nix store path. <code class="literal">files</code> will be the files to be concatenated. You can also set <code class="literal">executable</code> to true to make this file have the executable bit set. <code class="literal">concatText</code> and<code class="literal">concatScript</code> are simple wrappers over <code class="literal">concatTextFile</code>. </p>
<p> Here are a few examples: </p>
<pre class="programlisting" xml:space="preserve" data-language="nix">

# Writes my-file to /nix/store/&lt;store path&gt;
concatTextFile {
  name = "my-file";
  files = [ drv1 "${drv2}/path/to/file" ];
}
# See also the `concatText` helper function below.

# Writes executable my-file to /nix/store/&lt;store path&gt;/bin/my-file
concatTextFile {
  name = "my-file";
  files = [ drv1 "${drv2}/path/to/file" ];
  executable = true;
  destination = "/bin/my-file";
}
# Writes contents of files to /nix/store/&lt;store path&gt;
concatText "my-file" [ file1 file2 ]

# Writes contents of files to /nix/store/&lt;store path&gt;
concatScript "my-file" [ file1 file2 ]
</pre></section><section class="section"><div class="titlepage"><div><div><h2 id="trivial-builder-writeShellApplication" class="title" style="clear: both"><code class="literal">pkgs.writeShellApplication</code></h2></div></div></div>
<p> This can be used to easily produce a shell script that has some dependencies (<code class="literal">runtimeInputs</code>). It automatically sets the <code class="literal">PATH</code> of the script to contain all of the listed inputs, sets some sanity shellopts (<code class="literal">errexit</code>, <code class="literal">nounset</code>, <code class="literal">pipefail</code>), and checks the resulting script with <a class="link" href="https://github.com/koalaman/shellcheck" target="_top" shape="rect"><code class="literal">shellcheck</code></a>. </p>
<p> For example, look at the following code: </p>
<pre class="programlisting" xml:space="preserve" data-language="nix">
writeShellApplication {
  name = "show-nixos-org";

  runtimeInputs = [ curl w3m ];

  text = ''
    curl -s 'https://nixos.org' | w3m -dump -T text/html
  '';
}
</pre>
<p> Unlike with normal <code class="literal">writeShellScriptBin</code>, there is no need to manually write out <code class="literal">${curl}/bin/curl</code>, setting the PATH was handled by <code class="literal">writeShellApplication</code>. Moreover, the script is being checked with <code class="literal">shellcheck</code> for more strict validation. </p></section><section class="section"><div class="titlepage"><div><div><h2 id="trivial-builder-symlinkJoin" class="title" style="clear: both"><code class="literal">pkgs.symlinkJoin</code></h2></div></div></div>
<p> This can be used to put many derivations into the same directory structure. It works by creating a new derivation and adding symlinks to each of the paths listed. It expects two arguments, <code class="literal">name</code>, and <code class="literal">paths</code>. <code class="literal">name</code> is the name used in the Nix store path for the created derivation. <code class="literal">paths</code> is a list of paths that will be symlinked. These paths can be to Nix store derivations or any other subdirectory contained within. Here is an example: </p>
<pre class="programlisting" xml:space="preserve" data-language="nix">
# adds symlinks of hello and stack to current build and prints "links added"
symlinkJoin { name = "myexample"; paths = [ pkgs.hello pkgs.stack ]; postBuild = "echo links added"; }
</pre>
<p> This creates a derivation with a directory structure like the following: </p>
<pre class="programlisting" xml:space="preserve" data-language="nix">
/nix/store/sglsr5g079a5235hy29da3mq3hv8sjmm-myexample
|-- bin
|   |-- hello -&gt; /nix/store/qy93dp4a3rqyn2mz63fbxjg228hffwyw-hello-2.10/bin/hello
|   `-- stack -&gt; /nix/store/6lzdpxshx78281vy056lbk553ijsdr44-stack-2.1.3.1/bin/stack
`-- share
    |-- bash-completion
    |   `-- completions
    |       `-- stack -&gt; /nix/store/6lzdpxshx78281vy056lbk553ijsdr44-stack-2.1.3.1/share/bash-completion/completions/stack
    |-- fish
    |   `-- vendor_completions.d
    |       `-- stack.fish -&gt; /nix/store/6lzdpxshx78281vy056lbk553ijsdr44-stack-2.1.3.1/share/fish/vendor_completions.d/stack.fish
...
</pre></section><section class="section"><div class="titlepage"><div><div><h2 id="trivial-builder-writeReferencesToFile" class="title" style="clear: both"><code class="literal">pkgs.writeReferencesToFile</code></h2></div></div></div>
<p> Writes the closure of transitive dependencies to a file. </p>
<p> This produces the equivalent of <code class="literal">nix-store -q --requisites</code>. </p>
<p> For example, </p>
<pre class="programlisting" xml:space="preserve" data-language="nix">
writeReferencesToFile (writeScriptBin "hi" ''${hello}/bin/hello'')
</pre>
<p> produces an output path <code class="literal">/nix/store/&lt;hash&gt;-runtime-deps</code> containing </p>
<pre class="programlisting" xml:space="preserve" data-language="nix">
/nix/store/&lt;hash&gt;-hello-2.10
/nix/store/&lt;hash&gt;-hi
/nix/store/&lt;hash&gt;-libidn2-2.3.0
/nix/store/&lt;hash&gt;-libunistring-0.9.10
/nix/store/&lt;hash&gt;-glibc-2.32-40
</pre>
<p> You can see that this includes <code class="literal">hi</code>, the original input path, <code class="literal">hello</code>, which is a direct reference, but also the other paths that are indirectly required to run <code class="literal">hello</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 id="trivial-builder-writeDirectReferencesToFile" class="title" style="clear: both"><code class="literal">pkgs.writeDirectReferencesToFile</code></h2></div></div></div>
<p> Writes the set of references to the output file, that is, their immediate dependencies. </p>
<p> This produces the equivalent of <code class="literal">nix-store -q --references</code>. </p>
<p> For example, </p>
<pre class="programlisting" xml:space="preserve" data-language="nix">
writeDirectReferencesToFile (writeScriptBin "hi" ''${hello}/bin/hello'')
</pre>
<p> produces an output path <code class="literal">/nix/store/&lt;hash&gt;-runtime-references</code> containing </p>
<pre class="programlisting" xml:space="preserve" data-language="nix">
/nix/store/&lt;hash&gt;-hello-2.10
</pre>
<p> but none of <code class="literal">hello</code>’s dependencies because those are not referenced directly by <code class="literal">hi</code>’s output. </p></section><section class="section"><div class="titlepage"><div><div><h2 id="sec-fhs-environments" class="title" style="clear: both"><code>pkgs.buildFHSUserEnv</code></h2></div></div></div>
<p> <code class="literal">buildFHSUserEnv</code> provides a way to build and run FHS-compatible lightweight sandboxes. It creates an isolated root with bound <code class="literal">/nix/store</code>, so its footprint in terms of disk space needed is quite small. This allows one to run software which is hard or unfeasible to patch for NixOS – 3rd-party source trees with FHS assumptions, games distributed as tarballs, software with integrity checking and/or external self-updated binaries. It uses Linux namespaces feature to create temporary lightweight environments which are destroyed after all child processes exit, without root user rights requirement. Accepted arguments are: </p>
<div class="itemizedlist"><ul class="itemizedlist compact" style="list-style-type: disc; ">
<li class="listitem"><p> <code class="literal">name</code> Environment name. </p></li>
<li class="listitem"><p> <code class="literal">targetPkgs</code> Packages to be installed for the main host’s architecture (i.e. x86_64 on x86_64 installations). Along with libraries binaries are also installed. </p></li>
<li class="listitem"><p> <code class="literal">multiPkgs</code> Packages to be installed for all architectures supported by a host (i.e. i686 and x86_64 on x86_64 installations). Only libraries are installed by default. </p></li>
<li class="listitem"><p> <code class="literal">extraBuildCommands</code> Additional commands to be executed for finalizing the directory structure. </p></li>
<li class="listitem"><p> <code class="literal">extraBuildCommandsMulti</code> Like <code class="literal">extraBuildCommands</code>, but executed only on multilib architectures. </p></li>
<li class="listitem"><p> <code class="literal">extraOutputsToInstall</code> Additional derivation outputs to be linked for both target and multi-architecture packages. </p></li>
<li class="listitem"><p> <code class="literal">extraInstallCommands</code> Additional commands to be executed for finalizing the derivation with runner script. </p></li>
<li class="listitem"><p> <code class="literal">runScript</code> A command that would be executed inside the sandbox and passed all the command line arguments. It defaults to <code class="literal">bash</code>. </p></li>
<li class="listitem"><p> <code class="literal">profile</code> Optional script for <code class="literal">/etc/profile</code> within the sandbox. </p></li>
</ul></div>
<p> One can create a simple environment using a <code class="literal">shell.nix</code> like that: </p>
<pre class="programlisting" xml:space="preserve" data-language="nix">
{ pkgs ? import &lt;nixpkgs&gt; {} }:

(pkgs.buildFHSUserEnv {
  name = "simple-x11-env";
  targetPkgs = pkgs: (with pkgs;
    [ udev
      alsa-lib
    ]) ++ (with pkgs.xorg;
    [ libX11
      libXcursor
      libXrandr
    ]);
  multiPkgs = pkgs: (with pkgs;
    [ udev
      alsa-lib
    ]);
  runScript = "bash";
}).env
</pre>
<p> Running <code class="literal">nix-shell</code> would then drop you into a shell with these libraries and binaries available. You can use this to run closed-source applications which expect FHS structure without hassles: simply change <code class="literal">runScript</code> to the application path, e.g. <code class="literal">./bin/start.sh</code> – relative paths are supported. </p>
<p> Additionally, the FHS builder links all relocated gsettings-schemas (the glib setup-hook moves them to <code class="literal">share/gsettings-schemas/${name}/glib-2.0/schemas</code>) to their standard FHS location. This means you don’t need to wrap binaries with <code class="literal">wrapGAppsHook</code>. </p></section><section class="section"><div class="titlepage"><div><div><h2 id="sec-pkgs-mkShell" class="title" style="clear: both"><code>pkgs.mkShell</code></h2></div></div></div>
<p> <code class="literal">pkgs.mkShell</code> is a specialized <code class="literal">stdenv.mkDerivation</code> that removes some repetition when using it with <code class="literal">nix-shell</code> (or <code class="literal">nix develop</code>). </p>
<section class="section"><div class="titlepage"><div><div><h3 id="sec-pkgs-mkShell-usage" class="title">Usage</h3></div></div></div>
<p> Here is a common usage example: </p>
<pre class="programlisting" xml:space="preserve" data-language="nix">
{ pkgs ? import &lt;nixpkgs&gt; {} }:
pkgs.mkShell {
  packages = [ pkgs.gnumake ];

  inputsFrom = [ pkgs.hello pkgs.gnutar ];

  shellHook = ''
    export DEBUG=1
  '';
}
</pre></section><section class="section"><div class="titlepage"><div><div><h3 id="idm140737318641712" class="title">Attributes</h3></div></div></div>
<div class="itemizedlist"><ul class="itemizedlist compact" style="list-style-type: disc; ">
<li class="listitem"><p> <code class="literal">name</code> (default: <code class="literal">nix-shell</code>). Set the name of the derivation. </p></li>
<li class="listitem"><p> <code class="literal">packages</code> (default: <code class="literal">[]</code>). Add executable packages to the <code class="literal">nix-shell</code> environment. </p></li>
<li class="listitem"><p> <code class="literal">inputsFrom</code> (default: <code class="literal">[]</code>). Add build dependencies of the listed derivations to the <code class="literal">nix-shell</code> environment. </p></li>
<li class="listitem"><p> <code class="literal">shellHook</code> (default: <code class="literal">""</code>). Bash statements that are executed by <code class="literal">nix-shell</code>. </p></li>
</ul></div>
<p> … all the attributes of <code class="literal">stdenv.mkDerivation</code>. </p></section><section class="section"><div class="titlepage"><div><div><h3 id="idm140737318631280" class="title">Building the shell</h3></div></div></div>
<p> This derivation output will contain a text file that contains a reference to all the build inputs. This is useful in CI where we want to make sure that every derivation, and its dependencies, build properly. Or when creating a GC root so that the build dependencies don’t get garbage-collected. </p></section></section><section class="section"><div class="titlepage"><div><div><h2 id="sec-pkgs-appimageTools" class="title" style="clear: both"><code>pkgs.appimageTools</code></h2></div></div></div>
<p> <code class="literal">pkgs.appimageTools</code> is a set of functions for extracting and wrapping <a class="link" href="https://appimage.org/" target="_top" shape="rect">AppImage</a> files. They are meant to be used if traditional packaging from source is infeasible, or it would take too long. To quickly run an AppImage file, <code class="literal">pkgs.appimage-run</code> can be used as well. </p>
<aside class="admonition-block -warning" role="note"><div class="title">Warning</div>
<p> The <code class="literal">appimageTools</code> API is unstable and may be subject to backwards-incompatible changes in the future. </p></aside><section class="section"><div class="titlepage"><div><div><h3 id="ssec-pkgs-appimageTools-formats" class="title"><code>AppImage formats</code></h3></div></div></div>
<p> There are different formats for AppImages, see <a class="link" href="https://github.com/AppImage/AppImageSpec/blob/74ad9ca2f94bf864a4a0dac1f369dd4f00bd1c28/draft.md#image-format" target="_top" shape="rect">the specification</a> for details. </p>
<div class="itemizedlist"><ul class="itemizedlist compact" style="list-style-type: disc; ">
<li class="listitem"><p> Type 1 images are ISO 9660 files that are also ELF executables. </p></li>
<li class="listitem"><p> Type 2 images are ELF executables with an appended filesystem. </p></li>
</ul></div>
<p> They can be told apart with <code class="literal">file -k</code>: </p>
<pre class="programlisting" xml:space="preserve" data-language="nix">
$ file -k type1.AppImage
type1.AppImage: ELF 64-bit LSB executable, x86-64, version 1 (SYSV) ISO 9660 CD-ROM filesystem data 'AppImage' (Lepton 3.x), scale 0-0,
spot sensor temperature 0.000000, unit celsius, color scheme 0, calibration: offset 0.000000, slope 0.000000, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.18, BuildID[sha1]=d629f6099d2344ad82818172add1d38c5e11bc6d, stripped\012- data

$ file -k type2.AppImage
type2.AppImage: ELF 64-bit LSB executable, x86-64, version 1 (SYSV) (Lepton 3.x), scale 232-60668, spot sensor temperature -4.187500, color scheme 15, show scale bar, calibration: offset -0.000000, slope 0.000000 (Lepton 2.x), scale 4111-45000, spot sensor temperature 412442.250000, color scheme 3, minimum point enabled, calibration: offset -75402534979642766821519867692934234112.000000, slope 5815371847733706829839455140374904832.000000, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.18, BuildID[sha1]=79dcc4e55a61c293c5e19edbd8d65b202842579f, stripped\012- data
</pre>
<p> Note how the type 1 AppImage is described as an <code class="literal">ISO 9660 CD-ROM filesystem</code>, and the type 2 AppImage is not. </p></section><section class="section"><div class="titlepage"><div><div><h3 id="ssec-pkgs-appimageTools-wrapping" class="title"><code>Wrapping</code></h3></div></div></div>
<p> Depending on the type of AppImage you’re wrapping, you’ll have to use <code class="literal">wrapType1</code> or <code class="literal">wrapType2</code>. </p>
<pre class="programlisting" xml:space="preserve" data-language="nix">
appimageTools.wrapType2 { # or wrapType1
  name = "patchwork";
  src = fetchurl {
    url = "https://github.com/ssbc/patchwork/releases/download/v3.11.4/Patchwork-3.11.4-linux-x86_64.AppImage";
    sha256 = "1blsprpkvm0ws9b96gb36f0rbf8f5jgmw4x6dsb1kswr4ysf591s";
  };
  extraPkgs = pkgs: with pkgs; [ ];
}
</pre>
<div class="itemizedlist"><ul class="itemizedlist compact" style="list-style-type: disc; ">
<li class="listitem"><p> <code class="literal">name</code> specifies the name of the resulting image. </p></li>
<li class="listitem"><p> <code class="literal">src</code> specifies the AppImage file to extract. </p></li>
<li class="listitem">
<p> <code class="literal">extraPkgs</code> allows you to pass a function to include additional packages inside the FHS environment your AppImage is going to run in. There are a few ways to learn which dependencies an application needs: </p>
<div class="itemizedlist"><ul class="itemizedlist compact" style="list-style-type: circle; ">
<li class="listitem"><p> Looking through the extracted AppImage files, reading its scripts and running <code class="literal">patchelf</code> and <code class="literal">ldd</code> on its executables. This can also be done in <code class="literal">appimage-run</code>, by setting <code class="literal">APPIMAGE_DEBUG_EXEC=bash</code>. </p></li>
<li class="listitem"><p> Running <code class="literal">strace -vfefile</code> on the wrapped executable, looking for libraries that can’t be found. </p></li>
</ul></div>
</li>
</ul></div></section></section><section class="section"><div class="titlepage"><div><div><h2 id="sec-pkgs-dockerTools" class="title" style="clear: both"><code>pkgs.dockerTools</code></h2></div></div></div>
<p> <code class="literal">pkgs.dockerTools</code> is a set of functions for creating and manipulating Docker images according to the <a class="link" href="https://github.com/moby/moby/blob/master/image/spec/v1.2.md#docker-image-specification-v120" target="_top" shape="rect">Docker Image Specification v1.2.0</a>. Docker itself is not used to perform any of the operations done by these functions. </p>
<section class="section"><div class="titlepage"><div><div><h3 id="ssec-pkgs-dockerTools-buildImage" class="title" data-add-to-index=""><code>pkgs.dockerTools.buildImage</code></h3></div></div></div>
<p> This function is analogous to the <code class="literal">docker build</code> command, in that it can be used to build a Docker-compatible repository tarball containing a single image with one or multiple layers. As such, the result is suitable for being loaded in Docker with <code class="literal">docker load</code>. </p>
<p> The parameters of <code class="literal">buildImage</code> with relative example values are described below: </p>

<pre class="programlisting" xml:space="preserve" data-language="nix">
buildImage {
  name = "redis";
  tag = "latest";

  fromImage = someBaseImage;
  fromImageName = null;
  fromImageTag = "latest";

  contents = pkgs.redis;
  runAsRoot = ''
    #!${pkgs.runtimeShell}
    mkdir -p /data
  '';

  config = {
    Cmd = [ "/bin/redis-server" ];
    WorkingDir = "/data";
    Volumes = { "/data" = { }; };
  };
}
</pre>
<p> The above example will build a Docker image <code class="literal">redis/latest</code> from the given base image. Loading and running this image in Docker results in <code class="literal">redis-server</code> being started automatically. </p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem"><p> <code class="literal">name</code> specifies the name of the resulting image. This is the only required argument for <code class="literal">buildImage</code>. </p></li>
<li class="listitem"><p> <code class="literal">tag</code> specifies the tag of the resulting image. By default it’s <code class="literal">null</code>, which indicates that the nix output hash will be used as tag. </p></li>
<li class="listitem"><p> <code class="literal">fromImage</code> is the repository tarball containing the base image. It must be a valid Docker image, such as exported by <code class="literal">docker save</code>. By default it’s <code class="literal">null</code>, which can be seen as equivalent to <code class="literal">FROM scratch</code> of a <code class="literal">Dockerfile</code>. </p></li>
<li class="listitem"><p> <code class="literal">fromImageName</code> can be used to further specify the base image within the repository, in case it contains multiple images. By default it’s <code class="literal">null</code>, in which case <code class="literal">buildImage</code> will peek the first image available in the repository. </p></li>
<li class="listitem"><p> <code class="literal">fromImageTag</code> can be used to further specify the tag of the base image within the repository, in case an image contains multiple tags. By default it’s <code class="literal">null</code>, in which case <code class="literal">buildImage</code> will peek the first tag available for the base image. </p></li>
<li class="listitem"><p> <code class="literal">contents</code> is a derivation that will be copied in the new layer of the resulting image. This can be similarly seen as <code class="literal">ADD contents/ /</code> in a <code class="literal">Dockerfile</code>. By default it’s <code class="literal">null</code>. </p></li>
<li class="listitem"><p> <code class="literal">runAsRoot</code> is a bash script that will run as root in an environment that overlays the existing layers of the base image with the new resulting layer, including the previously copied <code class="literal">contents</code> derivation. This can be similarly seen as <code class="literal">RUN ...</code> in a <code class="literal">Dockerfile</code>. </p></li>
</ul></div>
<div class="blockquote"><blockquote class="blockquote"><p> <span class="strong"><strong><span class="emphasis"><em>NOTE:</em></span></strong></span> Using this parameter requires the <code class="literal">kvm</code> device to be available. </p></blockquote></div>
<div class="itemizedlist"><ul class="itemizedlist compact" style="list-style-type: disc; "><li class="listitem"><p> <code class="literal">config</code> is used to specify the configuration of the containers that will be started off the built image in Docker. The available options are listed in the <a class="link" href="https://github.com/moby/moby/blob/master/image/spec/v1.2.md#image-json-field-descriptions" target="_top" shape="rect">Docker Image Specification v1.2.0</a>. </p></li></ul></div>
<p> After the new layer has been created, its closure (to which <code class="literal">contents</code>, <code class="literal">config</code> and <code class="literal">runAsRoot</code> contribute) will be copied in the layer itself. Only new dependencies that are not already in the existing layers will be copied. </p>
<p> At the end of the process, only one new single layer will be produced and added to the resulting image. </p>
<p> The resulting repository will only list the single image <code class="literal">image/tag</code>. In the case of <a class="link" href="#ex-dockerTools-buildImage" shape="rect">the <code class="literal">buildImage</code> example</a>, it would be <code class="literal">redis/latest</code>. </p>
<p> It is possible to inspect the arguments with which an image was built using its <code class="literal">buildArgs</code> attribute. </p>
<div class="blockquote"><blockquote class="blockquote"><p> <span class="strong"><strong><span class="emphasis"><em>NOTE:</em></span></strong></span> If you see errors similar to <code class="literal">getProtocolByName: does not exist (no such protocol name: tcp)</code> you may need to add <code class="literal">pkgs.iana-etc</code> to <code class="literal">contents</code>. </p></blockquote></div>
<div class="blockquote"><blockquote class="blockquote"><p> <span class="strong"><strong><span class="emphasis"><em>NOTE:</em></span></strong></span> If you see errors similar to <code class="literal">Error_Protocol ("certificate has unknown CA",True,UnknownCa)</code> you may need to add <code class="literal">pkgs.cacert</code> to <code class="literal">contents</code>. </p></blockquote></div>
<p> By default <code class="literal">buildImage</code> will use a static date of one second past the UNIX Epoch. This allows <code class="literal">buildImage</code> to produce binary reproducible images. When listing images with <code class="literal">docker images</code>, the newly created images will be listed like this: </p>
<pre class="programlisting" xml:space="preserve" data-language="nix">
$ docker images
REPOSITORY   TAG      IMAGE ID       CREATED        SIZE
hello        latest   08c791c7846e   48 years ago   25.2MB
</pre>
<p> You can break binary reproducibility but have a sorted, meaningful <code class="literal">CREATED</code> column by setting <code class="literal">created</code> to <code class="literal">now</code>. </p>
<pre class="programlisting" xml:space="preserve" data-language="nix">
pkgs.dockerTools.buildImage {
  name = "hello";
  tag = "latest";
  created = "now";
  contents = pkgs.hello;

  config.Cmd = [ "/bin/hello" ];
}
</pre>
<p> Now the Docker CLI will display a reasonable date and sort the images as expected: </p>
<pre class="programlisting" xml:space="preserve" data-language="nix">
$ docker images
REPOSITORY   TAG      IMAGE ID       CREATED              SIZE
hello        latest   de2bf4786de6   About a minute ago   25.2MB
</pre>
<p> However, the produced images will not be binary reproducible. </p></section><section class="section"><div class="titlepage"><div><div><h3 id="ssec-pkgs-dockerTools-buildLayeredImage" class="title" data-add-to-index=""><code>pkgs.dockerTools.buildLayeredImage</code></h3></div></div></div>
<p> Create a Docker image with many of the store paths being on their own layer to improve sharing between images. The image is realized into the Nix store as a gzipped tarball. Depending on the intended usage, many users might prefer to use <code class="literal">streamLayeredImage</code> instead, which this function uses internally. </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"> <code class="literal">name</code> </span></dt>
<dd><p> The name of the resulting image. </p></dd>
<dt><span class="term"> <code class="literal">tag</code> <span class="emphasis"><em>optional</em></span> </span></dt>
<dd>
<p> Tag of the generated image. </p>
<p> <span class="emphasis"><em>Default:</em></span> the output path’s hash </p>
</dd>
<dt><span class="term"> <code class="literal">fromImage</code> <span class="emphasis"><em>optional</em></span> </span></dt>
<dd>
<p> The repository tarball containing the base image. It must be a valid Docker image, such as one exported by <code class="literal">docker save</code>. </p>
<p> <span class="emphasis"><em>Default:</em></span> <code class="literal">null</code>, which can be seen as equivalent to <code class="literal">FROM scratch</code> of a <code class="literal">Dockerfile</code>. </p>
</dd>
<dt><span class="term"> <code class="literal">contents</code> <span class="emphasis"><em>optional</em></span> </span></dt>
<dd>
<p> Top-level paths in the container. Either a single derivation, or a list of derivations. </p>
<p> <span class="emphasis"><em>Default:</em></span> <code class="literal">[]</code> </p>
</dd>
<dt><span class="term"> <code class="literal">config</code> <span class="emphasis"><em>optional</em></span> </span></dt>
<dd>
<p> Run-time configuration of the container. A full list of the options are available at in the <a class="link" href="https://github.com/moby/moby/blob/master/image/spec/v1.2.md#image-json-field-descriptions" target="_top" shape="rect">Docker Image Specification v1.2.0</a>. </p>
<p> <span class="emphasis"><em>Default:</em></span> <code class="literal">{}</code> </p>
</dd>
<dt><span class="term"> <code class="literal">created</code> <span class="emphasis"><em>optional</em></span> </span></dt>
<dd>
<p> Date and time the layers were created. Follows the same <code class="literal">now</code> exception supported by <code class="literal">buildImage</code>. </p>
<p> <span class="emphasis"><em>Default:</em></span> <code class="literal">1970-01-01T00:00:01Z</code> </p>
</dd>
<dt><span class="term"> <code class="literal">maxLayers</code> <span class="emphasis"><em>optional</em></span> </span></dt>
<dd>
<p> Maximum number of layers to create. </p>
<p> <span class="emphasis"><em>Default:</em></span> <code class="literal">100</code> </p>
<p> <span class="emphasis"><em>Maximum:</em></span> <code class="literal">125</code> </p>
</dd>
<dt><span class="term"> <code class="literal">extraCommands</code> <span class="emphasis"><em>optional</em></span> </span></dt>
<dd><p> Shell commands to run while building the final layer, without access to most of the layer contents. Changes to this layer are <span class="quote">“<span class="quote">on top</span>”</span> of all the other layers, so can create additional directories and files. </p></dd>
<dt><span class="term"> <code class="literal">fakeRootCommands</code> <span class="emphasis"><em>optional</em></span> </span></dt>
<dd><p> Shell commands to run while creating the archive for the final layer in a fakeroot environment. Unlike <code class="literal">extraCommands</code>, you can run <code class="literal">chown</code> to change the owners of the files in the archive, changing fakeroot’s state instead of the real filesystem. The latter would require privileges that the build user does not have. Static binaries do not interact with the fakeroot environment. By default all files in the archive will be owned by root. </p></dd>
<dt><span class="term"> <code class="literal">enableFakechroot</code> <span class="emphasis"><em>optional</em></span> </span></dt>
<dd>
<p> Whether to run in <code class="literal">fakeRootCommands</code> in <code class="literal">fakechroot</code>, making programs behave as though <code class="literal">/</code> is the root of the image being created, while files in the Nix store are available as usual. This allows scripts that perform installation in <code class="literal">/</code> to work as expected. Considering that <code class="literal">fakechroot</code> is implemented via the same mechanism as <code class="literal">fakeroot</code>, the same caveats apply. </p>
<p> <span class="emphasis"><em>Default:</em></span> <code class="literal">false</code> </p>
</dd>
</dl></div>
<section class="section"><div class="titlepage"><div><div><h4 class="title">
<code>Behavior of </code><code class="literal">contents</code> in the final image</h4></div></div></div>
<p> Each path directly listed in <code class="literal">contents</code> will have a symlink in the root of the image. </p>
<p> For example: </p>
<pre class="programlisting" xml:space="preserve" data-language="nix">
pkgs.dockerTools.buildLayeredImage {
  name = "hello";
  contents = [ pkgs.hello ];
}
</pre>
<p> will create symlinks for all the paths in the <code class="literal">hello</code> package: </p>
<pre class="programlisting" xml:space="preserve" data-language="nix">
/bin/hello -&gt; /nix/store/h1zb1padqbbb7jicsvkmrym3r6snphxg-hello-2.10/bin/hello
/share/info/hello.info -&gt; /nix/store/h1zb1padqbbb7jicsvkmrym3r6snphxg-hello-2.10/share/info/hello.info
/share/locale/bg/LC_MESSAGES/hello.mo -&gt; /nix/store/h1zb1padqbbb7jicsvkmrym3r6snphxg-hello-2.10/share/locale/bg/LC_MESSAGES/hello.mo
</pre></section><section class="section"><div class="titlepage"><div><div><h4 class="title">
<code>Automatic inclusion of </code><code class="literal">config</code> references</h4></div></div></div>
<p> The closure of <code class="literal">config</code> is automatically included in the closure of the final image. </p>
<p> This allows you to make very simple Docker images with very little code. This container will start up and run <code class="literal">hello</code>: </p>
<pre class="programlisting" xml:space="preserve" data-language="nix">
pkgs.dockerTools.buildLayeredImage {
  name = "hello";
  config.Cmd = [ "${pkgs.hello}/bin/hello" ];
}
</pre></section><section class="section"><div class="titlepage"><div><div><h4 class="title">
<code>Adjusting </code><code class="literal">maxLayers</code>
</h4></div></div></div>
<p> Increasing the <code class="literal">maxLayers</code> increases the number of layers which have a chance to be shared between different images. </p>
<p> Modern Docker installations support up to 128 layers, but older versions support as few as 42. </p>
<p> If the produced image will not be extended by other Docker builds, it is safe to set <code class="literal">maxLayers</code> to <code class="literal">128</code>. However, it will be impossible to extend the image further. </p>
<p> The first (<code class="literal">maxLayers-2</code>) most <span class="quote">“<span class="quote">popular</span>”</span> paths will have their own individual layers, then layer #<code class="literal">maxLayers-1</code> will contain all the remaining <span class="quote">“<span class="quote">unpopular</span>”</span> paths, and finally layer #<code class="literal">maxLayers</code> will contain the Image configuration. </p>
<p> Docker’s Layers are not inherently ordered, they are content-addressable and are not explicitly layered until they are composed in to an Image. </p></section></section><section class="section"><div class="titlepage"><div><div><h3 id="ssec-pkgs-dockerTools-streamLayeredImage" class="title" data-add-to-index=""><code>pkgs.dockerTools.streamLayeredImage</code></h3></div></div></div>
<p> Builds a script which, when run, will stream an uncompressed tarball of a Docker image to stdout. The arguments to this function are as for <code class="literal">buildLayeredImage</code>. This method of constructing an image does not realize the image into the Nix store, so it saves on IO and disk/cache space, particularly with large images. </p>
<p> The image produced by running the output script can be piped directly into <code class="literal">docker load</code>, to load it into the local docker daemon: </p>
<pre class="programlisting" xml:space="preserve" data-language="nix">
$(nix-build) | docker load
</pre>
<p> Alternatively, the image be piped via <code class="literal">gzip</code> into <code class="literal">skopeo</code>, e.g., to copy it into a registry: </p>
<pre class="programlisting" xml:space="preserve" data-language="nix">
$(nix-build) | gzip --fast | skopeo copy docker-archive:/dev/stdin docker://some_docker_registry/myimage:tag
</pre></section><section class="section"><div class="titlepage"><div><div><h3 id="ssec-pkgs-dockerTools-fetchFromRegistry" class="title" data-add-to-index=""><code>pkgs.dockerTools.pullImage</code></h3></div></div></div>
<p> This function is analogous to the <code class="literal">docker pull</code> command, in that it can be used to pull a Docker image from a Docker registry. By default <a class="link" href="https://hub.docker.com/" target="_top" shape="rect">Docker Hub</a> is used to pull images. </p>
<p> Its parameters are described in the example below: </p>
<pre class="programlisting" xml:space="preserve" data-language="nix">
pullImage {
  imageName = "nixos/nix";
  imageDigest =
    "sha256:20d9485b25ecfd89204e843a962c1bd70e9cc6858d65d7f5fadc340246e2116b";
  finalImageName = "nix";
  finalImageTag = "1.11";
  sha256 = "0mqjy3zq2v6rrhizgb9nvhczl87lcfphq9601wcprdika2jz7qh8";
  os = "linux";
  arch = "x86_64";
}
</pre>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem"><p> <code class="literal">imageName</code> specifies the name of the image to be downloaded, which can also include the registry namespace (e.g. <code class="literal">nixos</code>). This argument is required. </p></li>
<li class="listitem"><p> <code class="literal">imageDigest</code> specifies the digest of the image to be downloaded. This argument is required. </p></li>
<li class="listitem"><p> <code class="literal">finalImageName</code>, if specified, this is the name of the image to be created. Note it is never used to fetch the image since we prefer to rely on the immutable digest ID. By default it’s equal to <code class="literal">imageName</code>. </p></li>
<li class="listitem"><p> <code class="literal">finalImageTag</code>, if specified, this is the tag of the image to be created. Note it is never used to fetch the image since we prefer to rely on the immutable digest ID. By default it’s <code class="literal">latest</code>. </p></li>
<li class="listitem"><p> <code class="literal">sha256</code> is the checksum of the whole fetched image. This argument is required. </p></li>
<li class="listitem"><p> <code class="literal">os</code>, if specified, is the operating system of the fetched image. By default it’s <code class="literal">linux</code>. </p></li>
<li class="listitem"><p> <code class="literal">arch</code>, if specified, is the cpu architecture of the fetched image. By default it’s <code class="literal">x86_64</code>. </p></li>
</ul></div>
<p> <code class="literal">nix-prefetch-docker</code> command can be used to get required image parameters: </p>
<pre class="programlisting" xml:space="preserve" data-language="nix">
$ nix run nixpkgs.nix-prefetch-docker -c nix-prefetch-docker --image-name mysql --image-tag 5
</pre>
<p> Since a given <code class="literal">imageName</code> may transparently refer to a manifest list of images which support multiple architectures and/or operating systems, you can supply the <code class="literal">--os</code> and <code class="literal">--arch</code> arguments to specify exactly which image you want. By default it will match the OS and architecture of the host the command is run on. </p>
<pre class="programlisting" xml:space="preserve" data-language="nix">
$ nix-prefetch-docker --image-name mysql --image-tag 5 --arch x86_64 --os linux
</pre>
<p> Desired image name and tag can be set using <code class="literal">--final-image-name</code> and <code class="literal">--final-image-tag</code> arguments: </p>
<pre class="programlisting" xml:space="preserve" data-language="nix">
$ nix-prefetch-docker --image-name mysql --image-tag 5 --final-image-name eu.gcr.io/my-project/mysql --final-image-tag prod
</pre></section><section class="section"><div class="titlepage"><div><div><h3 id="ssec-pkgs-dockerTools-exportImage" class="title" data-add-to-index=""><code>pkgs.dockerTools.exportImage</code></h3></div></div></div>
<p> This function is analogous to the <code class="literal">docker export</code> command, in that it can be used to flatten a Docker image that contains multiple layers. It is in fact the result of the merge of all the layers of the image. As such, the result is suitable for being imported in Docker with <code class="literal">docker import</code>. </p>
<div class="blockquote"><blockquote class="blockquote"><p> <span class="strong"><strong><span class="emphasis"><em>NOTE:</em></span></strong></span> Using this function requires the <code class="literal">kvm</code> device to be available. </p></blockquote></div>
<p> The parameters of <code class="literal">exportImage</code> are the following: </p>
<pre class="programlisting" xml:space="preserve" data-language="nix">
exportImage {
  fromImage = someLayeredImage;
  fromImageName = null;
  fromImageTag = null;

  name = someLayeredImage.name;
}
</pre>
<p> The parameters relative to the base image have the same synopsis as described in <a class="link" href="#ssec-pkgs-dockerTools-buildImage" title="15.2.1. buildImage" shape="rect">buildImage</a>, except that <code class="literal">fromImage</code> is the only required argument in this case. </p>
<p> The <code class="literal">name</code> argument is the name of the derivation output, which defaults to <code class="literal">fromImage.name</code>. </p></section><section class="section"><div class="titlepage"><div><div><h3 id="ssec-pkgs-dockerTools-shadowSetup" class="title" data-add-to-index=""><code>pkgs.dockerTools.shadowSetup</code></h3></div></div></div>
<p> This constant string is a helper for setting up the base files for managing users and groups, only if such files don’t exist already. It is suitable for being used in a <a class="link" href="#ex-dockerTools-buildImage-runAsRoot" shape="rect"><code class="literal">buildImage</code> <code class="literal">runAsRoot</code></a> script for cases like in the example below: </p>
<pre class="programlisting" xml:space="preserve" data-language="nix">
buildImage {
  name = "shadow-basic";

  runAsRoot = ''
    #!${pkgs.runtimeShell}
    ${pkgs.dockerTools.shadowSetup}
    groupadd -r redis
    useradd -r -g redis redis
    mkdir /data
    chown redis:redis /data
  '';
}
</pre>
<p> Creating base files like <code class="literal">/etc/passwd</code> or <code class="literal">/etc/login.defs</code> is necessary for shadow-utils to manipulate users and groups. </p></section></section><section class="section"><div class="titlepage"><div><div><h2 id="sec-pkgs-ociTools" class="title" style="clear: both"><code>pkgs.ociTools</code></h2></div></div></div>
<p> <code class="literal">pkgs.ociTools</code> is a set of functions for creating containers according to the <a class="link" href="https://github.com/opencontainers/runtime-spec" target="_top" shape="rect">OCI container specification v1.0.0</a>. Beyond that, it makes no assumptions about the container runner you choose to use to run the created container. </p>
<section class="section"><div class="titlepage"><div><div><h3 id="ssec-pkgs-ociTools-buildContainer" class="title" data-add-to-index=""><code>pkgs.ociTools.buildContainer</code></h3></div></div></div>
<p> This function creates a simple OCI container that runs a single command inside of it. An OCI container consists of a <code class="literal">config.json</code> and a rootfs directory. The nix store of the container will contain all referenced dependencies of the given command. </p>
<p> The parameters of <code class="literal">buildContainer</code> with an example value are described below: </p>
<pre class="programlisting" xml:space="preserve" data-language="nix">
buildContainer {
  args = [
    (with pkgs;
      writeScript "run.sh" ''
        #!${bash}/bin/bash
        exec ${bash}/bin/bash
      '').outPath
  ];

  mounts = {
    "/data" = {
      type = "none";
      source = "/var/lib/mydata";
      options = [ "bind" ];
    };
  };

  readonly = false;
}
</pre>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem"><p> <code class="literal">args</code> specifies a set of arguments to run inside the container. This is the only required argument for <code class="literal">buildContainer</code>. All referenced packages inside the derivation will be made available inside the container. </p></li>
<li class="listitem"><p> <code class="literal">mounts</code> specifies additional mount points chosen by the user. By default only a minimal set of necessary filesystems are mounted into the container (e.g procfs, cgroupfs) </p></li>
<li class="listitem"><p> <code class="literal">readonly</code> makes the container's rootfs read-only if it is set to true. The default value is false <code class="literal">false</code>. </p></li>
</ul></div></section></section><section class="section"><div class="titlepage"><div><div><h2 id="sec-pkgs-snapTools" class="title" style="clear: both"><code>pkgs.snapTools</code></h2></div></div></div>
<p> <code class="literal">pkgs.snapTools</code> is a set of functions for creating Snapcraft images. Snap and Snapcraft is not used to perform these operations. </p>
<section class="section"><div class="titlepage"><div><div><h3 id="ssec-pkgs-snapTools-makeSnap-signature" class="title"><code>The makeSnap Function</code></h3></div></div></div>
<p> <code class="literal">makeSnap</code> takes a single named argument, <code class="literal">meta</code>. This argument mirrors <a class="link" href="https://docs.snapcraft.io/snap-format" target="_top" shape="rect">the upstream <code class="literal">snap.yaml</code> format</a> exactly. </p>
<p> The <code class="literal">base</code> should not be specified, as <code class="literal">makeSnap</code> will force set it. </p>
<p> Currently, <code class="literal">makeSnap</code> does not support creating GUI stubs. </p></section><section class="section"><div class="titlepage"><div><div><h3 id="ssec-pkgs-snapTools-build-a-snap-hello" class="title"><code>Build a Hello World Snap</code></h3></div></div></div>
<p> The following expression packages GNU Hello as a Snapcraft snap. </p>
<pre class="programlisting" xml:space="preserve" data-language="nix">
let
  inherit (import &lt;nixpkgs&gt; { }) snapTools hello;
in snapTools.makeSnap {
  meta = {
    name = "hello";
    summary = hello.meta.description;
    description = hello.meta.longDescription;
    architectures = [ "amd64" ];
    confinement = "strict";
    apps.hello.command = "${hello}/bin/hello";
  };
}
</pre>
<p> <code class="literal">nix-build</code> this expression and install it with <code class="literal">snap install ./result --dangerous</code>. <code class="literal">hello</code> will now be the Snapcraft version of the package. </p></section><section class="section"><div class="titlepage"><div><div><h3 id="ssec-pkgs-snapTools-build-a-snap-firefox" class="title"><code>Build a Graphical Snap</code></h3></div></div></div>
<p> Graphical programs require many more integrations with the host. This example uses Firefox as an example because it is one of the most complicated programs we could package. </p>
<pre class="programlisting" xml:space="preserve" data-language="nix">
let
  inherit (import &lt;nixpkgs&gt; { }) snapTools firefox;
in snapTools.makeSnap {
  meta = {
    name = "nix-example-firefox";
    summary = firefox.meta.description;
    architectures = [ "amd64" ];
    apps.nix-example-firefox = {
      command = "${firefox}/bin/firefox";
      plugs = [
        "pulseaudio"
        "camera"
        "browser-support"
        "avahi-observe"
        "cups-control"
        "desktop"
        "desktop-legacy"
        "gsettings"
        "home"
        "network"
        "mount-observe"
        "removable-media"
        "x11"
      ];
    };
    confinement = "strict";
  };
}
</pre>
<p> <code class="literal">nix-build</code> this expression and install it with <code class="literal">snap install ./result --dangerous</code>. <code class="literal">nix-example-firefox</code> will now be the Snapcraft version of the Firefox package. </p>
<p> The specific meaning behind plugs can be looked up in the <a class="link" href="https://docs.snapcraft.io/supported-interfaces" target="_top" shape="rect">Snapcraft interface documentation</a>. </p></section></section><div class="_attribution">
  <p class="_attribution-p">
    © 2022 NixOS Contributors<br>Licensed under the LGPL License.<br>
    <a href="https://nixos.org/manual/nixpkgs/stable/index.html" class="_attribution-link">https://nixos.org/manual/nixpkgs/stable/index.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
