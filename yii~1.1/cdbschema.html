
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>CDbSchema - Yii 1.1 - W3cubDocs</title>
  
  <meta name="description" content=" the abstract column types mapped to physical column types. ">
  <meta name="keywords" content="cdbschema, yii, yii~1.1">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/yii~1.1/cdbschema.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-01fda2ddb8339756caccf7add5ad4cf849ab52d069bd799015c7f04f93164f64753bff0d15a49d8060b1e66e41002bb301ccadc2350937df079cea3cd52d3cca.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/yii~1.1.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/yii~1.1/" class="_nav-link" title="" style="margin-left:0;">Yii 1.1</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _yii">
				
				
<h1>CDbSchema</h1>  <table class="summaryTable docClass"> <colgroup> <col class="col-name"> <col class="col-value"> </colgroup> <tr> <th>Package</th> <td><a href="index#system.db.schema">system.db.schema</a></td> </tr> <tr> <th>Inheritance</th> <td>abstract class CDbSchema » <a href="ccomponent">CComponent</a>
</td> </tr> <tr> <th>Subclasses</th> <td>
<a href="ccubridschema">CCubridSchema</a>, <a href="cmssqlschema">CMssqlSchema</a>, <a href="cmysqlschema">CMysqlSchema</a>, <a href="cocischema">COciSchema</a>, <a href="cpgsqlschema">CPgsqlSchema</a>, <a href="csqliteschema">CSqliteSchema</a>
</td> </tr> <tr> <th>Since</th> <td>1.0</td> </tr> <tr> <th>Source Code</th> <td><a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/CDbSchema.php">framework/db/schema/CDbSchema.php</a></td> </tr> </table> <div id="classDescription"> CDbSchema is the base class for retrieving metadata information.</div>  <div class="summary docProperty"> <h2>Public Properties</h2>  <table class="summaryTable"> <colgroup> <col class="col-property"> <col class="col-type"> <col class="col-description"> <col class="col-defined"> </colgroup> <tr> <th>Property</th>
<th>Type</th>
<th>Description</th>
<th>Defined By</th> </tr> <tr id="columnTypes"> <td><a href="cdbschema#columnTypes-detail">columnTypes</a></td> <td>array</td> <td>the abstract column types mapped to physical column types.</td> <td>CDbSchema</td> </tr> <tr id="commandBuilder"> <td><a href="cdbschema#commandBuilder-detail">commandBuilder</a></td> <td><a href="cdbcommandbuilder">CDbCommandBuilder</a></td> <td>the SQL command builder for this connection.</td> <td>CDbSchema</td> </tr> <tr id="dbConnection"> <td><a href="cdbschema#dbConnection-detail">dbConnection</a></td> <td><a href="cdbconnection">CDbConnection</a></td> <td>database connection.</td> <td>CDbSchema</td> </tr> <tr id="tableNames"> <td><a href="cdbschema#tableNames-detail">tableNames</a></td> <td>array</td> <td>Returns all table names in the database.</td> <td>CDbSchema</td> </tr> <tr id="tables"> <td><a href="cdbschema#tables-detail">tables</a></td> <td>array</td> <td>Returns the metadata for all tables in the database.</td> <td>CDbSchema</td> </tr> </table> </div>  <div class="summary docMethod"> <h2>Public Methods</h2>  <table class="summaryTable"> <colgroup> <col class="col-method"> <col class="col-description"> <col class="col-defined"> </colgroup> <tr> <th>Method</th>
<th>Description</th>
<th>Defined By</th> </tr> <tr class="inherited" id="__call"> <td><a href="ccomponent#__call-detail">__call()</a></td> <td>Calls the named method which is not a class method.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr id="__construct"> <td><a href="cdbschema#__construct-detail">__construct()</a></td> <td>Constructor.</td> <td>CDbSchema</td> </tr> <tr class="inherited" id="__get"> <td><a href="ccomponent#__get-detail">__get()</a></td> <td>Returns a property value, an event handler list or a behavior based on its name.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="__isset"> <td><a href="ccomponent#__isset-detail">__isset()</a></td> <td>Checks if a property value is null.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="__set"> <td><a href="ccomponent#__set-detail">__set()</a></td> <td>Sets value of a component property.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="__unset"> <td><a href="ccomponent#__unset-detail">__unset()</a></td> <td>Sets a component property to be null.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr id="addColumn"> <td><a href="cdbschema#addColumn-detail">addColumn()</a></td> <td>Builds a SQL statement for adding a new DB column.</td> <td>CDbSchema</td> </tr> <tr id="addForeignKey"> <td><a href="cdbschema#addForeignKey-detail">addForeignKey()</a></td> <td>Builds a SQL statement for adding a foreign key constraint to an existing table.</td> <td>CDbSchema</td> </tr> <tr id="addPrimaryKey"> <td><a href="cdbschema#addPrimaryKey-detail">addPrimaryKey()</a></td> <td>Builds a SQL statement for adding a primary key constraint to an existing table.</td> <td>CDbSchema</td> </tr> <tr id="alterColumn"> <td><a href="cdbschema#alterColumn-detail">alterColumn()</a></td> <td>Builds a SQL statement for changing the definition of a column.</td> <td>CDbSchema</td> </tr> <tr class="inherited" id="asa"> <td><a href="ccomponent#asa-detail">asa()</a></td> <td>Returns the named behavior object.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="attachBehavior"> <td><a href="ccomponent#attachBehavior-detail">attachBehavior()</a></td> <td>Attaches a behavior to this component.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="attachBehaviors"> <td><a href="ccomponent#attachBehaviors-detail">attachBehaviors()</a></td> <td>Attaches a list of behaviors to the component.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="attachEventHandler"> <td><a href="ccomponent#attachEventHandler-detail">attachEventHandler()</a></td> <td>Attaches an event handler to an event.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="canGetProperty"> <td><a href="ccomponent#canGetProperty-detail">canGetProperty()</a></td> <td>Determines whether a property can be read.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="canSetProperty"> <td><a href="ccomponent#canSetProperty-detail">canSetProperty()</a></td> <td>Determines whether a property can be set.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr id="checkIntegrity"> <td><a href="cdbschema#checkIntegrity-detail">checkIntegrity()</a></td> <td>Enables or disables integrity check.</td> <td>CDbSchema</td> </tr> <tr id="compareTableNames"> <td><a href="cdbschema#compareTableNames-detail">compareTableNames()</a></td> <td>Compares two table names.</td> <td>CDbSchema</td> </tr> <tr id="createIndex"> <td><a href="cdbschema#createIndex-detail">createIndex()</a></td> <td>Builds a SQL statement for creating a new index.</td> <td>CDbSchema</td> </tr> <tr id="createTable"> <td><a href="cdbschema#createTable-detail">createTable()</a></td> <td>Builds a SQL statement for creating a new DB table.</td> <td>CDbSchema</td> </tr> <tr class="inherited" id="detachBehavior"> <td><a href="ccomponent#detachBehavior-detail">detachBehavior()</a></td> <td>Detaches a behavior from the component.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="detachBehaviors"> <td><a href="ccomponent#detachBehaviors-detail">detachBehaviors()</a></td> <td>Detaches all behaviors from the component.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="detachEventHandler"> <td><a href="ccomponent#detachEventHandler-detail">detachEventHandler()</a></td> <td>Detaches an existing event handler.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="disableBehavior"> <td><a href="ccomponent#disableBehavior-detail">disableBehavior()</a></td> <td>Disables an attached behavior.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="disableBehaviors"> <td><a href="ccomponent#disableBehaviors-detail">disableBehaviors()</a></td> <td>Disables all behaviors attached to this component.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr id="dropColumn"> <td><a href="cdbschema#dropColumn-detail">dropColumn()</a></td> <td>Builds a SQL statement for dropping a DB column.</td> <td>CDbSchema</td> </tr> <tr id="dropForeignKey"> <td><a href="cdbschema#dropForeignKey-detail">dropForeignKey()</a></td> <td>Builds a SQL statement for dropping a foreign key constraint.</td> <td>CDbSchema</td> </tr> <tr id="dropIndex"> <td><a href="cdbschema#dropIndex-detail">dropIndex()</a></td> <td>Builds a SQL statement for dropping an index.</td> <td>CDbSchema</td> </tr> <tr id="dropPrimaryKey"> <td><a href="cdbschema#dropPrimaryKey-detail">dropPrimaryKey()</a></td> <td>Builds a SQL statement for removing a primary key constraint to an existing table.</td> <td>CDbSchema</td> </tr> <tr id="dropTable"> <td><a href="cdbschema#dropTable-detail">dropTable()</a></td> <td>Builds a SQL statement for dropping a DB table.</td> <td>CDbSchema</td> </tr> <tr class="inherited" id="enableBehavior"> <td><a href="ccomponent#enableBehavior-detail">enableBehavior()</a></td> <td>Enables an attached behavior.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="enableBehaviors"> <td><a href="ccomponent#enableBehaviors-detail">enableBehaviors()</a></td> <td>Enables all behaviors attached to this component.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="evaluateExpression"> <td><a href="ccomponent#evaluateExpression-detail">evaluateExpression()</a></td> <td>Evaluates a PHP expression or callback under the context of this component.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr id="getColumnType"> <td><a href="cdbschema#getColumnType-detail">getColumnType()</a></td> <td>Converts an abstract column type into a physical column type.</td> <td>CDbSchema</td> </tr> <tr id="getCommandBuilder"> <td><a href="cdbschema#getCommandBuilder-detail">getCommandBuilder()</a></td> <td>Returns the SQL command builder for this connection.</td> <td>CDbSchema</td> </tr> <tr id="getDbConnection"> <td><a href="cdbschema#getDbConnection-detail">getDbConnection()</a></td> <td>Returns database connection. The connection is active.</td> <td>CDbSchema</td> </tr> <tr class="inherited" id="getEventHandlers"> <td><a href="ccomponent#getEventHandlers-detail">getEventHandlers()</a></td> <td>Returns the list of attached event handlers for an event.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr id="getTable"> <td><a href="cdbschema#getTable-detail">getTable()</a></td> <td>Obtains the metadata for the named table.</td> <td>CDbSchema</td> </tr> <tr id="getTableNames"> <td><a href="cdbschema#getTableNames-detail">getTableNames()</a></td> <td>Returns all table names in the database.</td> <td>CDbSchema</td> </tr> <tr id="getTables"> <td><a href="cdbschema#getTables-detail">getTables()</a></td> <td>Returns the metadata for all tables in the database.</td> <td>CDbSchema</td> </tr> <tr class="inherited" id="hasEvent"> <td><a href="ccomponent#hasEvent-detail">hasEvent()</a></td> <td>Determines whether an event is defined.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="hasEventHandler"> <td><a href="ccomponent#hasEventHandler-detail">hasEventHandler()</a></td> <td>Checks whether the named event has attached handlers.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="hasProperty"> <td><a href="ccomponent#hasProperty-detail">hasProperty()</a></td> <td>Determines whether a property is defined.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr id="quoteColumnName"> <td><a href="cdbschema#quoteColumnName-detail">quoteColumnName()</a></td> <td>Quotes a column name for use in a query.</td> <td>CDbSchema</td> </tr> <tr id="quoteSimpleColumnName"> <td><a href="cdbschema#quoteSimpleColumnName-detail">quoteSimpleColumnName()</a></td> <td>Quotes a simple column name for use in a query.</td> <td>CDbSchema</td> </tr> <tr id="quoteSimpleTableName"> <td><a href="cdbschema#quoteSimpleTableName-detail">quoteSimpleTableName()</a></td> <td>Quotes a simple table name for use in a query.</td> <td>CDbSchema</td> </tr> <tr id="quoteTableName"> <td><a href="cdbschema#quoteTableName-detail">quoteTableName()</a></td> <td>Quotes a table name for use in a query.</td> <td>CDbSchema</td> </tr> <tr class="inherited" id="raiseEvent"> <td><a href="ccomponent#raiseEvent-detail">raiseEvent()</a></td> <td>Raises an event.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr id="refresh"> <td><a href="cdbschema#refresh-detail">refresh()</a></td> <td>Refreshes the schema.</td> <td>CDbSchema</td> </tr> <tr id="renameColumn"> <td><a href="cdbschema#renameColumn-detail">renameColumn()</a></td> <td>Builds a SQL statement for renaming a column.</td> <td>CDbSchema</td> </tr> <tr id="renameTable"> <td><a href="cdbschema#renameTable-detail">renameTable()</a></td> <td>Builds a SQL statement for renaming a DB table.</td> <td>CDbSchema</td> </tr> <tr id="resetSequence"> <td><a href="cdbschema#resetSequence-detail">resetSequence()</a></td> <td>Resets the sequence value of a table's primary key.</td> <td>CDbSchema</td> </tr> <tr id="truncateTable"> <td><a href="cdbschema#truncateTable-detail">truncateTable()</a></td> <td>Builds a SQL statement for truncating a DB table.</td> <td>CDbSchema</td> </tr> </table> </div> <div class="summary docMethod"> <h2>Protected Methods</h2>  <table class="summaryTable"> <colgroup> <col class="col-method"> <col class="col-description"> <col class="col-defined"> </colgroup> <tr> <th>Method</th>
<th>Description</th>
<th>Defined By</th> </tr> <tr id="createCommandBuilder"> <td><a href="cdbschema#createCommandBuilder-detail">createCommandBuilder()</a></td> <td>Creates a command builder for the database.</td> <td>CDbSchema</td> </tr> <tr id="findTableNames"> <td><a href="cdbschema#findTableNames-detail">findTableNames()</a></td> <td>Returns all table names in the database.</td> <td>CDbSchema</td> </tr> <tr id="loadTable"> <td><a href="cdbschema#loadTable-detail">loadTable()</a></td> <td>Loads the metadata for the specified table.</td> <td>CDbSchema</td> </tr> </table> </div>  <h2>Property Details</h2> <h3 class="detailHeader" id="columnTypes-detail"> columnTypes<span class="detailHeaderTag"> property (available since v1.1.6) </span> </h3> <pre class="signature">public array <b>$columnTypes</b>;</pre> <p>the abstract column types mapped to physical column types.</p> <h3 class="detailHeader" id="commandBuilder-detail"> commandBuilder<span class="detailHeaderTag"> property <em>read-only</em> </span> </h3> <pre class="signature">public <a href="cdbcommandbuilder">CDbCommandBuilder</a> <a href="cdbschema#getCommandBuilder"><b>getCommandBuilder</b></a>()</pre> <p>the SQL command builder for this connection.</p> <h3 class="detailHeader" id="dbConnection-detail"> dbConnection<span class="detailHeaderTag"> property <em>read-only</em> </span> </h3> <pre class="signature">public <a href="cdbconnection">CDbConnection</a> <a href="cdbschema#getDbConnection"><b>getDbConnection</b></a>()</pre> <p>database connection. The connection is active.</p> <h3 class="detailHeader" id="tableNames-detail"> tableNames<span class="detailHeaderTag"> property <em>read-only</em> </span> </h3> <pre class="signature">public array <a href="cdbschema#getTableNames"><b>getTableNames</b></a>(string $schema='')</pre> <p>Returns all table names in the database.</p> <h3 class="detailHeader" id="tables-detail"> tables<span class="detailHeaderTag"> property <em>read-only</em> </span> </h3> <pre class="signature">public array <a href="cdbschema#getTables"><b>getTables</b></a>(string $schema='')</pre> <p>Returns the metadata for all tables in the database.</p> <h2>Method Details</h2> <h3 class="detailHeader" id="__construct-detail"> __construct() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public void <b>__construct</b>(<a href="cdbconnection">CDbConnection</a> $conn)</pre> </td></tr> <tr> <td class="paramNameCol">$conn</td> <td class="paramTypeCol"><a href="cdbconnection">CDbConnection</a></td> <td class="paramDescCol">database connection.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/CDbSchema.php#L50">framework/db/schema/CDbSchema.php#50</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">__construct</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">)<br>{<br>    </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_connection</span><span style="color: #007700">=</span><span style="color: #0000BB">$conn</span><span style="color: #007700">;<br>    foreach(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">schemaCachingExclude </span><span style="color: #007700">as </span><span style="color: #0000BB">$name</span><span style="color: #007700">)<br>        </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_cacheExclude</span><span style="color: #007700">[</span><span style="color: #0000BB">$name</span><span style="color: #007700">]=</span><span style="color: #0000BB">true</span><span style="color: #007700">;<br>}</span></pre> </div> <p>Constructor.</p> <h3 class="detailHeader" id="addColumn-detail"> addColumn() <span class="detailHeaderTag"> method (available since v1.1.6) </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public string <b>addColumn</b>(string $table, string $column, string $type)</pre> </td></tr> <tr> <td class="paramNameCol">$table</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the table that the new column will be added to. The table name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">$column</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the name of the new column. The name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">$type</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the column type. The <a href="cdbschema#getColumnType">getColumnType</a> method will be invoked to convert abstract column type (if any) into the physical one. Anything that is not recognized as abstract type will be kept in the generated SQL. For example, 'string' will be turned into 'varchar(255)', while 'string not null' will become 'varchar(255) not null'.</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the SQL statement for adding a new column.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/CDbSchema.php#L429">framework/db/schema/CDbSchema.php#429</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">addColumn</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">,</span><span style="color: #0000BB">$column</span><span style="color: #007700">,</span><span style="color: #0000BB">$type</span><span style="color: #007700">)<br>{<br>    return </span><span style="color: #DD0000">'ALTER TABLE ' </span><span style="color: #007700">. </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">)<br>        . </span><span style="color: #DD0000">' ADD ' </span><span style="color: #007700">. </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteColumnName</span><span style="color: #007700">(</span><span style="color: #0000BB">$column</span><span style="color: #007700">) . </span><span style="color: #DD0000">' '<br>        </span><span style="color: #007700">. </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getColumnType</span><span style="color: #007700">(</span><span style="color: #0000BB">$type</span><span style="color: #007700">);<br>}</span></pre> </div> <p>Builds a SQL statement for adding a new DB column.</p> <h3 class="detailHeader" id="addForeignKey-detail"> addForeignKey() <span class="detailHeaderTag"> method (available since v1.1.6) </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public string <b>addForeignKey</b>(string $name, string $table, string|array $columns, string $refTable, string|array $refColumns, string $delete=NULL, string $update=NULL)</pre> </td></tr> <tr> <td class="paramNameCol">$name</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the name of the foreign key constraint.</td> </tr> <tr> <td class="paramNameCol">$table</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the table that the foreign key constraint will be added to.</td> </tr> <tr> <td class="paramNameCol">$columns</td> <td class="paramTypeCol">string|array</td> <td class="paramDescCol">the name of the column to that the constraint will be added on. If there are multiple columns, separate them with commas or pass as an array of column names.</td> </tr> <tr> <td class="paramNameCol">$refTable</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the table that the foreign key references to.</td> </tr> <tr> <td class="paramNameCol">$refColumns</td> <td class="paramTypeCol">string|array</td> <td class="paramDescCol">the name of the column that the foreign key references to. If there are multiple columns, separate them with commas or pass as an array of column names.</td> </tr> <tr> <td class="paramNameCol">$delete</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the ON DELETE option. Most DBMS support these options: RESTRICT, CASCADE, NO ACTION, SET DEFAULT, SET NULL</td> </tr> <tr> <td class="paramNameCol">$update</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the ON UPDATE option. Most DBMS support these options: RESTRICT, CASCADE, NO ACTION, SET DEFAULT, SET NULL</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the SQL statement for adding a foreign key constraint to an existing table.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/CDbSchema.php#L495">framework/db/schema/CDbSchema.php#495</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">addForeignKey</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">,</span><span style="color: #0000BB">$table</span><span style="color: #007700">,</span><span style="color: #0000BB">$columns</span><span style="color: #007700">,</span><span style="color: #0000BB">$refTable</span><span style="color: #007700">,</span><span style="color: #0000BB">$refColumns</span><span style="color: #007700">,</span><span style="color: #0000BB">$delete</span><span style="color: #007700">=</span><span style="color: #0000BB">null</span><span style="color: #007700">,</span><span style="color: #0000BB">$update</span><span style="color: #007700">=</span><span style="color: #0000BB">null</span><span style="color: #007700">)<br>{<br>    if(</span><span style="color: #0000BB">is_string</span><span style="color: #007700">(</span><span style="color: #0000BB">$columns</span><span style="color: #007700">))<br>        </span><span style="color: #0000BB">$columns</span><span style="color: #007700">=</span><span style="color: #0000BB">preg_split</span><span style="color: #007700">(</span><span style="color: #DD0000">'/\s*,\s*/'</span><span style="color: #007700">,</span><span style="color: #0000BB">$columns</span><span style="color: #007700">,-</span><span style="color: #0000BB">1</span><span style="color: #007700">,</span><span style="color: #0000BB">PREG_SPLIT_NO_EMPTY</span><span style="color: #007700">);<br>    foreach(</span><span style="color: #0000BB">$columns </span><span style="color: #007700">as </span><span style="color: #0000BB">$i</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">$col</span><span style="color: #007700">)<br>        </span><span style="color: #0000BB">$columns</span><span style="color: #007700">[</span><span style="color: #0000BB">$i</span><span style="color: #007700">]=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteColumnName</span><span style="color: #007700">(</span><span style="color: #0000BB">$col</span><span style="color: #007700">);<br>    if(</span><span style="color: #0000BB">is_string</span><span style="color: #007700">(</span><span style="color: #0000BB">$refColumns</span><span style="color: #007700">))<br>        </span><span style="color: #0000BB">$refColumns</span><span style="color: #007700">=</span><span style="color: #0000BB">preg_split</span><span style="color: #007700">(</span><span style="color: #DD0000">'/\s*,\s*/'</span><span style="color: #007700">,</span><span style="color: #0000BB">$refColumns</span><span style="color: #007700">,-</span><span style="color: #0000BB">1</span><span style="color: #007700">,</span><span style="color: #0000BB">PREG_SPLIT_NO_EMPTY</span><span style="color: #007700">);<br>    foreach(</span><span style="color: #0000BB">$refColumns </span><span style="color: #007700">as </span><span style="color: #0000BB">$i</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">$col</span><span style="color: #007700">)<br>        </span><span style="color: #0000BB">$refColumns</span><span style="color: #007700">[</span><span style="color: #0000BB">$i</span><span style="color: #007700">]=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteColumnName</span><span style="color: #007700">(</span><span style="color: #0000BB">$col</span><span style="color: #007700">);<br>    </span><span style="color: #0000BB">$sql</span><span style="color: #007700">=</span><span style="color: #DD0000">'ALTER TABLE '</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">)<br>        .</span><span style="color: #DD0000">' ADD CONSTRAINT '</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteColumnName</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">)<br>        .</span><span style="color: #DD0000">' FOREIGN KEY ('</span><span style="color: #007700">.</span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #DD0000">', '</span><span style="color: #007700">,</span><span style="color: #0000BB">$columns</span><span style="color: #007700">).</span><span style="color: #DD0000">')'<br>        </span><span style="color: #007700">.</span><span style="color: #DD0000">' REFERENCES '</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$refTable</span><span style="color: #007700">)<br>        .</span><span style="color: #DD0000">' ('</span><span style="color: #007700">.</span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #DD0000">', '</span><span style="color: #007700">,</span><span style="color: #0000BB">$refColumns</span><span style="color: #007700">).</span><span style="color: #DD0000">')'</span><span style="color: #007700">;<br>    if(</span><span style="color: #0000BB">$delete</span><span style="color: #007700">!==</span><span style="color: #0000BB">null</span><span style="color: #007700">)<br>        </span><span style="color: #0000BB">$sql</span><span style="color: #007700">.=</span><span style="color: #DD0000">' ON DELETE '</span><span style="color: #007700">.</span><span style="color: #0000BB">$delete</span><span style="color: #007700">;<br>    if(</span><span style="color: #0000BB">$update</span><span style="color: #007700">!==</span><span style="color: #0000BB">null</span><span style="color: #007700">)<br>        </span><span style="color: #0000BB">$sql</span><span style="color: #007700">.=</span><span style="color: #DD0000">' ON UPDATE '</span><span style="color: #007700">.</span><span style="color: #0000BB">$update</span><span style="color: #007700">;<br>    return </span><span style="color: #0000BB">$sql</span><span style="color: #007700">;<br>}</span></pre> </div> <p>Builds a SQL statement for adding a foreign key constraint to an existing table. The method will properly quote the table and column names.</p> <h3 class="detailHeader" id="addPrimaryKey-detail"> addPrimaryKey() <span class="detailHeaderTag"> method (available since v1.1.13) </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public string <b>addPrimaryKey</b>(string $name, string $table, string|array $columns)</pre> </td></tr> <tr> <td class="paramNameCol">$name</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the name of the primary key constraint.</td> </tr> <tr> <td class="paramNameCol">$table</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the table that the primary key constraint will be added to.</td> </tr> <tr> <td class="paramNameCol">$columns</td> <td class="paramTypeCol">string|array</td> <td class="paramDescCol">comma separated string or array of columns that the primary key will consist of. Array value can be passed since 1.1.14.</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the SQL statement for adding a primary key constraint to an existing table.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/CDbSchema.php#L578">framework/db/schema/CDbSchema.php#578</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">addPrimaryKey</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">,</span><span style="color: #0000BB">$table</span><span style="color: #007700">,</span><span style="color: #0000BB">$columns</span><span style="color: #007700">)<br>{<br>    if(</span><span style="color: #0000BB">is_string</span><span style="color: #007700">(</span><span style="color: #0000BB">$columns</span><span style="color: #007700">))<br>        </span><span style="color: #0000BB">$columns</span><span style="color: #007700">=</span><span style="color: #0000BB">preg_split</span><span style="color: #007700">(</span><span style="color: #DD0000">'/\s*,\s*/'</span><span style="color: #007700">,</span><span style="color: #0000BB">$columns</span><span style="color: #007700">,-</span><span style="color: #0000BB">1</span><span style="color: #007700">,</span><span style="color: #0000BB">PREG_SPLIT_NO_EMPTY</span><span style="color: #007700">);<br>    foreach(</span><span style="color: #0000BB">$columns </span><span style="color: #007700">as </span><span style="color: #0000BB">$i</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">$col</span><span style="color: #007700">)<br>        </span><span style="color: #0000BB">$columns</span><span style="color: #007700">[</span><span style="color: #0000BB">$i</span><span style="color: #007700">]=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteColumnName</span><span style="color: #007700">(</span><span style="color: #0000BB">$col</span><span style="color: #007700">);<br>    return </span><span style="color: #DD0000">'ALTER TABLE ' </span><span style="color: #007700">. </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">) . </span><span style="color: #DD0000">' ADD CONSTRAINT '<br>        </span><span style="color: #007700">. </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteColumnName</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">) . </span><span style="color: #DD0000">'  PRIMARY KEY ('<br>        </span><span style="color: #007700">. </span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #DD0000">', '</span><span style="color: #007700">,</span><span style="color: #0000BB">$columns</span><span style="color: #007700">). </span><span style="color: #DD0000">' )'</span><span style="color: #007700">;<br>}</span></pre> </div> <p>Builds a SQL statement for adding a primary key constraint to an existing table.</p> <h3 class="detailHeader" id="alterColumn-detail"> alterColumn() <span class="detailHeaderTag"> method (available since v1.1.6) </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public string <b>alterColumn</b>(string $table, string $column, string $type)</pre> </td></tr> <tr> <td class="paramNameCol">$table</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the table whose column is to be changed. The table name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">$column</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the name of the column to be changed. The name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">$type</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the new column type. The <a href="cdbschema#getColumnType">getColumnType</a> method will be invoked to convert abstract column type (if any) into the physical one. Anything that is not recognized as abstract type will be kept in the generated SQL. For example, 'string' will be turned into 'varchar(255)', while 'string not null' will become 'varchar(255) not null'.</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the SQL statement for changing the definition of a column.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/CDbSchema.php#L474">framework/db/schema/CDbSchema.php#474</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">alterColumn</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">,</span><span style="color: #0000BB">$column</span><span style="color: #007700">,</span><span style="color: #0000BB">$type</span><span style="color: #007700">)<br>{<br>    return </span><span style="color: #DD0000">'ALTER TABLE ' </span><span style="color: #007700">. </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">) . </span><span style="color: #DD0000">' CHANGE '<br>        </span><span style="color: #007700">. </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteColumnName</span><span style="color: #007700">(</span><span style="color: #0000BB">$column</span><span style="color: #007700">) . </span><span style="color: #DD0000">' '<br>        </span><span style="color: #007700">. </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteColumnName</span><span style="color: #007700">(</span><span style="color: #0000BB">$column</span><span style="color: #007700">) . </span><span style="color: #DD0000">' '<br>        </span><span style="color: #007700">. </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getColumnType</span><span style="color: #007700">(</span><span style="color: #0000BB">$type</span><span style="color: #007700">);<br>}</span></pre> </div> <p>Builds a SQL statement for changing the definition of a column.</p> <h3 class="detailHeader" id="checkIntegrity-detail"> checkIntegrity() <span class="detailHeaderTag"> method (available since v1.1) </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public void <b>checkIntegrity</b>(boolean $check=true, string $schema='')</pre> </td></tr> <tr> <td class="paramNameCol">$check</td> <td class="paramTypeCol">boolean</td> <td class="paramDescCol">whether to turn on or off the integrity check.</td> </tr> <tr> <td class="paramNameCol">$schema</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the schema of the tables. Defaults to empty string, meaning the current or default schema.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/CDbSchema.php#L284">framework/db/schema/CDbSchema.php#284</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">checkIntegrity</span><span style="color: #007700">(</span><span style="color: #0000BB">$check</span><span style="color: #007700">=</span><span style="color: #0000BB">true</span><span style="color: #007700">,</span><span style="color: #0000BB">$schema</span><span style="color: #007700">=</span><span style="color: #DD0000">''</span><span style="color: #007700">)<br>{<br>}</span></pre> </div> <p>Enables or disables integrity check.</p> <h3 class="detailHeader" id="compareTableNames-detail"> compareTableNames() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public boolean <b>compareTableNames</b>(string $name1, string $name2)</pre> </td></tr> <tr> <td class="paramNameCol">$name1</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">table name 1</td> </tr> <tr> <td class="paramNameCol">$name2</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">table name 2</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">boolean</td> <td class="paramDescCol">whether the two table names refer to the same table.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/CDbSchema.php#L246">framework/db/schema/CDbSchema.php#246</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">compareTableNames</span><span style="color: #007700">(</span><span style="color: #0000BB">$name1</span><span style="color: #007700">,</span><span style="color: #0000BB">$name2</span><span style="color: #007700">)<br>{<br>    </span><span style="color: #0000BB">$name1</span><span style="color: #007700">=</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(array(</span><span style="color: #DD0000">'"'</span><span style="color: #007700">,</span><span style="color: #DD0000">'`'</span><span style="color: #007700">,</span><span style="color: #DD0000">"'"</span><span style="color: #007700">),</span><span style="color: #DD0000">''</span><span style="color: #007700">,</span><span style="color: #0000BB">$name1</span><span style="color: #007700">);<br>    </span><span style="color: #0000BB">$name2</span><span style="color: #007700">=</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(array(</span><span style="color: #DD0000">'"'</span><span style="color: #007700">,</span><span style="color: #DD0000">'`'</span><span style="color: #007700">,</span><span style="color: #DD0000">"'"</span><span style="color: #007700">),</span><span style="color: #DD0000">''</span><span style="color: #007700">,</span><span style="color: #0000BB">$name2</span><span style="color: #007700">);<br>    if((</span><span style="color: #0000BB">$pos</span><span style="color: #007700">=</span><span style="color: #0000BB">strrpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$name1</span><span style="color: #007700">,</span><span style="color: #DD0000">'.'</span><span style="color: #007700">))!==</span><span style="color: #0000BB">false</span><span style="color: #007700">)<br>        </span><span style="color: #0000BB">$name1</span><span style="color: #007700">=</span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$name1</span><span style="color: #007700">,</span><span style="color: #0000BB">$pos</span><span style="color: #007700">+</span><span style="color: #0000BB">1</span><span style="color: #007700">);<br>    if((</span><span style="color: #0000BB">$pos</span><span style="color: #007700">=</span><span style="color: #0000BB">strrpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$name2</span><span style="color: #007700">,</span><span style="color: #DD0000">'.'</span><span style="color: #007700">))!==</span><span style="color: #0000BB">false</span><span style="color: #007700">)<br>        </span><span style="color: #0000BB">$name2</span><span style="color: #007700">=</span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$name2</span><span style="color: #007700">,</span><span style="color: #0000BB">$pos</span><span style="color: #007700">+</span><span style="color: #0000BB">1</span><span style="color: #007700">);<br>    if(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_connection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tablePrefix</span><span style="color: #007700">!==</span><span style="color: #0000BB">null</span><span style="color: #007700">)<br>    {<br>        if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$name1</span><span style="color: #007700">,</span><span style="color: #DD0000">'{'</span><span style="color: #007700">)!==</span><span style="color: #0000BB">false</span><span style="color: #007700">)<br>            </span><span style="color: #0000BB">$name1</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_connection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tablePrefix</span><span style="color: #007700">.</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(array(</span><span style="color: #DD0000">'{'</span><span style="color: #007700">,</span><span style="color: #DD0000">'}'</span><span style="color: #007700">),</span><span style="color: #DD0000">''</span><span style="color: #007700">,</span><span style="color: #0000BB">$name1</span><span style="color: #007700">);<br>        if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$name2</span><span style="color: #007700">,</span><span style="color: #DD0000">'{'</span><span style="color: #007700">)!==</span><span style="color: #0000BB">false</span><span style="color: #007700">)<br>            </span><span style="color: #0000BB">$name2</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_connection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tablePrefix</span><span style="color: #007700">.</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(array(</span><span style="color: #DD0000">'{'</span><span style="color: #007700">,</span><span style="color: #DD0000">'}'</span><span style="color: #007700">),</span><span style="color: #DD0000">''</span><span style="color: #007700">,</span><span style="color: #0000BB">$name2</span><span style="color: #007700">);<br>    }<br>    return </span><span style="color: #0000BB">$name1</span><span style="color: #007700">===</span><span style="color: #0000BB">$name2</span><span style="color: #007700">;<br>}</span></pre> </div> <p>Compares two table names. The table names can be either quoted or unquoted. This method will consider both cases.</p> <h3 class="detailHeader" id="createCommandBuilder-detail"> createCommandBuilder() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">protected <a href="cdbcommandbuilder">CDbCommandBuilder</a> <b>createCommandBuilder</b>()</pre> </td></tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol"><a href="cdbcommandbuilder">CDbCommandBuilder</a></td> <td class="paramDescCol">command builder instance</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/CDbSchema.php#L293">framework/db/schema/CDbSchema.php#293</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">protected function </span><span style="color: #0000BB">createCommandBuilder</span><span style="color: #007700">()<br>{<br>    return new </span><span style="color: #0000BB">CDbCommandBuilder</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">);<br>}</span></pre> </div> <p>Creates a command builder for the database. This method may be overridden by child classes to create a DBMS-specific command builder.</p> <h3 class="detailHeader" id="createIndex-detail"> createIndex() <span class="detailHeaderTag"> method (available since v1.1.6) </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public string <b>createIndex</b>(string $name, string $table, string|array $columns, boolean $unique=false)</pre> </td></tr> <tr> <td class="paramNameCol">$name</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the name of the index. The name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">$table</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the table that the new index will be created for. The table name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">$columns</td> <td class="paramTypeCol">string|array</td> <td class="paramDescCol">the column(s) that should be included in the index. If there are multiple columns, please separate them by commas or pass as an array of column names. Each column name will be properly quoted by the method, unless a parenthesis is found in the name.</td> </tr> <tr> <td class="paramNameCol">$unique</td> <td class="paramTypeCol">boolean</td> <td class="paramDescCol">whether to add UNIQUE constraint on the created index.</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the SQL statement for creating a new index.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/CDbSchema.php#L540">framework/db/schema/CDbSchema.php#540</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">createIndex</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">,</span><span style="color: #0000BB">$table</span><span style="color: #007700">,</span><span style="color: #0000BB">$columns</span><span style="color: #007700">,</span><span style="color: #0000BB">$unique</span><span style="color: #007700">=</span><span style="color: #0000BB">false</span><span style="color: #007700">)<br>{<br>    </span><span style="color: #0000BB">$cols</span><span style="color: #007700">=array();<br>    if(</span><span style="color: #0000BB">is_string</span><span style="color: #007700">(</span><span style="color: #0000BB">$columns</span><span style="color: #007700">))<br>        </span><span style="color: #0000BB">$columns</span><span style="color: #007700">=</span><span style="color: #0000BB">preg_split</span><span style="color: #007700">(</span><span style="color: #DD0000">'/\s*,\s*/'</span><span style="color: #007700">,</span><span style="color: #0000BB">$columns</span><span style="color: #007700">,-</span><span style="color: #0000BB">1</span><span style="color: #007700">,</span><span style="color: #0000BB">PREG_SPLIT_NO_EMPTY</span><span style="color: #007700">);<br>    foreach(</span><span style="color: #0000BB">$columns </span><span style="color: #007700">as </span><span style="color: #0000BB">$col</span><span style="color: #007700">)<br>    {<br>        if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$col</span><span style="color: #007700">,</span><span style="color: #DD0000">'('</span><span style="color: #007700">)!==</span><span style="color: #0000BB">false</span><span style="color: #007700">)<br>            </span><span style="color: #0000BB">$cols</span><span style="color: #007700">[]=</span><span style="color: #0000BB">$col</span><span style="color: #007700">;<br>        else<br>            </span><span style="color: #0000BB">$cols</span><span style="color: #007700">[]=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteColumnName</span><span style="color: #007700">(</span><span style="color: #0000BB">$col</span><span style="color: #007700">);<br>    }<br>    return (</span><span style="color: #0000BB">$unique </span><span style="color: #007700">? </span><span style="color: #DD0000">'CREATE UNIQUE INDEX ' </span><span style="color: #007700">: </span><span style="color: #DD0000">'CREATE INDEX '</span><span style="color: #007700">)<br>        . </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">).</span><span style="color: #DD0000">' ON '<br>        </span><span style="color: #007700">. </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">).</span><span style="color: #DD0000">' ('</span><span style="color: #007700">.</span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #DD0000">', '</span><span style="color: #007700">,</span><span style="color: #0000BB">$cols</span><span style="color: #007700">).</span><span style="color: #DD0000">')'</span><span style="color: #007700">;<br>}</span></pre> </div> <p>Builds a SQL statement for creating a new index.</p> <h3 class="detailHeader" id="createTable-detail"> createTable() <span class="detailHeaderTag"> method (available since v1.1.6) </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public string <b>createTable</b>(string $table, array $columns, string $options=NULL)</pre> </td></tr> <tr> <td class="paramNameCol">$table</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the name of the table to be created. The name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">$columns</td> <td class="paramTypeCol">array</td> <td class="paramDescCol">the columns (name=&gt;definition) in the new table.</td> </tr> <tr> <td class="paramNameCol">$options</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">additional SQL fragment that will be appended to the generated SQL.</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the SQL statement for creating a new DB table.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/CDbSchema.php#L371">framework/db/schema/CDbSchema.php#371</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">createTable</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">,</span><span style="color: #0000BB">$columns</span><span style="color: #007700">,</span><span style="color: #0000BB">$options</span><span style="color: #007700">=</span><span style="color: #0000BB">null</span><span style="color: #007700">)<br>{<br>    </span><span style="color: #0000BB">$cols</span><span style="color: #007700">=array();<br>    foreach(</span><span style="color: #0000BB">$columns </span><span style="color: #007700">as </span><span style="color: #0000BB">$name</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">$type</span><span style="color: #007700">)<br>    {<br>        if(</span><span style="color: #0000BB">is_string</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">))<br>            </span><span style="color: #0000BB">$cols</span><span style="color: #007700">[]=</span><span style="color: #DD0000">"\t"</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteColumnName</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">).</span><span style="color: #DD0000">' '</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getColumnType</span><span style="color: #007700">(</span><span style="color: #0000BB">$type</span><span style="color: #007700">);<br>        else<br>            </span><span style="color: #0000BB">$cols</span><span style="color: #007700">[]=</span><span style="color: #DD0000">"\t"</span><span style="color: #007700">.</span><span style="color: #0000BB">$type</span><span style="color: #007700">;<br>    }<br>    </span><span style="color: #0000BB">$sql</span><span style="color: #007700">=</span><span style="color: #DD0000">"CREATE TABLE "</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">).</span><span style="color: #DD0000">" (\n"</span><span style="color: #007700">.</span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #DD0000">",\n"</span><span style="color: #007700">,</span><span style="color: #0000BB">$cols</span><span style="color: #007700">).</span><span style="color: #DD0000">"\n)"</span><span style="color: #007700">;<br>    return </span><span style="color: #0000BB">$options</span><span style="color: #007700">===</span><span style="color: #0000BB">null </span><span style="color: #007700">? </span><span style="color: #0000BB">$sql </span><span style="color: #007700">: </span><span style="color: #0000BB">$sql</span><span style="color: #007700">.</span><span style="color: #DD0000">' '</span><span style="color: #007700">.</span><span style="color: #0000BB">$options</span><span style="color: #007700">;<br>}</span></pre> </div> <p>Builds a SQL statement for creating a new DB table. <br><br> The columns in the new table should be specified as name-definition pairs (e.g. 'name'=&gt;'string'), where name stands for a column name which will be properly quoted by the method, and definition stands for the column type which can contain an abstract DB type. The <a href="cdbschema#getColumnType">getColumnType</a> method will be invoked to convert any abstract type into a physical one. <br><br> If a column is specified with definition only (e.g. 'PRIMARY KEY (name, type)'), it will be directly inserted into the generated SQL.</p> <h3 class="detailHeader" id="dropColumn-detail"> dropColumn() <span class="detailHeaderTag"> method (available since v1.1.6) </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public string <b>dropColumn</b>(string $table, string $column)</pre> </td></tr> <tr> <td class="paramNameCol">$table</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the table whose column is to be dropped. The name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">$column</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the name of the column to be dropped. The name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the SQL statement for dropping a DB column.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/CDbSchema.php#L443">framework/db/schema/CDbSchema.php#443</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">dropColumn</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">,</span><span style="color: #0000BB">$column</span><span style="color: #007700">)<br>{<br>    return </span><span style="color: #DD0000">"ALTER TABLE "</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">)<br>        .</span><span style="color: #DD0000">" DROP COLUMN "</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteColumnName</span><span style="color: #007700">(</span><span style="color: #0000BB">$column</span><span style="color: #007700">);<br>}</span></pre> </div> <p>Builds a SQL statement for dropping a DB column.</p> <h3 class="detailHeader" id="dropForeignKey-detail"> dropForeignKey() <span class="detailHeaderTag"> method (available since v1.1.6) </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public string <b>dropForeignKey</b>(string $name, string $table)</pre> </td></tr> <tr> <td class="paramNameCol">$name</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the name of the foreign key constraint to be dropped. The name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">$table</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the table whose foreign is to be dropped. The name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the SQL statement for dropping a foreign key constraint.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/CDbSchema.php#L524">framework/db/schema/CDbSchema.php#524</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">dropForeignKey</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">,</span><span style="color: #0000BB">$table</span><span style="color: #007700">)<br>{<br>    return </span><span style="color: #DD0000">'ALTER TABLE '</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">)<br>        .</span><span style="color: #DD0000">' DROP CONSTRAINT '</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteColumnName</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">);<br>}</span></pre> </div> <p>Builds a SQL statement for dropping a foreign key constraint.</p> <h3 class="detailHeader" id="dropIndex-detail"> dropIndex() <span class="detailHeaderTag"> method (available since v1.1.6) </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public string <b>dropIndex</b>(string $name, string $table)</pre> </td></tr> <tr> <td class="paramNameCol">$name</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the name of the index to be dropped. The name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">$table</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the table whose index is to be dropped. The name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the SQL statement for dropping an index.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/CDbSchema.php#L564">framework/db/schema/CDbSchema.php#564</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">dropIndex</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">,</span><span style="color: #0000BB">$table</span><span style="color: #007700">)<br>{<br>    return </span><span style="color: #DD0000">'DROP INDEX '</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">).</span><span style="color: #DD0000">' ON '</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">);<br>}</span></pre> </div> <p>Builds a SQL statement for dropping an index.</p> <h3 class="detailHeader" id="dropPrimaryKey-detail"> dropPrimaryKey() <span class="detailHeaderTag"> method (available since v1.1.13) </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public string <b>dropPrimaryKey</b>(string $name, string $table)</pre> </td></tr> <tr> <td class="paramNameCol">$name</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the name of the primary key constraint to be removed.</td> </tr> <tr> <td class="paramNameCol">$table</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the table that the primary key constraint will be removed from.</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the SQL statement for removing a primary key constraint from an existing table.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/CDbSchema.php#L596">framework/db/schema/CDbSchema.php#596</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">dropPrimaryKey</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">,</span><span style="color: #0000BB">$table</span><span style="color: #007700">)<br>{<br>    return </span><span style="color: #DD0000">'ALTER TABLE ' </span><span style="color: #007700">. </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">) . </span><span style="color: #DD0000">' DROP CONSTRAINT '<br>        </span><span style="color: #007700">. </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteColumnName</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">);<br>}</span></pre> </div> <p>Builds a SQL statement for removing a primary key constraint to an existing table.</p> <h3 class="detailHeader" id="dropTable-detail"> dropTable() <span class="detailHeaderTag"> method (available since v1.1.6) </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public string <b>dropTable</b>(string $table)</pre> </td></tr> <tr> <td class="paramNameCol">$table</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the table to be dropped. The name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the SQL statement for dropping a DB table.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/CDbSchema.php#L403">framework/db/schema/CDbSchema.php#403</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">dropTable</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">)<br>{<br>    return </span><span style="color: #DD0000">"DROP TABLE "</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">);<br>}</span></pre> </div> <p>Builds a SQL statement for dropping a DB table.</p> <h3 class="detailHeader" id="findTableNames-detail"> findTableNames() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">protected array <b>findTableNames</b>(string $schema='')</pre> </td></tr> <tr> <td class="paramNameCol">$schema</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the schema of the tables. Defaults to empty string, meaning the current or default schema. If not empty, the returned table names will be prefixed with the schema name.</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">array</td> <td class="paramDescCol">all table names in the database.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/CDbSchema.php#L307">framework/db/schema/CDbSchema.php#307</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">protected function </span><span style="color: #0000BB">findTableNames</span><span style="color: #007700">(</span><span style="color: #0000BB">$schema</span><span style="color: #007700">=</span><span style="color: #DD0000">''</span><span style="color: #007700">)<br>{<br>    throw new </span><span style="color: #0000BB">CDbException</span><span style="color: #007700">(</span><span style="color: #0000BB">Yii</span><span style="color: #007700">::</span><span style="color: #0000BB">t</span><span style="color: #007700">(</span><span style="color: #DD0000">'yii'</span><span style="color: #007700">,</span><span style="color: #DD0000">'{class} does not support fetching all table names.'</span><span style="color: #007700">,<br>        array(</span><span style="color: #DD0000">'{class}'</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">get_class</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">))));<br>}</span></pre> </div> <p>Returns all table names in the database. This method should be overridden by child classes in order to support this feature because the default implementation simply throws an exception.</p> <h3 class="detailHeader" id="getColumnType-detail"> getColumnType() <span class="detailHeaderTag"> method (available since v1.1.6) </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public string <b>getColumnType</b>(string $type)</pre> </td></tr> <tr> <td class="paramNameCol">$type</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">abstract column type</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">physical column type.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/CDbSchema.php#L341">framework/db/schema/CDbSchema.php#341</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">getColumnType</span><span style="color: #007700">(</span><span style="color: #0000BB">$type</span><span style="color: #007700">)<br>{<br>    if(isset(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">columnTypes</span><span style="color: #007700">[</span><span style="color: #0000BB">$type</span><span style="color: #007700">]))<br>        return </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">columnTypes</span><span style="color: #007700">[</span><span style="color: #0000BB">$type</span><span style="color: #007700">];<br>    elseif((</span><span style="color: #0000BB">$pos</span><span style="color: #007700">=</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$type</span><span style="color: #007700">,</span><span style="color: #DD0000">' '</span><span style="color: #007700">))!==</span><span style="color: #0000BB">false</span><span style="color: #007700">)<br>    {<br>        </span><span style="color: #0000BB">$t</span><span style="color: #007700">=</span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$type</span><span style="color: #007700">,</span><span style="color: #0000BB">0</span><span style="color: #007700">,</span><span style="color: #0000BB">$pos</span><span style="color: #007700">);<br>        return (isset(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">columnTypes</span><span style="color: #007700">[</span><span style="color: #0000BB">$t</span><span style="color: #007700">]) ? </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">columnTypes</span><span style="color: #007700">[</span><span style="color: #0000BB">$t</span><span style="color: #007700">] : </span><span style="color: #0000BB">$t</span><span style="color: #007700">).</span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$type</span><span style="color: #007700">,</span><span style="color: #0000BB">$pos</span><span style="color: #007700">);<br>    }<br>    else<br>        return </span><span style="color: #0000BB">$type</span><span style="color: #007700">;<br>}</span></pre> </div> <p>Converts an abstract column type into a physical column type. The conversion is done using the type map specified in <a href="cdbschema#columnTypes">columnTypes</a>. These abstract column types are supported (using MySQL as example to explain the corresponding physical types): </p>
<ul> <li>pk and bigpk: an auto-incremental primary key type, will be converted into "int(11) NOT NULL AUTO_INCREMENT PRIMARY KEY" or "bigint(20) NOT NULL AUTO_INCREMENT PRIMARY KEY"</li> <li>string: string type, will be converted into "varchar(255)"</li> <li>text: a long string type, will be converted into "text"</li> <li>integer: integer type, will be converted into "int(11)"</li> <li>bigint: integer type, will be converted into "bigint(20)"</li> <li>boolean: boolean type, will be converted into "tinyint(1)"</li> <li>float: float number type, will be converted into "float"</li> <li>decimal: decimal number type, will be converted into "decimal"</li> <li>datetime: datetime type, will be converted into "datetime"</li> <li>timestamp: timestamp type, will be converted into "timestamp"</li> <li>time: time type, will be converted into "time"</li> <li>date: date type, will be converted into "date"</li> <li>binary: binary data type, will be converted into "blob"</li> </ul> <br><br> If the abstract type contains two or more parts separated by spaces (e.g. "string NOT NULL"), then only the first part will be converted, and the rest of the parts will be appended to the conversion result. For example, 'string NOT NULL' is converted to 'varchar(255) NOT NULL'. <h3 class="detailHeader" id="getCommandBuilder-detail"> getCommandBuilder() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public <a href="cdbcommandbuilder">CDbCommandBuilder</a> <b>getCommandBuilder</b>()</pre> </td></tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol"><a href="cdbcommandbuilder">CDbCommandBuilder</a></td> <td class="paramDescCol">the SQL command builder for this connection.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/CDbSchema.php#L146">framework/db/schema/CDbSchema.php#146</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">getCommandBuilder</span><span style="color: #007700">()<br>{<br>    if(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_builder</span><span style="color: #007700">!==</span><span style="color: #0000BB">null</span><span style="color: #007700">)<br>        return </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_builder</span><span style="color: #007700">;<br>    else<br>        return </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_builder</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">createCommandBuilder</span><span style="color: #007700">();<br>}</span></pre> </div>  <h3 class="detailHeader" id="getDbConnection-detail"> getDbConnection() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public <a href="cdbconnection">CDbConnection</a> <b>getDbConnection</b>()</pre> </td></tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol"><a href="cdbconnection">CDbConnection</a></td> <td class="paramDescCol">database connection. The connection is active.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/CDbSchema.php#L60">framework/db/schema/CDbSchema.php#60</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">getDbConnection</span><span style="color: #007700">()<br>{<br>    return </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_connection</span><span style="color: #007700">;<br>}</span></pre> </div>  <h3 class="detailHeader" id="getTable-detail"> getTable() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public <a href="cdbtableschema">CDbTableSchema</a> <b>getTable</b>(string $name, boolean $refresh=false)</pre> </td></tr> <tr> <td class="paramNameCol">$name</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">table name</td> </tr> <tr> <td class="paramNameCol">$refresh</td> <td class="paramTypeCol">boolean</td> <td class="paramDescCol">if we need to refresh schema cache for a table. Parameter available since 1.1.9</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol"><a href="cdbtableschema">CDbTableSchema</a></td> <td class="paramDescCol">table metadata. Null if the named table does not exist.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/CDbSchema.php#L72">framework/db/schema/CDbSchema.php#72</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">getTable</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">,</span><span style="color: #0000BB">$refresh</span><span style="color: #007700">=</span><span style="color: #0000BB">false</span><span style="color: #007700">)<br>{<br>    if(</span><span style="color: #0000BB">$refresh</span><span style="color: #007700">===</span><span style="color: #0000BB">false </span><span style="color: #007700">&amp;&amp; isset(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_tables</span><span style="color: #007700">[</span><span style="color: #0000BB">$name</span><span style="color: #007700">]))<br>        return </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_tables</span><span style="color: #007700">[</span><span style="color: #0000BB">$name</span><span style="color: #007700">];<br>    else<br>    {<br>        if(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_connection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tablePrefix</span><span style="color: #007700">!==</span><span style="color: #0000BB">null </span><span style="color: #007700">&amp;&amp; </span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">,</span><span style="color: #DD0000">'{{'</span><span style="color: #007700">)!==</span><span style="color: #0000BB">false</span><span style="color: #007700">)<br>            </span><span style="color: #0000BB">$realName</span><span style="color: #007700">=</span><span style="color: #0000BB">preg_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">'/\{\{(.*?)\}\}/'</span><span style="color: #007700">,</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_connection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tablePrefix</span><span style="color: #007700">.</span><span style="color: #DD0000">'$1'</span><span style="color: #007700">,</span><span style="color: #0000BB">$name</span><span style="color: #007700">);<br>        else<br>            </span><span style="color: #0000BB">$realName</span><span style="color: #007700">=</span><span style="color: #0000BB">$name</span><span style="color: #007700">;<br><br>        </span><span style="color: #FF8000">// temporarily disable query caching<br>        </span><span style="color: #007700">if(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_connection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">queryCachingDuration</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">0</span><span style="color: #007700">)<br>        {<br>            </span><span style="color: #0000BB">$qcDuration</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_connection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">queryCachingDuration</span><span style="color: #007700">;<br>            </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_connection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">queryCachingDuration</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;<br>        }<br><br>        if(!isset(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_cacheExclude</span><span style="color: #007700">[</span><span style="color: #0000BB">$name</span><span style="color: #007700">]) &amp;&amp; (</span><span style="color: #0000BB">$duration</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_connection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">schemaCachingDuration</span><span style="color: #007700">)&gt;</span><span style="color: #0000BB">0 </span><span style="color: #007700">&amp;&amp; </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_connection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">schemaCacheID</span><span style="color: #007700">!==</span><span style="color: #0000BB">false </span><span style="color: #007700">&amp;&amp; (</span><span style="color: #0000BB">$cache</span><span style="color: #007700">=</span><span style="color: #0000BB">Yii</span><span style="color: #007700">::</span><span style="color: #0000BB">app</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">getComponent</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_connection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">schemaCacheID</span><span style="color: #007700">))!==</span><span style="color: #0000BB">null</span><span style="color: #007700">)<br>        {<br>            </span><span style="color: #0000BB">$key</span><span style="color: #007700">=</span><span style="color: #DD0000">'yii:dbschema'</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_connection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">connectionString</span><span style="color: #007700">.</span><span style="color: #DD0000">':'</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_connection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">username</span><span style="color: #007700">.</span><span style="color: #DD0000">':'</span><span style="color: #007700">.</span><span style="color: #0000BB">$name</span><span style="color: #007700">;<br>            </span><span style="color: #0000BB">$table</span><span style="color: #007700">=</span><span style="color: #0000BB">$cache</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">get</span><span style="color: #007700">(</span><span style="color: #0000BB">$key</span><span style="color: #007700">);<br>            if(</span><span style="color: #0000BB">$refresh</span><span style="color: #007700">===</span><span style="color: #0000BB">true </span><span style="color: #007700">|| </span><span style="color: #0000BB">$table</span><span style="color: #007700">===</span><span style="color: #0000BB">false</span><span style="color: #007700">)<br>            {<br>                </span><span style="color: #0000BB">$table</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">loadTable</span><span style="color: #007700">(</span><span style="color: #0000BB">$realName</span><span style="color: #007700">);<br>                if(</span><span style="color: #0000BB">$table</span><span style="color: #007700">!==</span><span style="color: #0000BB">null</span><span style="color: #007700">)<br>                    </span><span style="color: #0000BB">$cache</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">set</span><span style="color: #007700">(</span><span style="color: #0000BB">$key</span><span style="color: #007700">,</span><span style="color: #0000BB">$table</span><span style="color: #007700">,</span><span style="color: #0000BB">$duration</span><span style="color: #007700">);<br>            }<br>            </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_tables</span><span style="color: #007700">[</span><span style="color: #0000BB">$name</span><span style="color: #007700">]=</span><span style="color: #0000BB">$table</span><span style="color: #007700">;<br>        }<br>        else<br>            </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_tables</span><span style="color: #007700">[</span><span style="color: #0000BB">$name</span><span style="color: #007700">]=</span><span style="color: #0000BB">$table</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">loadTable</span><span style="color: #007700">(</span><span style="color: #0000BB">$realName</span><span style="color: #007700">);<br><br>        if(isset(</span><span style="color: #0000BB">$qcDuration</span><span style="color: #007700">))  </span><span style="color: #FF8000">// re-enable query caching<br>            </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_connection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">queryCachingDuration</span><span style="color: #007700">=</span><span style="color: #0000BB">$qcDuration</span><span style="color: #007700">;<br><br>        return </span><span style="color: #0000BB">$table</span><span style="color: #007700">;<br>    }<br>}</span></pre> </div> <p>Obtains the metadata for the named table.</p> <h3 class="detailHeader" id="getTableNames-detail"> getTableNames() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public array <b>getTableNames</b>(string $schema='')</pre> </td></tr> <tr> <td class="paramNameCol">$schema</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the schema of the tables. Defaults to empty string, meaning the current or default schema. If not empty, the returned table names will be prefixed with the schema name.</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">array</td> <td class="paramDescCol">all table names in the database.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/CDbSchema.php#L136">framework/db/schema/CDbSchema.php#136</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">getTableNames</span><span style="color: #007700">(</span><span style="color: #0000BB">$schema</span><span style="color: #007700">=</span><span style="color: #DD0000">''</span><span style="color: #007700">)<br>{<br>    if(!isset(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_tableNames</span><span style="color: #007700">[</span><span style="color: #0000BB">$schema</span><span style="color: #007700">]))<br>        </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_tableNames</span><span style="color: #007700">[</span><span style="color: #0000BB">$schema</span><span style="color: #007700">]=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findTableNames</span><span style="color: #007700">(</span><span style="color: #0000BB">$schema</span><span style="color: #007700">);<br>    return </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_tableNames</span><span style="color: #007700">[</span><span style="color: #0000BB">$schema</span><span style="color: #007700">];<br>}</span></pre> </div> <p>Returns all table names in the database.</p> <h3 class="detailHeader" id="getTables-detail"> getTables() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public array <b>getTables</b>(string $schema='')</pre> </td></tr> <tr> <td class="paramNameCol">$schema</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the schema of the tables. Defaults to empty string, meaning the current or default schema.</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">array</td> <td class="paramDescCol">the metadata for all tables in the database. Each array element is an instance of <a href="cdbtableschema">CDbTableSchema</a> (or its child class). The array keys are table names.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/CDbSchema.php#L119">framework/db/schema/CDbSchema.php#119</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">getTables</span><span style="color: #007700">(</span><span style="color: #0000BB">$schema</span><span style="color: #007700">=</span><span style="color: #DD0000">''</span><span style="color: #007700">)<br>{<br>    </span><span style="color: #0000BB">$tables</span><span style="color: #007700">=array();<br>    foreach(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getTableNames</span><span style="color: #007700">(</span><span style="color: #0000BB">$schema</span><span style="color: #007700">) as </span><span style="color: #0000BB">$name</span><span style="color: #007700">)<br>    {<br>        if((</span><span style="color: #0000BB">$table</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getTable</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">))!==</span><span style="color: #0000BB">null</span><span style="color: #007700">)<br>            </span><span style="color: #0000BB">$tables</span><span style="color: #007700">[</span><span style="color: #0000BB">$name</span><span style="color: #007700">]=</span><span style="color: #0000BB">$table</span><span style="color: #007700">;<br>    }<br>    return </span><span style="color: #0000BB">$tables</span><span style="color: #007700">;<br>}</span></pre> </div> <p>Returns the metadata for all tables in the database.</p> <h3 class="detailHeader" id="loadTable-detail"> loadTable() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">abstract protected <a href="cdbtableschema">CDbTableSchema</a> <b>loadTable</b>(string $name)</pre> </td></tr> <tr> <td class="paramNameCol">$name</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">table name</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol"><a href="cdbtableschema">CDbTableSchema</a></td> <td class="paramDescCol">driver dependent table metadata, null if the table does not exist.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/CDbSchema.php#L44">framework/db/schema/CDbSchema.php#44</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">abstract protected function </span><span style="color: #0000BB">loadTable</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">);</span></pre> </div> <p>Loads the metadata for the specified table.</p> <h3 class="detailHeader" id="quoteColumnName-detail"> quoteColumnName() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public string <b>quoteColumnName</b>(string $name)</pre> </td></tr> <tr> <td class="paramNameCol">$name</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">column name</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the properly quoted column name</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/CDbSchema.php#L214">framework/db/schema/CDbSchema.php#214</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">quoteColumnName</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">)<br>{<br>    if((</span><span style="color: #0000BB">$pos</span><span style="color: #007700">=</span><span style="color: #0000BB">strrpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">,</span><span style="color: #DD0000">'.'</span><span style="color: #007700">))!==</span><span style="color: #0000BB">false</span><span style="color: #007700">)<br>    {<br>        </span><span style="color: #0000BB">$prefix</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">,</span><span style="color: #0000BB">0</span><span style="color: #007700">,</span><span style="color: #0000BB">$pos</span><span style="color: #007700">)).</span><span style="color: #DD0000">'.'</span><span style="color: #007700">;<br>        </span><span style="color: #0000BB">$name</span><span style="color: #007700">=</span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">,</span><span style="color: #0000BB">$pos</span><span style="color: #007700">+</span><span style="color: #0000BB">1</span><span style="color: #007700">);<br>    }<br>    else<br>        </span><span style="color: #0000BB">$prefix</span><span style="color: #007700">=</span><span style="color: #DD0000">''</span><span style="color: #007700">;<br>    return </span><span style="color: #0000BB">$prefix </span><span style="color: #007700">. (</span><span style="color: #0000BB">$name</span><span style="color: #007700">===</span><span style="color: #DD0000">'*' </span><span style="color: #007700">? </span><span style="color: #0000BB">$name </span><span style="color: #007700">: </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteSimpleColumnName</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">));<br>}</span></pre> </div> <p>Quotes a column name for use in a query. If the column name contains prefix, the prefix will also be properly quoted.</p> <div class="SeeAlso"> <h4>See Also</h4> <ul> <li><a href="cdbschema#quoteSimpleColumnName">quoteSimpleColumnName</a></li> </ul> </div> <h3 class="detailHeader" id="quoteSimpleColumnName-detail"> quoteSimpleColumnName() <span class="detailHeaderTag"> method (available since v1.1.6) </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public string <b>quoteSimpleColumnName</b>(string $name)</pre> </td></tr> <tr> <td class="paramNameCol">$name</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">column name</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the properly quoted column name</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/CDbSchema.php#L233">framework/db/schema/CDbSchema.php#233</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">quoteSimpleColumnName</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">)<br>{<br>    return </span><span style="color: #DD0000">'"'</span><span style="color: #007700">.</span><span style="color: #0000BB">$name</span><span style="color: #007700">.</span><span style="color: #DD0000">'"'</span><span style="color: #007700">;<br>}</span></pre> </div> <p>Quotes a simple column name for use in a query. A simple column name does not contain prefix.</p> <h3 class="detailHeader" id="quoteSimpleTableName-detail"> quoteSimpleTableName() <span class="detailHeaderTag"> method (available since v1.1.6) </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public string <b>quoteSimpleTableName</b>(string $name)</pre> </td></tr> <tr> <td class="paramNameCol">$name</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">table name</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the properly quoted table name</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/CDbSchema.php#L202">framework/db/schema/CDbSchema.php#202</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">quoteSimpleTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">)<br>{<br>    return </span><span style="color: #DD0000">"'"</span><span style="color: #007700">.</span><span style="color: #0000BB">$name</span><span style="color: #007700">.</span><span style="color: #DD0000">"'"</span><span style="color: #007700">;<br>}</span></pre> </div> <p>Quotes a simple table name for use in a query. A simple table name does not schema prefix.</p> <h3 class="detailHeader" id="quoteTableName-detail"> quoteTableName() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public string <b>quoteTableName</b>(string $name)</pre> </td></tr> <tr> <td class="paramNameCol">$name</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">table name</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the properly quoted table name</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/CDbSchema.php#L184">framework/db/schema/CDbSchema.php#184</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">)<br>{<br>    if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">,</span><span style="color: #DD0000">'.'</span><span style="color: #007700">)===</span><span style="color: #0000BB">false</span><span style="color: #007700">)<br>        return </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteSimpleTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">);<br>    </span><span style="color: #0000BB">$parts</span><span style="color: #007700">=</span><span style="color: #0000BB">explode</span><span style="color: #007700">(</span><span style="color: #DD0000">'.'</span><span style="color: #007700">,</span><span style="color: #0000BB">$name</span><span style="color: #007700">);<br>    foreach(</span><span style="color: #0000BB">$parts </span><span style="color: #007700">as </span><span style="color: #0000BB">$i</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">$part</span><span style="color: #007700">)<br>        </span><span style="color: #0000BB">$parts</span><span style="color: #007700">[</span><span style="color: #0000BB">$i</span><span style="color: #007700">]=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteSimpleTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$part</span><span style="color: #007700">);<br>    return </span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #DD0000">'.'</span><span style="color: #007700">,</span><span style="color: #0000BB">$parts</span><span style="color: #007700">);<br><br>}</span></pre> </div> <p>Quotes a table name for use in a query. If the table name contains schema prefix, the prefix will also be properly quoted.</p> <div class="SeeAlso"> <h4>See Also</h4> <ul> <li><a href="cdbschema#quoteSimpleTableName">quoteSimpleTableName</a></li> </ul> </div> <h3 class="detailHeader" id="refresh-detail"> refresh() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public void <b>refresh</b>()</pre> </td></tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/CDbSchema.php#L159">framework/db/schema/CDbSchema.php#159</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">refresh</span><span style="color: #007700">()<br>{<br>    if((</span><span style="color: #0000BB">$duration</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_connection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">schemaCachingDuration</span><span style="color: #007700">)&gt;</span><span style="color: #0000BB">0 </span><span style="color: #007700">&amp;&amp; </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_connection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">schemaCacheID</span><span style="color: #007700">!==</span><span style="color: #0000BB">false </span><span style="color: #007700">&amp;&amp; (</span><span style="color: #0000BB">$cache</span><span style="color: #007700">=</span><span style="color: #0000BB">Yii</span><span style="color: #007700">::</span><span style="color: #0000BB">app</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">getComponent</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_connection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">schemaCacheID</span><span style="color: #007700">))!==</span><span style="color: #0000BB">null</span><span style="color: #007700">)<br>    {<br>        foreach(</span><span style="color: #0000BB">array_keys</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_tables</span><span style="color: #007700">) as </span><span style="color: #0000BB">$name</span><span style="color: #007700">)<br>        {<br>            if(!isset(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_cacheExclude</span><span style="color: #007700">[</span><span style="color: #0000BB">$name</span><span style="color: #007700">]))<br>            {<br>                </span><span style="color: #0000BB">$key</span><span style="color: #007700">=</span><span style="color: #DD0000">'yii:dbschema'</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_connection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">connectionString</span><span style="color: #007700">.</span><span style="color: #DD0000">':'</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_connection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">username</span><span style="color: #007700">.</span><span style="color: #DD0000">':'</span><span style="color: #007700">.</span><span style="color: #0000BB">$name</span><span style="color: #007700">;<br>                </span><span style="color: #0000BB">$cache</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">delete</span><span style="color: #007700">(</span><span style="color: #0000BB">$key</span><span style="color: #007700">);<br>            }<br>        }<br>    }<br>    </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_tables</span><span style="color: #007700">=array();<br>    </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_tableNames</span><span style="color: #007700">=array();<br>    </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_builder</span><span style="color: #007700">=</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br>}</span></pre> </div> <p>Refreshes the schema. This method resets the loaded table metadata and command builder so that they can be recreated to reflect the change of schema.</p> <h3 class="detailHeader" id="renameColumn-detail"> renameColumn() <span class="detailHeaderTag"> method (available since v1.1.6) </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public string <b>renameColumn</b>(string $table, string $name, string $newName)</pre> </td></tr> <tr> <td class="paramNameCol">$table</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the table whose column is to be renamed. The name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">$name</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the old name of the column. The name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">$newName</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the new name of the column. The name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the SQL statement for renaming a DB column.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/CDbSchema.php#L457">framework/db/schema/CDbSchema.php#457</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">renameColumn</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">,</span><span style="color: #0000BB">$name</span><span style="color: #007700">,</span><span style="color: #0000BB">$newName</span><span style="color: #007700">)<br>{<br>    return </span><span style="color: #DD0000">"ALTER TABLE "</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">)<br>        . </span><span style="color: #DD0000">" RENAME COLUMN "</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteColumnName</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">)<br>        . </span><span style="color: #DD0000">" TO "</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteColumnName</span><span style="color: #007700">(</span><span style="color: #0000BB">$newName</span><span style="color: #007700">);<br>}</span></pre> </div> <p>Builds a SQL statement for renaming a column.</p> <h3 class="detailHeader" id="renameTable-detail"> renameTable() <span class="detailHeaderTag"> method (available since v1.1.6) </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public string <b>renameTable</b>(string $table, string $newName)</pre> </td></tr> <tr> <td class="paramNameCol">$table</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the table to be renamed. The name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">$newName</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the new table name. The name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the SQL statement for renaming a DB table.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/CDbSchema.php#L392">framework/db/schema/CDbSchema.php#392</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">renameTable</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">,</span><span style="color: #0000BB">$newName</span><span style="color: #007700">)<br>{<br>    return </span><span style="color: #DD0000">'RENAME TABLE ' </span><span style="color: #007700">. </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">) . </span><span style="color: #DD0000">' TO ' </span><span style="color: #007700">. </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$newName</span><span style="color: #007700">);<br>}</span></pre> </div> <p>Builds a SQL statement for renaming a DB table.</p> <h3 class="detailHeader" id="resetSequence-detail"> resetSequence() <span class="detailHeaderTag"> method (available since v1.1) </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public void <b>resetSequence</b>(<a href="cdbtableschema">CDbTableSchema</a> $table, integer|null $value=NULL)</pre> </td></tr> <tr> <td class="paramNameCol">$table</td> <td class="paramTypeCol"><a href="cdbtableschema">CDbTableSchema</a></td> <td class="paramDescCol">the table schema whose primary key sequence will be reset</td> </tr> <tr> <td class="paramNameCol">$value</td> <td class="paramTypeCol">integer|null</td> <td class="paramDescCol">the value for the primary key of the next new row inserted. If this is not set, the next new row's primary key will have the max value of a primary key plus one (i.e. sequence trimming).</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/CDbSchema.php#L274">framework/db/schema/CDbSchema.php#274</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">resetSequence</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">,</span><span style="color: #0000BB">$value</span><span style="color: #007700">=</span><span style="color: #0000BB">null</span><span style="color: #007700">)<br>{<br>}</span></pre> </div> <p>Resets the sequence value of a table's primary key. The sequence will be reset such that the primary key of the next new row inserted will have the specified value or max value of a primary key plus one (i.e. sequence trimming).</p> <h3 class="detailHeader" id="truncateTable-detail"> truncateTable() <span class="detailHeaderTag"> method (available since v1.1.6) </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public string <b>truncateTable</b>(string $table)</pre> </td></tr> <tr> <td class="paramNameCol">$table</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the table to be truncated. The name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the SQL statement for truncating a DB table.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/CDbSchema.php#L414">framework/db/schema/CDbSchema.php#414</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">truncateTable</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">)<br>{<br>    return </span><span style="color: #DD0000">"TRUNCATE TABLE "</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">);<br>}</span></pre> </div> <p>Builds a SQL statement for truncating a DB table.</p>
<div class="_attribution">
  <p class="_attribution-p">
    © 2008–2017 by Yii Software LLC<br>Licensed under the three clause BSD license.<br>
    <a href="http://www.yiiframework.com/doc/api/1.1/CDbSchema" class="_attribution-link">http://www.yiiframework.com/doc/api/1.1/CDbSchema</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
