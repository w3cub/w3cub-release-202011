
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Cholesky - R - W3cubDocs</title>
  
  <meta name="description" content="Computes the Cholesky (aka “Choleski”) decomposition of a sparse, symmetric, positive-definite matrix. However, typically chol() should rather be &hellip;">
  <meta name="keywords" content="cholesky, r">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/r/library/matrix/html/cholesky.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-c2f2e7d1236e299f399a2d9bf4342fa70a8839fbe6eb79130546d6bf383b99636ffdf29c557090085d7c4ac34eeb5426851b42d2f4ec63cf218916cbd19aa876.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/r.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/r/" class="_nav-link" title="" style="margin-left:0;">R</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _simple">
				
				
<h2>
<code>Cholesky</code> Cholesky Decomposition of a Sparse Matrix</h2> <h3>Description</h3> <p>Computes the Cholesky (aka “Choleski”) decomposition of a sparse, symmetric, positive-definite matrix. However, typically <code><a href="chol">chol</a>()</code> should rather be used unless you are interested in the different kinds of sparse Cholesky decompositions. </p> <h3>Usage</h3> <pre data-language="r">
Cholesky(A, perm = TRUE, LDL = !super, super = FALSE, Imult = 0, ...)
</pre> <h3>Arguments</h3> <table summary="R argblock"> <tr valign="top">
<td><code>A</code></td> <td> <p>sparse symmetric matrix. No missing values or IEEE special values are allowed.</p> </td>
</tr> <tr valign="top">
<td><code>perm</code></td> <td> <p>logical scalar indicating if a fill-reducing permutation should be computed and applied to the rows and columns of <code>A</code>. Default is <code>TRUE</code>.</p> </td>
</tr>
</table> <table summary="R argblock"> <tr valign="top">
<td><code>LDL</code></td> <td> <p>logical scalar indicating if the decomposition should be computed as LDL' where <code>L</code> is a unit lower triangular matrix. The alternative is LL' where <code>L</code> is lower triangular with arbitrary diagonal elements. Default is <code>TRUE</code>. Setting it to <code><a href="../../base/html/na">NA</a></code> leaves the choice to a CHOLMOD-internal heuristic.</p> </td>
</tr> <tr valign="top">
<td><code>super</code></td> <td> <p>logical scalar indicating if a supernodal decomposition should be created. The alternative is a simplicial decomposition. Default is <code>FALSE</code>. Setting it to <code><a href="../../base/html/na">NA</a></code> leaves the choice to a CHOLMOD-internal heuristic.</p> </td>
</tr> <tr valign="top">
<td><code>Imult</code></td> <td> <p>numeric scalar which defaults to zero. The matrix that is decomposed is <i>A+m*I</i> where <i>m</i> is the value of <code>Imult</code> and <code>I</code> is the identity matrix of order <code>ncol(A)</code>.</p> </td>
</tr> <tr valign="top">
<td><code>...</code></td> <td> <p>further arguments passed to or from other methods.</p> </td>
</tr> </table> <h3>Details</h3> <p>This is a generic function with special methods for different types of matrices. Use <code><a href="../../methods/html/showmethods">showMethods</a>("Cholesky")</code> to list all the methods for the <code><a href="cholesky">Cholesky</a></code> generic. </p> <p>The method for class <code><a href="dscmatrix-class">dsCMatrix</a></code> of sparse matrices — the only one available currently — is based on functions from the CHOLMOD library. </p> <p>Again: If you just want the Cholesky decomposition of a matrix in a straightforward way, you should probably rather use <code><a href="chol">chol</a>(.)</code>. </p> <p>Note that if <code>perm=TRUE</code> (default), the decomposition is </p> <p style="text-align: center;"><i>A = P' L~ D L~' P = P' L L' P,</i></p> <p>where <i>L</i> can be extracted by <code>as(*, "Matrix")</code>, <i>P</i> by <code>as(*, "pMatrix")</code> and both by <code><a href="expand">expand</a>(*)</code>, see the class <code><a href="chmfactor-class">CHMfactor</a></code> documentation. </p> <p>Note that consequently, you cannot easily get the “traditional” cholesky factor <i>R</i>, from this decomposition, as </p> <p style="text-align: center;"><i> R'R = A = P'LL'P = P' R~' R~ P = (R~ P)' (R~ P),</i></p> <p>but <i>R~ P</i> is <em>not</em> triangular even though <i>R~</i> is. </p> <h3>Value</h3> <p>an object inheriting from either <code>"<a href="chmfactor-class">CHMsuper</a>"</code>, or <code>"<a href="chmfactor-class">CHMsimpl</a>"</code>, depending on the <code>super</code> argument; both classes extend <code>"<a href="chmfactor-class">CHMfactor</a>"</code> which extends <code>"<a href="matrixfactorization-class">MatrixFactorization</a>"</code>. </p> <p>In other words, the result of <code>Cholesky()</code> is <em>not</em> a matrix, and if you want one, you should probably rather use <code><a href="chol">chol</a>()</code>, see Details. </p> <h3>References</h3> <p>Yanqing Chen, Timothy A. Davis, William W. Hager, and Sivasankaran Rajamanickam (2008) Algorithm 887: CHOLMOD, Supernodal Sparse Cholesky Factorization and Update/Downdate. <em>ACM Trans. Math. Softw.</em> <b>35</b>, 3, Article 22, 14 pages. doi: <a href="https://doi.org/10.1145/1391989.1391995">10.1145/1391989.1391995</a> </p> <p>Timothy A. Davis (2006) <em>Direct Methods for Sparse Linear Systems</em>, SIAM Series “Fundamentals of Algorithms”. </p> <h3>See Also</h3> <p>Class definitions <code><a href="chmfactor-class">CHMfactor</a></code> and <code><a href="dscmatrix-class">dsCMatrix</a></code> and function <code><a href="expand">expand</a></code>. Note the extra <code><a href="solve-methods">solve</a>(*, system = . )</code> options in <code><a href="chmfactor-class">CHMfactor</a></code>. </p> <p>Note that <code><a href="chol">chol</a>()</code> returns matrices (inheriting from <code>"<a href="matrix-class">Matrix</a>"</code>) whereas <code>Cholesky()</code> returns a <code>"<a href="chmfactor-class">CHMfactor</a>"</code> object, and hence a typical user will rather use <code>chol(A)</code>. </p> <h3>Examples</h3> <pre data-language="r">
data(KNex)
mtm &lt;- with(KNex, crossprod(mm))
str(mtm@factors) # empty list()
(C1 &lt;- Cholesky(mtm))             # uses show(&lt;MatrixFactorization&gt;)
str(mtm@factors) # 'sPDCholesky' (simpl)
(Cm &lt;- Cholesky(mtm, super = TRUE))
c(C1 = isLDL(C1), Cm = isLDL(Cm))
str(mtm@factors) # 'sPDCholesky'  *and* 'SPdCholesky'
str(cm1  &lt;- as(C1, "sparseMatrix"))
str(cmat &lt;- as(Cm, "sparseMatrix"))# hmm: super is *less* sparse here
cm1[1:20, 1:20]

b &lt;- matrix(c(rep(0, 711), 1), nc = 1)
## solve(Cm, b) by default solves  Ax = b, where A = Cm'Cm (= mtm)!
## hence, the identical() check *should* work, but fails on some GOTOblas:
x &lt;- solve(Cm, b)
stopifnot(identical(x, solve(Cm, b, system = "A")),
          all.equal(x, solve(mtm, b)))

Cn &lt;- Cholesky(mtm, perm = FALSE)# no permutation -- much worse:
sizes &lt;- c(simple = object.size(C1),
           super  = object.size(Cm),
           noPerm = object.size(Cn))
## simple is 100, super= 137, noPerm= 812 :
noquote(cbind(format(100 * sizes / sizes[1], digits=4)))


## Visualize the sparseness:
dq &lt;- function(ch) paste('"',ch,'"', sep="") ## dQuote(&lt;UTF-8&gt;) gives bad plots
image(mtm, main=paste("crossprod(mm) : Sparse", dq(class(mtm))))
image(cm1, main= paste("as(Cholesky(crossprod(mm)),\"sparseMatrix\"):",
                        dq(class(cm1))))


## Smaller example, with same matrix as in  help(chol) :
(mm &lt;- Matrix(toeplitz(c(10, 0, 1, 0, 3)), sparse = TRUE)) # 5 x 5
(opts &lt;- expand.grid(perm = c(TRUE,FALSE), LDL = c(TRUE,FALSE), super = c(FALSE,TRUE)))
rr &lt;- lapply(seq_len(nrow(opts)), function(i)
             do.call(Cholesky, c(list(A = mm), opts[i,])))
nn &lt;- do.call(expand.grid, c(attr(opts, "out.attr")$dimnames,
              stringsAsFactors=FALSE,KEEP.OUT.ATTRS=FALSE))
names(rr) &lt;- apply(nn, 1, function(r)
                   paste(sub("(=.).*","\\1", r), collapse=","))
str(rr, max=1)

str(re &lt;- lapply(rr, expand), max=2) ## each has a 'P' and a 'L' matrix

R0 &lt;- chol(mm, pivot=FALSE)
R1 &lt;- chol(mm, pivot=TRUE )
stopifnot(all.equal(t(R1), re[[1]]$L),
          all.equal(t(R0), re[[2]]$L),
          identical(as(1:5, "pMatrix"), re[[2]]$P), # no pivoting
TRUE)



# Version of the underlying SuiteSparse library by Tim Davis :
.SuiteSparse_version()
</pre>
<div class="_attribution">
  <p class="_attribution-p">
    Copyright (©) 1999–2012 R Foundation for Statistical Computing.<br>Licensed under the <a href="https://www.gnu.org/copyleft/gpl.html">GNU General Public License</a>.<br>
    
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
