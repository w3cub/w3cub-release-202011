
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Integrate - R - W3cubDocs</title>
  
  <meta name="description" content=" Adaptive quadrature of functions of one variable over a finite or infinite interval. ">
  <meta name="keywords" content="integrate, r">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/r/library/stats/html/integrate.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-c2f2e7d1236e299f399a2d9bf4342fa70a8839fbe6eb79130546d6bf383b99636ffdf29c557090085d7c4ac34eeb5426851b42d2f4ec63cf218916cbd19aa876.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/r.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/r/" class="_nav-link" title="" style="margin-left:0;">R</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _simple">
				
				
<h2>
<code>integrate</code> Integration of One-Dimensional Functions</h2> <h3>Description</h3> <p>Adaptive quadrature of functions of one variable over a finite or infinite interval. </p> <h3>Usage</h3> <pre data-language="r">
integrate(f, lower, upper, ..., subdivisions = 100L,
          rel.tol = .Machine$double.eps^0.25, abs.tol = rel.tol,
          stop.on.error = TRUE, keep.xy = FALSE, aux = NULL)
</pre> <h3>Arguments</h3> <table summary="R argblock"> <tr valign="top">
<td><code>f</code></td> <td> <p>an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> function taking a numeric first argument and returning a numeric vector of the same length. Returning a non-finite element will generate an error.</p> </td>
</tr> <tr valign="top">
<td><code>lower, upper</code></td> <td> <p>the limits of integration. Can be infinite.</p> </td>
</tr> <tr valign="top">
<td><code>...</code></td> <td> <p>additional arguments to be passed to <code>f</code>.</p> </td>
</tr> <tr valign="top">
<td><code>subdivisions</code></td> <td> <p>the maximum number of subintervals.</p> </td>
</tr> <tr valign="top">
<td><code>rel.tol</code></td> <td> <p>relative accuracy requested.</p> </td>
</tr> <tr valign="top">
<td><code>abs.tol</code></td> <td> <p>absolute accuracy requested.</p> </td>
</tr> <tr valign="top">
<td><code>stop.on.error</code></td> <td> <p>logical. If true (the default) an error stops the function. If false some errors will give a result with a warning in the <code>message</code> component.</p> </td>
</tr> <tr valign="top">
<td><code>keep.xy</code></td> <td> <p>unused. For compatibility with S.</p> </td>
</tr> <tr valign="top">
<td><code>aux</code></td> <td> <p>unused. For compatibility with S.</p> </td>
</tr> </table> <h3>Details</h3> <p>Note that arguments after <code>...</code> must be matched exactly. </p> <p>If one or both limits are infinite, the infinite range is mapped onto a finite interval. </p> <p>For a finite interval, globally adaptive interval subdivision is used in connection with extrapolation by Wynn's Epsilon algorithm, with the basic step being Gauss–Kronrod quadrature. </p> <p><code>rel.tol</code> cannot be less than <code>max(50*.Machine$double.eps,
    0.5e-28)</code> if <code>abs.tol &lt;= 0</code>. </p> <p>Note that the comments in the C source code in ‘<span class="file">&lt;R&gt;/src/appl/integrate.c</span>’ give more details, particularly about reasons for failure (internal error code <code>ier &gt;= 1</code>). </p> <p>In <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> versions <i>&lt;=</i> 3.2.x, the first entries of <code>lower</code> and <code>upper</code> were used whereas an error is signalled now if they are not of length one. </p> <h3>Value</h3> <p>A list of class <code>"integrate"</code> with components </p> <table summary="R valueblock"> <tr valign="top">
<td><code>value</code></td> <td> <p>the final estimate of the integral.</p> </td>
</tr> <tr valign="top">
<td><code>abs.error</code></td> <td> <p>estimate of the modulus of the absolute error.</p> </td>
</tr> <tr valign="top">
<td><code>subdivisions</code></td> <td> <p>the number of subintervals produced in the subdivision process.</p> </td>
</tr> <tr valign="top">
<td><code>message</code></td> <td> <p><code>"OK"</code> or a character string giving the error message.</p> </td>
</tr> <tr valign="top">
<td><code>call</code></td> <td> <p>the matched call.</p> </td>
</tr> </table> <h3>Note</h3> <p>Like all numerical integration routines, these evaluate the function on a finite set of points. If the function is approximately constant (in particular, zero) over nearly all its range it is possible that the result and error estimate may be seriously wrong. </p> <p>When integrating over infinite intervals do so explicitly, rather than just using a large number as the endpoint. This increases the chance of a correct answer – any function whose integral over an infinite interval is finite must be near zero for most of that interval. </p> <p>For values at a finite set of points to be a fair reflection of the behaviour of the function elsewhere, the function needs to be well-behaved, for example differentiable except perhaps for a small number of jumps or integrable singularities. </p> <p><code>f</code> must accept a vector of inputs and produce a vector of function evaluations at those points. The <code><a href="../../base/html/vectorize">Vectorize</a></code> function may be helpful to convert <code>f</code> to this form. </p> <h3>Source</h3> <p>Based on QUADPACK routines <code>dqags</code> and <code>dqagi</code> by R. Piessens and E. deDoncker–Kapenga, available from Netlib. </p> <h3>References</h3> <p>R. Piessens, E. deDoncker–Kapenga, C. Uberhuber, D. Kahaner (1983) <em>Quadpack: a Subroutine Package for Automatic Integration</em>; Springer Verlag. </p> <h3>Examples</h3> <pre data-language="r">
integrate(dnorm, -1.96, 1.96)
integrate(dnorm, -Inf, Inf)

## a slowly-convergent integral
integrand &lt;- function(x) {1/((x+1)*sqrt(x))}
integrate(integrand, lower = 0, upper = Inf)

## don't do this if you really want the integral from 0 to Inf
integrate(integrand, lower = 0, upper = 10)
integrate(integrand, lower = 0, upper = 100000)
integrate(integrand, lower = 0, upper = 1000000, stop.on.error = FALSE)

## some functions do not handle vector input properly
f &lt;- function(x) 2.0
try(integrate(f, 0, 1))
integrate(Vectorize(f), 0, 1)  ## correct
integrate(function(x) rep(2.0, length(x)), 0, 1)  ## correct

## integrate can fail if misused
integrate(dnorm, 0, 2)
integrate(dnorm, 0, 20)
integrate(dnorm, 0, 200)
integrate(dnorm, 0, 2000)
integrate(dnorm, 0, 20000) ## fails on many systems
integrate(dnorm, 0, Inf)   ## works

integrate(dnorm, 0:1, 20) #-&gt; error!
## "silently" gave  integrate(dnorm, 0, 20)  in earlier versions of R

</pre>
<div class="_attribution">
  <p class="_attribution-p">
    Copyright (©) 1999–2012 R Foundation for Statistical Computing.<br>Licensed under the <a href="https://www.gnu.org/copyleft/gpl.html">GNU General Public License</a>.<br>
    
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
