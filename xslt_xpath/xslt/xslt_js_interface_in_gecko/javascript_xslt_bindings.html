
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>XSLT JS Interface in Gecko.JavaScript XSLT Bindings - XSLT &#38; XPath - W3cubDocs</title>
  
  <meta name="description" content="JavaScript can run XSLT transformations through the XSLTProcessor object. Once instantiated, an XSLTProcessor has an XSLTProcessor.importStylesheet &hellip;">
  <meta name="keywords" content="javascript, xslt, bindings, js, interface, gecko, &#38;, xpath, xslt_xpath">
  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/xslt_xpath/xslt/xslt_js_interface_in_gecko/javascript_xslt_bindings.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-9c7b0d969c0ce639a6c01c2badcdd81667c7c66206aa3d0fccc5cb0585fb1b912dab72ea882101d18010680927514b4b77b107282db8f756fbf63301fe9c88b0.css">
  <script type="text/javascript" src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js"></script>
  <script src="/json/xslt_xpath.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/xslt_xpath/" class="_nav-link" title="" style="margin-left:0;">XSLT & XPath</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _mdn">
				
				
<h1>JavaScript/XSLT Bindings</h1>
<section aria-labelledby="javascriptxslt_bindings"><h2 id="javascriptxslt_bindings">JavaScript/XSLT Bindings</h2>
<div class="section-content">
<p>JavaScript can run XSLT transformations through the <a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor"><code>XSLTProcessor</code></a> object. Once instantiated, an <a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor"><code>XSLTProcessor</code></a> has an <a class="page-not-created"><code>XSLTProcessor.importStylesheet()</code></a> method that takes as an argument the XSLT stylesheet to be used in the transformation. The stylesheet has to be passed in as an XML document, which means that the .xsl file has to be loaded by the page before calling <a class="page-not-created"><code>XSLTProcessor.importStylesheet()</code></a>. This can be done via <a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest"><code>XMLHttpRequest</code></a> or <a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLDocument/load"><code>XMLDocument.load()</code></a>.</p> <p><strong>Figure 1 : Instantiating an <a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor"><code>XSLTProcessor</code></a></strong></p> <div class="code-example"><pre data-language="js">  <span class="token keyword">const</span> xsltProcessor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XSLTProcessor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Load the xsl file using synchronous (third param is set to false) XMLHttpRequest</span>
  <span class="token keyword">const</span> myXMLHTTPRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  myXMLHTTPRequest<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"GET"</span><span class="token punctuation">,</span> <span class="token string">"example.xsl"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  myXMLHTTPRequest<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> xslRef <span class="token operator">=</span> myXMLHTTPRequest<span class="token punctuation">.</span>responseXML<span class="token punctuation">;</span>

  <span class="token comment">// Finally import the .xsl</span>
  xsltProcessor<span class="token punctuation">.</span><span class="token function">importStylesheet</span><span class="token punctuation">(</span>xslRef<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre></div> <p>For the actual transformation, <a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor"><code>XSLTProcessor</code></a> requires an XML document, which is used in conjunction with the imported XSL file to produce the final result. The XML document can be a separate XML file loaded as shown in figure 1, or it can be part of the existing page. To process part of a page's DOM, it is necessary to first create an XML document in memory. Assuming that the DOM to be processed is contained by an element with the id <code>example</code>, that DOM can be "cloned" using the in-memory XML document's <a href="https://developer.mozilla.org/en-US/docs/Web/API/Document/importNode"><code>Document.importNode()</code></a> method. <a href="https://developer.mozilla.org/en-US/docs/Web/API/Document/importNode"><code>Document.importNode()</code></a> allows transferring a DOM fragment between documents, in this case from an HTML document to an XML document. The first parameter references the DOM node to clone. By making the second parameter "true", it will clone all descendants as well (a deep clone). The cloned DOM can then be easily inserted into the XML document using <a href="https://developer.mozilla.org/en-US/docs/Web/API/Node/appendChild"><code>Node.appendChild()</code></a>, as shown in figure 2.</p> <p><strong>Figure 2 : Creating an XML document based on part of a document's DOM</strong></p> <div class="code-example"><pre data-language="js">  <span class="token comment">// Create a new XML document in memory</span>
  <span class="token keyword">const</span> xmlRef <span class="token operator">=</span> document<span class="token punctuation">.</span>implementation<span class="token punctuation">.</span><span class="token function">createDocument</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// We want to move a part of the DOM from an HTML document to an XML document.</span>
  <span class="token comment">// importNode is used to clone the nodes we want to process via XSLT - true makes it do a deep clone</span>
  <span class="token keyword">const</span> myNode <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"example"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> clonedNode <span class="token operator">=</span> xmlRef<span class="token punctuation">.</span><span class="token function">importNode</span><span class="token punctuation">(</span>myNode<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Add the cloned DOM into the XML document</span>
  xmlRef<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>clonedNode<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre></div> <p>Once the stylesheet has been imported, <a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor"><code>XSLTProcessor</code></a> has to perform two methods for the actual transformation, namely <a class="page-not-created"><code>XSLTProcessor.transformToDocument()</code></a> and <a class="page-not-created"><code>XSLTProcessor.transformToFragment()</code></a>. <a class="page-not-created"><code>XSLTProcessor.transformToDocument()</code></a> returns a full XML document while <a class="page-not-created"><code>XSLTProcessor.transformToFragment()</code></a> returns a document fragment that can be easily added to an existing document. Both take in the XML document as the first parameter that will be transformed. <a class="page-not-created"><code>XSLTProcessor.transformToFragment()</code></a> requires a second parameter, namely the document object that will own the generated fragment. If the generated fragment will be inserted into the current HTML document, passing in document is enough.</p> <p><strong>Figure 2.1 : Creating an XML document From a String 'XML Soup'</strong></p> <p>While you can use IE <code>loadXML</code> method to load a string containing XML you have to perform some tweaking and tuning to do the same in Mozilla. You must use the DomParser.no to create any document, as this is handled by the DomParser.</p> <div class="code-example"><pre data-language="js"><span class="token keyword">const</span> parser <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DOMParser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> doc <span class="token operator">=</span> parser<span class="token punctuation">.</span><span class="token function">parseFromString</span><span class="token punctuation">(</span>aStr<span class="token punctuation">,</span> <span class="token string">"text/xml"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre></div> <p><strong>Figure 3 : Performing the transformation</strong></p> <div class="code-example"><pre data-language="js">  <span class="token keyword">const</span> fragment <span class="token operator">=</span> xsltProcessor<span class="token punctuation">.</span><span class="token function">transformToFragment</span><span class="token punctuation">(</span>xmlRef<span class="token punctuation">,</span> document<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre></div>
</div></section><div class="_attribution">
  <p class="_attribution-p">
    © 2005–2022 MDN contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/XSLT/XSLT_JS_interface_in_Gecko/JavaScript_XSLT_Bindings" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/XSLT/XSLT_JS_interface_in_Gecko/JavaScript_XSLT_Bindings</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
