
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>runners.fileserver - SaltStack - W3cubDocs</title>
  
  <meta name="description" content=" Directly manage the Salt fileserver plugins ">
  <meta name="keywords" content="salt, runners, fileserver, saltstack">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/saltstack/ref/runners/all/salt.runners.fileserver.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e4ebd3a2a5652ff55173659804c4390a004917f3bdd17b5bb3ba78ea5c9c46fe181cadaac34517ccd815f5bdc982bbfe67179d6f4ac2f084ef2265e2a3dc8dc5.css" integrity="sha512-5OvToqVlL/VRc2WYBMQ5CgBJF/O90Xtbs7p46lycRv4YHK2qw0UXzNgV9b3Jgrv+Zxedb0rC8ITvImXio9yNxQ==" crossorigin="anonymous">
  <script type="text/javascript" integrity="sha512-EpkDeu98lN/jPKijllzVWdRg/dUSSMCaldYZNFz6bcNoBvpWRNz0HSTRQJ3ENmQc5Cuj1zDW1vHd7b0DzpOgyA==" crossorigin="anonymous" src="/assets/application-1299037aef7c94dfe33ca8a3965cd559d460fdd51248c09a95d619345cfa6dc36806fa5644dcf41d24d1409dc436641ce42ba3d730d6d6f1ddedbd03ce93a0c8.js"></script>
  <script src="/json/saltstack.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/saltstack/" class="_nav-link" title="" style="margin-left:0;">SaltStack</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _simple">
				
				
<h1>salt.runners.fileserver</h1> <p>Directly manage the Salt fileserver plugins</p> <dl class="function"> <h3 id="salt.runners.fileserver.clear_cache"> salt.runners.fileserver.clear_cache(backend=None)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 2015.5.0.</span></p> </div> <p>Clear the fileserver cache from VCS fileserver backends (<a class="reference internal" href="../../file_server/all/salt.fileserver.gitfs#module-salt.fileserver.gitfs" title="salt.fileserver.gitfs"><code class="xref py py-mod docutils literal notranslate"><span class="pre">git</span></code></a>, <a class="reference internal" href="../../file_server/all/salt.fileserver.hgfs#module-salt.fileserver.hgfs" title="salt.fileserver.hgfs"><code class="xref py py-mod docutils literal notranslate"><span class="pre">hg</span></code></a>, <a class="reference internal" href="../../file_server/all/salt.fileserver.svnfs#module-salt.fileserver.svnfs" title="salt.fileserver.svnfs"><code class="xref py py-mod docutils literal notranslate"><span class="pre">svn</span></code></a>). Executing this runner with no arguments will clear the cache for all enabled VCS fileserver backends, but this can be narrowed using the <code class="docutils literal notranslate"><span class="pre">backend</span></code> argument.</p> <dl class="docutils"> <dt>backend</dt> <dd>Only clear the update lock for the specified backend(s). If all passed backends start with a minus sign (<code class="docutils literal notranslate"><span class="pre">-</span></code>), then these backends will be excluded from the enabled backends. However, if there is a mix of backends with and without a minus sign (ex: <code class="docutils literal notranslate"><span class="pre">backend=-roots,git</span></code>) then the ones starting with a minus sign will be disregarded.</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-run fileserver.clear_cache
salt-run fileserver.clear_cache backend=git,hg
salt-run fileserver.clear_cache hg
salt-run fileserver.clear_cache -roots</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.runners.fileserver.clear_file_list_cache"> salt.runners.fileserver.clear_file_list_cache(saltenv=None, backend=None)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 2016.11.0.</span></p> </div> <p>The Salt fileserver caches the files/directories/symlinks for each fileserver backend and environment as they are requested. This is done to help the fileserver scale better. Without this caching, when hundreds/thousands of minions simultaneously ask the master what files are available, this would cause the master's CPU load to spike as it obtains the same information separately for each minion.</p> <dl class="docutils"> <dt>saltenv</dt> <dd>By default, this runner will clear the file list caches for all environments. This argument allows for a list of environments to be passed, to clear more selectively. This list can be passed either as a comma-separated string, or a Python list.</dd> <dt>backend</dt> <dd>Similar to the <code class="docutils literal notranslate"><span class="pre">saltenv</span></code> parameter, this argument will restrict the cache clearing to specific fileserver backends (the default behavior is to clear from all enabled fileserver backends). This list can be passed either as a comma-separated string, or a Python list.</dd> </dl> <p>Since the ability to clear these caches is often required by users writing custom runners which add/remove files, this runner can easily be called from within a custom runner using any of the following examples:</p> <pre class="highlight-python notranslate" data-language="python"># Clear all file list caches
__salt__['fileserver.clear_file_list_cache']()
# Clear just the 'base' saltenv file list caches
__salt__['fileserver.clear_file_list_cache'](saltenv='base')
# Clear just the 'base' saltenv file list caches from just the 'roots'
# fileserver backend
__salt__['fileserver.clear_file_list_cache'](saltenv='base', backend='roots')
# Clear all file list caches from the 'roots' fileserver backend
__salt__['fileserver.clear_file_list_cache'](backend='roots')</pre> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">In runners, the <code class="docutils literal notranslate"><span class="pre">__salt__</span></code> dictionary will likely be renamed to <code class="docutils literal notranslate"><span class="pre">__runner__</span></code> in a future Salt release to distinguish runner functions from remote execution functions. See <a class="reference external" href="https://github.com/saltstack/salt/issues/34958">this GitHub issue</a> for discussion/updates on this.</p> </div> <p>If using Salt's Python API (not a runner), the following examples are equivalent to the ones above:</p> <pre class="highlight-python notranslate" data-language="python">import salt.config
import salt.runner

opts = salt.config.master_config('/etc/salt/master')
opts['fun'] = 'fileserver.clear_file_list_cache'

# Clear all file list_caches
opts['arg'] = []  # No arguments
runner = salt.runner.Runner(opts)
cleared = runner.run()

# Clear just the 'base' saltenv file list caches
opts['arg'] = ['base', None]
runner = salt.runner.Runner(opts)
cleared = runner.run()

# Clear just the 'base' saltenv file list caches from just the 'roots'
# fileserver backend
opts['arg'] = ['base', 'roots']
runner = salt.runner.Runner(opts)
cleared = runner.run()

# Clear all file list caches from the 'roots' fileserver backend
opts['arg'] = [None, 'roots']
runner = salt.runner.Runner(opts)
cleared = runner.run()</pre> <p>This function will return a dictionary showing a list of environments which were cleared for each backend. An empty return dictionary means that no changes were made.</p> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash"># Clear all file list caches
salt-run fileserver.clear_file_list_cache
# Clear just the 'base' saltenv file list caches
salt-run fileserver.clear_file_list_cache saltenv=base
# Clear just the 'base' saltenv file list caches from just the 'roots'
# fileserver backend
salt-run fileserver.clear_file_list_cache saltenv=base backend=roots
# Clear all file list caches from the 'roots' fileserver backend
salt-run fileserver.clear_file_list_cache backend=roots</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.runners.fileserver.clear_lock"> salt.runners.fileserver.clear_lock(backend=None, remote=None)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 2015.5.0.</span></p> </div> <p>Clear the fileserver update lock from VCS fileserver backends (<a class="reference internal" href="../../file_server/all/salt.fileserver.gitfs#module-salt.fileserver.gitfs" title="salt.fileserver.gitfs"><code class="xref py py-mod docutils literal notranslate"><span class="pre">git</span></code></a>, <a class="reference internal" href="../../file_server/all/salt.fileserver.hgfs#module-salt.fileserver.hgfs" title="salt.fileserver.hgfs"><code class="xref py py-mod docutils literal notranslate"><span class="pre">hg</span></code></a>, <a class="reference internal" href="../../file_server/all/salt.fileserver.svnfs#module-salt.fileserver.svnfs" title="salt.fileserver.svnfs"><code class="xref py py-mod docutils literal notranslate"><span class="pre">svn</span></code></a>). This should only need to be done if a fileserver update was interrupted and a remote is not updating (generating a warning in the Master's log file). Executing this runner with no arguments will remove all update locks from all enabled VCS fileserver backends, but this can be narrowed by using the following arguments:</p> <dl class="docutils"> <dt>backend</dt> <dd>Only clear the update lock for the specified backend(s).</dd> <dt>remote</dt> <dd>If specified, then any remotes which contain the passed string will have their lock cleared. For example, a <code class="docutils literal notranslate"><span class="pre">remote</span></code> value of <strong>github</strong> will remove the lock from all github.com remotes.</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-run fileserver.clear_lock
salt-run fileserver.clear_lock backend=git,hg
salt-run fileserver.clear_lock backend=git remote=github
salt-run fileserver.clear_lock remote=bitbucket</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.runners.fileserver.dir_list"> salt.runners.fileserver.dir_list(saltenv='base', backend=None)</h3> <dd>
<p>Return a list of directories in the given environment</p> <dl class="docutils"> <dt>saltenv <span class="classifier-delimiter">:</span> <span class="classifier">base</span>
</dt> <dd>The salt fileserver environment to be listed</dd> <dt>backend</dt> <dd>
<p class="first">Narrow fileserver backends to a subset of the enabled ones. If all passed backends start with a minus sign (<code class="docutils literal notranslate"><span class="pre">-</span></code>), then these backends will be excluded from the enabled backends. However, if there is a mix of backends with and without a minus sign (ex: <code class="docutils literal notranslate"><span class="pre">backend=-roots,git</span></code>) then the ones starting with a minus sign will be disregarded.</p> <div class="last versionadded"> <p><span class="versionmodified">New in version 2015.5.0.</span></p> </div> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-run fileserver.dir_list
salt-run fileserver.dir_list saltenv=prod
salt-run fileserver.dir_list saltenv=dev backend=git
salt-run fileserver.dir_list base hg,roots
salt-run fileserver.dir_list -git</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.runners.fileserver.empty_dir_list"> salt.runners.fileserver.empty_dir_list(saltenv='base', backend=None)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 2015.5.0.</span></p> </div> <p>Return a list of empty directories in the given environment</p> <dl class="docutils"> <dt>saltenv <span class="classifier-delimiter">:</span> <span class="classifier">base</span>
</dt> <dd>The salt fileserver environment to be listed</dd> <dt>backend</dt> <dd>
<p class="first">Narrow fileserver backends to a subset of the enabled ones. If all passed backends start with a minus sign (<code class="docutils literal notranslate"><span class="pre">-</span></code>), then these backends will be excluded from the enabled backends. However, if there is a mix of backends with and without a minus sign (ex: <code class="docutils literal notranslate"><span class="pre">backend=-roots,git</span></code>) then the ones starting with a minus sign will be disregarded.</p> <div class="last admonition note"> <p class="first admonition-title">Note</p> <p class="last">Some backends (such as <a class="reference internal" href="../../file_server/all/salt.fileserver.gitfs#module-salt.fileserver.gitfs" title="salt.fileserver.gitfs"><code class="xref py py-mod docutils literal notranslate"><span class="pre">git</span></code></a> and <a class="reference internal" href="../../file_server/all/salt.fileserver.hgfs#module-salt.fileserver.hgfs" title="salt.fileserver.hgfs"><code class="xref py py-mod docutils literal notranslate"><span class="pre">hg</span></code></a>) do not support empty directories. So, passing <code class="docutils literal notranslate"><span class="pre">backend=git</span></code> or <code class="docutils literal notranslate"><span class="pre">backend=hg</span></code> will result in an empty list being returned.</p> </div> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-run fileserver.empty_dir_list
salt-run fileserver.empty_dir_list saltenv=prod
salt-run fileserver.empty_dir_list backend=roots</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.runners.fileserver.envs"> salt.runners.fileserver.envs(backend=None, sources=False)</h3> <dd>
<p>Return the available fileserver environments. If no backend is provided, then the environments for all configured backends will be returned.</p> <dl class="docutils"> <dt>backend</dt> <dd>
<p class="first">Narrow fileserver backends to a subset of the enabled ones.</p> <div class="last versionchanged"> <p><span class="versionmodified">Changed in version 2015.5.0: </span>If all passed backends start with a minus sign (<code class="docutils literal notranslate"><span class="pre">-</span></code>), then these backends will be excluded from the enabled backends. However, if there is a mix of backends with and without a minus sign (ex: <code class="docutils literal notranslate"><span class="pre">backend=-roots,git</span></code>) then the ones starting with a minus sign will be disregarded.</p> <p>Additionally, fileserver backends can now be passed as a comma-separated list. In earlier versions, they needed to be passed as a python list (ex: <code class="docutils literal notranslate"><span class="pre">backend="['roots',</span> <span class="pre">'git']"</span></code>)</p> </div> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-run fileserver.envs
salt-run fileserver.envs backend=roots,git
salt-run fileserver.envs git</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.runners.fileserver.file_list"> salt.runners.fileserver.file_list(saltenv='base', backend=None)</h3> <dd>
<p>Return a list of files from the salt fileserver</p> <dl class="docutils"> <dt>saltenv <span class="classifier-delimiter">:</span> <span class="classifier">base</span>
</dt> <dd>The salt fileserver environment to be listed</dd> <dt>backend</dt> <dd>
<p class="first">Narrow fileserver backends to a subset of the enabled ones. If all passed backends start with a minus sign (<code class="docutils literal notranslate"><span class="pre">-</span></code>), then these backends will be excluded from the enabled backends. However, if there is a mix of backends with and without a minus sign (ex: <code class="docutils literal notranslate"><span class="pre">backend=-roots,git</span></code>) then the ones starting with a minus sign will be disregarded.</p> <div class="last versionadded"> <p><span class="versionmodified">New in version 2015.5.0.</span></p> </div> </dd> </dl> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-run fileserver.file_list
salt-run fileserver.file_list saltenv=prod
salt-run fileserver.file_list saltenv=dev backend=git
salt-run fileserver.file_list base hg,roots
salt-run fileserver.file_list -git</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.runners.fileserver.lock"> salt.runners.fileserver.lock(backend=None, remote=None)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 2015.5.0.</span></p> </div> <p>Set a fileserver update lock for VCS fileserver backends (<a class="reference internal" href="../../file_server/all/salt.fileserver.gitfs#module-salt.fileserver.gitfs" title="salt.fileserver.gitfs"><code class="xref py py-mod docutils literal notranslate"><span class="pre">git</span></code></a>, <a class="reference internal" href="../../file_server/all/salt.fileserver.hgfs#module-salt.fileserver.hgfs" title="salt.fileserver.hgfs"><code class="xref py py-mod docutils literal notranslate"><span class="pre">hg</span></code></a>, <a class="reference internal" href="../../file_server/all/salt.fileserver.svnfs#module-salt.fileserver.svnfs" title="salt.fileserver.svnfs"><code class="xref py py-mod docutils literal notranslate"><span class="pre">svn</span></code></a>).</p> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">This will only operate on enabled backends (those configured in <a class="reference internal" href="https://docs.saltstack.com/en/latest/ref/configuration/master.html#std:conf_master-fileserver_backend"><code class="xref std std-conf_master docutils literal notranslate"><span class="pre">fileserver_backend</span></code></a>).</p> </div> <dl class="docutils"> <dt>backend</dt> <dd>Only set the update lock for the specified backend(s).</dd> <dt>remote</dt> <dd>If not None, then any remotes which contain the passed string will have their lock cleared. For example, a <code class="docutils literal notranslate"><span class="pre">remote</span></code> value of <code class="docutils literal notranslate"><span class="pre">*github.com*</span></code> will remove the lock from all github.com remotes.</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-run fileserver.lock
salt-run fileserver.lock backend=git,hg
salt-run fileserver.lock backend=git remote='*github.com*'
salt-run fileserver.lock remote=bitbucket</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.runners.fileserver.symlink_list"> salt.runners.fileserver.symlink_list(saltenv='base', backend=None)</h3> <dd>
<p>Return a list of symlinked files and dirs</p> <dl class="docutils"> <dt>saltenv <span class="classifier-delimiter">:</span> <span class="classifier">base</span>
</dt> <dd>The salt fileserver environment to be listed</dd> <dt>backend</dt> <dd>
<p class="first">Narrow fileserver backends to a subset of the enabled ones. If all passed backends start with a minus sign (<code class="docutils literal notranslate"><span class="pre">-</span></code>), then these backends will be excluded from the enabled backends. However, if there is a mix of backends with and without a minus sign (ex: <code class="docutils literal notranslate"><span class="pre">backend=-roots,git</span></code>) then the ones starting with a minus sign will be disregarded.</p> <div class="last versionadded"> <p><span class="versionmodified">New in version 2015.5.0.</span></p> </div> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-run fileserver.symlink_list
salt-run fileserver.symlink_list saltenv=prod
salt-run fileserver.symlink_list saltenv=dev backend=git
salt-run fileserver.symlink_list base hg,roots
salt-run fileserver.symlink_list -git</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.runners.fileserver.update"> salt.runners.fileserver.update(backend=None)</h3> <dd>
<p>Update the fileserver cache. If no backend is provided, then the cache for all configured backends will be updated.</p> <dl class="docutils"> <dt>backend</dt> <dd>
<p class="first">Narrow fileserver backends to a subset of the enabled ones.</p> <div class="last versionchanged"> <p><span class="versionmodified">Changed in version 2015.5.0: </span>If all passed backends start with a minus sign (<code class="docutils literal notranslate"><span class="pre">-</span></code>), then these backends will be excluded from the enabled backends. However, if there is a mix of backends with and without a minus sign (ex: <code class="docutils literal notranslate"><span class="pre">backend=-roots,git</span></code>) then the ones starting with a minus sign will be disregarded.</p> <p>Additionally, fileserver backends can now be passed as a comma-separated list. In earlier versions, they needed to be passed as a python list (ex: <code class="docutils literal notranslate"><span class="pre">backend="['roots',</span> <span class="pre">'git']"</span></code>)</p> </div> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-run fileserver.update
salt-run fileserver.update backend=roots,git</pre> </dd>
</dl>
<div class="_attribution">
  <p class="_attribution-p">
    Â© 2019 SaltStack.<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://docs.saltstack.com/en/latest/ref/runners/all/salt.runners.fileserver.html" class="_attribution-link">https://docs.saltstack.com/en/latest/ref/runners/all/salt.runners.fileserver.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
