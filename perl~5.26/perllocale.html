
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Perllocale - Perl 5.26 - W3cubDocs</title>
  
  <meta name="description" content=" perllocale - Perl locale handling (internationalization and localization) ">
  <meta name="keywords" content="perllocale, perl, perl~5.26">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/perl~5.26/perllocale.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-01fda2ddb8339756caccf7add5ad4cf849ab52d069bd799015c7f04f93164f64753bff0d15a49d8060b1e66e41002bb301ccadc2350937df079cea3cd52d3cca.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/perl~5.26.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/perl~5.26/" class="_nav-link" title="" style="margin-left:0;">Perl 5.26</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _perl">
				
				
<h1>perllocale</h1>  <ul>
<li><a href="#NAME">NAME</a></li>
<li><a href="#DESCRIPTION">DESCRIPTION</a></li>
<li><a href="#WHAT-IS-A-LOCALE">WHAT IS A LOCALE</a></li>
<li><a href="#PREPARING-TO-USE-LOCALES">PREPARING TO USE LOCALES</a></li>
<li>
<a href="#USING-LOCALES">USING LOCALES</a><ul>
<li><a href="#The-%22use-locale%22-pragma">The "use locale" pragma</a></li>
<li><a href="#The-setlocale-function">The setlocale function</a></li>
<li><a href="#Finding-locales">Finding locales</a></li>
<li><a href="#LOCALE-PROBLEMS">LOCALE PROBLEMS</a></li>
<li><a href="#Testing-for-broken-locales">Testing for broken locales</a></li>
<li><a href="#Temporarily-fixing-locale-problems">Temporarily fixing locale problems</a></li>
<li><a href="#Permanently-fixing-locale-problems">Permanently fixing locale problems</a></li>
<li><a href="#Permanently-fixing-your-system's-locale-configuration">Permanently fixing your system's locale configuration</a></li>
<li><a href="#Fixing-system-locale-configuration">Fixing system locale configuration</a></li>
<li><a href="#The-localeconv-function">The localeconv function</a></li>
<li><a href="#I18N%3a%3aLanginfo">I18N::Langinfo</a></li>
</ul>
</li>
<li>
<a href="#LOCALE-CATEGORIES">LOCALE CATEGORIES</a><ul>
<li><a href="#Category-LC_COLLATE%3a-Collation">Category LC_COLLATE: Collation</a></li>
<li><a href="#Category-LC_CTYPE%3a-Character-Types">Category LC_CTYPE: Character Types</a></li>
<li><a href="#Category-LC_NUMERIC%3a-Numeric-Formatting">Category LC_NUMERIC: Numeric Formatting</a></li>
<li><a href="#Category-LC_MONETARY%3a-Formatting-of-monetary-amounts">Category LC_MONETARY: Formatting of monetary amounts</a></li>
<li><a href="#LC_TIME">LC_TIME</a></li>
<li><a href="#Other-categories">Other categories</a></li>
</ul>
</li>
<li><a href="#SECURITY">SECURITY</a></li>
<li>
<a href="#ENVIRONMENT">ENVIRONMENT</a><ul><li><a href="#Examples">Examples</a></li></ul>
</li>
<li>
<a href="#NOTES">NOTES</a><ul>
<li><a href="#String-eval-and-LC_NUMERIC">String eval and LC_NUMERIC</a></li>
<li><a href="#Backward-compatibility">Backward compatibility</a></li>
<li><a href="#I18N%3aCollate-obsolete">I18N:Collate obsolete</a></li>
<li><a href="#Sort-speed-and-memory-use-impacts">Sort speed and memory use impacts</a></li>
<li><a href="#Freely-available-locale-definitions">Freely available locale definitions</a></li>
<li><a href="#I18n-and-l10n">I18n and l10n</a></li>
<li><a href="#An-imperfect-standard">An imperfect standard</a></li>
</ul>
</li>
<li><a href="#Unicode-and-UTF-8">Unicode and UTF-8</a></li>
<li>
<a href="#BUGS">BUGS</a><ul><li><a href="#Broken-systems">Broken systems</a></li></ul>
</li>
<li><a href="#SEE-ALSO">SEE ALSO</a></li>
<li><a href="#HISTORY">HISTORY</a></li>
</ul>
<h2 id="NAME">NAME</h2> <p>perllocale - Perl locale handling (internationalization and localization)</p> <h2 id="DESCRIPTION">DESCRIPTION</h2> <p>In the beginning there was ASCII, the "American Standard Code for Information Interchange", which works quite well for Americans with their English alphabet and dollar-denominated currency. But it doesn't work so well even for other English speakers, who may use different currencies, such as the pound sterling (as the symbol for that currency is not in ASCII); and it's hopelessly inadequate for many of the thousands of the world's other languages.</p> <p>To address these deficiencies, the concept of locales was invented (formally the ISO C, XPG4, POSIX 1.c "locale system"). And applications were and are being written that use the locale mechanism. The process of making such an application take account of its users' preferences in these kinds of matters is called <b>internationalization</b> (often abbreviated as <b>i18n</b>); telling such an application about a particular set of preferences is known as <b>localization</b> (<b>l10n</b>).</p> <p>Perl has been extended to support the locale system. This is controlled per application by using one pragma, one function call, and several environment variables.</p> <p>Unfortunately, there are quite a few deficiencies with the design (and often, the implementations) of locales. Unicode was invented (see <a href="perlunitut">perlunitut</a> for an introduction to that) in part to address these design deficiencies, and nowadays, there is a series of "UTF-8 locales", based on Unicode. These are locales whose character set is Unicode, encoded in UTF-8. Starting in v5.20, Perl fully supports UTF-8 locales, except for sorting and string comparisons. (Use <a href="unicode/collate">Unicode::Collate</a> for these.) Perl continues to support the old non UTF-8 locales as well. There are currently no UTF-8 locales for EBCDIC platforms.</p> <p>(Unicode is also creating <code class="inline"><span class="w">CLDR</span></code> , the "Common Locale Data Repository", <a href="http://cldr.unicode.org/">http://cldr.unicode.org/</a> which includes more types of information than are available in the POSIX locale system. At the time of this writing, there was no CPAN module that provides access to this XML-encoded data. However, many of its locales have the POSIX-only data extracted, and are available as UTF-8 locales at <a href="http://unicode.org/Public/cldr/latest/">http://unicode.org/Public/cldr/latest/</a>.)</p> <h2 id="WHAT-IS-A-LOCALE">WHAT IS A LOCALE</h2> <p>A locale is a set of data that describes various aspects of how various communities in the world categorize their world. These categories are broken down into the following types (some of which include a brief note here):</p> <ul> <li id="Category-LC_NUMERIC%3a-Numeric-formatting">
<b>Category <code class="inline"><span class="w">LC_NUMERIC</span></code> : Numeric formatting</b> <p>This indicates how numbers should be formatted for human readability, for example the character used as the decimal point.</p> </li> <li id="Category-LC_MONETARY%3a-Formatting-of-monetary-amounts">
<b>Category <code class="inline"><span class="w">LC_MONETARY</span></code> : Formatting of monetary amounts</b>  </li> <li id="Category-LC_TIME%3a-Date%2fTime-formatting">
<b>Category <code class="inline"><span class="w">LC_TIME</span></code> : Date/Time formatting</b>  </li> <li id="Category-LC_MESSAGES%3a-Error-and-other-messages">
<b>Category <code class="inline"><span class="w">LC_MESSAGES</span></code> : Error and other messages</b> <p>This is used by Perl itself only for accessing operating system error messages via <a href="perlvar#%24ERRNO">$!</a> and <a href="perlvar#%24EXTENDED_OS_ERROR">$^E</a>.</p> </li> <li id="Category-LC_COLLATE%3a-Collation">
<b>Category <code class="inline"><span class="w">LC_COLLATE</span></code> : Collation</b> <p>This indicates the ordering of letters for comparison and sorting. In Latin alphabets, for example, "b", generally follows "a".</p> </li> <li id="Category-LC_CTYPE%3a-Character-Types">
<b>Category <code class="inline"><span class="w">LC_CTYPE</span></code> : Character Types</b> <p>This indicates, for example if a character is an uppercase letter.</p> </li> <li id="Other-categories">
<b>Other categories</b> <p>Some platforms have other categories, dealing with such things as measurement units and paper sizes. None of these are used directly by Perl, but outside operations that Perl interacts with may use these. See <a href="#Not-within-the-scope-of-%22use-locale%22">Not within the scope of use locale</a> below.</p> </li> </ul> <p>More details on the categories used by Perl are given below in <a href="#LOCALE-CATEGORIES">LOCALE CATEGORIES</a>.</p> <p>Together, these categories go a long way towards being able to customize a single program to run in many different locations. But there are deficiencies, so keep reading.</p> <h2 id="PREPARING-TO-USE-LOCALES">PREPARING TO USE LOCALES</h2> <p>Perl itself (outside the <a href="posix">POSIX</a> module) will not use locales unless specifically requested to (but again note that Perl may interact with code that does use them). Even if there is such a request, <b>all</b> of the following must be true for it to work properly:</p> <ul> <li> <p><b>Your operating system must support the locale system</b>. If it does, you should find that the <code class="inline"><span class="i">setlocale</span><span class="s">(</span><span class="s">)</span></code> function is a documented part of its C library.</p> </li> <li> <p><b>Definitions for locales that you use must be installed</b>. You, or your system administrator, must make sure that this is the case. The available locales, the location in which they are kept, and the manner in which they are installed all vary from system to system. Some systems provide only a few, hard-wired locales and do not allow more to be added. Others allow you to add "canned" locales provided by the system supplier. Still others allow you or the system administrator to define and add arbitrary locales. (You may have to ask your supplier to provide canned locales that are not delivered with your operating system.) Read your system documentation for further illumination.</p> </li> <li> <p><b>Perl must believe that the locale system is supported</b>. If it does, <code class="inline">perl -V:d_setlocale</code> will say that the value for <code class="inline"><span class="w">d_setlocale</span></code> is <code class="inline"><span class="w">define</span></code> .</p> </li> </ul> <p>If you want a Perl application to process and present your data according to a particular locale, the application code should include the <code class="inline"><a class="l_k" href="functions/use">use</a> <span class="w">locale</span></code> pragma (see <a href="#The-%22use-locale%22-pragma">The use locale pragma</a>) where appropriate, and <b>at least one</b> of the following must be true:</p> <dl> <dt>1</dt>
<dd> <p><b>The locale-determining environment variables (see <a href="#ENVIRONMENT">ENVIRONMENT</a>) must be correctly set up</b> at the time the application is started, either by yourself or by whomever set up your system account; or</p> </dd> <dt>2</dt>
<dd> <p><b>The application must set its own locale</b> using the method described in <a href="#The-setlocale-function">The setlocale function</a>.</p> </dd> </dl> <h2 id="USING-LOCALES">USING LOCALES</h2> <h3 id="The-%22use-locale%22-pragma">The <code class="inline"><span class="q">"use locale"</span></code> pragma</h3> <p>By default, Perl itself (outside the <a href="posix">POSIX</a> module) ignores the current locale. The <code class="inline"><a class="l_k" href="functions/use">use</a> <span class="w">locale</span></code> pragma tells Perl to use the current locale for some operations. Starting in v5.16, there are optional parameters to this pragma, described below, which restrict which operations are affected by it.</p> <p>The current locale is set at execution time by <a href="#The-setlocale-function">setlocale()</a> described below. If that function hasn't yet been called in the course of the program's execution, the current locale is that which was determined by the <a href="#ENVIRONMENT">ENVIRONMENT</a> in effect at the start of the program. If there is no valid environment, the current locale is whatever the system default has been set to. On POSIX systems, it is likely, but not necessarily, the "C" locale. On Windows, the default is set via the computer's <code class="inline"><span class="w">Control</span> <span class="w">Panel</span><span class="w">-&gt;Regional</span> <a class="l_k" href="functions/and">and</a> <span class="w">Language</span> <span class="w">Options</span></code> (or its current equivalent).</p> <p>The operations that are affected by locale are:</p> <ul> <li id="*Not-within-the-scope-of-%22use-locale%22*">
<b><b>Not within the scope of <code class="inline"><span class="q">"use locale"</span></code> </b></b> <p>Only certain operations originating outside Perl should be affected, as follows:</p> <ul> <li> <p>The current locale is used when going outside of Perl with operations like <a href="functions/system">system LIST</a> or <a href="perlop#qx%2fSTRING%2f">qx//</a>, if those operations are locale-sensitive.</p> </li> <li> <p>Also Perl gives access to various C library functions through the <a href="posix">POSIX</a> module. Some of those functions are always affected by the current locale. For example, <code class="inline"><span class="i">POSIX::strftime</span><span class="s">(</span><span class="s">)</span></code> uses <code class="inline"><span class="w">LC_TIME</span></code> ; <code class="inline"><span class="i">POSIX::strtod</span><span class="s">(</span><span class="s">)</span></code> uses <code class="inline"><span class="w">LC_NUMERIC</span></code> ; <code class="inline"><span class="i">POSIX::strcoll</span><span class="s">(</span><span class="s">)</span></code> and <code class="inline"><span class="i">POSIX::strxfrm</span><span class="s">(</span><span class="s">)</span></code> use <code class="inline"><span class="w">LC_COLLATE</span></code> ; and character classification functions like <code class="inline"><span class="i">POSIX::isalnum</span><span class="s">(</span><span class="s">)</span></code> use <code class="inline"><span class="w">LC_CTYPE</span></code> . All such functions will behave according to the current underlying locale, even if that locale isn't exposed to Perl space.</p> </li> <li> <p>XS modules for all categories but <code class="inline"><span class="w">LC_NUMERIC</span></code> get the underlying locale, and hence any C library functions they call will use that underlying locale. For more discussion, see <a href="perlxs#CAVEATS">CAVEATS in perlxs</a>.</p> </li> </ul> <p>Note that all C programs (including the perl interpreter, which is written in C) always have an underlying locale. That locale is the "C" locale unless changed by a call to <a href="#The-setlocale-function">setlocale()</a>. When Perl starts up, it changes the underlying locale to the one which is indicated by the <a href="#ENVIRONMENT">ENVIRONMENT</a>. When using the <a href="posix">POSIX</a> module or writing XS code, it is important to keep in mind that the underlying locale may be something other than "C", even if the program hasn't explicitly changed it.</p>  </li> <li id="*Lingering-effects-of-use-locale*">
<b><b>Lingering effects of <code class="inline"><a class="l_k" href="functions/use">use</a> <span class="w">locale</span></code> </b></b> <p>Certain Perl operations that are set-up within the scope of a <code class="inline"><a class="l_k" href="functions/use">use</a> <span class="w">locale</span></code> retain that effect even outside the scope. These include:</p> <ul> <li> <p>The output format of a <a href="functions/write">write</a> is determined by an earlier format declaration (<a href="functions/format">format</a>), so whether or not the output is affected by locale is determined by if the <code class="inline"><a class="l_k" href="functions/format">format()</a></code> is within the scope of a <code class="inline"><a class="l_k" href="functions/use">use</a> <span class="w">locale</span></code> , not whether the <code class="inline"><a class="l_k" href="functions/write">write()</a></code> is.</p> </li> <li> <p>Regular expression patterns can be compiled using <a href="perlop#qr%2fSTRING%2fmsixpodualn">qr//</a> with actual matching deferred to later. Again, it is whether or not the compilation was done within the scope of <code class="inline"><a class="l_k" href="functions/use">use</a> <span class="w">locale</span></code> that determines the match behavior, not if the matches are done within such a scope or not.</p> </li> </ul>  </li> <li id="*Under-%22use-locale%22%3b*">
<b><b>Under <code class="inline"><span class="q">"use locale"</span><span class="sc">;</span></code> </b></b> <ul> <li> <p>All the above operations</p> </li> <li> <p><b>Format declarations</b> (<a href="functions/format">format</a>) and hence any subsequent <code class="inline"><a class="l_k" href="functions/write">write()</a></code>s use <code class="inline"><span class="w">LC_NUMERIC</span></code> .</p> </li> <li> <p><b>stringification and output</b> use <code class="inline"><span class="w">LC_NUMERIC</span></code> . These include the results of <code class="inline"><a class="l_k" href="functions/print">print()</a></code>, <code class="inline"><a class="l_k" href="functions/printf">printf()</a></code>, <code class="inline"><a class="l_k" href="functions/say">say()</a></code>, and <code class="inline"><a class="l_k" href="functions/sprintf">sprintf()</a></code>.</p> </li> <li> <p><b>The comparison operators</b> (<code class="inline">lt</code> , <code class="inline">le</code> , <code class="inline">cmp</code> , <code class="inline">ge</code> , and <code class="inline">gt</code> ) use <code class="inline"><span class="w">LC_COLLATE</span></code> . <code class="inline"><a class="l_k" href="functions/sort">sort()</a></code> is also affected if used without an explicit comparison function, because it uses <code class="inline">cmp</code> by default.</p> <p><b>Note:</b> <code class="inline">eq</code> and <code class="inline">ne</code> are unaffected by locale: they always perform a char-by-char comparison of their scalar operands. What's more, if <code class="inline">cmp</code> finds that its operands are equal according to the collation sequence specified by the current locale, it goes on to perform a char-by-char comparison, and only returns <i>0</i> (equal) if the operands are char-for-char identical. If you really want to know whether two strings--which <code class="inline">eq</code> and <code class="inline">cmp</code> may consider different--are equal as far as collation in the locale is concerned, see the discussion in <a href="#Category-LC_COLLATE-%3a-Collation">Category LC_COLLATE : Collation</a>.</p> </li> <li> <p><b>Regular expressions and case-modification functions</b> (<code class="inline"><a class="l_k" href="functions/uc">uc()</a></code>, <code class="inline"><a class="l_k" href="functions/lc">lc()</a></code>, <code class="inline"><a class="l_k" href="functions/ucfirst">ucfirst()</a></code>, and <code class="inline"><a class="l_k" href="functions/lcfirst">lcfirst()</a></code>) use <code class="inline"><span class="w">LC_CTYPE</span></code> </p> </li> <li> <p><b>The variables <a href="perlvar#%24ERRNO">$!</a></b> (and its synonyms <code class="inline"><span class="i">$ERRNO</span></code> and <code class="inline"><span class="i">$OS_ERROR</span></code> ) <b>and <a href="perlvar#%24EXTENDED_OS_ERROR">$^E</a></b> (and its synonym <code class="inline"><span class="i">$EXTENDED_OS_ERROR</span></code> ) when used as strings use <code class="inline"><span class="w">LC_MESSAGES</span></code> .</p> </li> </ul> </li> </ul> <p>The default behavior is restored with the <code class="inline"><a class="l_k" href="functions/no">no</a> <span class="w">locale</span></code> pragma, or upon reaching the end of the block enclosing <code class="inline"><a class="l_k" href="functions/use">use</a> <span class="w">locale</span></code> . Note that <code class="inline"><a class="l_k" href="functions/use">use</a> <span class="w">locale</span></code> calls may be nested, and that what is in effect within an inner scope will revert to the outer scope's rules at the end of the inner scope.</p> <p>The string result of any operation that uses locale information is tainted, as it is possible for a locale to be untrustworthy. See <a href="#SECURITY">SECURITY</a>.</p> <p>Starting in Perl v5.16 in a very limited way, and more generally in v5.22, you can restrict which category or categories are enabled by this particular instance of the pragma by adding parameters to it. For example,</p> <pre class="verbatim" data-language="perl">use locale qw(:ctype :numeric);
</pre>
<p>enables locale awareness within its scope of only those operations (listed above) that are affected by <code class="inline"><span class="w">LC_CTYPE</span></code> and <code class="inline"><span class="w">LC_NUMERIC</span></code> .</p> <p>The possible categories are: <code class="inline"><span class="j">:</span><span class="w">collate</span></code> , <code class="inline"><span class="j">:</span><span class="w">ctype</span></code> , <code class="inline"><span class="j">:</span><span class="w">messages</span></code> , <code class="inline"><span class="j">:</span><span class="w">monetary</span></code> , <code class="inline"><span class="j">:</span><span class="w">numeric</span></code> , <code class="inline"><span class="j">:</span><a class="l_k" href="functions/time">time</a></code> , and the pseudo category <code class="inline"><span class="j">:</span><span class="w">characters</span></code> (described below).</p> <p>Thus you can say</p> <pre class="verbatim" data-language="perl">use locale ':messages';
</pre>
<p>and only <a href="perlvar#%24ERRNO">$!</a> and <a href="perlvar#%24EXTENDED_OS_ERROR">$^E</a> will be locale aware. Everything else is unaffected.</p> <p>Since Perl doesn't currently do anything with the <code class="inline"><span class="w">LC_MONETARY</span></code> category, specifying <code class="inline"><span class="j">:</span><span class="w">monetary</span></code> does effectively nothing. Some systems have other categories, such as <code class="inline"><span class="w">LC_PAPER_SIZE</span></code> , but Perl also doesn't know anything about them, and there is no way to specify them in this pragma's arguments.</p> <p>You can also easily say to use all categories but one, by either, for example,</p> <pre class="verbatim" data-language="perl">use locale ':!ctype';
use locale ':not_ctype';
</pre>
<p>both of which mean to enable locale awarness of all categories but <code class="inline"><span class="w">LC_CTYPE</span></code> . Only one category argument may be specified in a <code class="inline"><a class="l_k" href="functions/use">use</a> <span class="w">locale</span></code> if it is of the negated form.</p> <p>Prior to v5.22 only one form of the pragma with arguments is available:</p> <pre class="verbatim" data-language="perl">use locale ':not_characters';
</pre>
<p>(and you have to say <code class="inline"><span class="w">not_</span></code> ; you can't use the bang <code class="inline">!</code> form). This pseudo category is a shorthand for specifying both <code class="inline"><span class="j">:</span><span class="w">collate</span></code> and <code class="inline"><span class="j">:</span><span class="w">ctype</span></code> . Hence, in the negated form, it is nearly the same thing as saying</p> <pre class="verbatim" data-language="perl">use locale qw(:messages :monetary :numeric :time);
</pre>
<p>We use the term "nearly", because <code class="inline"><span class="j">:</span><span class="w">not_characters</span></code> also turns on <code class="inline"><a class="l_k" href="functions/use">use</a> <span class="w">feature</span> <span class="q">'unicode_strings'</span></code> within its scope. This form is less useful in v5.20 and later, and is described fully in <a href="#Unicode-and-UTF-8">Unicode and UTF-8</a>, but briefly, it tells Perl to not use the character portions of the locale definition, that is the <code class="inline"><span class="w">LC_CTYPE</span></code> and <code class="inline"><span class="w">LC_COLLATE</span></code> categories. Instead it will use the native character set (extended by Unicode). When using this parameter, you are responsible for getting the external character set translated into the native/Unicode one (which it already will be if it is one of the increasingly popular UTF-8 locales). There are convenient ways of doing this, as described in <a href="#Unicode-and-UTF-8">Unicode and UTF-8</a>.</p> <h3 id="The-setlocale-function">The setlocale function</h3> <p>You can switch locales as often as you wish at run time with the <code class="inline"><span class="i">POSIX::setlocale</span><span class="s">(</span><span class="s">)</span></code> function:</p> <pre class="verbatim" data-language="perl"># Import locale-handling tool set from POSIX module.
# This example uses: setlocale -- the function call
#                    LC_CTYPE -- explained below
# (Showing the testing for success/failure of operations is
# omitted in these examples to avoid distracting from the main
# point)

use POSIX qw(locale_h);
use locale;
my $old_locale;

# query and save the old locale
$old_locale = setlocale(LC_CTYPE);

setlocale(LC_CTYPE, "fr_CA.ISO8859-1");
# LC_CTYPE now in locale "French, Canada, codeset ISO 8859-1"

setlocale(LC_CTYPE, "");
# LC_CTYPE now reset to the default defined by the
# LC_ALL/LC_CTYPE/LANG environment variables, or to the system
# default.  See below for documentation.

# restore the old locale
setlocale(LC_CTYPE, $old_locale);
</pre>
<p>This simultaneously affects all threads of the program, so it may be problematic to use locales in threaded applications except where there is a single locale applicable to all threads.</p> <p>The first argument of <code class="inline"><span class="i">setlocale</span><span class="s">(</span><span class="s">)</span></code> gives the <b>category</b>, the second the <b>locale</b>. The category tells in what aspect of data processing you want to apply locale-specific rules. Category names are discussed in <a href="#LOCALE-CATEGORIES">LOCALE CATEGORIES</a> and <a href="#ENVIRONMENT">ENVIRONMENT</a>. The locale is the name of a collection of customization information corresponding to a particular combination of language, country or territory, and codeset. Read on for hints on the naming of locales: not all systems name locales as in the example.</p> <p>If no second argument is provided and the category is something other than <code class="inline"><span class="w">LC_ALL</span></code> , the function returns a string naming the current locale for the category. You can use this value as the second argument in a subsequent call to <code class="inline"><span class="i">setlocale</span><span class="s">(</span><span class="s">)</span></code> , <b>but</b> on some platforms the string is opaque, not something that most people would be able to decipher as to what locale it means.</p> <p>If no second argument is provided and the category is <code class="inline"><span class="w">LC_ALL</span></code> , the result is implementation-dependent. It may be a string of concatenated locale names (separator also implementation-dependent) or a single locale name. Please consult your <i>setlocale(3)</i> man page for details.</p> <p>If a second argument is given and it corresponds to a valid locale, the locale for the category is set to that value, and the function returns the now-current locale value. You can then use this in yet another call to <code class="inline"><span class="i">setlocale</span><span class="s">(</span><span class="s">)</span></code> . (In some implementations, the return value may sometimes differ from the value you gave as the second argument--think of it as an alias for the value you gave.)</p> <p>As the example shows, if the second argument is an empty string, the category's locale is returned to the default specified by the corresponding environment variables. Generally, this results in a return to the default that was in force when Perl started up: changes to the environment made by the application after startup may or may not be noticed, depending on your system's C library.</p> <p>Note that when a form of <code class="inline"><a class="l_k" href="functions/use">use</a> <span class="w">locale</span></code> that doesn't include all categories is specified, Perl ignores the excluded categories.</p> <p>If <code class="inline"><span class="i">set_locale</span><span class="s">(</span><span class="s">)</span></code> fails for some reason (for example, an attempt to set to a locale unknown to the system), the locale for the category is not changed, and the function returns <code class="inline"><a class="l_k" href="functions/undef">undef</a></code>.</p> <p>For further information about the categories, consult <i>setlocale(3)</i>.</p> <h3 id="Finding-locales">Finding locales</h3> <p>For locales available in your system, consult also <i>setlocale(3)</i> to see whether it leads to the list of available locales (search for the <i>SEE ALSO</i> section). If that fails, try the following command lines:</p> <pre class="verbatim" data-language="perl">        locale -a

        nlsinfo

        ls /usr/lib/nls/loc

        ls /usr/lib/locale

        ls /usr/lib/nls

ls /usr/share/locale
</pre>
<p>and see whether they list something resembling these</p> <pre class="verbatim" data-language="perl">en_US.ISO8859-1     de_DE.ISO8859-1     ru_RU.ISO8859-5
en_US.iso88591      de_DE.iso88591      ru_RU.iso88595
en_US               de_DE               ru_RU
en                  de                  ru
english             german              russian
english.iso88591    german.iso88591     russian.iso88595
english.roman8                          russian.koi8r
</pre>
<p>Sadly, even though the calling interface for <code class="inline"><span class="i">setlocale</span><span class="s">(</span><span class="s">)</span></code> has been standardized, names of locales and the directories where the configuration resides have not been. The basic form of the name is <i>language_territory</i><b>.</b><i>codeset</i>, but the latter parts after <i>language</i> are not always present. The <i>language</i> and <i>country</i> are usually from the standards <b>ISO 3166</b> and <b>ISO 639</b>, the two-letter abbreviations for the countries and the languages of the world, respectively. The <i>codeset</i> part often mentions some <b>ISO 8859</b> character set, the Latin codesets. For example, <code class="inline"><span class="w">ISO</span> <span class="n">8859</span>-<span class="n">1</span></code> is the so-called "Western European codeset" that can be used to encode most Western European languages adequately. Again, there are several ways to write even the name of that one standard. Lamentably.</p> <p>Two special locales are worth particular mention: "C" and "POSIX". Currently these are effectively the same locale: the difference is mainly that the first one is defined by the C standard, the second by the POSIX standard. They define the <b>default locale</b> in which every program starts in the absence of locale information in its environment. (The <i>default</i> default locale, if you will.) Its language is (American) English and its character codeset ASCII or, rarely, a superset thereof (such as the "DEC Multinational Character Set (DEC-MCS)"). <b>Warning</b>. The C locale delivered by some vendors may not actually exactly match what the C standard calls for. So beware.</p> <p><b>NOTE</b>: Not all systems have the "POSIX" locale (not all systems are POSIX-conformant), so use "C" when you need explicitly to specify this default locale.</p> <h3 id="LOCALE-PROBLEMS">LOCALE PROBLEMS</h3> <p>You may encounter the following warning message at Perl startup:</p> <pre class="verbatim" data-language="perl">perl: warning: Setting locale failed.
perl: warning: Please check that your locale settings:
        LC_ALL = "En_US",
        LANG = (unset)
    are supported and installed on your system.
perl: warning: Falling back to the standard locale ("C").
</pre>
<p>This means that your locale settings had <code class="inline"><span class="w">LC_ALL</span></code> set to "En_US" and LANG exists but has no value. Perl tried to believe you but could not. Instead, Perl gave up and fell back to the "C" locale, the default locale that is supposed to work no matter what. (On Windows, it first tries falling back to the system default locale.) This usually means your locale settings were wrong, they mention locales your system has never heard of, or the locale installation in your system has problems (for example, some system files are broken or missing). There are quick and temporary fixes to these problems, as well as more thorough and lasting fixes.</p> <h3 id="Testing-for-broken-locales">Testing for broken locales</h3> <p>If you are building Perl from source, the Perl test suite file <i>lib/locale.t</i> can be used to test the locales on your system. Setting the environment variable <code class="inline"><span class="w">PERL_DEBUG_FULL_TEST</span></code> to 1 will cause it to output detailed results. For example, on Linux, you could say</p> <pre class="verbatim" data-language="perl">PERL_DEBUG_FULL_TEST=1 ./perl -T -Ilib lib/locale.t &gt; locale.log 2&gt;&amp;1
</pre>
<p>Besides many other tests, it will test every locale it finds on your system to see if they conform to the POSIX standard. If any have errors, it will include a summary near the end of the output of which locales passed all its tests, and which failed, and why.</p> <h3 id="Temporarily-fixing-locale-problems">Temporarily fixing locale problems</h3> <p>The two quickest fixes are either to render Perl silent about any locale inconsistencies or to run Perl under the default locale "C".</p> <p>Perl's moaning about locale problems can be silenced by setting the environment variable <code class="inline"><span class="w">PERL_BADLANG</span></code> to "0" or "". This method really just sweeps the problem under the carpet: you tell Perl to shut up even when Perl sees that something is wrong. Do not be surprised if later something locale-dependent misbehaves.</p> <p>Perl can be run under the "C" locale by setting the environment variable <code class="inline"><span class="w">LC_ALL</span></code> to "C". This method is perhaps a bit more civilized than the <code class="inline"><span class="w">PERL_BADLANG</span></code> approach, but setting <code class="inline"><span class="w">LC_ALL</span></code> (or other locale variables) may affect other programs as well, not just Perl. In particular, external programs run from within Perl will see these changes. If you make the new settings permanent (read on), all programs you run see the changes. See <a href="#ENVIRONMENT">ENVIRONMENT</a> for the full list of relevant environment variables and <a href="#USING-LOCALES">USING LOCALES</a> for their effects in Perl. Effects in other programs are easily deducible. For example, the variable <code class="inline"><span class="w">LC_COLLATE</span></code> may well affect your <b>sort</b> program (or whatever the program that arranges "records" alphabetically in your system is called).</p> <p>You can test out changing these variables temporarily, and if the new settings seem to help, put those settings into your shell startup files. Consult your local documentation for the exact details. For Bourne-like shells (<b>sh</b>, <b>ksh</b>, <b>bash</b>, <b>zsh</b>):</p> <pre class="verbatim" data-language="perl">LC_ALL=en_US.ISO8859-1
export LC_ALL
</pre>
<p>This assumes that we saw the locale "en_US.ISO8859-1" using the commands discussed above. We decided to try that instead of the above faulty locale "En_US"--and in Cshish shells (<b>csh</b>, <b>tcsh</b>)</p> <pre class="verbatim" data-language="perl">setenv LC_ALL en_US.ISO8859-1
</pre>
<p>or if you have the "env" application you can do (in any shell)</p> <pre class="verbatim" data-language="perl">env LC_ALL=en_US.ISO8859-1 perl ...
</pre>
<p>If you do not know what shell you have, consult your local helpdesk or the equivalent.</p> <h3 id="Permanently-fixing-locale-problems">Permanently fixing locale problems</h3> <p>The slower but superior fixes are when you may be able to yourself fix the misconfiguration of your own environment variables. The mis(sing)configuration of the whole system's locales usually requires the help of your friendly system administrator.</p> <p>First, see earlier in this document about <a href="#Finding-locales">Finding locales</a>. That tells how to find which locales are really supported--and more importantly, installed--on your system. In our example error message, environment variables affecting the locale are listed in the order of decreasing importance (and unset variables do not matter). Therefore, having LC_ALL set to "En_US" must have been the bad choice, as shown by the error message. First try fixing locale settings listed first.</p> <p>Second, if using the listed commands you see something <b>exactly</b> (prefix matches do not count and case usually counts) like "En_US" without the quotes, then you should be okay because you are using a locale name that should be installed and available in your system. In this case, see <a href="#Permanently-fixing-your-system's-locale-configuration">Permanently fixing your system's locale configuration</a>.</p> <h3 id="Permanently-fixing-your-system's-locale-configuration">Permanently fixing your system's locale configuration</h3> <p>This is when you see something like:</p> <pre class="verbatim" data-language="perl">perl: warning: Please check that your locale settings:
        LC_ALL = "En_US",
        LANG = (unset)
    are supported and installed on your system.
</pre>
<p>but then cannot see that "En_US" listed by the above-mentioned commands. You may see things like "en_US.ISO8859-1", but that isn't the same. In this case, try running under a locale that you can list and which somehow matches what you tried. The rules for matching locale names are a bit vague because standardization is weak in this area. See again the <a href="#Finding-locales">Finding locales</a> about general rules.</p> <h3 id="Fixing-system-locale-configuration">Fixing system locale configuration</h3> <p>Contact a system administrator (preferably your own) and report the exact error message you get, and ask them to read this same documentation you are now reading. They should be able to check whether there is something wrong with the locale configuration of the system. The <a href="#Finding-locales">Finding locales</a> section is unfortunately a bit vague about the exact commands and places because these things are not that standardized.</p> <h3 id="The-localeconv-function">The localeconv function</h3> <p>The <code class="inline"><span class="i">POSIX::localeconv</span><span class="s">(</span><span class="s">)</span></code> function allows you to get particulars of the locale-dependent numeric formatting information specified by the current underlying <code class="inline"><span class="w">LC_NUMERIC</span></code> and <code class="inline"><span class="w">LC_MONETARY</span></code> locales (regardless of whether called from within the scope of <code class="inline"><a class="l_k" href="functions/use">use</a> <span class="w">locale</span></code> or not). (If you just want the name of the current locale for a particular category, use <code class="inline"><span class="i">POSIX::setlocale</span><span class="s">(</span><span class="s">)</span></code> with a single parameter--see <a href="#The-setlocale-function">The setlocale function</a>.)</p> <pre class="verbatim" data-language="perl">use POSIX qw(locale_h);

# Get a reference to a hash of locale-dependent info
$locale_values = localeconv();

# Output sorted list of the values
for (sort keys %$locale_values) {
    printf "%-20s = %s\n", $_, $locale_values-&gt;{$_}
}
</pre>
<p><code class="inline"><span class="i">localeconv</span><span class="s">(</span><span class="s">)</span></code> takes no arguments, and returns <b>a reference to</b> a hash. The keys of this hash are variable names for formatting, such as <code class="inline"><span class="w">decimal_point</span></code> and <code class="inline"><span class="w">thousands_sep</span></code> . The values are the corresponding, er, values. See <a href="posix#localeconv">localeconv in POSIX</a> for a longer example listing the categories an implementation might be expected to provide; some provide more and others fewer. You don't need an explicit <code class="inline"><a class="l_k" href="functions/use">use</a> <span class="w">locale</span></code> , because <code class="inline"><span class="i">localeconv</span><span class="s">(</span><span class="s">)</span></code> always observes the current locale.</p> <p>Here's a simple-minded example program that rewrites its command-line parameters as integers correctly formatted in the current locale:</p> <pre class="verbatim" data-language="perl">use POSIX qw(locale_h);

# Get some of locale's numeric formatting parameters
my ($thousands_sep, $grouping) =
        @{localeconv()}{'thousands_sep', 'grouping'};

# Apply defaults if values are missing
$thousands_sep = ',' unless $thousands_sep;

# grouping and mon_grouping are packed lists
# of small integers (characters) telling the
# grouping (thousand_seps and mon_thousand_seps
# being the group dividers) of numbers and
# monetary quantities.  The integers' meanings:
# 255 means no more grouping, 0 means repeat
# the previous grouping, 1-254 means use that
# as the current grouping.  Grouping goes from
# right to left (low to high digits).  In the
# below we cheat slightly by never using anything
# else than the first grouping (whatever that is).
if ($grouping) {
    @grouping = unpack("C*", $grouping);
} else {
    @grouping = (3);
}

# Format command line params for current locale
for (@ARGV) {
    $_ = int;    # Chop non-integer part
    1 while
    s/(\d)(\d{$grouping[0]}($|$thousands_sep))/$1$thousands_sep$2/;
    print "$_";
}
print "\n";
</pre>
<p>Note that if the platform doesn't have <code class="inline"><span class="w">LC_NUMERIC</span></code> and/or <code class="inline"><span class="w">LC_MONETARY</span></code> available or enabled, the corresponding elements of the hash will be missing.</p> <h3 id="I18N%3a%3aLanginfo">I18N::Langinfo</h3> <p>Another interface for querying locale-dependent information is the <code class="inline"><span class="i">I18N::Langinfo::langinfo</span><span class="s">(</span><span class="s">)</span></code> function, available at least in Unix-like systems and VMS.</p> <p>The following example will import the <code class="inline"><span class="i">langinfo</span><span class="s">(</span><span class="s">)</span></code> function itself and three constants to be used as arguments to <code class="inline"><span class="i">langinfo</span><span class="s">(</span><span class="s">)</span></code> : a constant for the abbreviated first day of the week (the numbering starts from Sunday = 1) and two more constants for the affirmative and negative answers for a yes/no question in the current locale.</p> <pre class="verbatim" data-language="perl">use I18N::Langinfo qw(langinfo ABDAY_1 YESSTR NOSTR);

my ($abday_1, $yesstr, $nostr)
            = map { langinfo } qw(ABDAY_1 YESSTR NOSTR);

print "$abday_1? [$yesstr/$nostr] ";
</pre>
<p>In other words, in the "C" (or English) locale the above will probably print something like:</p> <pre class="verbatim" data-language="perl">Sun? [yes/no]
</pre>
<p>See <a href="i18n/langinfo">I18N::Langinfo</a> for more information.</p> <h2 id="LOCALE-CATEGORIES">LOCALE CATEGORIES</h2> <p>The following subsections describe basic locale categories. Beyond these, some combination categories allow manipulation of more than one basic category at a time. See <a href="#ENVIRONMENT">ENVIRONMENT</a> for a discussion of these.</p> <h3 id="Category-LC_COLLATE%3a-Collation">Category <code class="inline"><span class="w">LC_COLLATE</span></code> : Collation</h3> <p>In the scope of a <code class="inline"><a class="l_k" href="functions/use">use</a> <span class="w">locale</span></code> form that includes collation, Perl looks to the <code class="inline"><span class="w">LC_COLLATE</span></code> environment variable to determine the application's notions on collation (ordering) of characters. For example, "b" follows "a" in Latin alphabets, but where do "รก" and "รฅ" belong? And while "color" follows "chocolate" in English, what about in traditional Spanish?</p> <p>The following collations all make sense and you may meet any of them if you <code class="inline"><span class="q">"use locale"</span></code> .</p> <pre class="verbatim" data-language="perl">A B C D E a b c d e
A a B b C c D d E e
a A b B c C d D e E
a b c d e A B C D E
</pre>
<p>Here is a code snippet to tell what "word" characters are in the current locale, in that locale's order:</p> <pre class="verbatim" data-language="perl">use locale;
print +(sort grep /\w/, map { chr } 0..255), "\n";
</pre>
<p>Compare this with the characters that you see and their order if you state explicitly that the locale should be ignored:</p> <pre class="verbatim" data-language="perl">no locale;
print +(sort grep /\w/, map { chr } 0..255), "\n";
</pre>
<p>This machine-native collation (which is what you get unless <code class="inline"><a class="l_k" href="functions/use">use</a>
<span class="w">locale</span></code> has appeared earlier in the same block) must be used for sorting raw binary data, whereas the locale-dependent collation of the first example is useful for natural text.</p> <p>As noted in <a href="#USING-LOCALES">USING LOCALES</a>, <code class="inline">cmp</code> compares according to the current collation locale when <code class="inline"><a class="l_k" href="functions/use">use</a> <span class="w">locale</span></code> is in effect, but falls back to a char-by-char comparison for strings that the locale says are equal. You can use <code class="inline"><span class="i">POSIX::strcoll</span><span class="s">(</span><span class="s">)</span></code> if you don't want this fall-back:</p> <pre class="verbatim" data-language="perl">use POSIX qw(strcoll);
$equal_in_locale =
    !strcoll("space and case ignored", "SpaceAndCaseIgnored");
</pre>
<p><code class="inline"><span class="i">$equal_in_locale</span></code> will be true if the collation locale specifies a dictionary-like ordering that ignores space characters completely and which folds case.</p> <p>Perl currently only supports single-byte locales for <code class="inline"><span class="w">LC_COLLATE</span></code> . This means that a UTF-8 locale likely will just give you machine-native ordering. Use <a href="unicode/collate">Unicode::Collate</a> for the full implementation of the Unicode Collation Algorithm.</p> <p>If you have a single string that you want to check for "equality in locale" against several others, you might think you could gain a little efficiency by using <code class="inline"><span class="i">POSIX::strxfrm</span><span class="s">(</span><span class="s">)</span></code> in conjunction with <code class="inline">eq</code> :</p> <pre class="verbatim" data-language="perl">use POSIX qw(strxfrm);
$xfrm_string = strxfrm("Mixed-case string");
print "locale collation ignores spaces\n"
    if $xfrm_string eq strxfrm("Mixed-casestring");
print "locale collation ignores hyphens\n"
    if $xfrm_string eq strxfrm("Mixedcase string");
print "locale collation ignores case\n"
    if $xfrm_string eq strxfrm("mixed-case string");
</pre>
<p><code class="inline"><span class="i">strxfrm</span><span class="s">(</span><span class="s">)</span></code> takes a string and maps it into a transformed string for use in char-by-char comparisons against other transformed strings during collation. "Under the hood", locale-affected Perl comparison operators call <code class="inline"><span class="i">strxfrm</span><span class="s">(</span><span class="s">)</span></code> for both operands, then do a char-by-char comparison of the transformed strings. By calling <code class="inline"><span class="i">strxfrm</span><span class="s">(</span><span class="s">)</span></code> explicitly and using a non locale-affected comparison, the example attempts to save a couple of transformations. But in fact, it doesn't save anything: Perl magic (see <a href="perlguts#Magic-Variables">Magic Variables in perlguts</a>) creates the transformed version of a string the first time it's needed in a comparison, then keeps this version around in case it's needed again. An example rewritten the easy way with <code class="inline">cmp</code> runs just about as fast. It also copes with null characters embedded in strings; if you call <code class="inline"><span class="i">strxfrm</span><span class="s">(</span><span class="s">)</span></code> directly, it treats the first null it finds as a terminator. don't expect the transformed strings it produces to be portable across systems--or even from one revision of your operating system to the next. In short, don't call <code class="inline"><span class="i">strxfrm</span><span class="s">(</span><span class="s">)</span></code> directly: let Perl do it for you.</p> <p>Note: <code class="inline"><a class="l_k" href="functions/use">use</a> <span class="w">locale</span></code> isn't shown in some of these examples because it isn't needed: <code class="inline"><span class="i">strcoll</span><span class="s">(</span><span class="s">)</span></code> and <code class="inline"><span class="i">strxfrm</span><span class="s">(</span><span class="s">)</span></code> are POSIX functions which use the standard system-supplied <code class="inline"><span class="w">libc</span></code> functions that always obey the current <code class="inline"><span class="w">LC_COLLATE</span></code> locale.</p> <h3 id="Category-LC_CTYPE%3a-Character-Types">Category <code class="inline"><span class="w">LC_CTYPE</span></code> : Character Types</h3> <p>In the scope of a <code class="inline"><a class="l_k" href="functions/use">use</a> <span class="w">locale</span></code> form that includes <code class="inline"><span class="w">LC_CTYPE</span></code> , Perl obeys the <code class="inline"><span class="w">LC_CTYPE</span></code> locale setting. This controls the application's notion of which characters are alphabetic, numeric, punctuation, <i>etc</i>. This affects Perl's <code class="inline">\<span class="w">w</span></code> regular expression metanotation, which stands for alphanumeric characters--that is, alphabetic, numeric, and the platform's native underscore. (Consult <a href="perlre">perlre</a> for more information about regular expressions.) Thanks to <code class="inline"><span class="w">LC_CTYPE</span></code> , depending on your locale setting, characters like "รฆ", "รฐ", "ร", and "รธ" may be understood as <code class="inline">\<span class="w">w</span></code> characters. It also affects things like <code class="inline">\s</code>, <code class="inline">\<span class="w">D</span></code> , and the POSIX character classes, like <code class="inline"><span class="s">[</span><span class="s">[</span><span class="co">:</span><span class="w">graph</span><span class="co">:</span><span class="s">]</span><span class="s">]</span></code> . (See <a href="perlrecharclass">perlrecharclass</a> for more information on all these.)</p> <p>The <code class="inline"><span class="w">LC_CTYPE</span></code> locale also provides the map used in transliterating characters between lower and uppercase. This affects the case-mapping functions--<code class="inline"><a class="l_k" href="functions/fc">fc()</a></code>, <code class="inline"><a class="l_k" href="functions/lc">lc()</a></code>, <code class="inline"><a class="l_k" href="functions/lcfirst">lcfirst()</a></code>, <code class="inline"><a class="l_k" href="functions/uc">uc()</a></code>, and <code class="inline"><a class="l_k" href="functions/ucfirst">ucfirst()</a></code>; case-mapping interpolation with <code class="inline">\<span class="w">F</span></code> , <code class="inline">\<span class="w">l</span></code> , <code class="inline">\<span class="w">L</span></code> , <code class="inline">\<span class="w">u</span></code> , or <code class="inline">\<span class="w">U</span></code> in double-quoted strings and <code class="inline"><a class="l_k" href="functions/s">s///</a></code> substitutions; and case-independent regular expression pattern matching using the <code class="inline"><span class="w">i</span></code> modifier.</p> <p>Finally, <code class="inline"><span class="w">LC_CTYPE</span></code> affects the (deprecated) POSIX character-class test functions--<code class="inline"><span class="i">POSIX::isalpha</span><span class="s">(</span><span class="s">)</span></code> , <code class="inline"><span class="i">POSIX::islower</span><span class="s">(</span><span class="s">)</span></code> , and so on. For example, if you move from the "C" locale to a 7-bit ISO 646 one, you may find--possibly to your surprise--that <code class="inline"><span class="q">"|"</span></code> moves from the <code class="inline"><span class="i">POSIX::ispunct</span><span class="s">(</span><span class="s">)</span></code> class to <code class="inline"><span class="i">POSIX::isalpha</span><span class="s">(</span><span class="s">)</span></code> . Unfortunately, this creates big problems for regular expressions. "|" still means alternation even though it matches <code class="inline">\<span class="w">w</span></code> . Starting in v5.22, a warning will be raised when such a locale is switched into. More details are given several paragraphs further down.</p> <p>Starting in v5.20, Perl supports UTF-8 locales for <code class="inline"><span class="w">LC_CTYPE</span></code> , but otherwise Perl only supports single-byte locales, such as the ISO 8859 series. This means that wide character locales, for example for Asian languages, are not well-supported. (If the platform has the capability for Perl to detect such a locale, starting in Perl v5.22, <a href="warnings#Category-Hierarchy">Perl will warn, default enabled</a>, using the <code class="inline"><span class="w">locale</span></code> warning category, whenever such a locale is switched into.) The UTF-8 locale support is actually a superset of POSIX locales, because it is really full Unicode behavior as if no <code class="inline"><span class="w">LC_CTYPE</span></code> locale were in effect at all (except for tainting; see <a href="#SECURITY">SECURITY</a>). POSIX locales, even UTF-8 ones, are lacking certain concepts in Unicode, such as the idea that changing the case of a character could expand to be more than one character. Perl in a UTF-8 locale, will give you that expansion. Prior to v5.20, Perl treated a UTF-8 locale on some platforms like an ISO 8859-1 one, with some restrictions, and on other platforms more like the "C" locale. For releases v5.16 and v5.18, <code class="inline"><a class="l_k" href="functions/use">use</a> <span class="w">locale</span> <span class="q">'not_characters</span></code> could be used as a workaround for this (see <a href="#Unicode-and-UTF-8">Unicode and UTF-8</a>).</p> <p>Note that there are quite a few things that are unaffected by the current locale. Any literal character is the native character for the given platform. Hence 'A' means the character at code point 65 on ASCII platforms, and 193 on EBCDIC. That may or may not be an 'A' in the current locale, if that locale even has an 'A'. Similarly, all the escape sequences for particular characters, <code class="inline">\<span class="w">n</span></code> for example, always mean the platform's native one. This means, for example, that <code class="inline">\<span class="w">N</span></code> in regular expressions (every character but new-line) works on the platform character set.</p> <p>Starting in v5.22, Perl will by default warn when switching into a locale that redefines any ASCII printable character (plus <code class="inline">\<span class="w">t</span></code> and <code class="inline">\<span class="w">n</span></code> ) into a different class than expected. This is likely to happen on modern locales only on EBCDIC platforms, where, for example, a CCSID 0037 locale on a CCSID 1047 machine moves <code class="inline"><span class="q">"["</span></code> , but it can happen on ASCII platforms with the ISO 646 and other 7-bit locales that are essentially obsolete. Things may still work, depending on what features of Perl are used by the program. For example, in the example from above where <code class="inline"><span class="q">"|"</span></code> becomes a <code class="inline">\<span class="w">w</span></code> , and there are no regular expressions where this matters, the program may still work properly. The warning lists all the characters that it can determine could be adversely affected.</p> <p><b>Note:</b> A broken or malicious <code class="inline"><span class="w">LC_CTYPE</span></code> locale definition may result in clearly ineligible characters being considered to be alphanumeric by your application. For strict matching of (mundane) ASCII letters and digits--for example, in command strings--locale-aware applications should use <code class="inline">\<span class="w">w</span></code> with the <code class="inline"><span class="q">/a</span></code> regular expression modifier. See <a href="#SECURITY">SECURITY</a>.</p> <h3 id="Category-LC_NUMERIC%3a-Numeric-Formatting">Category <code class="inline"><span class="w">LC_NUMERIC</span></code> : Numeric Formatting</h3> <p>After a proper <code class="inline"><span class="i">POSIX::setlocale</span><span class="s">(</span><span class="s">)</span></code> call, and within the scope of of a <code class="inline"><a class="l_k" href="functions/use">use</a> <span class="w">locale</span></code> form that includes numerics, Perl obeys the <code class="inline"><span class="w">LC_NUMERIC</span></code> locale information, which controls an application's idea of how numbers should be formatted for human readability. In most implementations the only effect is to change the character used for the decimal point--perhaps from "." to ",". The functions aren't aware of such niceties as thousands separation and so on. (See <a href="#The-localeconv-function">The localeconv function</a> if you care about these things.)</p> <pre class="verbatim" data-language="perl">use POSIX qw(strtod setlocale LC_NUMERIC);
use locale;

setlocale LC_NUMERIC, "";

$n = 5/2;   # Assign numeric 2.5 to $n

$a = " $n"; # Locale-dependent conversion to string

print "half five is $n\n";       # Locale-dependent output

printf "half five is %g\n", $n;  # Locale-dependent output

print "DECIMAL POINT IS COMMA\n"
         if $n == (strtod("2,5"))[0]; # Locale-dependent conversion
</pre>
<p>See also <a href="i18n/langinfo">I18N::Langinfo</a> and <code class="inline"><span class="w">RADIXCHAR</span></code> .</p> <h3 id="Category-LC_MONETARY%3a-Formatting-of-monetary-amounts">Category <code class="inline"><span class="w">LC_MONETARY</span></code> : Formatting of monetary amounts</h3> <p>The C standard defines the <code class="inline"><span class="w">LC_MONETARY</span></code> category, but not a function that is affected by its contents. (Those with experience of standards committees will recognize that the working group decided to punt on the issue.) Consequently, Perl essentially takes no notice of it. If you really want to use <code class="inline"><span class="w">LC_MONETARY</span></code> , you can query its contents--see <a href="#The-localeconv-function">The localeconv function</a>--and use the information that it returns in your application's own formatting of currency amounts. However, you may well find that the information, voluminous and complex though it may be, still does not quite meet your requirements: currency formatting is a hard nut to crack.</p> <p>See also <a href="i18n/langinfo">I18N::Langinfo</a> and <code class="inline"><span class="w">CRNCYSTR</span></code> .</p> <h3 id="LC_TIME">
<code class="inline"><span class="w">LC_TIME</span></code> </h3> <p>Output produced by <code class="inline"><span class="i">POSIX::strftime</span><span class="s">(</span><span class="s">)</span></code> , which builds a formatted human-readable date/time string, is affected by the current <code class="inline"><span class="w">LC_TIME</span></code> locale. Thus, in a French locale, the output produced by the <code class="inline"><span class="i">%B</span></code> format element (full month name) for the first month of the year would be "janvier". Here's how to get a list of long month names in the current locale:</p> <pre class="verbatim" data-language="perl">use POSIX qw(strftime);
for (0..11) {
    $long_month_name[$_] =
        strftime("%B", 0, 0, 0, 1, $_, 96);
}
</pre>
<p>Note: <code class="inline"><a class="l_k" href="functions/use">use</a> <span class="w">locale</span></code> isn't needed in this example: <code class="inline"><span class="i">strftime</span><span class="s">(</span><span class="s">)</span></code> is a POSIX function which uses the standard system-supplied <code class="inline"><span class="w">libc</span></code> function that always obeys the current <code class="inline"><span class="w">LC_TIME</span></code> locale.</p> <p>See also <a href="i18n/langinfo">I18N::Langinfo</a> and <code class="inline"><span class="w">ABDAY_1</span></code> ..<code class="inline"><span class="w">ABDAY_7</span></code> , <code class="inline"><span class="w">DAY_1</span></code> ..<code class="inline"><span class="w">DAY_7</span></code> , <code class="inline"><span class="w">ABMON_1</span></code> ..<code class="inline"><span class="w">ABMON_12</span></code> , and <code class="inline"><span class="w">ABMON_1</span></code> ..<code class="inline"><span class="w">ABMON_12</span></code> .</p> <h3 id="Other-categories">Other categories</h3> <p>The remaining locale categories are not currently used by Perl itself. But again note that things Perl interacts with may use these, including extensions outside the standard Perl distribution, and by the operating system and its utilities. Note especially that the string value of <code class="inline"><span class="i">$!</span></code> and the error messages given by external utilities may be changed by <code class="inline"><span class="w">LC_MESSAGES</span></code> . If you want to have portable error codes, use <code class="inline"><span class="i">%!</span></code> . See <a href="errno">Errno</a>.</p> <h2 id="SECURITY">SECURITY</h2> <p>Although the main discussion of Perl security issues can be found in <a href="perlsec">perlsec</a>, a discussion of Perl's locale handling would be incomplete if it did not draw your attention to locale-dependent security issues. Locales--particularly on systems that allow unprivileged users to build their own locales--are untrustworthy. A malicious (or just plain broken) locale can make a locale-aware application give unexpected results. Here are a few possibilities:</p> <ul> <li> <p>Regular expression checks for safe file names or mail addresses using <code class="inline">\<span class="w">w</span></code> may be spoofed by an <code class="inline"><span class="w">LC_CTYPE</span></code> locale that claims that characters such as <code class="inline"><span class="q">"&gt;"</span></code> and <code class="inline"><span class="q">"|"</span></code> are alphanumeric.</p> </li> <li> <p>String interpolation with case-mapping, as in, say, <code class="inline"><span class="i">$dest</span> =
<span class="q">"C:\U$name.$ext"</span></code> , may produce dangerous results if a bogus <code class="inline"><span class="w">LC_CTYPE</span></code> case-mapping table is in effect.</p> </li> <li> <p>A sneaky <code class="inline"><span class="w">LC_COLLATE</span></code> locale could result in the names of students with "D" grades appearing ahead of those with "A"s.</p> </li> <li> <p>An application that takes the trouble to use information in <code class="inline"><span class="w">LC_MONETARY</span></code> may format debits as if they were credits and vice versa if that locale has been subverted. Or it might make payments in US dollars instead of Hong Kong dollars.</p> </li> <li> <p>The date and day names in dates formatted by <code class="inline"><span class="i">strftime</span><span class="s">(</span><span class="s">)</span></code> could be manipulated to advantage by a malicious user able to subvert the <code class="inline"><span class="w">LC_DATE</span></code> locale. ("Look--it says I wasn't in the building on Sunday.")</p> </li> </ul> <p>Such dangers are not peculiar to the locale system: any aspect of an application's environment which may be modified maliciously presents similar challenges. Similarly, they are not specific to Perl: any programming language that allows you to write programs that take account of their environment exposes you to these issues.</p> <p>Perl cannot protect you from all possibilities shown in the examples--there is no substitute for your own vigilance--but, when <code class="inline"><a class="l_k" href="functions/use">use</a> <span class="w">locale</span></code> is in effect, Perl uses the tainting mechanism (see <a href="perlsec">perlsec</a>) to mark string results that become locale-dependent, and which may be untrustworthy in consequence. Here is a summary of the tainting behavior of operators and functions that may be affected by the locale:</p> <ul> <li> <p><b>Comparison operators</b> (<code class="inline">lt</code> , <code class="inline">le</code> , <code class="inline">ge</code> , <code class="inline">gt</code> and <code class="inline">cmp</code> ):</p> <p>Scalar true/false (or less/equal/greater) result is never tainted.</p> </li> <li> <p><b>Case-mapping interpolation</b> (with <code class="inline">\<span class="w">l</span></code> , <code class="inline">\<span class="w">L</span></code> , <code class="inline">\<span class="w">u</span></code> , <code class="inline">\<span class="w">U</span></code> , or <code class="inline">\<span class="w">F</span></code> )</p> <p>The result string containing interpolated material is tainted if a <code class="inline"><a class="l_k" href="functions/use">use</a> <span class="w">locale</span></code> form that includes <code class="inline"><span class="w">LC_CTYPE</span></code> is in effect.</p> </li> <li> <p><b>Matching operator</b> (<code class="inline"><a class="l_k" href="functions/m">m//</a></code>):</p> <p>Scalar true/false result never tainted.</p> <p>All subpatterns, either delivered as a list-context result or as <code class="inline"><span class="i">$1</span></code> <i>etc</i>., are tainted if a <code class="inline"><a class="l_k" href="functions/use">use</a> <span class="w">locale</span></code> form that includes <code class="inline"><span class="w">LC_CTYPE</span></code> is in effect, and the subpattern regular expression contains a locale-dependent construct. These constructs include <code class="inline">\<span class="w">w</span></code> (to match an alphanumeric character), <code class="inline">\<span class="w">W</span></code> (non-alphanumeric character), <code class="inline">\<span class="w">b</span></code> and <code class="inline">\<span class="w">B</span></code> (word-boundary and non-boundardy, which depend on what <code class="inline">\<span class="w">w</span></code> and <code class="inline">\<span class="w">W</span></code> match), <code class="inline">\s</code> (whitespace character), <code class="inline">\<span class="w">S</span></code> (non whitespace character), <code class="inline">\<span class="w">d</span></code> and <code class="inline">\<span class="w">D</span></code> (digits and non-digits), and the POSIX character classes, such as <code class="inline">[:alpha:]</code> (see <a href="perlrecharclass#POSIX-Character-Classes">POSIX Character Classes in perlrecharclass</a>).</p> <p>Tainting is also likely if the pattern is to be matched case-insensitively (via <code class="inline">/i</code>). The exception is if all the code points to be matched this way are above 255 and do not have folds under Unicode rules to below 256. Tainting is not done for these because Perl only uses Unicode rules for such code points, and those rules are the same no matter what the current locale.</p> <p>The matched-pattern variables, <code class="inline"><span class="i">$&amp;</span></code> , <code class="inline"><span class="i">$`</span></code> (pre-match), <code class="inline"><span class="i">$'</span></code> (post-match), and <code class="inline"><span class="i">$+</span></code> (last match) also are tainted.</p> </li> <li> <p><b>Substitution operator</b> (<code class="inline"><a class="l_k" href="functions/s">s///</a></code>):</p> <p>Has the same behavior as the match operator. Also, the left operand of <code class="inline">=~</code> becomes tainted when a <code class="inline"><a class="l_k" href="functions/use">use</a> <span class="w">locale</span></code> form that includes <code class="inline"><span class="w">LC_CTYPE</span></code> is in effect, if modified as a result of a substitution based on a regular expression match involving any of the things mentioned in the previous item, or of case-mapping, such as <code class="inline">\<span class="w">l</span></code> , <code class="inline">\<span class="w">L</span></code> ,<code class="inline">\<span class="w">u</span></code> , <code class="inline">\<span class="w">U</span></code> , or <code class="inline">\<span class="w">F</span></code> .</p> </li> <li> <p><b>Output formatting functions</b> (<code class="inline"><a class="l_k" href="functions/printf">printf()</a></code> and <code class="inline"><a class="l_k" href="functions/write">write()</a></code>):</p> <p>Results are never tainted because otherwise even output from print, for example <code class="inline"><a class="l_k" href="functions/print">print(1/7)</a></code>, should be tainted if <code class="inline"><a class="l_k" href="functions/use">use</a> <span class="w">locale</span></code> is in effect.</p> </li> <li> <p><b>Case-mapping functions</b> (<code class="inline"><a class="l_k" href="functions/lc">lc()</a></code>, <code class="inline"><a class="l_k" href="functions/lcfirst">lcfirst()</a></code>, <code class="inline"><a class="l_k" href="functions/uc">uc()</a></code>, <code class="inline"><a class="l_k" href="functions/ucfirst">ucfirst()</a></code>):</p> <p>Results are tainted if a <code class="inline"><a class="l_k" href="functions/use">use</a> <span class="w">locale</span></code> form that includes <code class="inline"><span class="w">LC_CTYPE</span></code> is in effect.</p> </li> <li> <p><b>POSIX locale-dependent functions</b> (<code class="inline"><span class="i">localeconv</span><span class="s">(</span><span class="s">)</span></code> , <code class="inline"><span class="i">strcoll</span><span class="s">(</span><span class="s">)</span></code> , <code class="inline"><span class="i">strftime</span><span class="s">(</span><span class="s">)</span></code> , <code class="inline"><span class="i">strxfrm</span><span class="s">(</span><span class="s">)</span></code> ):</p> <p>Results are never tainted.</p> </li> <li> <p><b>POSIX character class tests</b> (<code class="inline"><span class="i">POSIX::isalnum</span><span class="s">(</span><span class="s">)</span></code> , <code class="inline"><span class="i">POSIX::isalpha</span><span class="s">(</span><span class="s">)</span></code> , <code class="inline"><span class="i">POSIX::isdigit</span><span class="s">(</span><span class="s">)</span></code> , <code class="inline"><span class="i">POSIX::isgraph</span><span class="s">(</span><span class="s">)</span></code> , <code class="inline"><span class="i">POSIX::islower</span><span class="s">(</span><span class="s">)</span></code> , <code class="inline"><span class="i">POSIX::isprint</span><span class="s">(</span><span class="s">)</span></code> , <code class="inline"><span class="i">POSIX::ispunct</span><span class="s">(</span><span class="s">)</span></code> , <code class="inline"><span class="i">POSIX::isspace</span><span class="s">(</span><span class="s">)</span></code> , <code class="inline"><span class="i">POSIX::isupper</span><span class="s">(</span><span class="s">)</span></code> , <code class="inline"><span class="i">POSIX::isxdigit</span><span class="s">(</span><span class="s">)</span></code> ):</p> <p>True/false results are never tainted.</p> </li> </ul> <p>Three examples illustrate locale-dependent tainting. The first program, which ignores its locale, won't run: a value taken directly from the command line may not be used to name an output file when taint checks are enabled.</p> <pre class="verbatim" data-language="perl">#/usr/local/bin/perl -T
# Run with taint checking

# Command line sanity check omitted...
$tainted_output_file = shift;

open(F, "&gt;$tainted_output_file")
    or warn "Open of $tainted_output_file failed: $!\n";
</pre>
<p>The program can be made to run by "laundering" the tainted value through a regular expression: the second example--which still ignores locale information--runs, creating the file named on its command line if it can.</p> <pre class="verbatim" data-language="perl">#/usr/local/bin/perl -T

$tainted_output_file = shift;
$tainted_output_file =~ m%[\w/]+%;
$untainted_output_file = $&amp;;

open(F, "&gt;$untainted_output_file")
    or warn "Open of $untainted_output_file failed: $!\n";
</pre>
<p>Compare this with a similar but locale-aware program:</p> <pre class="verbatim" data-language="perl">#/usr/local/bin/perl -T

$tainted_output_file = shift;
use locale;
$tainted_output_file =~ m%[\w/]+%;
$localized_output_file = $&amp;;

open(F, "&gt;$localized_output_file")
    or warn "Open of $localized_output_file failed: $!\n";
</pre>
<p>This third program fails to run because <code class="inline"><span class="i">$&amp;</span></code> is tainted: it is the result of a match involving <code class="inline">\<span class="w">w</span></code> while <code class="inline"><a class="l_k" href="functions/use">use</a> <span class="w">locale</span></code> is in effect.</p> <h2 id="ENVIRONMENT">ENVIRONMENT</h2> <ul> <li id="PERL_SKIP_LOCALE_INIT">
<b>PERL_SKIP_LOCALE_INIT</b> <p>This environment variable, available starting in Perl v5.20, if set (to any value), tells Perl to not use the rest of the environment variables to initialize with. Instead, Perl uses whatever the current locale settings are. This is particularly useful in embedded environments, see <a href="perlembed#Using-embedded-Perl-with-POSIX-locales">Using embedded Perl with POSIX locales in perlembed</a>.</p> </li> <li id="PERL_BADLANG">
<b>PERL_BADLANG</b> <p>A string that can suppress Perl's warning about failed locale settings at startup. Failure can occur if the locale support in the operating system is lacking (broken) in some way--or if you mistyped the name of a locale when you set up your environment. If this environment variable is absent, or has a value other than "0" or "", Perl will complain about locale setting failures.</p> <p><b>NOTE</b>: <code class="inline"><span class="w">PERL_BADLANG</span></code> only gives you a way to hide the warning message. The message tells about some problem in your system's locale support, and you should investigate what the problem is.</p> </li> </ul> <p>The following environment variables are not specific to Perl: They are part of the standardized (ISO C, XPG4, POSIX 1.c) <code class="inline"><span class="i">setlocale</span><span class="s">(</span><span class="s">)</span></code> method for controlling an application's opinion on data. Windows is non-POSIX, but Perl arranges for the following to work as described anyway. If the locale given by an environment variable is not valid, Perl tries the next lower one in priority. If none are valid, on Windows, the system default locale is then tried. If all else fails, the <code class="inline"><span class="q">"C"</span></code> locale is used. If even that doesn't work, something is badly broken, but Perl tries to forge ahead with whatever the locale settings might be.</p> <ul> <li id="LC_ALL">
<b><code class="inline"><span class="w">LC_ALL</span></code> </b> <p><code class="inline"><span class="w">LC_ALL</span></code> is the "override-all" locale environment variable. If set, it overrides all the rest of the locale environment variables.</p> </li> <li id="LANGUAGE">
<b><code class="inline"><span class="w">LANGUAGE</span></code> </b> <p><b>NOTE</b>: <code class="inline"><span class="w">LANGUAGE</span></code> is a GNU extension, it affects you only if you are using the GNU libc. This is the case if you are using e.g. Linux. If you are using "commercial" Unixes you are most probably <i>not</i> using GNU libc and you can ignore <code class="inline"><span class="w">LANGUAGE</span></code> .</p> <p>However, in the case you are using <code class="inline"><span class="w">LANGUAGE</span></code> : it affects the language of informational, warning, and error messages output by commands (in other words, it's like <code class="inline"><span class="w">LC_MESSAGES</span></code> ) but it has higher priority than <code class="inline"><span class="w">LC_ALL</span></code> . Moreover, it's not a single value but instead a "path" (":"-separated list) of <i>languages</i> (not locales). See the GNU <code class="inline"><span class="w">gettext</span></code> library documentation for more information.</p> </li> <li id="LC_CTYPE">
<b><code class="inline"><span class="w">LC_CTYPE</span></code> </b> <p>In the absence of <code class="inline"><span class="w">LC_ALL</span></code> , <code class="inline"><span class="w">LC_CTYPE</span></code> chooses the character type locale. In the absence of both <code class="inline"><span class="w">LC_ALL</span></code> and <code class="inline"><span class="w">LC_CTYPE</span></code> , <code class="inline"><span class="w">LANG</span></code> chooses the character type locale.</p> </li> <li id="LC_COLLATE">
<b><code class="inline"><span class="w">LC_COLLATE</span></code> </b> <p>In the absence of <code class="inline"><span class="w">LC_ALL</span></code> , <code class="inline"><span class="w">LC_COLLATE</span></code> chooses the collation (sorting) locale. In the absence of both <code class="inline"><span class="w">LC_ALL</span></code> and <code class="inline"><span class="w">LC_COLLATE</span></code> , <code class="inline"><span class="w">LANG</span></code> chooses the collation locale.</p> </li> <li id="LC_MONETARY">
<b><code class="inline"><span class="w">LC_MONETARY</span></code> </b> <p>In the absence of <code class="inline"><span class="w">LC_ALL</span></code> , <code class="inline"><span class="w">LC_MONETARY</span></code> chooses the monetary formatting locale. In the absence of both <code class="inline"><span class="w">LC_ALL</span></code> and <code class="inline"><span class="w">LC_MONETARY</span></code> , <code class="inline"><span class="w">LANG</span></code> chooses the monetary formatting locale.</p> </li> <li id="LC_NUMERIC">
<b><code class="inline"><span class="w">LC_NUMERIC</span></code> </b> <p>In the absence of <code class="inline"><span class="w">LC_ALL</span></code> , <code class="inline"><span class="w">LC_NUMERIC</span></code> chooses the numeric format locale. In the absence of both <code class="inline"><span class="w">LC_ALL</span></code> and <code class="inline"><span class="w">LC_NUMERIC</span></code> , <code class="inline"><span class="w">LANG</span></code> chooses the numeric format.</p> </li> <li id="LC_TIME">
<b><code class="inline"><span class="w">LC_TIME</span></code> </b> <p>In the absence of <code class="inline"><span class="w">LC_ALL</span></code> , <code class="inline"><span class="w">LC_TIME</span></code> chooses the date and time formatting locale. In the absence of both <code class="inline"><span class="w">LC_ALL</span></code> and <code class="inline"><span class="w">LC_TIME</span></code> , <code class="inline"><span class="w">LANG</span></code> chooses the date and time formatting locale.</p> </li> <li id="LANG">
<b><code class="inline"><span class="w">LANG</span></code> </b> <p><code class="inline"><span class="w">LANG</span></code> is the "catch-all" locale environment variable. If it is set, it is used as the last resort after the overall <code class="inline"><span class="w">LC_ALL</span></code> and the category-specific <code class="inline">LC_<i>foo</i></code>.</p> </li> </ul> <h3 id="Examples">Examples</h3> <p>The <code class="inline"><span class="w">LC_NUMERIC</span></code> controls the numeric output:</p> <pre class="verbatim" data-language="perl">use locale;
use POSIX qw(locale_h); # Imports setlocale() and the LC_ constants.
setlocale(LC_NUMERIC, "fr_FR") or die "Pardon";
printf "%g\n", 1.23; # If the "fr_FR" succeeded, probably shows 1,23.
</pre>
<p>and also how strings are parsed by <code class="inline"><span class="i">POSIX::strtod</span><span class="s">(</span><span class="s">)</span></code> as numbers:</p> <pre class="verbatim" data-language="perl">use locale;
use POSIX qw(locale_h strtod);
setlocale(LC_NUMERIC, "de_DE") or die "Entschuldigung";
my $x = strtod("2,34") + 5;
print $x, "\n"; # Probably shows 7,34.
</pre>
<h2 id="NOTES">NOTES</h2> <h3 id="String-eval-and-LC_NUMERIC">String <code class="inline"><a class="l_k" href="functions/eval">eval</a></code> and <code class="inline"><span class="w">LC_NUMERIC</span></code> </h3> <p>A string <a href="functions/eval">eval EXPR</a> parses its expression as standard Perl. It is therefore expecting the decimal point to be a dot. If <code class="inline"><span class="w">LC_NUMERIC</span></code> is set to have this be a comma instead, the parsing will be confused, perhaps silently.</p> <pre class="verbatim" data-language="perl">use locale;
use POSIX qw(locale_h);
setlocale(LC_NUMERIC, "fr_FR") or die "Pardon";
my $a = 1.2;
print eval "$a + 1.5";
print "\n";
</pre>
<p>prints <code class="inline"><span class="n">13</span><span class="cm">,</span><span class="n">5</span></code> . This is because in that locale, the comma is the decimal point character. The <code class="inline"><a class="l_k" href="functions/eval">eval</a></code> thus expands to:</p> <pre class="verbatim" data-language="perl">eval "1,2 + 1.5"
</pre>
<p>and the result is not what you likely expected. No warnings are generated. If you do string <code class="inline"><a class="l_k" href="functions/eval">eval</a></code>'s within the scope of <code class="inline"><a class="l_k" href="functions/use">use</a> <span class="w">locale</span></code> , you should instead change the <code class="inline"><a class="l_k" href="functions/eval">eval</a></code> line to do something like:</p> <pre class="verbatim" data-language="perl">print eval "no locale; $a + 1.5";
</pre>
<p>This prints <code class="inline"><span class="n">2.7</span></code> .</p> <p>You could also exclude <code class="inline"><span class="w">LC_NUMERIC</span></code> , if you don't need it, by</p> <pre class="verbatim" data-language="perl">use locale ':!numeric';
</pre>
<h3 id="Backward-compatibility">Backward compatibility</h3> <p>Versions of Perl prior to 5.004 <b>mostly</b> ignored locale information, generally behaving as if something similar to the <code class="inline"><span class="q">"C"</span></code> locale were always in force, even if the program environment suggested otherwise (see <a href="#The-setlocale-function">The setlocale function</a>). By default, Perl still behaves this way for backward compatibility. If you want a Perl application to pay attention to locale information, you <b>must</b> use the <code class="inline"><a class="l_k" href="functions/use">use</a> <span class="w">locale</span></code> pragma (see <a href="#The-%22use-locale%22-pragma">The use locale pragma</a>) or, in the unlikely event that you want to do so for just pattern matching, the <code class="inline"><span class="q">/l</span></code> regular expression modifier (see <a href="perlre#Character-set-modifiers">Character set modifiers in perlre</a>) to instruct it to do so.</p> <p>Versions of Perl from 5.002 to 5.003 did use the <code class="inline"><span class="w">LC_CTYPE</span></code> information if available; that is, <code class="inline">\<span class="w">w</span></code> did understand what were the letters according to the locale environment variables. The problem was that the user had no control over the feature: if the C library supported locales, Perl used them.</p> <h3 id="I18N%3aCollate-obsolete">I18N:Collate obsolete</h3> <p>In versions of Perl prior to 5.004, per-locale collation was possible using the <code class="inline"><span class="w">I18N::Collate</span></code> library module. This module is now mildly obsolete and should be avoided in new applications. The <code class="inline"><span class="w">LC_COLLATE</span></code> functionality is now integrated into the Perl core language: One can use locale-specific scalar data completely normally with <code class="inline"><a class="l_k" href="functions/use">use</a> <span class="w">locale</span></code> , so there is no longer any need to juggle with the scalar references of <code class="inline"><span class="w">I18N::Collate</span></code> .</p> <h3 id="Sort-speed-and-memory-use-impacts">Sort speed and memory use impacts</h3> <p>Comparing and sorting by locale is usually slower than the default sorting; slow-downs of two to four times have been observed. It will also consume more memory: once a Perl scalar variable has participated in any string comparison or sorting operation obeying the locale collation rules, it will take 3-15 times more memory than before. (The exact multiplier depends on the string's contents, the operating system and the locale.) These downsides are dictated more by the operating system's implementation of the locale system than by Perl.</p> <h3 id="Freely-available-locale-definitions">Freely available locale definitions</h3> <p>The Unicode CLDR project extracts the POSIX portion of many of its locales, available at</p> <pre class="verbatim" data-language="perl">http://unicode.org/Public/cldr/latest/
</pre>
<p>There is a large collection of locale definitions at:</p> <pre class="verbatim" data-language="perl">http://std.dkuug.dk/i18n/WG15-collection/locales/
</pre>
<p>You should be aware that it is unsupported, and is not claimed to be fit for any purpose. If your system allows installation of arbitrary locales, you may find the definitions useful as they are, or as a basis for the development of your own locales.</p> <h3 id="I18n-and-l10n">I18n and l10n</h3> <p>"Internationalization" is often abbreviated as <b>i18n</b> because its first and last letters are separated by eighteen others. (You may guess why the internalin ... internaliti ... i18n tends to get abbreviated.) In the same way, "localization" is often abbreviated to <b>l10n</b>.</p> <h3 id="An-imperfect-standard">An imperfect standard</h3> <p>Internationalization, as defined in the C and POSIX standards, can be criticized as incomplete, ungainly, and having too large a granularity. (Locales apply to a whole process, when it would arguably be more useful to have them apply to a single thread, window group, or whatever.) They also have a tendency, like standards groups, to divide the world into nations, when we all know that the world can equally well be divided into bankers, bikers, gamers, and so on.</p> <h2 id="Unicode-and-UTF-8">Unicode and UTF-8</h2> <p>The support of Unicode is new starting from Perl version v5.6, and more fully implemented in versions v5.8 and later. See <a href="perluniintro">perluniintro</a>.</p> <p>Starting in Perl v5.20, UTF-8 locales are supported in Perl, except for <code class="inline"><span class="w">LC_COLLATE</span></code> (use <a href="unicode/collate">Unicode::Collate</a> instead). If you have Perl v5.16 or v5.18 and can't upgrade, you can use</p> <pre class="verbatim" data-language="perl">use locale ':not_characters';
</pre>
<p>When this form of the pragma is used, only the non-character portions of locales are used by Perl, for example <code class="inline"><span class="w">LC_NUMERIC</span></code> . Perl assumes that you have translated all the characters it is to operate on into Unicode (actually the platform's native character set (ASCII or EBCDIC) plus Unicode). For data in files, this can conveniently be done by also specifying</p> <pre class="verbatim" data-language="perl">use open ':locale';
</pre>
<p>This pragma arranges for all inputs from files to be translated into Unicode from the current locale as specified in the environment (see <a href="#ENVIRONMENT">ENVIRONMENT</a>), and all outputs to files to be translated back into the locale. (See <a href="open">open</a>). On a per-filehandle basis, you can instead use the <a href="http://search.cpan.org/perldoc/PerlIO::locale">PerlIO::locale</a> module, or the <a href="http://search.cpan.org/perldoc/Encode::Locale">Encode::Locale</a> module, both available from CPAN. The latter module also has methods to ease the handling of <code class="inline"><span class="w">ARGV</span></code> and environment variables, and can be used on individual strings. If you know that all your locales will be UTF-8, as many are these days, you can use the <a href="perlrun#-C">-C</a> command line switch.</p> <p>This form of the pragma allows essentially seamless handling of locales with Unicode. The collation order will be by Unicode code point order. It is strongly recommended that when you need to order and sort strings that you use the standard module <a href="unicode/collate">Unicode::Collate</a> which gives much better results in many instances than you can get with the old-style locale handling.</p> <p>All the modules and switches just described can be used in v5.20 with just plain <code class="inline"><a class="l_k" href="functions/use">use</a> <span class="w">locale</span></code> , and, should the input locales not be UTF-8, you'll get the less than ideal behavior, described below, that you get with pre-v5.16 Perls, or when you use the locale pragma without the <code class="inline"><span class="j">:</span><span class="w">not_characters</span></code> parameter in v5.16 and v5.18. If you are using exclusively UTF-8 locales in v5.20 and higher, the rest of this section does not apply to you.</p> <p>There are two cases, multi-byte and single-byte locales. First multi-byte:</p> <p>The only multi-byte (or wide character) locale that Perl is ever likely to support is UTF-8. This is due to the difficulty of implementation, the fact that high quality UTF-8 locales are now published for every area of the world (<a href="http://unicode.org/Public/cldr/latest/">http://unicode.org/Public/cldr/latest/</a>), and that failing all that you can use the <a href="encode">Encode</a> module to translate to/from your locale. So, you'll have to do one of those things if you're using one of these locales, such as Big5 or Shift JIS. For UTF-8 locales, in Perls (pre v5.20) that don't have full UTF-8 locale support, they may work reasonably well (depending on your C library implementation) simply because both they and Perl store characters that take up multiple bytes the same way. However, some, if not most, C library implementations may not process the characters in the upper half of the Latin-1 range (128 - 255) properly under <code class="inline"><span class="w">LC_CTYPE</span></code> . To see if a character is a particular type under a locale, Perl uses the functions like <code class="inline"><span class="i">isalnum</span><span class="s">(</span><span class="s">)</span></code> . Your C library may not work for UTF-8 locales with those functions, instead only working under the newer wide library functions like <code class="inline"><span class="i">iswalnum</span><span class="s">(</span><span class="s">)</span></code> , which Perl does not use. These multi-byte locales are treated like single-byte locales, and will have the restrictions described below. Starting in Perl v5.22 a warning message is raised when Perl detects a multi-byte locale that it doesn't fully support.</p> <p>For single-byte locales, Perl generally takes the tack to use locale rules on code points that can fit in a single byte, and Unicode rules for those that can't (though this isn't uniformly applied, see the note at the end of this section). This prevents many problems in locales that aren't UTF-8. Suppose the locale is ISO8859-7, Greek. The character at 0xD7 there is a capital Chi. But in the ISO8859-1 locale, Latin1, it is a multiplication sign. The POSIX regular expression character class <code class="inline"><span class="s">[</span><span class="s">[</span><span class="co">:</span><span class="w">alpha</span><span class="co">:</span><span class="s">]</span><span class="s">]</span></code> will magically match 0xD7 in the Greek locale but not in the Latin one.</p> <p>However, there are places where this breaks down. Certain Perl constructs are for Unicode only, such as <code class="inline">\<span class="i">p</span><span class="s">{</span><span class="w">Alpha</span><span class="s">}</span></code> . They assume that 0xD7 always has its Unicode meaning (or the equivalent on EBCDIC platforms). Since Latin1 is a subset of Unicode and 0xD7 is the multiplication sign in both Latin1 and Unicode, <code class="inline">\<span class="i">p</span><span class="s">{</span><span class="w">Alpha</span><span class="s">}</span></code> will never match it, regardless of locale. A similar issue occurs with <code class="inline">\<span class="i">N</span><span class="s">{</span>...<span class="s">}</span></code> . Prior to v5.20, It is therefore a bad idea to use <code class="inline">\<span class="w">p</span><span class="s">{</span><span class="s">}</span></code> or <code class="inline">\<span class="w">N</span><span class="s">{</span><span class="s">}</span></code> under plain <code class="inline"><a class="l_k" href="functions/use">use</a> <span class="w">locale</span></code> --<i>unless</i> you can guarantee that the locale will be ISO8859-1. Use POSIX character classes instead.</p> <p>Another problem with this approach is that operations that cross the single byte/multiple byte boundary are not well-defined, and so are disallowed. (This boundary is between the codepoints at 255/256.) For example, lower casing LATIN CAPITAL LETTER Y WITH DIAERESIS (U+0178) should return LATIN SMALL LETTER Y WITH DIAERESIS (U+00FF). But in the Greek locale, for example, there is no character at 0xFF, and Perl has no way of knowing what the character at 0xFF is really supposed to represent. Thus it disallows the operation. In this mode, the lowercase of U+0178 is itself.</p> <p>The same problems ensue if you enable automatic UTF-8-ification of your standard file handles, default <code class="inline"><a class="l_k" href="functions/open">open()</a></code> layer, and <code class="inline"><span class="i">@ARGV</span></code> on non-ISO8859-1, non-UTF-8 locales (by using either the <b>-C</b> command line switch or the <code class="inline"><span class="w">PERL_UNICODE</span></code> environment variable; see <a href="perlrun">perlrun</a>). Things are read in as UTF-8, which would normally imply a Unicode interpretation, but the presence of a locale causes them to be interpreted in that locale instead. For example, a 0xD7 code point in the Unicode input, which should mean the multiplication sign, won't be interpreted by Perl that way under the Greek locale. This is not a problem <i>provided</i> you make certain that all locales will always and only be either an ISO8859-1, or, if you don't have a deficient C library, a UTF-8 locale.</p> <p>Still another problem is that this approach can lead to two code points meaning the same character. Thus in a Greek locale, both U+03A7 and U+00D7 are GREEK CAPITAL LETTER CHI.</p> <p>Because of all these problems, starting in v5.22, Perl will raise a warning if a multi-byte (hence Unicode) code point is used when a single-byte locale is in effect. (Although it doesn't check for this if doing so would unreasonably slow execution down.)</p> <p>Vendor locales are notoriously buggy, and it is difficult for Perl to test its locale-handling code because this interacts with code that Perl has no control over; therefore the locale-handling code in Perl may be buggy as well. (However, the Unicode-supplied locales should be better, and there is a feed back mechanism to correct any problems. See <a href="#Freely-available-locale-definitions">Freely available locale definitions</a>.)</p> <p>If you have Perl v5.16, the problems mentioned above go away if you use the <code class="inline"><span class="j">:</span><span class="w">not_characters</span></code> parameter to the locale pragma (except for vendor bugs in the non-character portions). If you don't have v5.16, and you <i>do</i> have locales that work, using them may be worthwhile for certain specific purposes, as long as you keep in mind the gotchas already mentioned. For example, if the collation for your locales works, it runs faster under locales than under <a href="unicode/collate">Unicode::Collate</a>; and you gain access to such things as the local currency symbol and the names of the months and days of the week. (But to hammer home the point, in v5.16, you get this access without the downsides of locales by using the <code class="inline"><span class="j">:</span><span class="w">not_characters</span></code> form of the pragma.)</p> <p>Note: The policy of using locale rules for code points that can fit in a byte, and Unicode rules for those that can't is not uniformly applied. Pre-v5.12, it was somewhat haphazard; in v5.12 it was applied fairly consistently to regular expression matching except for bracketed character classes; in v5.14 it was extended to all regex matches; and in v5.16 to the casing operations such as <code class="inline">\<span class="w">L</span></code> and <code class="inline"><a class="l_k" href="functions/uc">uc()</a></code>. For collation, in all releases so far, the system's <code class="inline"><span class="i">strxfrm</span><span class="s">(</span><span class="s">)</span></code> function is called, and whatever it does is what you get.</p> <h2 id="BUGS">BUGS</h2> <h3 id="Broken-systems">Broken systems</h3> <p>In certain systems, the operating system's locale support is broken and cannot be fixed or used by Perl. Such deficiencies can and will result in mysterious hangs and/or Perl core dumps when <code class="inline"><a class="l_k" href="functions/use">use</a> <span class="w">locale</span></code> is in effect. When confronted with such a system, please report in excruciating detail to &lt;<i>perlbug@perl.org</i>&gt;, and also contact your vendor: bug fixes may exist for these problems in your operating system. Sometimes such bug fixes are called an operating system upgrade. If you have the source for Perl, include in the perlbug email the output of the test described above in <a href="#Testing-for-broken-locales">Testing for broken locales</a>.</p> <h2 id="SEE-ALSO">SEE ALSO</h2> <p><a href="i18n/langinfo">I18N::Langinfo</a>, <a href="perluniintro">perluniintro</a>, <a href="perlunicode">perlunicode</a>, <a href="open">open</a>, <a href="posix#isalnum">isalnum in POSIX</a>, <a href="posix#isalpha">isalpha in POSIX</a>, <a href="posix#isdigit">isdigit in POSIX</a>, <a href="posix#isgraph">isgraph in POSIX</a>, <a href="posix#islower">islower in POSIX</a>, <a href="posix#isprint">isprint in POSIX</a>, <a href="posix#ispunct">ispunct in POSIX</a>, <a href="posix#isspace">isspace in POSIX</a>, <a href="posix#isupper">isupper in POSIX</a>, <a href="posix#isxdigit">isxdigit in POSIX</a>, <a href="posix#localeconv">localeconv in POSIX</a>, <a href="posix#setlocale">setlocale in POSIX</a>, <a href="posix#strcoll">strcoll in POSIX</a>, <a href="posix#strftime">strftime in POSIX</a>, <a href="posix#strtod">strtod in POSIX</a>, <a href="posix#strxfrm">strxfrm in POSIX</a>.</p> <p>For special considerations when Perl is embedded in a C program, see <a href="perlembed#Using-embedded-Perl-with-POSIX-locales">Using embedded Perl with POSIX locales in perlembed</a>.</p> <h2 id="HISTORY">HISTORY</h2> <p>Jarkko Hietaniemi's original <i>perli18n.pod</i> heavily hacked by Dominic Dunlop, assisted by the perl5-porters. Prose worked over a bit by Tom Christiansen, and updated by Perl 5 porters.</p>
<div class="_attribution">
  <p class="_attribution-p">
    ยฉ 1993โ2016 Larry Wall and others<br>Licensed under the GNU General Public License version 1 or later, or the Artistic License.<br>The Perl logo is a trademark of the Perl Foundation.<br>
    <a href="https://perldoc.perl.org/5.26.0/perllocale.html" class="_attribution-link">https://perldoc.perl.org/5.26.0/perllocale.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
