
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Development - Wagtail - W3cubDocs</title>
  
  <meta name="description" content="Setting up a local copy of the Wagtail git repository is slightly more involved than running a release package of Wagtail, as it requires Node.js &hellip;">
  <meta name="keywords" content="development, wagtail">
  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/wagtail/contributing/developing.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-9c7b0d969c0ce639a6c01c2badcdd81667c7c66206aa3d0fccc5cb0585fb1b912dab72ea882101d18010680927514b4b77b107282db8f756fbf63301fe9c88b0.css">
  <script type="text/javascript" src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js"></script>
  <script src="/json/wagtail.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/wagtail/" class="_nav-link" title="" style="margin-left:0;">Wagtail</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _sphinx">
				
				
<h1 id="developing-for-wagtail">Development</h1> <p>Setting up a local copy of <a class="reference external" href="https://github.com/wagtail/wagtail">the Wagtail git repository</a> is slightly more involved than running a release package of Wagtail, as it requires <a class="reference external" href="https://nodejs.org/">Node.js</a> and npm for building JavaScript and CSS assets. (This is not required when running a release version, as the compiled assets are included in the release package.)</p> <p>If you’re happy to develop on a local virtual machine, the <a class="reference external" href="https://github.com/wagtail/docker-wagtail-develop">docker-wagtail-develop</a> and <a class="reference external" href="https://github.com/wagtail/vagrant-wagtail-develop">vagrant-wagtail-develop</a> setup scripts are the fastest way to get up and running. They will provide you with a running instance of the <a class="reference external" href="https://github.com/wagtail/bakerydemo/">Wagtail Bakery demo site</a>, with the Wagtail and bakerydemo codebases available as shared folders for editing on your host machine.</p> <p>You can also set up a cloud development environment that you can work with in a browser-based IDE using the <a class="reference external" href="https://github.com/wagtail/gitpod-wagtail-develop">gitpod-wagtail-develop</a> project.</p> <p>(Build scripts for other platforms would be very much welcomed - if you create one, please let us know via the <a class="reference external" href="https://github.com/wagtail/wagtail/wiki/Slack">Slack workspace</a>!)</p> <p>If you’d prefer to set up all the components manually, read on. These instructions assume that you’re familiar with using pip and <a class="reference external" href="https://docs.python.org/3/tutorial/venv.html">virtual environments</a> to manage Python packages.</p> <section id="setting-up-the-wagtail-codebase"> <h2>Setting up the Wagtail codebase</h2> <p>The preferred way to install the correct version of Node is to use <a class="reference external" href="https://github.com/nvm-sh/nvm">Node Version Manager (nvm)</a> or <a class="reference external" href="https://github.com/Schniz/fnm">Fast Node Manager (fnm)</a>, which will always align the version with the supplied <code>.nvmrc</code> file in the root of the project. To ensure you are running the correct version of Node, run <code>nvm install</code> or <code>fnm install</code> from the project root. Alternatively, you can install <a class="reference external" href="https://nodejs.org/">Node.js</a> directly, ensure you install the version as declared in the project’s root <code>.nvmrc</code> file.</p> <p>You will also need to install the <strong>libjpeg</strong> and <strong>zlib</strong> libraries, if you haven’t done so already - see Pillow’s <a class="reference external" href="https://pillow.readthedocs.io/en/stable/installation.html#external-libraries">platform-specific installation instructions</a>.</p> <p>Clone a copy of <a class="reference external" href="https://github.com/wagtail/wagtail">the Wagtail codebase</a>:</p> <pre data-language="sh">git clone https://github.com/wagtail/wagtail.git
cd wagtail
</pre> <p><strong>With your preferred virtualenv activated,</strong> install the Wagtail package in development mode with the included testing and documentation dependencies:</p> <pre data-language="sh">pip install -e '.[testing,docs]' -U
</pre> <p>Install the tool chain for building static assets:</p> <pre data-language="sh">npm ci
</pre> <p>Compile the assets:</p> <pre data-language="sh">npm run build
</pre> <p>Any Wagtail sites you start up in this virtualenv will now run against this development instance of Wagtail. We recommend using the <a class="reference external" href="https://github.com/wagtail/bakerydemo/">Wagtail Bakery demo site</a> as a basis for developing Wagtail. Keep in mind that the setup steps for a Wagtail site may include installing a release version of Wagtail, which will override the development version you’ve just set up. In this case, you should install the site before running the <code>pip install -e</code> step, or re-run that step after the site is installed.</p> </section> <section id="testing"> <h2 id="id1">Testing</h2> <p>From the root of the Wagtail codebase, run the following command to run all the Python tests:</p> <pre data-language="sh">python runtests.py
</pre> <section id="running-only-some-of-the-tests"> <h3>Running only some of the tests</h3> <p>At the time of writing, Wagtail has well over 2500 tests, which takes a while to run. You can run tests for only one part of Wagtail by passing in the path as an argument to <code>runtests.py</code> or <code>tox</code>:</p> <pre data-language="sh"># Running in the current environment
python runtests.py wagtail

# Running in a specified Tox environment
tox -e py39-dj32-sqlite-noelasticsearch wagtail

# See a list of available Tox environments
tox -l
</pre> <p>You can also run tests for individual TestCases by passing in the path as an argument to <code>runtests.py</code></p> <pre data-language="sh"># Running in the current environment
python runtests.py wagtail.tests.test_blocks.TestIntegerBlock

# Running in a specified Tox environment
tox -e py39-dj32-sqlite-noelasticsearch wagtail.tests.test_blocks.TestIntegerBlock
</pre> </section> <section id="running-migrations-for-the-test-app-models"> <h3>Running migrations for the test app models</h3> <p>You can create migrations for the test app by running the following from the Wagtail root.</p> <pre data-language="sh">django-admin makemigrations --settings=wagtail.test.settings
</pre> </section> <section id="testing-against-postgresql"> <h3>Testing against PostgreSQL</h3> <div class="admonition note"> <p class="admonition-title">Note</p> <p>In order to run these tests, you must install the required modules for PostgreSQL as described in Django’s <a class="reference external" href="https://docs.djangoproject.com/en/stable/ref/databases/">Databases documentation</a>.</p> </div> <p>By default, Wagtail tests against SQLite. You can switch to using PostgreSQL by using the <code>--postgres</code> argument:</p> <pre data-language="sh">python runtests.py --postgres
</pre> <p>If you need to use a different user, password, host or port, use the <code>PGUSER</code>, <code>PGPASSWORD</code>, <code>PGHOST</code> and <code>PGPORT</code> environment variables respectively.</p> </section> <section id="testing-against-a-different-database"> <h3>Testing against a different database</h3> <div class="admonition note"> <p class="admonition-title">Note</p> <p>In order to run these tests, you must install the required client libraries and modules for the given database as described in Django’s <a class="reference external" href="https://docs.djangoproject.com/en/stable/ref/databases/">Databases documentation</a> or 3rd-party database backend’s documentation.</p> </div> <p>If you need to test against a different database, set the <code>DATABASE_ENGINE</code> environment variable to the name of the Django database backend to test against:</p> <pre data-language="sh">DATABASE_ENGINE=django.db.backends.mysql python runtests.py
</pre> <p>This will create a new database called <code>test_wagtail</code> in MySQL and run the tests against it.</p> <p>If you need to use different connection settings, use the following environment variables which correspond to the respective keys within Django’s <a class="reference external" href="https://docs.djangoproject.com/en/stable/ref/settings/#databases">DATABASES</a> settings dictionary:</p> <ul class="simple"> <li><code>DATABASE_ENGINE</code></li> <li><code>DATABASE_NAME</code></li> <li><code>DATABASE_PASSWORD</code></li> <li>
<p><code>DATABASE_HOST</code></p> <ul> <li>Note that for MySQL, this must be <code>127.0.0.1</code> rather than <code>localhost</code> if you need to connect using a TCP socket</li> </ul> </li> <li><code>DATABASE_PORT</code></li> </ul> <p>It is also possible to set <code>DATABASE_DRIVER</code>, which corresponds to the <code>driver</code> value within <code>OPTIONS</code> if an SQL Server engine is used.</p> </section> <section id="testing-elasticsearch"> <h3>Testing Elasticsearch</h3> <p>You can test Wagtail against Elasticsearch by passing the <code>--elasticsearch</code> argument to <code>runtests.py</code>:</p> <pre data-language="sh">python runtests.py --elasticsearch
</pre> <p>Wagtail will attempt to connect to a local instance of Elasticsearch (<code>http://localhost:9200</code>) and use the index <code>test_wagtail</code>.</p> <p>If your Elasticsearch instance is located somewhere else, you can set the <code>ELASTICSEARCH_URL</code> environment variable to point to its location:</p> <pre data-language="sh">ELASTICSEARCH_URL=http://my-elasticsearch-instance:9200 python runtests.py --elasticsearch
</pre> </section> <section id="unit-tests-for-javascript"> <h3>Unit tests for JavaScript</h3> <p>We use <a class="reference external" href="https://jestjs.io/">Jest</a> for unit tests of client-side business logic or UI components. From the root of the Wagtail codebase, run the following command to run all the front-end unit tests:</p> <pre data-language="sh">npm run test:unit
</pre> </section> <section id="integration-tests"> <h3>Integration tests</h3> <p>Our end-to-end browser testing suite also uses <a class="reference external" href="https://jestjs.io/">Jest</a>, combined with <a class="reference external" href="https://pptr.dev/">Puppeteer</a>. We set this up to be installed separately so as not to increase the installation size of the existing Node tooling. To run the tests, you will need to install the dependencies and, in a separate terminal, run the test suite’s Django development server:</p> <pre data-language="sh">export DJANGO_SETTINGS_MODULE=wagtail.test.settings_ui
# Assumes the current environment contains a valid installation of Wagtail for local development.
./wagtail/test/manage.py migrate
./wagtail/test/manage.py createcachetable
DJANGO_SUPERUSER_EMAIL=admin@example.com DJANGO_SUPERUSER_USERNAME=admin DJANGO_SUPERUSER_PASSWORD=changeme ./wagtail/test/manage.py createsuperuser --noinput
./wagtail/test/manage.py runserver 0:8000
# In a separate terminal:
npm --prefix client/tests/integration install
npm run test:integration
</pre> <p>Integration tests target <code>http://localhost:8000</code> by default. Use the <code>TEST_ORIGIN</code> environment variable to use a different port, or test a remote Wagtail instance: <code>TEST_ORIGIN=http://localhost:9000 npm run test:integration</code>.</p> </section> <section id="browser-and-device-support"> <h3>Browser and device support</h3> <p>Wagtail is meant to be used on a wide variety of devices and browsers. Supported browser / device versions include:</p> <table class="colwidths-auto docutils align-default"> <thead> <tr>
<th class="head"><p>Browser</p></th> <th class="head"><p>Device/OS</p></th> <th class="head"><p>Version(s)</p></th> </tr> </thead>  <tr>
<td><p>Mobile Safari</p></td> <td><p>iOS Phone</p></td> <td><p>Last 2</p></td> </tr> <tr>
<td><p>Mobile Safari</p></td> <td><p>iOS Tablet</p></td> <td><p>Last 2</p></td> </tr> <tr>
<td><p>Chrome</p></td> <td><p>Android</p></td> <td><p>Last 2</p></td> </tr> <tr>
<td><p>Chrome</p></td> <td><p>Desktop</p></td> <td><p>Last 2</p></td> </tr> <tr>
<td><p>MS Edge</p></td> <td><p>Windows</p></td> <td><p>Last 2</p></td> </tr> <tr>
<td><p>Firefox</p></td> <td><p>Desktop</p></td> <td><p>Latest</p></td> </tr> <tr>
<td><p>Firefox ESR</p></td> <td><p>Desktop</p></td> <td><p>Latest</p></td> </tr> <tr>
<td><p>Safari</p></td> <td><p>macOS</p></td> <td><p>Last 3</p></td> </tr>  </table> <p>We aim for Wagtail to work in those environments, there are known support gaps for Safari 13 introduced in Wagtail 4.0 to provide better support for RTL languages. Our development standards ensure that the site is usable on other browsers <strong>and will work on future browsers</strong>.</p> <p>IE 11 support has been officially dropped in 2.15 as it is gradually falling out of use. Features already known not to work include:</p> <ul class="simple"> <li>Rich text copy-paste in the rich text editor.</li> <li>Sticky toolbar in the rich text editor.</li> <li>Focus outline styles in the main menu &amp; explorer menu.</li> <li>Keyboard access to the actions in page listing tables.</li> </ul> <p><strong>Unsupported browsers / devices include:</strong></p> <table class="colwidths-auto docutils align-default"> <thead> <tr>
<th class="head"><p>Browser</p></th> <th class="head"><p>Device/OS</p></th> <th class="head"><p>Version(s)</p></th> </tr> </thead>  <tr>
<td><p>Stock browser</p></td> <td><p>Android</p></td> <td><p>All</p></td> </tr> <tr>
<td><p>IE</p></td> <td><p>Desktop</p></td> <td><p>All</p></td> </tr> <tr>
<td><p>Safari</p></td> <td><p>Windows</p></td> <td><p>All</p></td> </tr>  </table> </section> <section id="accessibility-targets"> <h3>Accessibility targets</h3> <p>We want to make Wagtail accessible for users of a wide variety of assistive technologies. The specific standard we aim for is <a class="reference external" href="https://www.w3.org/TR/WCAG21/">WCAG2.1</a>, AA level. Here are specific assistive technologies we aim to test for, and ultimately support:</p> <ul class="simple"> <li>
<a class="reference external" href="https://www.nvaccess.org/download/">NVDA</a> on Windows with Firefox ESR</li> <li>
<a class="reference external" href="https://support.apple.com/en-gb/guide/voiceover-guide/welcome/web">VoiceOver</a> on macOS with Safari</li> <li>
<a class="reference external" href="https://support.microsoft.com/en-gb/help/11542/windows-use-magnifier">Windows Magnifier</a> and macOS Zoom</li> <li>Windows Speech Recognition and macOS Dictation</li> <li>Mobile <a class="reference external" href="https://support.apple.com/en-gb/guide/voiceover-guide/welcome/web">VoiceOver</a> on iOS, or <a class="reference external" href="https://support.google.com/accessibility/android/answer/6283677?hl=en-GB">TalkBack</a> on Android</li> <li>Windows <a class="reference external" href="https://support.microsoft.com/en-us/windows/use-high-contrast-mode-in-windows-10-fedc744c-90ac-69df-aed5-c8a90125e696">High-contrast mode</a>
</li> </ul> <p>We aim for Wagtail to work in those environments. Our development standards ensure that the site is usable with other assistive technologies. In practice, testing with assistive technology can be a daunting task that requires specialised training – here are tools we rely on to help identify accessibility issues, to use during development and code reviews:</p> <ul class="simple"> <li>
<a class="reference external" href="https://github.com/dequelabs/react-axe">react-axe</a> integrated directly in our build tools, to identify actionable issues. Logs its results in the browser console.</li> <li>
<a class="reference external" href="https://github.com/WordPress/gutenberg/tree/trunk/packages/jest-puppeteer-axe">@wordpress/jest-puppeteer-axe</a> running Axe checks as part of integration tests.</li> <li>
<a class="reference external" href="https://chrome.google.com/webstore/detail/axe/lhdoppojpmngadmnindnejefpokejbdd">Axe</a> Chrome extension for more comprehensive automated tests of a given page.</li> <li>
<a class="reference external" href="https://accessibilityinsights.io/docs/en/web/overview">Accessibility Insights for Web</a> Chrome extension for semi-automated tests, and manual audits.</li> </ul> </section> <section id="known-accessibility-issues"> <h3>Known accessibility issues</h3> <p>Wagtail’s administration interface isn’t fully accessible at the moment. We actively work on fixing issues both as part of ongoing maintenance and bigger overhauls. To learn about known issues, check out:</p> <ul class="simple"> <li>The <a class="reference external" href="https://github.com/wagtail/wagtail/projects/5">WCAG2.1 AA for CMS admin</a> issues backlog.</li> <li>Our <a class="reference external" href="https://docs.google.com/spreadsheets/d/1l7tnpEyJiC5BWE_JX0XCkknyrjxYA5T2aee5JgPnmi4/edit">2021 accessibility audit</a>.</li> </ul> <p>The audit also states which parts of Wagtail have and haven’t been tested, how issues affect WCAG 2.1 compliance, and the likely impact on users.</p> </section> </section> <section id="compiling-static-assets"> <h2>Compiling static assets</h2> <p>All static assets such as JavaScript, CSS, images, and fonts for the Wagtail admin are compiled from their respective sources by Webpack. The compiled assets are not committed to the repository, and are compiled before packaging each new release. Compiled assets should not be submitted as part of a pull request.</p> <p>To compile the assets, run:</p> <pre data-language="sh">npm run build
</pre> <p>This must be done after every change to the source files. To watch the source files for changes and then automatically recompile the assets, run:</p> <pre data-language="sh">npm start
</pre> </section> <section id="using-the-pattern-library"> <h2>Using the pattern library</h2> <p>Wagtail’s UI component library is built with <a class="reference external" href="https://storybook.js.org/">Storybook</a> and <a class="reference external" href="https://github.com/torchbox/django-pattern-library">django-pattern-library</a>. To run it locally,</p> <pre data-language="sh">export DJANGO_SETTINGS_MODULE=wagtail.test.settings_ui
# Assumes the current environment contains a valid installation of Wagtail for local development.
./wagtail/test/manage.py migrate
./wagtail/test/manage.py createcachetable
./wagtail/test/manage.py runserver 0:8000
# In a separate terminal:
npm run storybook
</pre> <p>The last command will start Storybook at <code>http://localhost:6006/</code>. It will proxy specific requests to Django at <code>http://localhost:8000</code> by default. Use the <code>TEST_ORIGIN</code> environment variable to use a different port for Django: <code>TEST_ORIGIN=http://localhost:9000 npm run storybook</code>.</p> </section> <section id="compiling-the-documentation"> <h2>Compiling the documentation</h2> <p>The Wagtail documentation is built by Sphinx. To install Sphinx and compile the documentation, run:</p> <pre data-language="sh">cd /path/to/wagtail
# Install the documentation dependencies
pip install -e .[docs]
# or if using zsh as your shell:
#    pip install -e '.[docs]' -U
# Compile the docs
cd docs/
make html
</pre> <p>The compiled documentation will now be in <code>docs/_build/html</code>. Open this directory in a web browser to see it. Python comes with a module that makes it very easy to preview static files in a web browser. To start this simple server, run the following commands:</p> <pre data-language="sh">cd docs/_build/html/
python -m http.server 8080
</pre> <p>Now you can open <a class="reference external" href="http://localhost:8080/">http://localhost:8080/</a> in your web browser to see the compiled documentation.</p> <p>Sphinx caches the built documentation to speed up subsequent compilations. Unfortunately, this cache also hides any warnings thrown by unmodified documentation source files. To clear the built HTML and start fresh, so you can see all warnings thrown when building the documentation, run:</p> <pre data-language="sh">cd docs/
make clean
make html
</pre> <p>Wagtail also provides a way for documentation to be compiled automatically on each change. To do this, you can run the following command to see the changes automatically at <code>localhost:4000</code>:</p> <pre data-language="sh">cd docs/
make livehtml
</pre> </section> <section id="automatically-lint-and-code-format-on-commits"> <h2>Automatically lint and code format on commits</h2> <p><a class="reference external" href="https://pre-commit.com/">pre-commit</a> is configured to automatically run code linting and formatting checks with every commit. To install pre-commit into your git hooks run:</p> <pre data-language="sh">pre-commit install
</pre> <p>pre-commit should now run on every commit you make.</p> </section><div class="_attribution">
  <p class="_attribution-p">
    © 2014-present Torchbox Ltd and individual contributors.<br>All rights are reserved.<br>Licensed under the BSD License.<br>
    <a href="https://docs.wagtail.org/en/stable/contributing/developing.html" class="_attribution-link">https://docs.wagtail.org/en/stable/contributing/developing.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
