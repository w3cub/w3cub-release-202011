
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Npm&#58; Threats and Mitigations - Npm - W3cubDocs</title>
  
  <meta name="description" content="We put together this page to give an overview of the most common attacks npm faces, a high-level description of how we mitigate those attacks, and &hellip;">
  <meta name="keywords" content="npm, threats, and, mitigations">
  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/npm/threats-and-mitigations.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-f16eecbe420d8b2925d31ffbb21d05646497ecbd9515f08ffe69e9bba7332f5657accc7003c7f6c72cb4a132171acf171b359ae3bae4ae5660ddfb1718f88c67.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/npm.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/npm/" class="_nav-link" title="" style="margin-left:0;">npm</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _npm">
				
				
<h1 class="Heading-sc-1m35ws5-0 keoAKT">npm: Threats and Mitigations</h1>
<div id="___gatsby">
<div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="BaseStyles-sc-8q0tj8-0 dDtDlN">
<a class="Link-kudw2l-0 gveuDO skip-link__SkipLink-sc-sg54jn-0 jMgpPW" color="white" href="#skip-nav" font-size="1">Skip to content</a><div display="flex" class="Box-sc-1b6inku-0 Flex-jlpa5r-0 flKQDR">
<div class="Box-sc-1b6inku-0 Position-gj4o9g-0 ikWwzD nKRZg">

<div height="66" display="flex" class="Box-sc-1b6inku-0 Flex-jlpa5r-0 huIPeM">
<div display="flex" class="Box-sc-1b6inku-0 Flex-jlpa5r-0 ipfyof">
<a style="color:#dddddd;font-weight:600;display:flex;align-items:center" mr="4" theme="[object Object]" color="blue.5" class="Link-kudw2l-0 diA-DKt" href="index">npm Docs</a><div display="none,,,block" class="Box-sc-1b6inku-0 jsZuaw"><div role="combobox" aria-expanded="false" aria-haspopup="listbox" aria-labelledby="downshift-28-label" class="Box-sc-1b6inku-0 Position-gj4o9g-0 ikWwzD pSBmA"><span class="TextInput__Wrapper-sc-156lfck-1 YgOAw dark-text-input__DarkTextInput-sc-1qryvhy-0 TVMTy TextInput-wrapper" width="240"><input type="text" aria-autocomplete="list" aria-labelledby="downshift-28-label" autocomplete="off" value="" id="downshift-28-input" placeholder="Search npm Docs" class="TextInput__Input-sc-156lfck-0 hFmjeq"></span></div></div>
</div>
<div display="flex" class="Box-sc-1b6inku-0 Flex-jlpa5r-0 fZeRUj">
<div display="none,,,block" class="Box-sc-1b6inku-0 ezMiXD"><div color="gray.2" display="flex" class="Box-sc-1b6inku-0 Flex-jlpa5r-0 dbzVDM">
<a href="https://npmjs.com/" display="block" color="inherit" class="Link-kudw2l-0 lfdnZb">npmjs.com</a><a href="https://status.npmjs.com/" display="block" color="inherit" class="Link-kudw2l-0 lfdnZb">Status</a><a href="https://npmjs.com/support/" display="block" color="inherit" class="Link-kudw2l-0 lfdnZb">Support</a>
</div></div>

</div>
</div>
</div>
<div display="flex" class="Box-sc-1b6inku-0 Flex-jlpa5r-0 layout___StyledFlex-sc-1qhwq3g-0 fnaqwK fNYvIR">
<div display="none,,,block" class="Box-sc-1b6inku-0 ezMiXD"><div height="calc(100vh - 66px)" color="gray.8" class="Box-sc-1b6inku-0 Position-gj4o9g-0 JIaNk dNFflh"><div height="100%" style="overflow:auto" class="Box-sc-1b6inku-0 BorderBox-sc-1y9cbfx-0 ieiGkZ yoSNH"><div display="flex" class="Box-sc-1b6inku-0 Flex-jlpa5r-0 kyXAjL">
<div class="Box-sc-1b6inku-0 BorderBox-sc-1y9cbfx-0 jrqCkM iUKqVA"><div display="flex" class="Box-sc-1b6inku-0 Flex-jlpa5r-0 kyXAjL"><a theme="[object Object]" color="blue.5" class="nav-items__NavLink-sc-kh2ci9-0 nav-items__TopLevelLink-sc-kh2ci9-1 VgIlc cYphDH" href="about-npm">About npm</a></div></div>
<div class="Box-sc-1b6inku-0 BorderBox-sc-1y9cbfx-0 jrqCkM iUKqVA"><div display="flex" class="Box-sc-1b6inku-0 Flex-jlpa5r-0 kyXAjL"><a theme="[object Object]" color="blue.5" class="nav-items__NavLink-sc-kh2ci9-0 nav-items__TopLevelLink-sc-kh2ci9-1 VgIlc cYphDH" href="getting-started">Getting started</a></div></div>
<div class="Box-sc-1b6inku-0 BorderBox-sc-1y9cbfx-0 jrqCkM iUKqVA"><div display="flex" class="Box-sc-1b6inku-0 Flex-jlpa5r-0 kyXAjL"><a theme="[object Object]" color="blue.5" class="nav-items__NavLink-sc-kh2ci9-0 nav-items__TopLevelLink-sc-kh2ci9-1 VgIlc cYphDH" href="packages-and-modules">Packages and modules</a></div></div>
<div class="Box-sc-1b6inku-0 BorderBox-sc-1y9cbfx-0 jrqCkM iUKqVA"><div display="flex" class="Box-sc-1b6inku-0 Flex-jlpa5r-0 kyXAjL"><a theme="[object Object]" color="blue.5" class="nav-items__NavLink-sc-kh2ci9-0 nav-items__TopLevelLink-sc-kh2ci9-1 VgIlc cYphDH" href="integrations">Integrations</a></div></div>
<div class="Box-sc-1b6inku-0 BorderBox-sc-1y9cbfx-0 jrqCkM iUKqVA"><div display="flex" class="Box-sc-1b6inku-0 Flex-jlpa5r-0 kyXAjL"><a theme="[object Object]" color="blue.5" class="nav-items__NavLink-sc-kh2ci9-0 nav-items__TopLevelLink-sc-kh2ci9-1 VgIlc cYphDH" href="organizations">Organizations</a></div></div>
<div class="Box-sc-1b6inku-0 BorderBox-sc-1y9cbfx-0 jrqCkM iUKqVA"><div display="flex" class="Box-sc-1b6inku-0 Flex-jlpa5r-0 kyXAjL"><a theme="[object Object]" color="blue.5" class="nav-items__NavLink-sc-kh2ci9-0 nav-items__TopLevelLink-sc-kh2ci9-1 VgIlc cYphDH" href="https://docs.npmjs.com/policies">Policies</a></div></div>
<div class="Box-sc-1b6inku-0 BorderBox-sc-1y9cbfx-0 jrqCkM iUKqVA"><div display="flex" class="Box-sc-1b6inku-0 Flex-jlpa5r-0 kyXAjL"><a aria-current="page" theme="[object Object]" color="blue.5" class="nav-items__NavLink-sc-kh2ci9-0 nav-items__TopLevelLink-sc-kh2ci9-1 VgIlc cYphDH active" href="threats-and-mitigations">Threats and Mitigations</a></div></div>
<div class="Box-sc-1b6inku-0 BorderBox-sc-1y9cbfx-0 jrqCkM iUKqVA"><div display="flex" class="Box-sc-1b6inku-0 Flex-jlpa5r-0 kyXAjL"><a theme="[object Object]" color="blue.5" class="nav-items__NavLink-sc-kh2ci9-0 nav-items__TopLevelLink-sc-kh2ci9-1 VgIlc cYphDH" href="cli/v8">npm CLI</a></div></div>
</div></div></div></div>
<div id="skip-nav" display="grid" class="Box-sc-1b6inku-0 Grid-nhubvi-0 layout___StyledGrid-sc-1qhwq3g-1 eavzgG bBzKJd LAVNr">

<div display="none,,block" class="Box-sc-1b6inku-0 Position-gj4o9g-0 layout___StyledPosition-sc-1qhwq3g-4 ceIGgC dhFgjg ffFUDf">
<span display="inline-block" font-weight="bold" class="Text-sc-1g6etse-0 kfRBiA">Table of contents</span><ul class="Box-sc-1b6inku-0 table-of-contents___StyledBox-sc-167zp2h-0 gATGzQ bFAqS">
<li class="Box-sc-1b6inku-0 SdeyN">
<a display="inline-block" href="#account-takeovers" color="gray.6" class="Link-kudw2l-0 hbtGWO">Account Takeovers</a><ul class="Box-sc-1b6inku-0 table-of-contents___StyledBox-sc-167zp2h-0 gATGzQ bFAqS">
<li class="Box-sc-1b6inku-0 cuQrRm"><a display="inline-block" href="#by-compromising-passwords" color="gray.6" class="Link-kudw2l-0 hbtGWO">By compromising passwords</a></li>
<li class="Box-sc-1b6inku-0 cuQrRm"><a display="inline-block" href="#by-registering-an-expired-email-domain" color="gray.6" class="Link-kudw2l-0 hbtGWO">By registering an expired email domain</a></li>
</ul>
</li>
<li class="Box-sc-1b6inku-0 SdeyN">
<a display="inline-block" href="#uploading-malicious-packages" color="gray.6" class="Link-kudw2l-0 hbtGWO">Uploading Malicious Packages</a><ul class="Box-sc-1b6inku-0 table-of-contents___StyledBox-sc-167zp2h-0 gATGzQ bFAqS">
<li class="Box-sc-1b6inku-0 cuQrRm"><a display="inline-block" href="#by-typosquatting--dependency-confusion" color="gray.6" class="Link-kudw2l-0 hbtGWO">By "typosquatting" / dependency confusion</a></li>
<li class="Box-sc-1b6inku-0 cuQrRm"><a display="inline-block" href="#by-changing-an-existing-package-to-have-malicious-behavior" color="gray.6" class="Link-kudw2l-0 hbtGWO">By changing an existing package to have malicious behavior</a></li>
</ul>
</li>
</ul>
</div>
<div class="Box-sc-1b6inku-0 layout___StyledBox3-sc-1qhwq3g-5 ikWwzD cdcKmh">

<p class="paragraph__Paragraph-sc-cqjk0l-0 gDjqhD">We put together this page to give an overview of the most common attacks npm faces, a high-level description of how we mitigate those attacks, and links to more information.</p>
<h2 id="account-takeovers" class="Heading-sc-1m35ws5-0 heading__StyledHeading-sc-w625eb-0 heading__StyledH2-sc-w625eb-2 keoAKT dvEqcH ilrdty Heading-sc-1m35ws5-0 heading__StyledHeading-sc-w625eb-0 keoAKT dvEqcH">
Account Takeovers</h2>
<h3 id="by-compromising-passwords" class="Heading-sc-1m35ws5-0 heading__StyledHeading-sc-w625eb-0 heading__StyledH3-sc-w625eb-3 keoAKT dvEqcH jGwhGX Heading-sc-1m35ws5-0 heading__StyledHeading-sc-w625eb-0 keoAKT dvEqcH">
By compromising passwords</h3>
<p class="paragraph__Paragraph-sc-cqjk0l-0 gDjqhD">This is the most common attack, not just on npm but on any web service. The best way to protect your account is to <a href="configuring-two-factor-authentication" color="blue.5" class="Link-kudw2l-0 hbMoeF">enable two-factor authentication</a> (2FA). The strongest option is to use a security-key, either built-in to your device or an external hardware key; it binds the authentication to the site you are accessing, making phishing exceedingly difficult. Not everyone has access to a security-key though, so we also support authentication apps that generate one-time passcodes for 2FA.</p>
<p class="paragraph__Paragraph-sc-cqjk0l-0 gDjqhD">Because of how common this attack is, and how critical npm packages are to the broader software ecosystem, we have undertaken a phased approach in mandating 2FA for npm package maintainers. This has already rolled out to the <a href="https://github.blog/2022-02-01-top-100-npm-package-maintainers-require-2fa-additional-security/" color="blue.5" class="Link-kudw2l-0 hbMoeF">top-100 package maintainers</a> and <a href="https://github.blog/changelog/2022-05-31-top-500-npm-package-maintainers-now-require-2fa/" color="blue.5" class="Link-kudw2l-0 hbMoeF">top-500 package maintainers</a>, and in the near future, maintainers of all high-impact packages (those with 1 million+ weekly downloads or 500+ dependents) will be enrolled in mandatory 2FA.</p>
<p class="paragraph__Paragraph-sc-cqjk0l-0 gDjqhD">We also recognize that passwords aren’t going away any time soon. For users that don’t opt-in to 2FA, we do an enhanced login verification with a <a href="receiving-a-one-time-password-over-email" color="blue.5" class="Link-kudw2l-0 hbMoeF">one-time password sent to their email</a> to protect from account takeover.</p>
<h3 id="by-registering-an-expired-email-domain" class="Heading-sc-1m35ws5-0 heading__StyledHeading-sc-w625eb-0 heading__StyledH3-sc-w625eb-3 keoAKT dvEqcH jGwhGX Heading-sc-1m35ws5-0 heading__StyledHeading-sc-w625eb-0 keoAKT dvEqcH">
By registering an expired email domain</h3>
<p class="paragraph__Paragraph-sc-cqjk0l-0 gDjqhD">Another method used to take over an account is by identifying accounts using an expired domain for their email address. An attacker could register the expired domain and recreate the email address used to register the account. With access to an account's registered email address an attacker could take over an account not protected by 2FA via a password reset.</p>
<p class="paragraph__Paragraph-sc-cqjk0l-0 gDjqhD">When a package is published the email address associated with the account, <strong>at the time the package was published</strong>, is included in the public metadata. Attackers are able to utilize this public data to identify accounts that might be susceptible to account takeover. It is important to note that the<strong> email addresses stored in public metadata of packages are not updated when a maintainer updates their email address</strong>. As such crawling public metadata to identify accounts susceptible to expired domain takeover will result in false positives, accounts that appear to be vulnerable but are not.</p>
<p class="paragraph__Paragraph-sc-cqjk0l-0 gDjqhD">npm does periodically check if accounts email addresses have expired domains or invalid MX records. When the domain has expired, we disable the account from doing a password reset and require the user to undergo account recovery or go through a successful authentication flow before they can reset their password.</p>
<h2 id="uploading-malicious-packages" class="Heading-sc-1m35ws5-0 heading__StyledHeading-sc-w625eb-0 heading__StyledH2-sc-w625eb-2 keoAKT dvEqcH ilrdty Heading-sc-1m35ws5-0 heading__StyledHeading-sc-w625eb-0 keoAKT dvEqcH">
Uploading Malicious Packages</h2>
<h3 id="by-typosquatting--dependency-confusion" class="Heading-sc-1m35ws5-0 heading__StyledHeading-sc-w625eb-0 heading__StyledH3-sc-w625eb-3 keoAKT dvEqcH jGwhGX Heading-sc-1m35ws5-0 heading__StyledHeading-sc-w625eb-0 keoAKT dvEqcH">
By "typosquatting" / dependency confusion</h3>
<p class="paragraph__Paragraph-sc-cqjk0l-0 gDjqhD">Attackers may attempt to trick others into installing a malicious package by registering a package with a similar name to a popular package, in hopes that people will mistype or otherwise confuse the two. npm is able to detect typosquat attacks and block the publishing of these packages.</p>
<p class="paragraph__Paragraph-sc-cqjk0l-0 gDjqhD">A variant of this attack is when a public package is registered with the same name of a private package that an organization is using. We strongly encourage using <a href="https://github.blog/2021-02-12-avoiding-npm-substitution-attacks/" color="blue.5" class="Link-kudw2l-0 hbMoeF">scoped packages</a> to ensure that a private package isn’t being substituted with one from the public registry. While npm is not able to detect dependency confusion attacks we have a zero tolerance for malicious packages on the registry. If you believe you have identified a dependency confusion packages, <a href="reporting-malware-in-an-npm-package" color="blue.5" class="Link-kudw2l-0 hbMoeF">please let us know</a>!</p>
<h3 id="by-changing-an-existing-package-to-have-malicious-behavior" class="Heading-sc-1m35ws5-0 heading__StyledHeading-sc-w625eb-0 heading__StyledH3-sc-w625eb-3 keoAKT dvEqcH jGwhGX Heading-sc-1m35ws5-0 heading__StyledHeading-sc-w625eb-0 keoAKT dvEqcH">
By changing an existing package to have malicious behavior</h3>
<p class="paragraph__Paragraph-sc-cqjk0l-0 gDjqhD">Rather than tricking people into using a similarly-named package, attackers also try to add malicious behavior to existing popular packages. In partnership with Microsoft, npm both scans packages for known malicious content, and runs the packages to look for new patterns of behavior that could be malicious. This has led to a substantial reduction in malicious content in npm packages. Furthermore, our Trust and Safety team checks and removes malicious content reported by our users. Similar to dependency confusion attacks, we are constantly updating our detection services with new examples, so if you think a package contains malicious behavior, <a href="reporting-malware-in-an-npm-package" color="blue.5" class="Link-kudw2l-0 hbMoeF">please let us know</a>!</p>
<div class="Box-sc-1b6inku-0 BorderBox-sc-1y9cbfx-0 fWSmRk lartgG"><div display="grid" class="Box-sc-1b6inku-0 Grid-nhubvi-0 kfLmVf jIKFQx"><a href="https://github.com/npm/documentation/edit/main/content/threats-and-mitigations/index.mdx" color="blue.5" class="Link-kudw2l-0 hbMoeF">Edit this page on GitHub</a></div></div>
</div>
</div>
</div>
</div>
</div></div>

</div>
<div class="_attribution">
  <p class="_attribution-p">
    © npm, Inc. and Contributors<br>Licensed under the npm License.<br>npm is a trademark of npm, Inc.<br>
    <a href="https://docs.npmjs.com/threats-and-mitigations" class="_attribution-link">https://docs.npmjs.com/threats-and-mitigations</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
