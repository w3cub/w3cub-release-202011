
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Ordinary Differential Equations - Octave - W3cubDocs</title>
  
  <meta name="description" content=" The function lsode can be used to solve ODEs of the form ">
  <meta name="keywords" content="ordinary, differential, equations, octave">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/octave/ordinary-differential-equations.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e4ebd3a2a5652ff55173659804c4390a004917f3bdd17b5bb3ba78ea5c9c46fe181cadaac34517ccd815f5bdc982bbfe67179d6f4ac2f084ef2265e2a3dc8dc5.css" integrity="sha512-5OvToqVlL/VRc2WYBMQ5CgBJF/O90Xtbs7p46lycRv4YHK2qw0UXzNgV9b3Jgrv+Zxedb0rC8ITvImXio9yNxQ==" crossorigin="anonymous">
  <script type="text/javascript" integrity="sha512-EpkDeu98lN/jPKijllzVWdRg/dUSSMCaldYZNFz6bcNoBvpWRNz0HSTRQJ3ENmQc5Cuj1zDW1vHd7b0DzpOgyA==" crossorigin="anonymous" src="/assets/application-1299037aef7c94dfe33ca8a3965cd559d460fdd51248c09a95d619345cfa6dc36806fa5644dcf41d24d1409dc436641ce42ba3d730d6d6f1ddedbd03ce93a0c8.js"></script>
  <script src="/json/octave.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/octave/" class="_nav-link" title="" style="margin-left:0;">Octave</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _octave">
				
				
<h1 class="section">24.1 Ordinary Differential Equations</h1> <p>The function <code>lsode</code> can be used to solve ODEs of the form </p> <pre class="example" data-language="matlab">dx
-- = f (x, t)
dt</pre> <p>using Hindmarsh’s ODE solver <small>LSODE</small>. </p> <dl id="XREFlsode"> <dt id="index-lsode">[x, istate, msg] = lsode (fcn, x_0, t)</dt> <dt id="index-lsode-1">[x, istate, msg] = lsode (fcn, x_0, t, t_crit)</dt> <dd>
<p>Ordinary Differential Equation (ODE) solver. </p> <p>The set of differential equations to solve is </p> <pre class="example" data-language="matlab">dx
-- = f (x, t)
dt</pre> <p>with </p> <pre class="example" data-language="matlab">x(t_0) = x_0</pre> <p>The solution is returned in the matrix <var>x</var>, with each row corresponding to an element of the vector <var>t</var>. The first element of <var>t</var> should be <em>t_0</em> and should correspond to the initial state of the system <var>x_0</var>, so that the first row of the output is <var>x_0</var>. </p> <p>The first argument, <var>fcn</var>, is a string, inline, or function handle that names the function <em>f</em> to call to compute the vector of right hand sides for the set of equations. The function must have the form </p> <pre class="example" data-language="matlab">xdot = f (x, t)</pre> <p>in which <var>xdot</var> and <var>x</var> are vectors and <var>t</var> is a scalar. </p> <p>If <var>fcn</var> is a two-element string array or a two-element cell array of strings, inline functions, or function handles, the first element names the function <em>f</em> described above, and the second element names a function to compute the Jacobian of <em>f</em>. The Jacobian function must have the form </p> <pre class="example" data-language="matlab">jac = j (x, t)</pre> <p>in which <var>jac</var> is the matrix of partial derivatives </p> <pre class="example" data-language="matlab">| df_1  df_1       df_1 |
             | ----  ----  ...  ---- |
             | dx_1  dx_2       dx_N |
             |                       |
             | df_2  df_2       df_2 |
             | ----  ----  ...  ---- |
      df_i   | dx_1  dx_2       dx_N |
jac = ---- = |                       |
      dx_j   |  .    .     .    .    |
             |  .    .      .   .    |
             |  .    .       .  .    |
             |                       |
             | df_N  df_N       df_N |
             | ----  ----  ...  ---- |
             | dx_1  dx_2       dx_N |</pre> <p>The second argument specifies the initial state of the system <em>x_0</em>. The third argument is a vector, <var>t</var>, specifying the time values for which a solution is sought. </p> <p>The fourth argument is optional, and may be used to specify a set of times that the ODE solver should not integrate past. It is useful for avoiding difficulties with singularities and points where there is a discontinuity in the derivative. </p> <p>After a successful computation, the value of <var>istate</var> will be 2 (consistent with the Fortran version of <small>LSODE</small>). </p> <p>If the computation is not successful, <var>istate</var> will be something other than 2 and <var>msg</var> will contain additional information. </p> <p>You can use the function <code>lsode_options</code> to set optional parameters for <code>lsode</code>. </p> <p><strong>See also:</strong> <a href="differential_002dalgebraic-equations#XREFdaspk">daspk</a>, <a href="differential_002dalgebraic-equations#XREFdassl">dassl</a>, <a href="differential_002dalgebraic-equations#XREFdasrt">dasrt</a>. </p>
</dd>
</dl> <dl id="XREFlsode_005foptions"> <dt id="index-lsode_005foptions">lsode_options ()</dt> <dt id="index-lsode_005foptions-1">val = lsode_options (opt)</dt> <dt id="index-lsode_005foptions-2">lsode_options (opt, val)</dt> <dd>
<p>Query or set options for the function <code>lsode</code>. </p> <p>When called with no arguments, the names of all available options and their current values are displayed. </p> <p>Given one argument, return the value of the option <var>opt</var>. </p> <p>When called with two arguments, <code>lsode_options</code> sets the option <var>opt</var> to value <var>val</var>. </p> <p>Options include </p> <dl compact> <dt><code>"absolute tolerance"</code></dt> <dd>
<p>Absolute tolerance. May be either vector or scalar. If a vector, it must match the dimension of the state vector. </p> </dd> <dt><code>"relative tolerance"</code></dt> <dd>
<p>Relative tolerance parameter. Unlike the absolute tolerance, this parameter may only be a scalar. </p> <p>The local error test applied at each integration step is </p> <pre class="example" data-language="matlab">abs (local error in x(i)) &lt;= ...
      rtol * abs (y(i)) + atol(i)</pre> </dd> <dt><code>"integration method"</code></dt> <dd>
<p>A string specifying the method of integration to use to solve the ODE system. Valid values are </p> <dl compact> <dt><code>"adams"</code></dt> <dt><code>"non-stiff"</code></dt> <dd>
<p>No Jacobian used (even if it is available). </p> </dd> <dt><code>"bdf"</code></dt> <dt><code>"stiff"</code></dt> <dd><p>Use stiff backward differentiation formula (BDF) method. If a function to compute the Jacobian is not supplied, <code>lsode</code> will compute a finite difference approximation of the Jacobian matrix. </p></dd> </dl> </dd> <dt><code>"initial step size"</code></dt> <dd>
<p>The step size to be attempted on the first step (default is determined automatically). </p> </dd> <dt><code>"maximum order"</code></dt> <dd>
<p>Restrict the maximum order of the solution method. If using the Adams method, this option must be between 1 and 12. Otherwise, it must be between 1 and 5, inclusive. </p> </dd> <dt><code>"maximum step size"</code></dt> <dd>
<p>Setting the maximum stepsize will avoid passing over very large regions (default is not specified). </p> </dd> <dt><code>"minimum step size"</code></dt> <dd>
<p>The minimum absolute step size allowed (default is 0). </p> </dd> <dt><code>"step limit"</code></dt> <dd><p>Maximum number of steps allowed (default is 100000). </p></dd> </dl> </dd>
</dl> <p>Here is an example of solving a set of three differential equations using <code>lsode</code>. Given the function </p>  <pre class="example" data-language="matlab">## oregonator differential equation
function xdot = f (x, t)

  xdot = zeros (3,1);

  xdot(1) = 77.27 * (x(2) - x(1)*x(2) + x(1) ...
            - 8.375e-06*x(1)^2);
  xdot(2) = (x(3) - x(1)*x(2) - x(2)) / 77.27;
  xdot(3) = 0.161*(x(1) - x(3));

endfunction</pre> <p>and the initial condition <code>x0 = [ 4; 1.1; 4 ]</code>, the set of equations can be integrated using the command </p> <pre class="example" data-language="matlab">t = linspace (0, 500, 1000);

y = lsode ("f", x0, t);</pre> <p>If you try this, you will see that the value of the result changes dramatically between <var>t</var> = 0 and 5, and again around <var>t</var> = 305. A more efficient set of output points might be </p> <pre class="example" data-language="matlab">t = [0, logspace(-1, log10(303), 150), ...
        logspace(log10(304), log10(500), 150)];</pre> <p>See Alan C. Hindmarsh, <cite>ODEPACK, A Systematized Collection of ODE Solvers</cite>, in Scientific Computing, R. S. Stepleman, editor, (1983) for more information about the inner workings of <code>lsode</code>. </p> <p>An m-file for the differential equation used above is included with the Octave distribution in the examples directory under the name <samp>oregonator.m</samp>. </p> <table class="menu" border="0" cellspacing="0"> <tr><td align="left" valign="top">• <a href="matlab_002dcompatible-solvers#Matlab_002dcompatible-solvers" accesskey="1">Matlab-compatible solvers</a>:</td></tr> </table>
<div class="_attribution">
  <p class="_attribution-p">
          © 1996–2018 John W. Eaton<br>      Permission is granted to make and distribute verbatim copies of this manual provided the copyright notice and this permission notice are preserved on all copies.<br>Permission is granted to copy and distribute modified versions of this manual under the conditions for verbatim copying, provided that the entire resulting derived work is distributed under the terms of a permission notice identical to this one.Permission is granted to copy and distribute translations of this manual into another language, under the above conditions for modified versions.<br>
    <a href="https://octave.org/doc/interpreter/Ordinary-Differential-Equations.html" class="_attribution-link">https://octave.org/doc/interpreter/Ordinary-Differential-Equations.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
