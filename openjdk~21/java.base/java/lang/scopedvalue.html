
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>ScopedValue - OpenJDK 21 - W3cubDocs</title>
  
  <meta name="description" content="In the Java programming language, data is usually passed to a method by means of a method parameter. The data may need to be passed through a &hellip;">
  <meta name="keywords" content="class, scopedvalue, t, openjdk, openjdk~21">
  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/openjdk~21/java.base/java/lang/scopedvalue.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-c8f743fc70bb84079c3cf4b71f5f99835529659c30689b2fd6193651a680f383ef1d96896f8966c7ca8a0160ffd557685bb8ad12820ec6002d60143812238086.css">
  <script type="text/javascript" src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js"></script>
  <script src="/json/openjdk~21.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/openjdk~21/" class="_nav-link" title="" style="margin-left:0;">OpenJDK 21</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _openjdk">
				
				
<h1 title="Class ScopedValue" class="title">Class ScopedValue&lt;T&gt;</h1> <div class="inheritance" title="Inheritance Tree">
<a href="object" title="class in java.lang">java.lang.Object</a> <div class="inheritance">java.lang.ScopedValue&lt;T&gt;</div> </div> <section class="class-description" id="class-description"> <dl class="notes"> <dt>Type Parameters:</dt> <dd>
<code>T</code> - the type of the value</dd> </dl>  <pre class="lang-java" data-language="java">public final class ScopedValue&lt;T&gt; extends Object</pre> <div class="preview-block" id="preview-java.lang.ScopedValue">
<span class="preview-label"><code>ScopedValue</code> is a preview API of the Java platform.</span> <div class="preview-comment">Programs can only use <code>ScopedValue</code> when preview features are enabled.</div> <div class="preview-comment">Preview features may be removed in a future release, or upgraded to permanent features of the Java platform.</div> </div> <div class="block">A value that may be safely and efficiently shared to methods without using method parameters. <p> In the Java programming language, data is usually passed to a method by means of a method parameter. The data may need to be passed through a sequence of many methods to get to the method that makes use of the data. Every method in the sequence of calls needs to declare the parameter and every method has access to the data. <code>ScopedValue</code> provides a means to pass data to a faraway method (typically a <em>callback</em>) without using method parameters. In effect, a <code>ScopedValue</code> is an <em>implicit method parameter</em>. It is "as if" every method in a sequence of calls has an additional parameter. None of the methods declare the parameter and only the methods that have access to the <code>ScopedValue</code> object can access its value (the data). <code>ScopedValue</code> makes it possible to securely pass data from a <em>caller</em> to a faraway <em>callee</em> through a sequence of intermediate methods that do not declare a parameter for the data and have no access to the data. </p>
<p> The <code>ScopedValue</code> API works by executing a method with a <code>ScopedValue</code> object <em>bound</em> to some value for the bounded period of execution of a method. The method may invoke another method, which in turn may invoke another. The unfolding execution of the methods define a <em>dynamic scope</em>. Code in these methods with access to the <code>ScopedValue</code> object may read its value. The <code>ScopedValue</code> object reverts to being <em>unbound</em> when the original method completes normally or with an exception. The <code>ScopedValue</code> API supports executing a <a href="runnable#run()"><code>Runnable.run</code></a>, <a href="../util/concurrent/callable#call()"><code>Callable.call</code></a>, or <a href="../util/function/supplier#get()"><code>Supplier.get</code></a> method with a <code>ScopedValue</code> bound to a value. </p>
<p> Consider the following example with a scoped value "<code>NAME</code>" bound to the value "<code>duke</code>" for the execution of a <code>run</code> method. The <code>run</code> method, in turn, invokes <code>doSomething</code>. </p>
<div class="snippet-container">
<button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KCjwhLS0KIENvcHlyaWdodCAoYykgMjAyMSwgT3JhY2xlIGFuZC9vciBpdHMgYWZmaWxpYXRlcy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIERPIE5PVCBBTFRFUiBPUiBSRU1PVkUgQ09QWVJJR0hUIE5PVElDRVMgT1IgVEhJUyBGSUxFIEhFQURFUi4KCiBUaGlzIGNvZGUgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeSBpdAogdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSB2ZXJzaW9uIDIgb25seSwgYXMKIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLiAgT3JhY2xlIGRlc2lnbmF0ZXMgdGhpcwogcGFydGljdWxhciBmaWxlIGFzIHN1YmplY3QgdG8gdGhlICJDbGFzc3BhdGgiIGV4Y2VwdGlvbiBhcyBwcm92aWRlZAogYnkgT3JhY2xlIGluIHRoZSBMSUNFTlNFIGZpbGUgdGhhdCBhY2NvbXBhbmllZCB0aGlzIGNvZGUuCgogVGhpcyBjb2RlIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsIGJ1dCBXSVRIT1VUCiBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZiBNRVJDSEFOVEFCSUxJVFkgb3IKIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQogdmVyc2lvbiAyIGZvciBtb3JlIGRldGFpbHMgKGEgY29weSBpcyBpbmNsdWRlZCBpbiB0aGUgTElDRU5TRSBmaWxlIHRoYXQKIGFjY29tcGFuaWVkIHRoaXMgY29kZSkuCgogWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgdmVyc2lvbgogMiBhbG9uZyB3aXRoIHRoaXMgd29yazsgaWYgbm90LCB3cml0ZSB0byB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLAogSW5jLiwgNTEgRnJhbmtsaW4gU3QsIEZpZnRoIEZsb29yLCBCb3N0b24sIE1BIDAyMTEwLTEzMDEgVVNBLgoKIFBsZWFzZSBjb250YWN0IE9yYWNsZSwgNTAwIE9yYWNsZSBQYXJrd2F5LCBSZWR3b29kIFNob3JlcywgQ0EgOTQwNjUgVVNBCiBvciB2aXNpdCB3d3cub3JhY2xlLmNvbSBpZiB5b3UgbmVlZCBhZGRpdGlvbmFsIGluZm9ybWF0aW9uIG9yIGhhdmUgYW55CiBxdWVzdGlvbnMuCi0tPgoKPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDM4MCA0NjAiIGZpbGw9IiM1MDUwNTAiPgogIDxwYXRoCiAgICAgZD0iTSAzNDYsOCBIIDEwOCBDIDkwLDggNzUsMjMgNzUsNDEgdiAzMTYgYyAwLDE4IDE1LDMzIDMzLDMzIGggMjM4IGMgMTgsMCAzMywtMTUgMzMsLTMzIFYgNDEgQyAzNzksMjMgMzY0LDggMzQ2LDggWiBtIC04LDM0NCBIIDExNiBjIC0yLDAgLTMsLTEgLTMsLTMgViA0OSBjIDAsLTIgMSwtMyAzLC0zIGggMjIyIGMgMiwwIDMsMSAzLDMgdiAzMDAgaCAxMGUtNCBjIDAsMiAtMSwzIC0zLDMgeiIvPgogIDxwYXRoCiAgICAgZD0ibSAyOTAsMzg5IHYgMjYgaCAxMGUtNCBjIDAsMiAtMSwzIC0zLDMgSCA0OSBjIC0yLDAgLTMsLTEgLTMsLTMgViA5OSBjIDAsLTIgMSwtMyAzLC0zIGggMjcgdiAwIGwgLTVlLTQsLTM4IEggNDEgQyAyMyw1OCA4LDczIDgsOTEgdiAzMzIgYyAxMGUtNCwxOCAxNSwzMyAzMywzMyBoIDI1NCBjIDE4LDAgMzMsLTE1IDMzLC0zMyB2IC0zNCIvPgo8L3N2Zz4K" alt="Copy snippet"></button> <pre class="lang-java" data-language="java"><code class="language-java">    private static final ScopedValue&lt;String&gt; NAME = ScopedValue.<a href="#newInstance()"><code>newInstance</code></a>();

    ScopedValue.<a href="#runWhere(java.lang.ScopedValue,T,java.lang.Runnable)"><code>runWhere</code></a>(NAME, "duke", () -&gt; doSomething());
</code></pre> </div> Code executed directly or indirectly by <code>doSomething</code>, with access to the field <code>NAME</code>, can invoke <code>NAME.get()</code> to read the value "<code>duke</code>". <code>
 NAME</code> is bound while executing the <code>run</code> method. It reverts to being unbound when the <code>run</code> method completes. <p> The example using <code>runWhere</code> invokes a method that does not return a result. The <a href="#callWhere(java.lang.ScopedValue,T,java.util.concurrent.Callable)"><code>callWhere</code></a> and <a href="#getWhere(java.lang.ScopedValue,T,java.util.function.Supplier)"><code>getWhere</code></a> can be used to invoke a method that returns a result. In addition, <code>ScopedValue</code> defines the <a href="#where(java.lang.ScopedValue,T)"><code>where(ScopedValue, Object)</code></a> method for cases where multiple mappings (of <code>ScopedValue</code> to value) are accumulated in advance of calling a method with all <code>ScopedValue</code>s bound to their value. </p>
<h2 id="bindings-are-per-thread-heading">Bindings are per-thread</h2> A <code>ScopedValue</code> binding to a value is per-thread. Invoking <code>xxxWhere</code> executes a method with a <code>ScopedValue</code> bound to a value for the current thread. The <a href="#get()"><code>get</code></a> method returns the value bound for the current thread. <p> In the example, if code executed by one thread invokes this: </p>
<div class="snippet-container">
<button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KCjwhLS0KIENvcHlyaWdodCAoYykgMjAyMSwgT3JhY2xlIGFuZC9vciBpdHMgYWZmaWxpYXRlcy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIERPIE5PVCBBTFRFUiBPUiBSRU1PVkUgQ09QWVJJR0hUIE5PVElDRVMgT1IgVEhJUyBGSUxFIEhFQURFUi4KCiBUaGlzIGNvZGUgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeSBpdAogdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSB2ZXJzaW9uIDIgb25seSwgYXMKIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLiAgT3JhY2xlIGRlc2lnbmF0ZXMgdGhpcwogcGFydGljdWxhciBmaWxlIGFzIHN1YmplY3QgdG8gdGhlICJDbGFzc3BhdGgiIGV4Y2VwdGlvbiBhcyBwcm92aWRlZAogYnkgT3JhY2xlIGluIHRoZSBMSUNFTlNFIGZpbGUgdGhhdCBhY2NvbXBhbmllZCB0aGlzIGNvZGUuCgogVGhpcyBjb2RlIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsIGJ1dCBXSVRIT1VUCiBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZiBNRVJDSEFOVEFCSUxJVFkgb3IKIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQogdmVyc2lvbiAyIGZvciBtb3JlIGRldGFpbHMgKGEgY29weSBpcyBpbmNsdWRlZCBpbiB0aGUgTElDRU5TRSBmaWxlIHRoYXQKIGFjY29tcGFuaWVkIHRoaXMgY29kZSkuCgogWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgdmVyc2lvbgogMiBhbG9uZyB3aXRoIHRoaXMgd29yazsgaWYgbm90LCB3cml0ZSB0byB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLAogSW5jLiwgNTEgRnJhbmtsaW4gU3QsIEZpZnRoIEZsb29yLCBCb3N0b24sIE1BIDAyMTEwLTEzMDEgVVNBLgoKIFBsZWFzZSBjb250YWN0IE9yYWNsZSwgNTAwIE9yYWNsZSBQYXJrd2F5LCBSZWR3b29kIFNob3JlcywgQ0EgOTQwNjUgVVNBCiBvciB2aXNpdCB3d3cub3JhY2xlLmNvbSBpZiB5b3UgbmVlZCBhZGRpdGlvbmFsIGluZm9ybWF0aW9uIG9yIGhhdmUgYW55CiBxdWVzdGlvbnMuCi0tPgoKPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDM4MCA0NjAiIGZpbGw9IiM1MDUwNTAiPgogIDxwYXRoCiAgICAgZD0iTSAzNDYsOCBIIDEwOCBDIDkwLDggNzUsMjMgNzUsNDEgdiAzMTYgYyAwLDE4IDE1LDMzIDMzLDMzIGggMjM4IGMgMTgsMCAzMywtMTUgMzMsLTMzIFYgNDEgQyAzNzksMjMgMzY0LDggMzQ2LDggWiBtIC04LDM0NCBIIDExNiBjIC0yLDAgLTMsLTEgLTMsLTMgViA0OSBjIDAsLTIgMSwtMyAzLC0zIGggMjIyIGMgMiwwIDMsMSAzLDMgdiAzMDAgaCAxMGUtNCBjIDAsMiAtMSwzIC0zLDMgeiIvPgogIDxwYXRoCiAgICAgZD0ibSAyOTAsMzg5IHYgMjYgaCAxMGUtNCBjIDAsMiAtMSwzIC0zLDMgSCA0OSBjIC0yLDAgLTMsLTEgLTMsLTMgViA5OSBjIDAsLTIgMSwtMyAzLC0zIGggMjcgdiAwIGwgLTVlLTQsLTM4IEggNDEgQyAyMyw1OCA4LDczIDgsOTEgdiAzMzIgYyAxMGUtNCwxOCAxNSwzMyAzMywzMyBoIDI1NCBjIDE4LDAgMzMsLTE1IDMzLC0zMyB2IC0zNCIvPgo8L3N2Zz4K" alt="Copy snippet"></button> <pre class="lang-java" data-language="java"><code class="language-java">    ScopedValue.runWhere(NAME, "duke1", () -&gt; doSomething());
</code></pre> </div> and code executed by another thread invokes: <div class="snippet-container">
<button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KCjwhLS0KIENvcHlyaWdodCAoYykgMjAyMSwgT3JhY2xlIGFuZC9vciBpdHMgYWZmaWxpYXRlcy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIERPIE5PVCBBTFRFUiBPUiBSRU1PVkUgQ09QWVJJR0hUIE5PVElDRVMgT1IgVEhJUyBGSUxFIEhFQURFUi4KCiBUaGlzIGNvZGUgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeSBpdAogdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSB2ZXJzaW9uIDIgb25seSwgYXMKIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLiAgT3JhY2xlIGRlc2lnbmF0ZXMgdGhpcwogcGFydGljdWxhciBmaWxlIGFzIHN1YmplY3QgdG8gdGhlICJDbGFzc3BhdGgiIGV4Y2VwdGlvbiBhcyBwcm92aWRlZAogYnkgT3JhY2xlIGluIHRoZSBMSUNFTlNFIGZpbGUgdGhhdCBhY2NvbXBhbmllZCB0aGlzIGNvZGUuCgogVGhpcyBjb2RlIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsIGJ1dCBXSVRIT1VUCiBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZiBNRVJDSEFOVEFCSUxJVFkgb3IKIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQogdmVyc2lvbiAyIGZvciBtb3JlIGRldGFpbHMgKGEgY29weSBpcyBpbmNsdWRlZCBpbiB0aGUgTElDRU5TRSBmaWxlIHRoYXQKIGFjY29tcGFuaWVkIHRoaXMgY29kZSkuCgogWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgdmVyc2lvbgogMiBhbG9uZyB3aXRoIHRoaXMgd29yazsgaWYgbm90LCB3cml0ZSB0byB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLAogSW5jLiwgNTEgRnJhbmtsaW4gU3QsIEZpZnRoIEZsb29yLCBCb3N0b24sIE1BIDAyMTEwLTEzMDEgVVNBLgoKIFBsZWFzZSBjb250YWN0IE9yYWNsZSwgNTAwIE9yYWNsZSBQYXJrd2F5LCBSZWR3b29kIFNob3JlcywgQ0EgOTQwNjUgVVNBCiBvciB2aXNpdCB3d3cub3JhY2xlLmNvbSBpZiB5b3UgbmVlZCBhZGRpdGlvbmFsIGluZm9ybWF0aW9uIG9yIGhhdmUgYW55CiBxdWVzdGlvbnMuCi0tPgoKPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDM4MCA0NjAiIGZpbGw9IiM1MDUwNTAiPgogIDxwYXRoCiAgICAgZD0iTSAzNDYsOCBIIDEwOCBDIDkwLDggNzUsMjMgNzUsNDEgdiAzMTYgYyAwLDE4IDE1LDMzIDMzLDMzIGggMjM4IGMgMTgsMCAzMywtMTUgMzMsLTMzIFYgNDEgQyAzNzksMjMgMzY0LDggMzQ2LDggWiBtIC04LDM0NCBIIDExNiBjIC0yLDAgLTMsLTEgLTMsLTMgViA0OSBjIDAsLTIgMSwtMyAzLC0zIGggMjIyIGMgMiwwIDMsMSAzLDMgdiAzMDAgaCAxMGUtNCBjIDAsMiAtMSwzIC0zLDMgeiIvPgogIDxwYXRoCiAgICAgZD0ibSAyOTAsMzg5IHYgMjYgaCAxMGUtNCBjIDAsMiAtMSwzIC0zLDMgSCA0OSBjIC0yLDAgLTMsLTEgLTMsLTMgViA5OSBjIDAsLTIgMSwtMyAzLC0zIGggMjcgdiAwIGwgLTVlLTQsLTM4IEggNDEgQyAyMyw1OCA4LDczIDgsOTEgdiAzMzIgYyAxMGUtNCwxOCAxNSwzMyAzMywzMyBoIDI1NCBjIDE4LDAgMzMsLTE1IDMzLC0zMyB2IC0zNCIvPgo8L3N2Zz4K" alt="Copy snippet"></button> <pre class="lang-java" data-language="java"><code class="language-java">    ScopedValue.runWhere(NAME, "duke2", () -&gt; doSomething());
</code></pre> </div> then code in <code>doSomething</code> (or any method that it calls) invoking <code>NAME.get()</code> will read the value "<code>duke1</code>" or "<code>duke2</code>", depending on which thread is executing. <h2 id="scoped-values-as-capabilities-heading">Scoped values as capabilities</h2> A <code>ScopedValue</code> object should be treated as a <em>capability</em> or a key to access its value when the <code>ScopedValue</code> is bound. Secure usage depends on access control (see <cite>The Java Virtual Machine Specification</cite>, Section <a href="https://docs.oracle.com/javase/specs/jvms/se21/html/jvms-5.html#jvms-5.4.4">5.4.4</a>) and taking care to not share the <code>ScopedValue</code> object. In many cases, a <code>
 ScopedValue</code> will be declared in a <code>final</code> and <code>static</code> field so that it is only accessible to code in a single class (or nest). <h2><a id="rebind">Rebinding</a></h2> The <code>ScopedValue</code> API allows a new binding to be established for <em>nested dynamic scopes</em>. This is known as <em>rebinding</em>. A <code>ScopedValue</code> that is bound to a value may be bound to a new value for the bounded execution of a new method. The unfolding execution of code executed by that method defines the nested dynamic scope. When the method completes, the value of the <code>ScopedValue</code> reverts to its previous value. <p> In the above example, suppose that code executed by <code>doSomething</code> binds <code>NAME</code> to a new value with: </p>
<div class="snippet-container">
<button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KCjwhLS0KIENvcHlyaWdodCAoYykgMjAyMSwgT3JhY2xlIGFuZC9vciBpdHMgYWZmaWxpYXRlcy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIERPIE5PVCBBTFRFUiBPUiBSRU1PVkUgQ09QWVJJR0hUIE5PVElDRVMgT1IgVEhJUyBGSUxFIEhFQURFUi4KCiBUaGlzIGNvZGUgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeSBpdAogdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSB2ZXJzaW9uIDIgb25seSwgYXMKIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLiAgT3JhY2xlIGRlc2lnbmF0ZXMgdGhpcwogcGFydGljdWxhciBmaWxlIGFzIHN1YmplY3QgdG8gdGhlICJDbGFzc3BhdGgiIGV4Y2VwdGlvbiBhcyBwcm92aWRlZAogYnkgT3JhY2xlIGluIHRoZSBMSUNFTlNFIGZpbGUgdGhhdCBhY2NvbXBhbmllZCB0aGlzIGNvZGUuCgogVGhpcyBjb2RlIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsIGJ1dCBXSVRIT1VUCiBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZiBNRVJDSEFOVEFCSUxJVFkgb3IKIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQogdmVyc2lvbiAyIGZvciBtb3JlIGRldGFpbHMgKGEgY29weSBpcyBpbmNsdWRlZCBpbiB0aGUgTElDRU5TRSBmaWxlIHRoYXQKIGFjY29tcGFuaWVkIHRoaXMgY29kZSkuCgogWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgdmVyc2lvbgogMiBhbG9uZyB3aXRoIHRoaXMgd29yazsgaWYgbm90LCB3cml0ZSB0byB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLAogSW5jLiwgNTEgRnJhbmtsaW4gU3QsIEZpZnRoIEZsb29yLCBCb3N0b24sIE1BIDAyMTEwLTEzMDEgVVNBLgoKIFBsZWFzZSBjb250YWN0IE9yYWNsZSwgNTAwIE9yYWNsZSBQYXJrd2F5LCBSZWR3b29kIFNob3JlcywgQ0EgOTQwNjUgVVNBCiBvciB2aXNpdCB3d3cub3JhY2xlLmNvbSBpZiB5b3UgbmVlZCBhZGRpdGlvbmFsIGluZm9ybWF0aW9uIG9yIGhhdmUgYW55CiBxdWVzdGlvbnMuCi0tPgoKPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDM4MCA0NjAiIGZpbGw9IiM1MDUwNTAiPgogIDxwYXRoCiAgICAgZD0iTSAzNDYsOCBIIDEwOCBDIDkwLDggNzUsMjMgNzUsNDEgdiAzMTYgYyAwLDE4IDE1LDMzIDMzLDMzIGggMjM4IGMgMTgsMCAzMywtMTUgMzMsLTMzIFYgNDEgQyAzNzksMjMgMzY0LDggMzQ2LDggWiBtIC04LDM0NCBIIDExNiBjIC0yLDAgLTMsLTEgLTMsLTMgViA0OSBjIDAsLTIgMSwtMyAzLC0zIGggMjIyIGMgMiwwIDMsMSAzLDMgdiAzMDAgaCAxMGUtNCBjIDAsMiAtMSwzIC0zLDMgeiIvPgogIDxwYXRoCiAgICAgZD0ibSAyOTAsMzg5IHYgMjYgaCAxMGUtNCBjIDAsMiAtMSwzIC0zLDMgSCA0OSBjIC0yLDAgLTMsLTEgLTMsLTMgViA5OSBjIDAsLTIgMSwtMyAzLC0zIGggMjcgdiAwIGwgLTVlLTQsLTM4IEggNDEgQyAyMyw1OCA4LDczIDgsOTEgdiAzMzIgYyAxMGUtNCwxOCAxNSwzMyAzMywzMyBoIDI1NCBjIDE4LDAgMzMsLTE1IDMzLC0zMyB2IC0zNCIvPgo8L3N2Zz4K" alt="Copy snippet"></button> <pre class="lang-java" data-language="java"><code class="language-java">    ScopedValue.runWhere(NAME, "duchess", () -&gt; doMore());
</code></pre> </div> Code executed directly or indirectly by <code>doMore()</code> that invokes <code>
 NAME.get()</code> will read the value "<code>duchess</code>". When <code>doMore()</code> completes then the value of <code>NAME</code> reverts to "<code>duke</code>". <h2><a id="inheritance">Inheritance</a></h2> <code>ScopedValue</code> supports sharing across threads. This sharing is limited to structured cases where child threads are started and terminate within the bounded period of execution by a parent thread. When using a <a href="../util/concurrent/structuredtaskscope" title="class in java.util.concurrent"><code>StructuredTaskScope</code></a><sup><a href="../util/concurrent/structuredtaskscope#preview-java.util.concurrent.StructuredTaskScope">PREVIEW</a></sup>, scoped value bindings are <em>captured</em> when creating a <code>StructuredTaskScope</code> and inherited by all threads started in that task scope with the <a href="../util/concurrent/structuredtaskscope#fork(java.util.concurrent.Callable)"><code>fork</code></a><sup><a href="../util/concurrent/structuredtaskscope#preview-java.util.concurrent.StructuredTaskScope">PREVIEW</a></sup> method. <p> A <code>ScopedValue</code> that is shared across threads requires that the value be an immutable object or for all access to the value to be appropriately synchronized. </p>
<p> In the following example, the <code>ScopedValue</code> <code>NAME</code> is bound to the value "<code>duke</code>" for the execution of a runnable operation. The code in the <code>
 run</code> method creates a <code>StructuredTaskScope</code> that forks three tasks. Code executed directly or indirectly by these threads running <code>childTask1()</code>, <code>childTask2()</code>, and <code>childTask3()</code> that invokes <code>NAME.get()</code> will read the value "<code>duke</code>". </p>
<div class="snippet-container">
<button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KCjwhLS0KIENvcHlyaWdodCAoYykgMjAyMSwgT3JhY2xlIGFuZC9vciBpdHMgYWZmaWxpYXRlcy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIERPIE5PVCBBTFRFUiBPUiBSRU1PVkUgQ09QWVJJR0hUIE5PVElDRVMgT1IgVEhJUyBGSUxFIEhFQURFUi4KCiBUaGlzIGNvZGUgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeSBpdAogdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSB2ZXJzaW9uIDIgb25seSwgYXMKIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLiAgT3JhY2xlIGRlc2lnbmF0ZXMgdGhpcwogcGFydGljdWxhciBmaWxlIGFzIHN1YmplY3QgdG8gdGhlICJDbGFzc3BhdGgiIGV4Y2VwdGlvbiBhcyBwcm92aWRlZAogYnkgT3JhY2xlIGluIHRoZSBMSUNFTlNFIGZpbGUgdGhhdCBhY2NvbXBhbmllZCB0aGlzIGNvZGUuCgogVGhpcyBjb2RlIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsIGJ1dCBXSVRIT1VUCiBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZiBNRVJDSEFOVEFCSUxJVFkgb3IKIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQogdmVyc2lvbiAyIGZvciBtb3JlIGRldGFpbHMgKGEgY29weSBpcyBpbmNsdWRlZCBpbiB0aGUgTElDRU5TRSBmaWxlIHRoYXQKIGFjY29tcGFuaWVkIHRoaXMgY29kZSkuCgogWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgdmVyc2lvbgogMiBhbG9uZyB3aXRoIHRoaXMgd29yazsgaWYgbm90LCB3cml0ZSB0byB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLAogSW5jLiwgNTEgRnJhbmtsaW4gU3QsIEZpZnRoIEZsb29yLCBCb3N0b24sIE1BIDAyMTEwLTEzMDEgVVNBLgoKIFBsZWFzZSBjb250YWN0IE9yYWNsZSwgNTAwIE9yYWNsZSBQYXJrd2F5LCBSZWR3b29kIFNob3JlcywgQ0EgOTQwNjUgVVNBCiBvciB2aXNpdCB3d3cub3JhY2xlLmNvbSBpZiB5b3UgbmVlZCBhZGRpdGlvbmFsIGluZm9ybWF0aW9uIG9yIGhhdmUgYW55CiBxdWVzdGlvbnMuCi0tPgoKPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDM4MCA0NjAiIGZpbGw9IiM1MDUwNTAiPgogIDxwYXRoCiAgICAgZD0iTSAzNDYsOCBIIDEwOCBDIDkwLDggNzUsMjMgNzUsNDEgdiAzMTYgYyAwLDE4IDE1LDMzIDMzLDMzIGggMjM4IGMgMTgsMCAzMywtMTUgMzMsLTMzIFYgNDEgQyAzNzksMjMgMzY0LDggMzQ2LDggWiBtIC04LDM0NCBIIDExNiBjIC0yLDAgLTMsLTEgLTMsLTMgViA0OSBjIDAsLTIgMSwtMyAzLC0zIGggMjIyIGMgMiwwIDMsMSAzLDMgdiAzMDAgaCAxMGUtNCBjIDAsMiAtMSwzIC0zLDMgeiIvPgogIDxwYXRoCiAgICAgZD0ibSAyOTAsMzg5IHYgMjYgaCAxMGUtNCBjIDAsMiAtMSwzIC0zLDMgSCA0OSBjIC0yLDAgLTMsLTEgLTMsLTMgViA5OSBjIDAsLTIgMSwtMyAzLC0zIGggMjcgdiAwIGwgLTVlLTQsLTM4IEggNDEgQyAyMyw1OCA4LDczIDgsOTEgdiAzMzIgYyAxMGUtNCwxOCAxNSwzMyAzMywzMyBoIDI1NCBjIDE4LDAgMzMsLTE1IDMzLC0zMyB2IC0zNCIvPgo8L3N2Zz4K" alt="Copy snippet"></button> <pre class="lang-java" data-language="java"><code class="language-java">    private static final ScopedValue&lt;String&gt; NAME = ScopedValue.newInstance();

    ScopedValue.runWhere(NAME, "duke", () -&gt; {
        try (var scope = new StructuredTaskScope&lt;String&gt;()) {

            scope.fork(() -&gt; childTask1());
            scope.fork(() -&gt; childTask2());
            scope.fork(() -&gt; childTask3());

            ...
         }
    });
</code></pre> </div> <p> Unless otherwise specified, passing a <code>null</code> argument to a method in this class will cause a <a href="nullpointerexception" title="class in java.lang"><code>NullPointerException</code></a> to be thrown.</p>
</div> <dl class="notes"> <dt>API Note:</dt> <dd>A <code>ScopedValue</code> should be preferred over a <a href="threadlocal" title="class in java.lang"><code>ThreadLocal</code></a> for cases where the goal is "one-way transmission" of data without using method parameters. While a <code>ThreadLocal</code> can be used to pass data to a method without using method parameters, it does suffer from a number of issues: <ol> <li> <code>ThreadLocal</code> does not prevent code in a faraway callee from <a href="threadlocal#set(T)">setting</a> a new value. </li>
<li> A <code>ThreadLocal</code> has an unbounded lifetime and thus continues to have a value after a method completes, unless explicitly <a href="threadlocal#remove()">removed</a>. </li>
<li> <a href="inheritablethreadlocal" title="class in java.lang">Inheritance</a> is expensive - the map of thread-locals to values must be copied when creating each child thread. </li>
</ol>
</dd> <dt>Implementation Note:</dt> <dd>Scoped values are designed to be used in fairly small numbers. <a href="#get()"><code>get()</code></a> initially performs a search through enclosing scopes to find a scoped value's innermost binding. It then caches the result of the search in a small thread-local cache. Subsequent invocations of <a href="#get()"><code>get()</code></a> for that scoped value will almost always be very fast. However, if a program has many scoped values that it uses cyclically, the cache hit rate will be low and performance will be poor. This design allows scoped-value inheritance by <a href="../util/concurrent/structuredtaskscope" title="class in java.util.concurrent"><code>StructuredTaskScope</code></a><sup><a href="../util/concurrent/structuredtaskscope#preview-java.util.concurrent.StructuredTaskScope">PREVIEW</a></sup> threads to be very fast: in essence, no more than copying a pointer, and leaving a scoped-value binding also requires little more than updating a pointer. <p>Because the scoped-value per-thread cache is small, clients should minimize the number of bound scoped values in use. For example, if it is necessary to pass a number of values in this way, it makes sense to create a record class to hold those values, and then bind a single <code>ScopedValue</code> to an instance of that record. </p>
<p>For this release, the reference implementation provides some system properties to tune the performance of scoped values. </p>
<p>The system property <code>java.lang.ScopedValue.cacheSize</code> controls the size of the (per-thread) scoped-value cache. This cache is crucial for the performance of scoped values. If it is too small, the runtime library will repeatedly need to scan for each <a href="#get()"><code>get()</code></a>. If it is too large, memory will be unnecessarily consumed. The default scoped-value cache size is 16 entries. It may be varied from 2 to 16 entries in size. <code>ScopedValue.cacheSize</code> must be an integer power of 2. </p>
<p>For example, you could use <code>-Djava.lang.ScopedValue.cacheSize=8</code>. </p>
<p>The other system property is <code>jdk.preserveScopedValueCache</code>. This property determines whether the per-thread scoped-value cache is preserved when a virtual thread is blocked. By default this property is set to <code>true</code>, meaning that every virtual thread preserves its scoped-value cache when blocked. Like <code>
 ScopedValue.cacheSize</code>, this is a space versus speed trade-off: in situations where many virtual threads are blocked most of the time, setting this property to <code>false</code> might result in a useful memory saving, but each virtual thread's scoped-value cache would have to be regenerated after a blocking operation.</p>
</dd> <dt>Since:</dt> <dd>21</dd> </dl> </section> <section class="summary"> <section class="nested-class-summary" id="nested-class-summary"> <h2>Nested Class Summary</h2>  <table class="summary-table three-column-summary">       <tr>
<th>Modifier and Type</th>
<th>Class</th>
<th>Description</th>
</tr>
<tr>
<td><code>static final class </code></td>
<td><code><a href="scopedvalue.carrier" class="type-name-link" title="class in java.lang">ScopedValue.Carrier</a><sup><a href="scopedvalue.carrier#preview-java.lang.ScopedValue.Carrier">PREVIEW</a></sup></code></td>
<td> <div class="block"><span class="preview-label">Preview.</span></div> <div class="block">A mapping of scoped values, as <em>keys</em>, to values.</div> </td>
</tr>
</table> </section><section class="method-summary" id="method-summary"> <h2>Method Summary</h2> <div id="method-summary-table">  <div id="method-summary-table.tabpanel" role="tabpanel"> <table class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">                               <tr>
<th>Modifier and Type</th>
<th>Method</th>
<th>Description</th>
</tr>
<tr>
<td><code>static &lt;T,<wbr>
R&gt; R</wbr></code></td>
<td><code><a href="#callWhere(java.lang.ScopedValue,T,java.util.concurrent.Callable)" class="member-name-link">callWhere</a><wbr>(<a href="scopedvalue" title="class in java.lang">ScopedValue</a><sup><a href="#preview-java.lang.ScopedValue">PREVIEW</a></sup>&lt;T&gt; key,
 T value,
 <a href="../util/concurrent/callable" title="interface in java.util.concurrent">Callable</a>&lt;? extends R&gt; op)</wbr></code></td>
<td> <div class="block">Calls a value-returning operation with a <code>ScopedValue</code> bound to a value in the current thread.</div> </td>
</tr>
<tr>
<td><code><a href="scopedvalue" title="type parameter in ScopedValue">T</a></code></td>
<td><code><a href="#get()" class="member-name-link">get</a>()</code></td>
<td> <div class="block">Returns the value of the scoped value if bound in the current thread.</div> </td>
</tr>
<tr>
<td><code>static &lt;T,<wbr>
R&gt; R</wbr></code></td>
<td><code><a href="#getWhere(java.lang.ScopedValue,T,java.util.function.Supplier)" class="member-name-link">getWhere</a><wbr>(<a href="scopedvalue" title="class in java.lang">ScopedValue</a><sup><a href="#preview-java.lang.ScopedValue">PREVIEW</a></sup>&lt;T&gt; key,
 T value,
 <a href="../util/function/supplier" title="interface in java.util.function">Supplier</a>&lt;? extends R&gt; op)</wbr></code></td>
<td> <div class="block">Invokes a supplier of results with a <code>ScopedValue</code> bound to a value in the current thread.</div> </td>
</tr>
<tr>
<td><code>boolean</code></td>
<td><code><a href="#isBound()" class="member-name-link">isBound</a>()</code></td>
<td> <div class="block">Returns <code>true</code> if this scoped value is bound in the current thread.</div> </td>
</tr>
<tr>
<td><code>static &lt;T&gt; <a href="scopedvalue" title="class in java.lang">ScopedValue</a><sup><a href="#preview-java.lang.ScopedValue">PREVIEW</a></sup><wbr>&lt;T&gt;</wbr></code></td>
<td><code><a href="#newInstance()" class="member-name-link">newInstance</a>()</code></td>
<td> <div class="block">Creates a scoped value that is initially unbound for all threads.</div> </td>
</tr>
<tr>
<td><code><a href="scopedvalue" title="type parameter in ScopedValue">T</a></code></td>
<td><code><a href="#orElse(T)" class="member-name-link">orElse</a><wbr>(<a href="scopedvalue" title="type parameter in ScopedValue">T</a> other)</wbr></code></td>
<td> <div class="block">Returns the value of this scoped value if bound in the current thread, otherwise returns <code>other</code>.</div> </td>
</tr>
<tr>
<td><code>&lt;X extends <a href="throwable" title="class in java.lang">Throwable</a>&gt;<br><a href="scopedvalue" title="type parameter in ScopedValue">T</a></code></td>
<td><code><a href="#orElseThrow(java.util.function.Supplier)" class="member-name-link">orElseThrow</a><wbr>(<a href="../util/function/supplier" title="interface in java.util.function">Supplier</a>&lt;? extends X&gt; exceptionSupplier)</wbr></code></td>
<td> <div class="block">Returns the value of this scoped value if bound in the current thread, otherwise throws an exception produced by the exception supplying function.</div> </td>
</tr>
<tr>
<td><code>static &lt;T&gt; void</code></td>
<td><code><a href="#runWhere(java.lang.ScopedValue,T,java.lang.Runnable)" class="member-name-link">runWhere</a><wbr>(<a href="scopedvalue" title="class in java.lang">ScopedValue</a><sup><a href="#preview-java.lang.ScopedValue">PREVIEW</a></sup>&lt;T&gt; key,
 T value,
 <a href="runnable" title="interface in java.lang">Runnable</a> op)</wbr></code></td>
<td> <div class="block">Run an operation with a <code>ScopedValue</code> bound to a value in the current thread.</div> </td>
</tr>
<tr>
<td><code>static &lt;T&gt; <a href="scopedvalue.carrier" title="class in java.lang">ScopedValue.Carrier</a><sup><a href="scopedvalue.carrier#preview-java.lang.ScopedValue.Carrier">PREVIEW</a></sup></code></td>
<td><code><a href="#where(java.lang.ScopedValue,T)" class="member-name-link">where</a><wbr>(<a href="scopedvalue" title="class in java.lang">ScopedValue</a><sup><a href="#preview-java.lang.ScopedValue">PREVIEW</a></sup>&lt;T&gt; key,
 T value)</wbr></code></td>
<td> <div class="block">Creates a new <code>Carrier</code> with a single mapping of a <code>ScopedValue</code> <em>key</em> to a value.</div> </td>
</tr>
</table> </div> </div> <div class="inherited-list"> <h3 id="methods-inherited-from-class-java.lang.Object">Methods declared in class java.lang.<a href="object" title="class in java.lang">Object</a>
</h3> <code><a href="object#clone()">clone</a>, <a href="object#equals(java.lang.Object)">equals</a>, <a href="object#finalize()">finalize</a>, <a href="object#getClass()">getClass</a>, <a href="object#hashCode()">hashCode</a>, <a href="object#notify()">notify</a>, <a href="object#notifyAll()">notifyAll</a>, <a href="object#toString()">toString</a>, <a href="object#wait()">wait</a>, <a href="object#wait(long)">wait</a>, <a href="object#wait(long,int)">wait</a></code>
</div> </section> </section> <section class="details"> <section class="method-details" id="method-detail"> <h2>Method Details</h2>  </section><section class="detail" id="where(java.lang.ScopedValue,T)"> <h3 id="where(java.lang.ScopedValue,java.lang.Object)">where</h3> <pre class="lang-java" data-language="java">public static &lt;T&gt; ScopedValue.CarrierPREVIEW where(ScopedValuePREVIEW&lt;T&gt; key, T value)</pre> <div class="block">Creates a new <code>Carrier</code> with a single mapping of a <code>ScopedValue</code> <em>key</em> to a value. The <code>Carrier</code> can be used to accumulate mappings so that an operation can be executed with all scoped values in the mapping bound to values. The following example runs an operation with <code>k1</code> bound (or rebound) to <code>v1</code>, and <code>k2</code> bound (or rebound) to <code>v2</code>. <div class="snippet-container">
<button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KCjwhLS0KIENvcHlyaWdodCAoYykgMjAyMSwgT3JhY2xlIGFuZC9vciBpdHMgYWZmaWxpYXRlcy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIERPIE5PVCBBTFRFUiBPUiBSRU1PVkUgQ09QWVJJR0hUIE5PVElDRVMgT1IgVEhJUyBGSUxFIEhFQURFUi4KCiBUaGlzIGNvZGUgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeSBpdAogdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSB2ZXJzaW9uIDIgb25seSwgYXMKIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLiAgT3JhY2xlIGRlc2lnbmF0ZXMgdGhpcwogcGFydGljdWxhciBmaWxlIGFzIHN1YmplY3QgdG8gdGhlICJDbGFzc3BhdGgiIGV4Y2VwdGlvbiBhcyBwcm92aWRlZAogYnkgT3JhY2xlIGluIHRoZSBMSUNFTlNFIGZpbGUgdGhhdCBhY2NvbXBhbmllZCB0aGlzIGNvZGUuCgogVGhpcyBjb2RlIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsIGJ1dCBXSVRIT1VUCiBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZiBNRVJDSEFOVEFCSUxJVFkgb3IKIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQogdmVyc2lvbiAyIGZvciBtb3JlIGRldGFpbHMgKGEgY29weSBpcyBpbmNsdWRlZCBpbiB0aGUgTElDRU5TRSBmaWxlIHRoYXQKIGFjY29tcGFuaWVkIHRoaXMgY29kZSkuCgogWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgdmVyc2lvbgogMiBhbG9uZyB3aXRoIHRoaXMgd29yazsgaWYgbm90LCB3cml0ZSB0byB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLAogSW5jLiwgNTEgRnJhbmtsaW4gU3QsIEZpZnRoIEZsb29yLCBCb3N0b24sIE1BIDAyMTEwLTEzMDEgVVNBLgoKIFBsZWFzZSBjb250YWN0IE9yYWNsZSwgNTAwIE9yYWNsZSBQYXJrd2F5LCBSZWR3b29kIFNob3JlcywgQ0EgOTQwNjUgVVNBCiBvciB2aXNpdCB3d3cub3JhY2xlLmNvbSBpZiB5b3UgbmVlZCBhZGRpdGlvbmFsIGluZm9ybWF0aW9uIG9yIGhhdmUgYW55CiBxdWVzdGlvbnMuCi0tPgoKPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDM4MCA0NjAiIGZpbGw9IiM1MDUwNTAiPgogIDxwYXRoCiAgICAgZD0iTSAzNDYsOCBIIDEwOCBDIDkwLDggNzUsMjMgNzUsNDEgdiAzMTYgYyAwLDE4IDE1LDMzIDMzLDMzIGggMjM4IGMgMTgsMCAzMywtMTUgMzMsLTMzIFYgNDEgQyAzNzksMjMgMzY0LDggMzQ2LDggWiBtIC04LDM0NCBIIDExNiBjIC0yLDAgLTMsLTEgLTMsLTMgViA0OSBjIDAsLTIgMSwtMyAzLC0zIGggMjIyIGMgMiwwIDMsMSAzLDMgdiAzMDAgaCAxMGUtNCBjIDAsMiAtMSwzIC0zLDMgeiIvPgogIDxwYXRoCiAgICAgZD0ibSAyOTAsMzg5IHYgMjYgaCAxMGUtNCBjIDAsMiAtMSwzIC0zLDMgSCA0OSBjIC0yLDAgLTMsLTEgLTMsLTMgViA5OSBjIDAsLTIgMSwtMyAzLC0zIGggMjcgdiAwIGwgLTVlLTQsLTM4IEggNDEgQyAyMyw1OCA4LDczIDgsOTEgdiAzMzIgYyAxMGUtNCwxOCAxNSwzMyAzMywzMyBoIDI1NCBjIDE4LDAgMzMsLTE1IDMzLC0zMyB2IC0zNCIvPgo8L3N2Zz4K" alt="Copy snippet"></button> <pre class="lang-java" data-language="java"><code class="language-java">    ScopedValue.where(k1, v1).where(k2, v2).<a href="scopedvalue.carrier#run(java.lang.Runnable)"><code>run</code></a>(() -&gt; ... );
</code></pre> </div> </div> <dl class="notes"> <dt>Type Parameters:</dt> <dd>
<code>T</code> - the type of the value</dd> <dt>Parameters:</dt> <dd>
<code>key</code> - the <code>ScopedValue</code> key</dd> <dd>
<code>value</code> - the value, can be <code>null</code>
</dd> <dt>Returns:</dt> <dd>a new <code>Carrier</code> with a single mapping</dd> </dl> </section><section class="detail" id="callWhere(java.lang.ScopedValue,T,java.util.concurrent.Callable)"> <h3 id="callWhere(java.lang.ScopedValue,java.lang.Object,java.util.concurrent.Callable)">callWhere</h3> <pre class="lang-java" data-language="java">public static &lt;T, R&gt; R callWhere(ScopedValuePREVIEW&lt;T&gt; key, T value, Callable&lt;? extends R&gt; op) throws Exception</pre> <div class="block">Calls a value-returning operation with a <code>ScopedValue</code> bound to a value in the current thread. When the operation completes (normally or with an exception), the <code>ScopedValue</code> will revert to being unbound, or revert to its previous value when previously bound, in the current thread. If <code>op</code> completes with an exception then it propagated by this method. <p> Scoped values are intended to be used in a <em>structured manner</em>. If code invoked directly or indirectly by the operation creates a <a href="../util/concurrent/structuredtaskscope" title="class in java.util.concurrent"><code>StructuredTaskScope</code></a><sup><a href="../util/concurrent/structuredtaskscope#preview-java.util.concurrent.StructuredTaskScope">PREVIEW</a></sup> but does not <a href="../util/concurrent/structuredtaskscope#close()">close</a><sup><a href="../util/concurrent/structuredtaskscope#preview-java.util.concurrent.StructuredTaskScope">PREVIEW</a></sup> it, then it is detected as a <em>structure violation</em> when the operation completes (normally or with an exception). In that case, the underlying construct of the <code>StructuredTaskScope</code> is closed and <a href="../util/concurrent/structureviolationexception" title="class in java.util.concurrent"><code>StructureViolationException</code></a><sup><a href="../util/concurrent/structureviolationexception#preview-java.util.concurrent.StructureViolationException">PREVIEW</a></sup> is thrown.</p>
</div> <dl class="notes"> <dt>Implementation Note:</dt> <dd>This method is implemented to be equivalent to: <div class="snippet-container">
<button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KCjwhLS0KIENvcHlyaWdodCAoYykgMjAyMSwgT3JhY2xlIGFuZC9vciBpdHMgYWZmaWxpYXRlcy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIERPIE5PVCBBTFRFUiBPUiBSRU1PVkUgQ09QWVJJR0hUIE5PVElDRVMgT1IgVEhJUyBGSUxFIEhFQURFUi4KCiBUaGlzIGNvZGUgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeSBpdAogdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSB2ZXJzaW9uIDIgb25seSwgYXMKIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLiAgT3JhY2xlIGRlc2lnbmF0ZXMgdGhpcwogcGFydGljdWxhciBmaWxlIGFzIHN1YmplY3QgdG8gdGhlICJDbGFzc3BhdGgiIGV4Y2VwdGlvbiBhcyBwcm92aWRlZAogYnkgT3JhY2xlIGluIHRoZSBMSUNFTlNFIGZpbGUgdGhhdCBhY2NvbXBhbmllZCB0aGlzIGNvZGUuCgogVGhpcyBjb2RlIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsIGJ1dCBXSVRIT1VUCiBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZiBNRVJDSEFOVEFCSUxJVFkgb3IKIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQogdmVyc2lvbiAyIGZvciBtb3JlIGRldGFpbHMgKGEgY29weSBpcyBpbmNsdWRlZCBpbiB0aGUgTElDRU5TRSBmaWxlIHRoYXQKIGFjY29tcGFuaWVkIHRoaXMgY29kZSkuCgogWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgdmVyc2lvbgogMiBhbG9uZyB3aXRoIHRoaXMgd29yazsgaWYgbm90LCB3cml0ZSB0byB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLAogSW5jLiwgNTEgRnJhbmtsaW4gU3QsIEZpZnRoIEZsb29yLCBCb3N0b24sIE1BIDAyMTEwLTEzMDEgVVNBLgoKIFBsZWFzZSBjb250YWN0IE9yYWNsZSwgNTAwIE9yYWNsZSBQYXJrd2F5LCBSZWR3b29kIFNob3JlcywgQ0EgOTQwNjUgVVNBCiBvciB2aXNpdCB3d3cub3JhY2xlLmNvbSBpZiB5b3UgbmVlZCBhZGRpdGlvbmFsIGluZm9ybWF0aW9uIG9yIGhhdmUgYW55CiBxdWVzdGlvbnMuCi0tPgoKPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDM4MCA0NjAiIGZpbGw9IiM1MDUwNTAiPgogIDxwYXRoCiAgICAgZD0iTSAzNDYsOCBIIDEwOCBDIDkwLDggNzUsMjMgNzUsNDEgdiAzMTYgYyAwLDE4IDE1LDMzIDMzLDMzIGggMjM4IGMgMTgsMCAzMywtMTUgMzMsLTMzIFYgNDEgQyAzNzksMjMgMzY0LDggMzQ2LDggWiBtIC04LDM0NCBIIDExNiBjIC0yLDAgLTMsLTEgLTMsLTMgViA0OSBjIDAsLTIgMSwtMyAzLC0zIGggMjIyIGMgMiwwIDMsMSAzLDMgdiAzMDAgaCAxMGUtNCBjIDAsMiAtMSwzIC0zLDMgeiIvPgogIDxwYXRoCiAgICAgZD0ibSAyOTAsMzg5IHYgMjYgaCAxMGUtNCBjIDAsMiAtMSwzIC0zLDMgSCA0OSBjIC0yLDAgLTMsLTEgLTMsLTMgViA5OSBjIDAsLTIgMSwtMyAzLC0zIGggMjcgdiAwIGwgLTVlLTQsLTM4IEggNDEgQyAyMyw1OCA4LDczIDgsOTEgdiAzMzIgYyAxMGUtNCwxOCAxNSwzMyAzMywzMyBoIDI1NCBjIDE4LDAgMzMsLTE1IDMzLC0zMyB2IC0zNCIvPgo8L3N2Zz4K" alt="Copy snippet"></button> <pre class="lang-java" data-language="java"><code class="language-java">    ScopedValue.where(key, value).<a href="scopedvalue.carrier#call(java.util.concurrent.Callable)"><code>call</code></a>(op);
</code></pre> </div> </dd> <dt>Type Parameters:</dt> <dd>
<code>T</code> - the type of the value</dd> <dd>
<code>R</code> - the result type</dd> <dt>Parameters:</dt> <dd>
<code>key</code> - the <code>ScopedValue</code> key</dd> <dd>
<code>value</code> - the value, can be <code>null</code>
</dd> <dd>
<code>op</code> - the operation to call</dd> <dt>Returns:</dt> <dd>the result</dd> <dt>Throws:</dt> <dd>
<code><a href="../util/concurrent/structureviolationexception" title="class in java.util.concurrent">StructureViolationException</a><sup><a href="../util/concurrent/structureviolationexception#preview-java.util.concurrent.StructureViolationException">PREVIEW</a></sup></code> - if a structure violation is detected</dd> <dd>
<code><a href="exception" title="class in java.lang">Exception</a></code> - if the operation completes with an exception</dd> </dl> </section><section class="detail" id="getWhere(java.lang.ScopedValue,T,java.util.function.Supplier)"> <h3 id="getWhere(java.lang.ScopedValue,java.lang.Object,java.util.function.Supplier)">getWhere</h3> <pre class="lang-java" data-language="java">public static &lt;T, R&gt; R getWhere(ScopedValuePREVIEW&lt;T&gt; key, T value, Supplier&lt;? extends R&gt; op)</pre> <div class="block">Invokes a supplier of results with a <code>ScopedValue</code> bound to a value in the current thread. When the operation completes (normally or with an exception), the <code>ScopedValue</code> will revert to being unbound, or revert to its previous value when previously bound, in the current thread. If <code>op</code> completes with an exception then it propagated by this method. <p> Scoped values are intended to be used in a <em>structured manner</em>. If code invoked directly or indirectly by the operation creates a <a href="../util/concurrent/structuredtaskscope" title="class in java.util.concurrent"><code>StructuredTaskScope</code></a><sup><a href="../util/concurrent/structuredtaskscope#preview-java.util.concurrent.StructuredTaskScope">PREVIEW</a></sup> but does not <a href="../util/concurrent/structuredtaskscope#close()">close</a><sup><a href="../util/concurrent/structuredtaskscope#preview-java.util.concurrent.StructuredTaskScope">PREVIEW</a></sup> it, then it is detected as a <em>structure violation</em> when the operation completes (normally or with an exception). In that case, the underlying construct of the <code>StructuredTaskScope</code> is closed and <a href="../util/concurrent/structureviolationexception" title="class in java.util.concurrent"><code>StructureViolationException</code></a><sup><a href="../util/concurrent/structureviolationexception#preview-java.util.concurrent.StructureViolationException">PREVIEW</a></sup> is thrown.</p>
</div> <dl class="notes"> <dt>Implementation Note:</dt> <dd>This method is implemented to be equivalent to: <div class="snippet-container">
<button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KCjwhLS0KIENvcHlyaWdodCAoYykgMjAyMSwgT3JhY2xlIGFuZC9vciBpdHMgYWZmaWxpYXRlcy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIERPIE5PVCBBTFRFUiBPUiBSRU1PVkUgQ09QWVJJR0hUIE5PVElDRVMgT1IgVEhJUyBGSUxFIEhFQURFUi4KCiBUaGlzIGNvZGUgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeSBpdAogdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSB2ZXJzaW9uIDIgb25seSwgYXMKIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLiAgT3JhY2xlIGRlc2lnbmF0ZXMgdGhpcwogcGFydGljdWxhciBmaWxlIGFzIHN1YmplY3QgdG8gdGhlICJDbGFzc3BhdGgiIGV4Y2VwdGlvbiBhcyBwcm92aWRlZAogYnkgT3JhY2xlIGluIHRoZSBMSUNFTlNFIGZpbGUgdGhhdCBhY2NvbXBhbmllZCB0aGlzIGNvZGUuCgogVGhpcyBjb2RlIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsIGJ1dCBXSVRIT1VUCiBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZiBNRVJDSEFOVEFCSUxJVFkgb3IKIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQogdmVyc2lvbiAyIGZvciBtb3JlIGRldGFpbHMgKGEgY29weSBpcyBpbmNsdWRlZCBpbiB0aGUgTElDRU5TRSBmaWxlIHRoYXQKIGFjY29tcGFuaWVkIHRoaXMgY29kZSkuCgogWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgdmVyc2lvbgogMiBhbG9uZyB3aXRoIHRoaXMgd29yazsgaWYgbm90LCB3cml0ZSB0byB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLAogSW5jLiwgNTEgRnJhbmtsaW4gU3QsIEZpZnRoIEZsb29yLCBCb3N0b24sIE1BIDAyMTEwLTEzMDEgVVNBLgoKIFBsZWFzZSBjb250YWN0IE9yYWNsZSwgNTAwIE9yYWNsZSBQYXJrd2F5LCBSZWR3b29kIFNob3JlcywgQ0EgOTQwNjUgVVNBCiBvciB2aXNpdCB3d3cub3JhY2xlLmNvbSBpZiB5b3UgbmVlZCBhZGRpdGlvbmFsIGluZm9ybWF0aW9uIG9yIGhhdmUgYW55CiBxdWVzdGlvbnMuCi0tPgoKPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDM4MCA0NjAiIGZpbGw9IiM1MDUwNTAiPgogIDxwYXRoCiAgICAgZD0iTSAzNDYsOCBIIDEwOCBDIDkwLDggNzUsMjMgNzUsNDEgdiAzMTYgYyAwLDE4IDE1LDMzIDMzLDMzIGggMjM4IGMgMTgsMCAzMywtMTUgMzMsLTMzIFYgNDEgQyAzNzksMjMgMzY0LDggMzQ2LDggWiBtIC04LDM0NCBIIDExNiBjIC0yLDAgLTMsLTEgLTMsLTMgViA0OSBjIDAsLTIgMSwtMyAzLC0zIGggMjIyIGMgMiwwIDMsMSAzLDMgdiAzMDAgaCAxMGUtNCBjIDAsMiAtMSwzIC0zLDMgeiIvPgogIDxwYXRoCiAgICAgZD0ibSAyOTAsMzg5IHYgMjYgaCAxMGUtNCBjIDAsMiAtMSwzIC0zLDMgSCA0OSBjIC0yLDAgLTMsLTEgLTMsLTMgViA5OSBjIDAsLTIgMSwtMyAzLC0zIGggMjcgdiAwIGwgLTVlLTQsLTM4IEggNDEgQyAyMyw1OCA4LDczIDgsOTEgdiAzMzIgYyAxMGUtNCwxOCAxNSwzMyAzMywzMyBoIDI1NCBjIDE4LDAgMzMsLTE1IDMzLC0zMyB2IC0zNCIvPgo8L3N2Zz4K" alt="Copy snippet"></button> <pre class="lang-java" data-language="java"><code class="language-java">    ScopedValue.where(key, value).<a href="scopedvalue.carrier#get(java.util.function.Supplier)"><code>get</code></a>(op);
</code></pre> </div> </dd> <dt>Type Parameters:</dt> <dd>
<code>T</code> - the type of the value</dd> <dd>
<code>R</code> - the result type</dd> <dt>Parameters:</dt> <dd>
<code>key</code> - the <code>ScopedValue</code> key</dd> <dd>
<code>value</code> - the value, can be <code>null</code>
</dd> <dd>
<code>op</code> - the operation to call</dd> <dt>Returns:</dt> <dd>the result</dd> <dt>Throws:</dt> <dd>
<code><a href="../util/concurrent/structureviolationexception" title="class in java.util.concurrent">StructureViolationException</a><sup><a href="../util/concurrent/structureviolationexception#preview-java.util.concurrent.StructureViolationException">PREVIEW</a></sup></code> - if a structure violation is detected</dd> </dl> </section><section class="detail" id="runWhere(java.lang.ScopedValue,T,java.lang.Runnable)"> <h3 id="runWhere(java.lang.ScopedValue,java.lang.Object,java.lang.Runnable)">runWhere</h3> <pre class="lang-java" data-language="java">public static &lt;T&gt; void runWhere(ScopedValuePREVIEW&lt;T&gt; key, T value, Runnable op)</pre> <div class="block">Run an operation with a <code>ScopedValue</code> bound to a value in the current thread. When the operation completes (normally or with an exception), the <code>ScopedValue</code> will revert to being unbound, or revert to its previous value when previously bound, in the current thread. If <code>op</code> completes with an exception then it propagated by this method. <p> Scoped values are intended to be used in a <em>structured manner</em>. If code invoked directly or indirectly by the operation creates a <a href="../util/concurrent/structuredtaskscope" title="class in java.util.concurrent"><code>StructuredTaskScope</code></a><sup><a href="../util/concurrent/structuredtaskscope#preview-java.util.concurrent.StructuredTaskScope">PREVIEW</a></sup> but does not <a href="../util/concurrent/structuredtaskscope#close()">close</a><sup><a href="../util/concurrent/structuredtaskscope#preview-java.util.concurrent.StructuredTaskScope">PREVIEW</a></sup> it, then it is detected as a <em>structure violation</em> when the operation completes (normally or with an exception). In that case, the underlying construct of the <code>StructuredTaskScope</code> is closed and <a href="../util/concurrent/structureviolationexception" title="class in java.util.concurrent"><code>StructureViolationException</code></a><sup><a href="../util/concurrent/structureviolationexception#preview-java.util.concurrent.StructureViolationException">PREVIEW</a></sup> is thrown.</p>
</div> <dl class="notes"> <dt>Implementation Note:</dt> <dd>This method is implemented to be equivalent to: <div class="snippet-container">
<button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KCjwhLS0KIENvcHlyaWdodCAoYykgMjAyMSwgT3JhY2xlIGFuZC9vciBpdHMgYWZmaWxpYXRlcy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIERPIE5PVCBBTFRFUiBPUiBSRU1PVkUgQ09QWVJJR0hUIE5PVElDRVMgT1IgVEhJUyBGSUxFIEhFQURFUi4KCiBUaGlzIGNvZGUgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeSBpdAogdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSB2ZXJzaW9uIDIgb25seSwgYXMKIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLiAgT3JhY2xlIGRlc2lnbmF0ZXMgdGhpcwogcGFydGljdWxhciBmaWxlIGFzIHN1YmplY3QgdG8gdGhlICJDbGFzc3BhdGgiIGV4Y2VwdGlvbiBhcyBwcm92aWRlZAogYnkgT3JhY2xlIGluIHRoZSBMSUNFTlNFIGZpbGUgdGhhdCBhY2NvbXBhbmllZCB0aGlzIGNvZGUuCgogVGhpcyBjb2RlIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsIGJ1dCBXSVRIT1VUCiBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZiBNRVJDSEFOVEFCSUxJVFkgb3IKIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQogdmVyc2lvbiAyIGZvciBtb3JlIGRldGFpbHMgKGEgY29weSBpcyBpbmNsdWRlZCBpbiB0aGUgTElDRU5TRSBmaWxlIHRoYXQKIGFjY29tcGFuaWVkIHRoaXMgY29kZSkuCgogWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgdmVyc2lvbgogMiBhbG9uZyB3aXRoIHRoaXMgd29yazsgaWYgbm90LCB3cml0ZSB0byB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLAogSW5jLiwgNTEgRnJhbmtsaW4gU3QsIEZpZnRoIEZsb29yLCBCb3N0b24sIE1BIDAyMTEwLTEzMDEgVVNBLgoKIFBsZWFzZSBjb250YWN0IE9yYWNsZSwgNTAwIE9yYWNsZSBQYXJrd2F5LCBSZWR3b29kIFNob3JlcywgQ0EgOTQwNjUgVVNBCiBvciB2aXNpdCB3d3cub3JhY2xlLmNvbSBpZiB5b3UgbmVlZCBhZGRpdGlvbmFsIGluZm9ybWF0aW9uIG9yIGhhdmUgYW55CiBxdWVzdGlvbnMuCi0tPgoKPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDM4MCA0NjAiIGZpbGw9IiM1MDUwNTAiPgogIDxwYXRoCiAgICAgZD0iTSAzNDYsOCBIIDEwOCBDIDkwLDggNzUsMjMgNzUsNDEgdiAzMTYgYyAwLDE4IDE1LDMzIDMzLDMzIGggMjM4IGMgMTgsMCAzMywtMTUgMzMsLTMzIFYgNDEgQyAzNzksMjMgMzY0LDggMzQ2LDggWiBtIC04LDM0NCBIIDExNiBjIC0yLDAgLTMsLTEgLTMsLTMgViA0OSBjIDAsLTIgMSwtMyAzLC0zIGggMjIyIGMgMiwwIDMsMSAzLDMgdiAzMDAgaCAxMGUtNCBjIDAsMiAtMSwzIC0zLDMgeiIvPgogIDxwYXRoCiAgICAgZD0ibSAyOTAsMzg5IHYgMjYgaCAxMGUtNCBjIDAsMiAtMSwzIC0zLDMgSCA0OSBjIC0yLDAgLTMsLTEgLTMsLTMgViA5OSBjIDAsLTIgMSwtMyAzLC0zIGggMjcgdiAwIGwgLTVlLTQsLTM4IEggNDEgQyAyMyw1OCA4LDczIDgsOTEgdiAzMzIgYyAxMGUtNCwxOCAxNSwzMyAzMywzMyBoIDI1NCBjIDE4LDAgMzMsLTE1IDMzLC0zMyB2IC0zNCIvPgo8L3N2Zz4K" alt="Copy snippet"></button> <pre class="lang-java" data-language="java"><code class="language-java">    ScopedValue.where(key, value).<a href="scopedvalue.carrier#run(java.lang.Runnable)"><code>run</code></a>(op);
</code></pre> </div> </dd> <dt>Type Parameters:</dt> <dd>
<code>T</code> - the type of the value</dd> <dt>Parameters:</dt> <dd>
<code>key</code> - the <code>ScopedValue</code> key</dd> <dd>
<code>value</code> - the value, can be <code>null</code>
</dd> <dd>
<code>op</code> - the operation to call</dd> <dt>Throws:</dt> <dd>
<code><a href="../util/concurrent/structureviolationexception" title="class in java.util.concurrent">StructureViolationException</a><sup><a href="../util/concurrent/structureviolationexception#preview-java.util.concurrent.StructureViolationException">PREVIEW</a></sup></code> - if a structure violation is detected</dd> </dl> </section><section class="detail" id="newInstance()"> <h3>newInstance</h3> <pre class="lang-java" data-language="java">public static &lt;T&gt; ScopedValuePREVIEW&lt;T&gt; newInstance()</pre> <div class="block">Creates a scoped value that is initially unbound for all threads.</div> <dl class="notes"> <dt>Type Parameters:</dt> <dd>
<code>T</code> - the type of the value</dd> <dt>Returns:</dt> <dd>a new <code>ScopedValue</code>
</dd> </dl> </section><section class="detail" id="get()"> <h3>get</h3> <pre class="lang-java" data-language="java">public T get()</pre> <div class="block">Returns the value of the scoped value if bound in the current thread.</div> <dl class="notes"> <dt>Returns:</dt> <dd>the value of the scoped value if bound in the current thread</dd> <dt>Throws:</dt> <dd>
<code><a href="../util/nosuchelementexception" title="class in java.util">NoSuchElementException</a></code> - if the scoped value is not bound</dd> </dl> </section><section class="detail" id="isBound()"> <h3>isBound</h3> <pre class="lang-java" data-language="java">public boolean isBound()</pre> <div class="block">Returns <code>true</code> if this scoped value is bound in the current thread.</div> <dl class="notes"> <dt>Returns:</dt> <dd>
<code>true</code> if this scoped value is bound in the current thread</dd> </dl> </section><section class="detail" id="orElse(T)"> <h3 id="orElse(java.lang.Object)">orElse</h3> <pre class="lang-java" data-language="java">public T orElse(T other)</pre> <div class="block">Returns the value of this scoped value if bound in the current thread, otherwise returns <code>other</code>.</div> <dl class="notes"> <dt>Parameters:</dt> <dd>
<code>other</code> - the value to return if not bound, can be <code>null</code>
</dd> <dt>Returns:</dt> <dd>the value of the scoped value if bound, otherwise <code>other</code>
</dd> </dl> </section><section class="detail" id="orElseThrow(java.util.function.Supplier)"> <h3>orElseThrow</h3> <pre class="lang-java" data-language="java">public &lt;X extends Throwable&gt; T orElseThrow(Supplier&lt;? extends X&gt; exceptionSupplier) throws X</pre> <div class="block">Returns the value of this scoped value if bound in the current thread, otherwise throws an exception produced by the exception supplying function.</div> <dl class="notes"> <dt>Type Parameters:</dt> <dd>
<code>X</code> - the type of the exception that may be thrown</dd> <dt>Parameters:</dt> <dd>
<code>exceptionSupplier</code> - the supplying function that produces the exception to throw</dd> <dt>Returns:</dt> <dd>the value of the scoped value if bound in the current thread</dd> <dt>Throws:</dt> <dd>
<code>X</code> - if the scoped value is not bound in the current thread</dd> </dl> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    © 1993, 2023, Oracle and/or its affiliates. All rights reserved.<br>Documentation extracted from Debian's OpenJDK Development Kit package.<br>Licensed under the GNU General Public License, version 2, with the Classpath Exception.<br>Various third party code in OpenJDK is licensed under different licenses (see Debian package).<br>Java and OpenJDK are trademarks or registered trademarks of Oracle and/or its affiliates.<br>
    <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/ScopedValue.html" class="_attribution-link">https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/ScopedValue.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
