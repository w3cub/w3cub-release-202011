
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>C &#47; C++ Rules - Bazel 7.0 - W3cubDocs</title>
  
  <meta name="description" content=" Name; required ">
  <meta name="keywords" content="c, c++, rules, bazel, bazel~7.0">
  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/bazel~7.0/c-cpp.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-c8f743fc70bb84079c3cf4b71f5f99835529659c30689b2fd6193651a680f383ef1d96896f8966c7ca8a0160ffd557685bb8ad12820ec6002d60143812238086.css">
  <script type="text/javascript" src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js"></script>
  <script src="/json/bazel~7.0.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/bazel~7.0/" class="_nav-link" title="" style="margin-left:0;">Bazel 7.0</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _bazel">
				
				
<article class="devsite-article">  <h1 class="devsite-page-title" tabindex="-1">C / C++ Rules</h1> <div class="devsite-page-title-meta"><devsite-view-release-notes></devsite-view-release-notes></div>  <div class="devsite-article-body clearfix
  ">     <h2 id="rules" data-text="Rules" tabindex="-1">Rules</h2> <ul> <li> <a href="#cc_binary"> cc_binary </a> </li> <li> <a href="#cc_import"> cc_import </a> </li> <li> <a href="#cc_library"> cc_library </a> </li> <li> <a href="#cc_proto_library"> cc_proto_library </a> </li> <li> <a href="#cc_shared_library"> cc_shared_library </a> </li> <li> <a href="#fdo_prefetch_hints"> fdo_prefetch_hints </a> </li> <li> <a href="#fdo_profile"> fdo_profile </a> </li> <li> <a href="#memprof_profile"> memprof_profile </a> </li> <li> <a href="#propeller_optimize"> propeller_optimize </a> </li> <li> <a href="#cc_test"> cc_test </a> </li> <li> <a href="#cc_toolchain"> cc_toolchain </a> </li> <li> <a href="#cc_toolchain_suite"> cc_toolchain_suite </a> </li> </ul> <h2 id="cc_binary" data-text="     cc_binary   " tabindex="-1"> cc_binary </h2>  <pre class="rule-signature" translate="no" dir="ltr">cc_binary(<a href="#cc_binary.name">name</a>, <a href="#cc_binary.deps">deps</a>, <a href="#cc_binary.srcs">srcs</a>, <a href="common-definitions#typical.data">data</a>, <a href="#cc_binary.additional_linker_inputs">additional_linker_inputs</a>, <a href="common-definitions#binary.args">args</a>, <a href="common-definitions#common.compatible_with">compatible_with</a>, <a href="#cc_binary.copts">copts</a>, <a href="#cc_binary.defines">defines</a>, <a href="common-definitions#common.deprecation">deprecation</a>, <a href="common-definitions#common.distribs">distribs</a>, <a href="common-definitions#binary.env">env</a>, <a href="common-definitions#common.exec_compatible_with">exec_compatible_with</a>, <a href="common-definitions#common.exec_properties">exec_properties</a>, <a href="common-definitions#common.features">features</a>, <a href="#cc_binary.includes">includes</a>, <a href="common-definitions#typical.licenses">licenses</a>, <a href="#cc_binary.link_extra_lib">link_extra_lib</a>, <a href="#cc_binary.linkopts">linkopts</a>, <a href="#cc_binary.linkshared">linkshared</a>, <a href="#cc_binary.linkstatic">linkstatic</a>, <a href="#cc_binary.local_defines">local_defines</a>, <a href="#cc_binary.malloc">malloc</a>, <a href="#cc_binary.nocopts">nocopts</a>, <a href="common-definitions#binary.output_licenses">output_licenses</a>, <a href="common-definitions#common.restricted_to">restricted_to</a>, <a href="#cc_binary.stamp">stamp</a>, <a href="common-definitions#common.tags">tags</a>, <a href="common-definitions#common.target_compatible_with">target_compatible_with</a>, <a href="common-definitions#common.testonly">testonly</a>, <a href="common-definitions#common.toolchains">toolchains</a>, <a href="common-definitions#common.visibility">visibility</a>, <a href="#cc_binary.win_def_file">win_def_file</a>)</pre> <h4 id="cc_binary_implicit_outputs" data-text="Implicit output targets" tabindex="-1">Implicit output targets</h4> <ul> <li>
<code translate="no" dir="ltr"><var translate="no">name</var>.stripped</code> (only built if explicitly requested): A stripped version of the binary. <code translate="no" dir="ltr">strip -g</code> is run on the binary to remove debug symbols. Additional strip options can be provided on the command line using <code translate="no" dir="ltr">--stripopt=-foo</code>. This output is only built if explicitly requested.</li> <li>
<code translate="no" dir="ltr"><var translate="no">name</var>.dwp</code> (only built if explicitly requested): If <a href="https://gcc.gnu.org/wiki/DebugFission">Fission</a> is enabled: a debug information package file suitable for debugging remotely deployed binaries. Else: an empty file.</li> </ul> <h3 id="cc_binary_args" data-text="Arguments" tabindex="-1">Arguments</h3> <table class="table table-condensed table-bordered table-params"> <colgroup> <col class="col-param"> <col class="param-description"> </colgroup> <thead> <tr> <th colspan="2">Attributes</th> </tr> </thead> <tbody> <tr> <td id="cc_binary.name"><code translate="no" dir="ltr">name</code></td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels#target-names">Name</a>; required</p> <p>A unique name for this target.</p> </td> </tr> <tr> <td id="cc_binary.deps"> <code translate="no" dir="ltr">deps</code> </td> <td> <p>List of <a href="https://bazel.build/versions/7.0.0/concepts/labels">labels</a>; default is <code translate="no" dir="ltr">[]</code></p> The list of other libraries to be linked in to the binary target. <p>These can be <code translate="no" dir="ltr">cc_library</code> or <code translate="no" dir="ltr">objc_library</code> targets.</p> </td> </tr> <tr> <td id="cc_binary.srcs"> <code translate="no" dir="ltr">srcs</code> </td> <td> <p>List of <a href="https://bazel.build/versions/7.0.0/concepts/labels">labels</a>; default is <code translate="no" dir="ltr">[]</code></p> The list of C and C++ files that are processed to create the target. These are C/C++ source and header files, either non-generated (normal source code) or generated. <p>All <code translate="no" dir="ltr">.cc</code>, <code translate="no" dir="ltr">.c</code>, and <code translate="no" dir="ltr">.cpp</code> files will be compiled. These might be generated files: if a named file is in the <code translate="no" dir="ltr">outs</code> of some other rule, this rule will automatically depend on that other rule. </p> <p>A <code translate="no" dir="ltr">.h</code> file will not be compiled, but will be available for inclusion by sources in this rule. Both <code translate="no" dir="ltr">.cc</code> and <code translate="no" dir="ltr">.h</code> files can directly include headers listed in these <code translate="no" dir="ltr">srcs</code> or in the <code translate="no" dir="ltr">hdrs</code> of any rule listed in the <code translate="no" dir="ltr">deps</code> argument. </p> <p>All <code translate="no" dir="ltr">#include</code>d files must be mentioned in the <code translate="no" dir="ltr">srcs</code> attribute of this rule, or in the <code translate="no" dir="ltr">hdrs</code> attribute of referenced <code translate="no" dir="ltr">cc_library()</code>s. The recommended style is for headers associated with a library to be listed in that library's <code translate="no" dir="ltr">hdrs</code> attribute, and any remaining headers associated with this rule's sources to be listed in <code translate="no" dir="ltr">srcs</code>. See <a href="#hdrs">"Header inclusion checking"</a> for a more detailed description. </p> <p>If a rule's name is in the <code translate="no" dir="ltr">srcs</code>, then this rule automatically depends on that one. If the named rule's <code translate="no" dir="ltr">outs</code> are C or C++ source files, they are compiled into this rule; if they are library files, they are linked in. </p> <p> Permitted <code translate="no" dir="ltr">srcs</code> file types: </p> <ul> <li>C and C++ source files: <code translate="no" dir="ltr">.c</code>, <code translate="no" dir="ltr">.cc</code>, <code translate="no" dir="ltr">.cpp</code>, <code translate="no" dir="ltr">.cxx</code>, <code translate="no" dir="ltr">.c++</code>, <code translate="no" dir="ltr">.C</code>
</li> <li>C and C++ header files: <code translate="no" dir="ltr">.h</code>, <code translate="no" dir="ltr">.hh</code>, <code translate="no" dir="ltr">.hpp</code>, <code translate="no" dir="ltr">.hxx</code>, <code translate="no" dir="ltr">.inc</code>, <code translate="no" dir="ltr">.inl</code>, <code translate="no" dir="ltr">.H</code>
</li> <li>Assembler with C preprocessor: <code translate="no" dir="ltr">.S</code>
</li> <li>Archive: <code translate="no" dir="ltr">.a</code>, <code translate="no" dir="ltr">.pic.a</code>
</li> <li>"Always link" library: <code translate="no" dir="ltr">.lo</code>, <code translate="no" dir="ltr">.pic.lo</code>
</li> <li>Shared library, versioned or unversioned: <code translate="no" dir="ltr">.so</code>, <code translate="no" dir="ltr">.so.<i>version</i></code>
</li> <li>Object file: <code translate="no" dir="ltr">.o</code>, <code translate="no" dir="ltr">.pic.o</code>
</li> </ul> <p> ...and any rules that produce those files. Different extensions denote different programming languages in accordance with gcc convention. </p> </td> </tr> <tr> <td id="cc_binary.additional_linker_inputs"> <code translate="no" dir="ltr">additional_linker_inputs</code> </td> <td> <p>List of <a href="https://bazel.build/versions/7.0.0/concepts/labels">labels</a>; default is <code translate="no" dir="ltr">[]</code></p> Pass these files to the C++ linker command. <p> For example, compiled Windows .res files can be provided here to be embedded in the binary target. </p> </td> </tr> <tr> <td id="cc_binary.copts"> <code translate="no" dir="ltr">copts</code> </td> <td> <p>List of strings; default is <code translate="no" dir="ltr">[]</code></p> Add these options to the C++ compilation command. Subject to <a href="make-variables">"Make variable"</a> substitution and <a href="common-definitions#sh-tokenization">Bourne shell tokenization</a>. <p> Each string in this attribute is added in the given order to <code translate="no" dir="ltr">COPTS</code> before compiling the binary target. The flags take effect only for compiling this target, not its dependencies, so be careful about header files included elsewhere. All paths should be relative to the workspace, not to the current package. </p> <p> If the package declares the <a href="functions#package.features">feature</a> <code translate="no" dir="ltr">no_copts_tokenization</code>, Bourne shell tokenization applies only to strings that consist of a single "Make" variable. </p> </td> </tr> <tr> <td id="cc_binary.defines"> <code translate="no" dir="ltr">defines</code> </td> <td> <p>List of strings; default is <code translate="no" dir="ltr">[]</code></p> List of defines to add to the compile line. Subject to <a href="make-variables">"Make" variable</a> substitution and <a href="common-definitions#sh-tokenization">Bourne shell tokenization</a>. Each string, which must consist of a single Bourne shell token, is prepended with <code translate="no" dir="ltr">-D</code> and added to the compile command line to this target, as well as to every rule that depends on it. Be very careful, since this may have far-reaching effects. When in doubt, add define values to <a href="#cc_binary.local_defines"><code translate="no" dir="ltr">local_defines</code></a> instead. </td> </tr> <tr> <td id="cc_binary.includes"> <code translate="no" dir="ltr">includes</code> </td> <td> <p>List of strings; default is <code translate="no" dir="ltr">[]</code></p> List of include dirs to be added to the compile line. <p> Subject to <a href="make-variables">"Make variable"</a> substitution. Each string is prepended with <code translate="no" dir="ltr">-isystem</code> and added to <code translate="no" dir="ltr">COPTS</code>. Unlike <a href="#cc_binary.copts">COPTS</a>, these flags are added for this rule and every rule that depends on it. (Note: not the rules it depends upon!) Be very careful, since this may have far-reaching effects. When in doubt, add "-I" flags to <a href="#cc_binary.copts">COPTS</a> instead. </p> <p> Headers must be added to srcs or hdrs, otherwise they will not be available to dependent rules when compilation is sandboxed (the default). </p> </td> </tr> <tr> <td id="cc_binary.link_extra_lib"> <code translate="no" dir="ltr">link_extra_lib</code> </td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels">Label</a>; default is <code translate="no" dir="ltr">"@bazel_tools//tools/cpp:link_extra_lib"</code></p> Control linking of extra libraries. <p> By default, C++ binaries are linked against <code translate="no" dir="ltr">//tools/cpp:link_extra_lib</code>, which by default depends on the label flag <code translate="no" dir="ltr">//tools/cpp:link_extra_libs</code>. Without setting the flag, this library is empty by default. Setting the label flag allows linking optional dependencies, such as overrides for weak symbols, interceptors for shared library functions, or special runtime libraries (for malloc replacements, prefer <code translate="no" dir="ltr">malloc</code> or <code translate="no" dir="ltr">--custom_malloc</code>). Setting this attribute to <code translate="no" dir="ltr">None</code> disables this behaviour. </p> </td> </tr> <tr> <td id="cc_binary.linkopts"> <code translate="no" dir="ltr">linkopts</code> </td> <td> <p>List of strings; default is <code translate="no" dir="ltr">[]</code></p> Add these flags to the C++ linker command. Subject to <a href="make-variables">"Make" variable</a> substitution, <a href="common-definitions#sh-tokenization"> Bourne shell tokenization</a> and <a href="common-definitions#label-expansion">label expansion</a>. Each string in this attribute is added to <code translate="no" dir="ltr">LINKOPTS</code> before linking the binary target. <p> Each element of this list that does not start with <code translate="no" dir="ltr">$</code> or <code translate="no" dir="ltr">-</code> is assumed to be the label of a target in <code translate="no" dir="ltr">deps</code>. The list of files generated by that target is appended to the linker options. An error is reported if the label is invalid, or is not declared in <code translate="no" dir="ltr">deps</code>. </p> </td> </tr> <tr> <td id="cc_binary.linkshared"> <code translate="no" dir="ltr">linkshared</code> </td> <td> <p>Boolean; <a href="common-definitions#configurable-attributes">nonconfigurable</a>; default is <code translate="no" dir="ltr">False</code></p> Create a shared library. To enable this attribute, include <code translate="no" dir="ltr">linkshared=True</code> in your rule. By default this option is off. <p> The presence of this flag means that linking occurs with the <code translate="no" dir="ltr">-shared</code> flag to <code translate="no" dir="ltr">gcc</code>, and the resulting shared library is suitable for loading into for example a Java program. However, for build purposes it will never be linked into the dependent binary, as it is assumed that shared libraries built with a <a href="#cc_binary">cc_binary</a> rule are only loaded manually by other programs, so it should not be considered a substitute for the <a href="#cc_library">cc_library</a> rule. For sake of scalability we recommend avoiding this approach altogether and simply letting <code translate="no" dir="ltr">java_library</code> depend on <code translate="no" dir="ltr">cc_library</code> rules instead. </p> <p> If you specify both <code translate="no" dir="ltr">linkopts=['-static']</code> and <code translate="no" dir="ltr">linkshared=True</code>, you get a single completely self-contained unit. If you specify both <code translate="no" dir="ltr">linkstatic=True</code> and <code translate="no" dir="ltr">linkshared=True</code>, you get a single, mostly self-contained unit. </p> </td> </tr> <tr> <td id="cc_binary.linkstatic"> <code translate="no" dir="ltr">linkstatic</code> </td> <td> <p>Boolean; default is <code translate="no" dir="ltr">True</code></p> For <a href="c-cpp#cc_binary"><code translate="no" dir="ltr">cc_binary</code></a> and <a href="c-cpp#cc_test"><code translate="no" dir="ltr">cc_test</code></a>: link the binary in static mode. For <code translate="no" dir="ltr">cc_library.linkstatic</code>: see below. <p> By default this option is on for <code translate="no" dir="ltr">cc_binary</code> and off for the rest. </p> <p> If enabled and this is a binary or test, this option tells the build tool to link in <code translate="no" dir="ltr">.a</code>'s instead of <code translate="no" dir="ltr">.so</code>'s for user libraries whenever possible. Some system libraries may still be linked dynamically, as are libraries for which there is no static library. So the resulting executable will still be dynamically linked, hence only <i>mostly</i> static. </p> <p>There are really three different ways to link an executable:</p> <ul> <li> STATIC with fully_static_link feature, in which everything is linked statically; e.g. "<code translate="no" dir="ltr">gcc -static foo.o libbar.a libbaz.a -lm</code>".<br> This mode is enabled by specifying <code translate="no" dir="ltr">fully_static_link</code> in the <a href="common-definitions#features"><code translate="no" dir="ltr">features</code></a> attribute.</li> <li> STATIC, in which all user libraries are linked statically (if a static version is available), but where system libraries (excluding C/C++ runtime libraries) are linked dynamically, e.g. "<code translate="no" dir="ltr">gcc foo.o libfoo.a libbaz.a -lm</code>".<br> This mode is enabled by specifying <code translate="no" dir="ltr">linkstatic=True</code>.</li> <li> DYNAMIC, in which all libraries are linked dynamically (if a dynamic version is available), e.g. "<code translate="no" dir="ltr">gcc foo.o libfoo.so libbaz.so -lm</code>".<br> This mode is enabled by specifying <code translate="no" dir="ltr">linkstatic=False</code>.</li> </ul> <p> The <code translate="no" dir="ltr">linkstatic</code> attribute has a different meaning if used on a <a href="c-cpp#cc_library"><code translate="no" dir="ltr">cc_library()</code></a> rule. For a C++ library, <code translate="no" dir="ltr">linkstatic=True</code> indicates that only static linking is allowed, so no <code translate="no" dir="ltr">.so</code> will be produced. linkstatic=False does not prevent static libraries from being created. The attribute is meant to control the creation of dynamic libraries. </p> <p> If <code translate="no" dir="ltr">linkstatic=False</code>, then the build tool will create symlinks to depended-upon shared libraries in the <code translate="no" dir="ltr">*.runfiles</code> area. </p> </td> </tr> <tr> <td id="cc_binary.local_defines"> <code translate="no" dir="ltr">local_defines</code> </td> <td> <p>List of strings; default is <code translate="no" dir="ltr">[]</code></p> List of defines to add to the compile line. Subject to <a href="make-variables">"Make" variable</a> substitution and <a href="common-definitions#sh-tokenization">Bourne shell tokenization</a>. Each string, which must consist of a single Bourne shell token, is prepended with <code translate="no" dir="ltr">-D</code> and added to the compile command line for this target, but not to its dependents. </td> </tr> <tr> <td id="cc_binary.malloc"> <code translate="no" dir="ltr">malloc</code> </td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels">Label</a>; default is <code translate="no" dir="ltr">"@bazel_tools//tools/cpp:malloc"</code></p> Override the default dependency on malloc. <p> By default, C++ binaries are linked against <code translate="no" dir="ltr">//tools/cpp:malloc</code>, which is an empty library so the binary ends up using libc malloc. This label must refer to a <code translate="no" dir="ltr">cc_library</code>. If compilation is for a non-C++ rule, this option has no effect. The value of this attribute is ignored if <code translate="no" dir="ltr">linkshared=True</code> is specified. </p> </td> </tr> <tr> <td id="cc_binary.nocopts"> <code translate="no" dir="ltr">nocopts</code> </td> <td> <p>String; default is <code translate="no" dir="ltr">""</code></p> Remove matching options from the C++ compilation command. Subject to <a href="make-variables">"Make" variable</a> substitution. The value of this attribute is interpreted as a regular expression. Any preexisting <code translate="no" dir="ltr">COPTS</code> that match this regular expression (including values explicitly specified in the rule's <a href="#cc_binary.copts">copts</a> attribute) will be removed from <code translate="no" dir="ltr">COPTS</code> for purposes of compiling this rule. This attribute should rarely be needed. </td> </tr> <tr> <td id="cc_binary.stamp"> <code translate="no" dir="ltr">stamp</code> </td> <td> <p>Integer; default is <code translate="no" dir="ltr">-1</code></p> Whether to encode build information into the binary. Possible values: <ul> <li> <code translate="no" dir="ltr">stamp = 1</code>: Always stamp the build information into the binary, even in <a href="https://bazel.build/versions/7.0.0/docs/user-manual#flag--stamp"><code translate="no" dir="ltr">--nostamp</code></a> builds. <b>This setting should be avoided</b>, since it potentially kills remote caching for the binary and any downstream actions that depend on it. </li> <li> <code translate="no" dir="ltr">stamp = 0</code>: Always replace build information by constant values. This gives good build result caching. </li> <li> <code translate="no" dir="ltr">stamp = -1</code>: Embedding of build information is controlled by the <a href="https://bazel.build/versions/7.0.0/docs/user-manual#flag--stamp"><code translate="no" dir="ltr">--[no]stamp</code></a> flag. </li> </ul> <p>Stamped binaries are <em>not</em> rebuilt unless their dependencies change.</p> </td> </tr> <tr> <td id="cc_binary.win_def_file"> <code translate="no" dir="ltr">win_def_file</code> </td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels">Label</a>; default is <code translate="no" dir="ltr">None</code></p> The Windows DEF file to be passed to linker. <p>This attribute should only be used when Windows is the target platform. It can be used to <a href="https://msdn.microsoft.com/en-us/library/d91k01sh.aspx"> export symbols</a> during linking a shared library.</p> </td> </tr> </tbody> </table> <h2 id="cc_import" data-text="     cc_import   " tabindex="-1"> cc_import </h2>  <pre class="rule-signature" translate="no" dir="ltr">cc_import(<a href="#cc_import.name">name</a>, <a href="#cc_import.deps">deps</a>, <a href="common-definitions#typical.data">data</a>, <a href="#cc_import.hdrs">hdrs</a>, <a href="#cc_import.alwayslink">alwayslink</a>, <a href="common-definitions#common.compatible_with">compatible_with</a>, <a href="common-definitions#common.deprecation">deprecation</a>, <a href="common-definitions#common.distribs">distribs</a>, <a href="common-definitions#common.features">features</a>, <a href="#cc_import.interface_library">interface_library</a>, <a href="common-definitions#typical.licenses">licenses</a>, <a href="common-definitions#common.restricted_to">restricted_to</a>, <a href="#cc_import.shared_library">shared_library</a>, <a href="#cc_import.static_library">static_library</a>, <a href="#cc_import.system_provided">system_provided</a>, <a href="common-definitions#common.tags">tags</a>, <a href="common-definitions#common.target_compatible_with">target_compatible_with</a>, <a href="common-definitions#common.testonly">testonly</a>, <a href="common-definitions#common.visibility">visibility</a>)</pre> <p> <code translate="no" dir="ltr">cc_import</code> rules allows users to import precompiled C/C++ libraries. </p> <p> The following are the typical use cases: <br> 1. Linking a static library </p>
<pre class="code" translate="no" dir="ltr">
cc_import(
  name = "mylib",
  hdrs = ["mylib.h"],
  static_library = "libmylib.a",
  # If alwayslink is turned on,
  # libmylib.a will be forcely linked into any binary that depends on it.
  # alwayslink = 1,
)
</pre> 2. Linking a shared library (Unix) <pre class="code" translate="no" dir="ltr">
cc_import(
  name = "mylib",
  hdrs = ["mylib.h"],
  shared_library = "libmylib.so",
)
</pre> 3. Linking a shared library with interface library (Windows) <pre class="code" translate="no" dir="ltr">
cc_import(
  name = "mylib",
  hdrs = ["mylib.h"],
  # mylib.lib is an import library for mylib.dll which will be passed to linker
  interface_library = "mylib.lib",
  # mylib.dll will be available for runtime
  shared_library = "mylib.dll",
)
</pre> 4. Linking a shared library with <code translate="no" dir="ltr">system_provided=True</code> (Windows) <pre class="code" translate="no" dir="ltr">
cc_import(
  name = "mylib",
  hdrs = ["mylib.h"],
  # mylib.lib is an import library for mylib.dll which will be passed to linker
  interface_library = "mylib.lib",
  # mylib.dll is provided by system environment, for example it can be found in PATH.
  # This indicates that Bazel is not responsible for making mylib.dll available.
  system_provided = 1,
)
</pre> 5. Linking to static or shared library <br> On Unix: <pre class="code" translate="no" dir="ltr">
cc_import(
  name = "mylib",
  hdrs = ["mylib.h"],
  static_library = "libmylib.a",
  shared_library = "libmylib.so",
)

# first will link to libmylib.a
cc_binary(
  name = "first",
  srcs = ["first.cc"],
  deps = [":mylib"],
  linkstatic = 1, # default value
)

# second will link to libmylib.so
cc_binary(
  name = "second",
  srcs = ["second.cc"],
  deps = [":mylib"],
  linkstatic = 0,
)
</pre> On Windows: <pre class="code" translate="no" dir="ltr">
cc_import(
  name = "mylib",
  hdrs = ["mylib.h"],
  static_library = "libmylib.lib", # A normal static library
  interface_library = "mylib.lib", # An import library for mylib.dll
  shared_library = "mylib.dll",
)

# first will link to libmylib.lib
cc_binary(
  name = "first",
  srcs = ["first.cc"],
  deps = [":mylib"],
  linkstatic = 1, # default value
)

# second will link to mylib.dll through mylib.lib
cc_binary(
  name = "second",
  srcs = ["second.cc"],
  deps = [":mylib"],
  linkstatic = 0,
)
</pre> <code translate="no" dir="ltr">cc_import</code> supports an include attribute. For example: <pre class="code" translate="no" dir="ltr">
  cc_import(
  name = "curl_lib",
  hdrs = glob(["vendor/curl/include/curl/*.h"]),
  includes = [ "vendor/curl/include" ],
  shared_library = "vendor/curl/lib/.libs/libcurl.dylib",
)
</pre> <h3 id="cc_import_args" data-text="Arguments" tabindex="-1">Arguments</h3> <table class="table table-condensed table-bordered table-params"> <colgroup> <col class="col-param"> <col class="param-description"> </colgroup> <thead> <tr> <th colspan="2">Attributes</th> </tr> </thead> <tbody> <tr> <td id="cc_import.name"><code translate="no" dir="ltr">name</code></td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels#target-names">Name</a>; required</p> <p>A unique name for this target.</p> </td> </tr> <tr> <td id="cc_import.deps"> <code translate="no" dir="ltr">deps</code> </td> <td> <p>List of <a href="https://bazel.build/versions/7.0.0/concepts/labels">labels</a>; default is <code translate="no" dir="ltr">[]</code></p> The list of other libraries that the target depends upon. See general comments about <code translate="no" dir="ltr">deps</code> at <a href="common-definitions#typical-attributes">Typical attributes defined by most build rules</a>. </td> </tr> <tr> <td id="cc_import.hdrs"> <code translate="no" dir="ltr">hdrs</code> </td> <td> <p>List of <a href="https://bazel.build/versions/7.0.0/concepts/labels">labels</a>; default is <code translate="no" dir="ltr">[]</code></p> The list of header files published by this precompiled library to be directly included by sources in dependent rules. </td> </tr> <tr> <td id="cc_import.alwayslink"> <code translate="no" dir="ltr">alwayslink</code> </td> <td> <p>Boolean; default is <code translate="no" dir="ltr">False</code></p> If 1, any binary that depends (directly or indirectly) on this C++ precompiled library will link in all the object files archived in the static library, even if some contain no symbols referenced by the binary. This is useful if your code isn't explicitly called by code in the binary, e.g., if your code registers to receive some callback provided by some service. <p>If alwayslink doesn't work with VS 2017 on Windows, that is due to a <a href="https://github.com/bazelbuild/bazel/issues/3949">known issue</a>, please upgrade your VS 2017 to the latest version.</p> </td> </tr> <tr> <td id="cc_import.interface_library"> <code translate="no" dir="ltr">interface_library</code> </td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels">Label</a>; default is <code translate="no" dir="ltr">None</code></p> A single interface library for linking the shared library. <p> Permitted file types: <code translate="no" dir="ltr">.ifso</code>, <code translate="no" dir="ltr">.tbd</code>, <code translate="no" dir="ltr">.lib</code>, <code translate="no" dir="ltr">.so</code> or <code translate="no" dir="ltr">.dylib</code> </p> </td> </tr> <tr> <td id="cc_import.shared_library"> <code translate="no" dir="ltr">shared_library</code> </td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels">Label</a>; default is <code translate="no" dir="ltr">None</code></p> A single precompiled shared library. Bazel ensures it is available to the binary that depends on it during runtime. <p> Permitted file types: <code translate="no" dir="ltr">.so</code>, <code translate="no" dir="ltr">.dll</code> or <code translate="no" dir="ltr">.dylib</code> </p> </td> </tr> <tr> <td id="cc_import.static_library"> <code translate="no" dir="ltr">static_library</code> </td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels">Label</a>; default is <code translate="no" dir="ltr">None</code></p> A single precompiled static library. <p> Permitted file types: <code translate="no" dir="ltr">.a</code>, <code translate="no" dir="ltr">.pic.a</code> or <code translate="no" dir="ltr">.lib</code> </p> </td> </tr> <tr> <td id="cc_import.system_provided"> <code translate="no" dir="ltr">system_provided</code> </td> <td> <p>Boolean; default is <code translate="no" dir="ltr">False</code></p> If 1, it indicates the shared library required at runtime is provided by the system. In this case, <code translate="no" dir="ltr">interface_library</code> should be specified and <code translate="no" dir="ltr">shared_library</code> should be empty. </td> </tr> </tbody> </table> <h2 id="cc_library" data-text="     cc_library   " tabindex="-1"> cc_library </h2>  <pre class="rule-signature" translate="no" dir="ltr">cc_library(<a href="#cc_library.name">name</a>, <a href="#cc_library.deps">deps</a>, <a href="#cc_library.srcs">srcs</a>, <a href="common-definitions#typical.data">data</a>, <a href="#cc_library.hdrs">hdrs</a>, <a href="#cc_library.additional_compiler_inputs">additional_compiler_inputs</a>, <a href="#cc_library.additional_linker_inputs">additional_linker_inputs</a>, <a href="#cc_library.alwayslink">alwayslink</a>, <a href="common-definitions#common.compatible_with">compatible_with</a>, <a href="#cc_library.copts">copts</a>, <a href="#cc_library.defines">defines</a>, <a href="common-definitions#common.deprecation">deprecation</a>, <a href="common-definitions#common.distribs">distribs</a>, <a href="common-definitions#common.exec_compatible_with">exec_compatible_with</a>, <a href="common-definitions#common.exec_properties">exec_properties</a>, <a href="common-definitions#common.features">features</a>, <a href="#cc_library.implementation_deps">implementation_deps</a>, <a href="#cc_library.include_prefix">include_prefix</a>, <a href="#cc_library.includes">includes</a>, <a href="common-definitions#typical.licenses">licenses</a>, <a href="#cc_library.linkopts">linkopts</a>, <a href="#cc_library.linkstamp">linkstamp</a>, <a href="#cc_library.linkstatic">linkstatic</a>, <a href="#cc_library.local_defines">local_defines</a>, <a href="#cc_library.nocopts">nocopts</a>, <a href="common-definitions#common.restricted_to">restricted_to</a>, <a href="#cc_library.strip_include_prefix">strip_include_prefix</a>, <a href="common-definitions#common.tags">tags</a>, <a href="common-definitions#common.target_compatible_with">target_compatible_with</a>, <a href="common-definitions#common.testonly">testonly</a>, <a href="#cc_library.textual_hdrs">textual_hdrs</a>, <a href="common-definitions#common.toolchains">toolchains</a>, <a href="common-definitions#common.visibility">visibility</a>, <a href="#cc_library.win_def_file">win_def_file</a>)</pre> <h4 id="hdrs" data-text="Header inclusion checking" tabindex="-1">Header inclusion checking</h4> <p> All header files that are used in the build must be declared in the <code translate="no" dir="ltr">hdrs</code> or <code translate="no" dir="ltr">srcs</code> of <code translate="no" dir="ltr">cc_*</code> rules. This is enforced. </p> <p> For <code translate="no" dir="ltr">cc_library</code> rules, headers in <code translate="no" dir="ltr">hdrs</code> comprise the public interface of the library and can be directly included both from the files in <code translate="no" dir="ltr">hdrs</code> and <code translate="no" dir="ltr">srcs</code> of the library itself as well as from files in <code translate="no" dir="ltr">hdrs</code> and <code translate="no" dir="ltr">srcs</code> of <code translate="no" dir="ltr">cc_*</code> rules that list the library in their <code translate="no" dir="ltr">deps</code>. Headers in <code translate="no" dir="ltr">srcs</code> must only be directly included from the files in <code translate="no" dir="ltr">hdrs</code> and <code translate="no" dir="ltr">srcs</code> of the library itself. When deciding whether to put a header into <code translate="no" dir="ltr">hdrs</code> or <code translate="no" dir="ltr">srcs</code>, you should ask whether you want consumers of this library to be able to directly include it. This is roughly the same decision as between <code translate="no" dir="ltr">public</code> and <code translate="no" dir="ltr">private</code> visibility in programming languages. </p> <p> <code translate="no" dir="ltr">cc_binary</code> and <code translate="no" dir="ltr">cc_test</code> rules do not have an exported interface, so they also do not have a <code translate="no" dir="ltr">hdrs</code> attribute. All headers that belong to the binary or test directly should be listed in the <code translate="no" dir="ltr">srcs</code>. </p> <p> To illustrate these rules, look at the following example. </p> <pre class="code" translate="no" dir="ltr">
cc_binary(
    name = "foo",
    srcs = [
        "foo.cc",
        "foo.h",
    ],
    deps = [":bar"],
)

cc_library(
    name = "bar",
    srcs = [
        "bar.cc",
        "bar-impl.h",
    ],
    hdrs = ["bar.h"],
    deps = [":baz"],
)

cc_library(
    name = "baz",
    srcs = [
        "baz.cc",
        "baz-impl.h",
    ],
    hdrs = ["baz.h"],
)
</pre> <p> The allowed direct inclusions in this example are listed in the table below. For example <code translate="no" dir="ltr">foo.cc</code> is allowed to directly include <code translate="no" dir="ltr">foo.h</code> and <code translate="no" dir="ltr">bar.h</code>, but not <code translate="no" dir="ltr">baz.h</code>. </p> <table class="table table-striped table-bordered table-condensed"> <thead> <tr>
<th>Including file</th>
<th>Allowed inclusions</th>
</tr> </thead> <tbody> <tr>
<td>foo.h</td>
<td>bar.h</td>
</tr> <tr>
<td>foo.cc</td>
<td>foo.h bar.h</td>
</tr> <tr>
<td>bar.h</td>
<td>bar-impl.h baz.h</td>
</tr> <tr>
<td>bar-impl.h</td>
<td>bar.h baz.h</td>
</tr> <tr>
<td>bar.cc</td>
<td>bar.h bar-impl.h baz.h</td>
</tr> <tr>
<td>baz.h</td>
<td>baz-impl.h</td>
</tr> <tr>
<td>baz-impl.h</td>
<td>baz.h</td>
</tr> <tr>
<td>baz.cc</td>
<td>baz.h baz-impl.h</td>
</tr> </tbody> </table> <p> The inclusion checking rules only apply to <em>direct</em> inclusions. In the example above <code translate="no" dir="ltr">foo.cc</code> is allowed to include <code translate="no" dir="ltr">bar.h</code>, which may include <code translate="no" dir="ltr">baz.h</code>, which in turn is allowed to include <code translate="no" dir="ltr">baz-impl.h</code>. Technically, the compilation of a <code translate="no" dir="ltr">.cc</code> file may transitively include any header file in the <code translate="no" dir="ltr">hdrs</code> or <code translate="no" dir="ltr">srcs</code> in any <code translate="no" dir="ltr">cc_library</code> in the transitive <code translate="no" dir="ltr">deps</code> closure. In this case the compiler may read <code translate="no" dir="ltr">baz.h</code> and <code translate="no" dir="ltr">baz-impl.h</code> when compiling <code translate="no" dir="ltr">foo.cc</code>, but <code translate="no" dir="ltr">foo.cc</code> must not contain <code translate="no" dir="ltr">#include "baz.h"</code>. For that to be allowed, <code translate="no" dir="ltr">baz</code> must be added to the <code translate="no" dir="ltr">deps</code> of <code translate="no" dir="ltr">foo</code>. </p> <p> Bazel depends on toolchain support to enforce the inclusion checking rules. The <code translate="no" dir="ltr">layering_check</code> feature has to be supported by the toolchain and requested explicitly, for example via the <code translate="no" dir="ltr">--features=layering_check</code> command-line flag or the <code translate="no" dir="ltr">features</code> parameter of the <a href="functions#package"><code translate="no" dir="ltr">package</code></a> function. The toolchains provided by Bazel only support this feature with clang on Unix and macOS. </p> <h3 id="cc_library_args" data-text="Arguments" tabindex="-1">Arguments</h3> <table class="table table-condensed table-bordered table-params"> <colgroup> <col class="col-param"> <col class="param-description"> </colgroup> <thead> <tr> <th colspan="2">Attributes</th> </tr> </thead> <tbody> <tr> <td id="cc_library.name"><code translate="no" dir="ltr">name</code></td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels#target-names">Name</a>; required</p> <p>A unique name for this target.</p> </td> </tr> <tr> <td id="cc_library.deps"> <code translate="no" dir="ltr">deps</code> </td> <td> <p>List of <a href="https://bazel.build/versions/7.0.0/concepts/labels">labels</a>; default is <code translate="no" dir="ltr">[]</code></p> The list of other libraries to be linked in to the binary target. <p>These can be <code translate="no" dir="ltr">cc_library</code> or <code translate="no" dir="ltr">objc_library</code> targets.</p> </td> </tr> <tr> <td id="cc_library.srcs"> <code translate="no" dir="ltr">srcs</code> </td> <td> <p>List of <a href="https://bazel.build/versions/7.0.0/concepts/labels">labels</a>; default is <code translate="no" dir="ltr">[]</code></p> The list of C and C++ files that are processed to create the target. These are C/C++ source and header files, either non-generated (normal source code) or generated. <p>All <code translate="no" dir="ltr">.cc</code>, <code translate="no" dir="ltr">.c</code>, and <code translate="no" dir="ltr">.cpp</code> files will be compiled. These might be generated files: if a named file is in the <code translate="no" dir="ltr">outs</code> of some other rule, this rule will automatically depend on that other rule. </p> <p>A <code translate="no" dir="ltr">.h</code> file will not be compiled, but will be available for inclusion by sources in this rule. Both <code translate="no" dir="ltr">.cc</code> and <code translate="no" dir="ltr">.h</code> files can directly include headers listed in these <code translate="no" dir="ltr">srcs</code> or in the <code translate="no" dir="ltr">hdrs</code> of any rule listed in the <code translate="no" dir="ltr">deps</code> argument. </p> <p>All <code translate="no" dir="ltr">#include</code>d files must be mentioned in the <code translate="no" dir="ltr">srcs</code> attribute of this rule, or in the <code translate="no" dir="ltr">hdrs</code> attribute of referenced <code translate="no" dir="ltr">cc_library()</code>s. The recommended style is for headers associated with a library to be listed in that library's <code translate="no" dir="ltr">hdrs</code> attribute, and any remaining headers associated with this rule's sources to be listed in <code translate="no" dir="ltr">srcs</code>. See <a href="#hdrs">"Header inclusion checking"</a> for a more detailed description. </p> <p>If a rule's name is in the <code translate="no" dir="ltr">srcs</code>, then this rule automatically depends on that one. If the named rule's <code translate="no" dir="ltr">outs</code> are C or C++ source files, they are compiled into this rule; if they are library files, they are linked in. </p> <p> Permitted <code translate="no" dir="ltr">srcs</code> file types: </p> <ul> <li>C and C++ source files: <code translate="no" dir="ltr">.c</code>, <code translate="no" dir="ltr">.cc</code>, <code translate="no" dir="ltr">.cpp</code>, <code translate="no" dir="ltr">.cxx</code>, <code translate="no" dir="ltr">.c++</code>, <code translate="no" dir="ltr">.C</code>
</li> <li>C and C++ header files: <code translate="no" dir="ltr">.h</code>, <code translate="no" dir="ltr">.hh</code>, <code translate="no" dir="ltr">.hpp</code>, <code translate="no" dir="ltr">.hxx</code>, <code translate="no" dir="ltr">.inc</code>, <code translate="no" dir="ltr">.inl</code>, <code translate="no" dir="ltr">.H</code>
</li> <li>Assembler with C preprocessor: <code translate="no" dir="ltr">.S</code>
</li> <li>Archive: <code translate="no" dir="ltr">.a</code>, <code translate="no" dir="ltr">.pic.a</code>
</li> <li>"Always link" library: <code translate="no" dir="ltr">.lo</code>, <code translate="no" dir="ltr">.pic.lo</code>
</li> <li>Shared library, versioned or unversioned: <code translate="no" dir="ltr">.so</code>, <code translate="no" dir="ltr">.so.<i>version</i></code>
</li> <li>Object file: <code translate="no" dir="ltr">.o</code>, <code translate="no" dir="ltr">.pic.o</code>
</li> </ul> <p> ...and any rules that produce those files. Different extensions denote different programming languages in accordance with gcc convention. </p> </td> </tr> <tr> <td id="cc_library.hdrs"> <code translate="no" dir="ltr">hdrs</code> </td> <td> <p>List of <a href="https://bazel.build/versions/7.0.0/concepts/labels">labels</a>; default is <code translate="no" dir="ltr">[]</code></p> The list of header files published by this library to be directly included by sources in dependent rules. <p>This is the strongly preferred location for declaring header files that describe the interface for the library. These headers will be made available for inclusion by sources in this rule or in dependent rules. Headers not meant to be included by a client of this library should be listed in the <code translate="no" dir="ltr">srcs</code> attribute instead, even if they are included by a published header. See <a href="#hdrs">"Header inclusion checking"</a> for a more detailed description. </p> </td> </tr> <tr> <td id="cc_library.additional_compiler_inputs"> <code translate="no" dir="ltr">additional_compiler_inputs</code> </td> <td> <p>List of <a href="https://bazel.build/versions/7.0.0/concepts/labels">labels</a>; default is <code translate="no" dir="ltr">[]</code></p> Any additional files you might want to pass to the compiler command line, such as sanitizer ignorelists, for example. Files specified here can then be used in copts with the $(location) function. </td> </tr> <tr> <td id="cc_library.additional_linker_inputs"> <code translate="no" dir="ltr">additional_linker_inputs</code> </td> <td> <p>List of <a href="https://bazel.build/versions/7.0.0/concepts/labels">labels</a>; default is <code translate="no" dir="ltr">[]</code></p> Pass these files to the C++ linker command. <p> For example, compiled Windows .res files can be provided here to be embedded in the binary target. </p> </td> </tr> <tr> <td id="cc_library.alwayslink"> <code translate="no" dir="ltr">alwayslink</code> </td> <td> <p>Boolean; default is <code translate="no" dir="ltr">False</code></p> If 1, any binary that depends (directly or indirectly) on this C++ library will link in all the object files for the files listed in <code translate="no" dir="ltr">srcs</code>, even if some contain no symbols referenced by the binary. This is useful if your code isn't explicitly called by code in the binary, e.g., if your code registers to receive some callback provided by some service. <p>If alwayslink doesn't work with VS 2017 on Windows, that is due to a <a href="https://github.com/bazelbuild/bazel/issues/3949">known issue</a>, please upgrade your VS 2017 to the latest version.</p> </td> </tr> <tr> <td id="cc_library.copts"> <code translate="no" dir="ltr">copts</code> </td> <td> <p>List of strings; default is <code translate="no" dir="ltr">[]</code></p> Add these options to the C++ compilation command. Subject to <a href="make-variables">"Make variable"</a> substitution and <a href="common-definitions#sh-tokenization">Bourne shell tokenization</a>. <p> Each string in this attribute is added in the given order to <code translate="no" dir="ltr">COPTS</code> before compiling the binary target. The flags take effect only for compiling this target, not its dependencies, so be careful about header files included elsewhere. All paths should be relative to the workspace, not to the current package. </p> <p> If the package declares the <a href="functions#package.features">feature</a> <code translate="no" dir="ltr">no_copts_tokenization</code>, Bourne shell tokenization applies only to strings that consist of a single "Make" variable. </p> </td> </tr> <tr> <td id="cc_library.defines"> <code translate="no" dir="ltr">defines</code> </td> <td> <p>List of strings; default is <code translate="no" dir="ltr">[]</code></p> List of defines to add to the compile line. Subject to <a href="make-variables">"Make" variable</a> substitution and <a href="common-definitions#sh-tokenization">Bourne shell tokenization</a>. Each string, which must consist of a single Bourne shell token, is prepended with <code translate="no" dir="ltr">-D</code> and added to the compile command line to this target, as well as to every rule that depends on it. Be very careful, since this may have far-reaching effects. When in doubt, add define values to <a href="#cc_binary.local_defines"><code translate="no" dir="ltr">local_defines</code></a> instead. </td> </tr> <tr> <td id="cc_library.implementation_deps"> <code translate="no" dir="ltr">implementation_deps</code> </td> <td> <p>List of <a href="https://bazel.build/versions/7.0.0/concepts/labels">labels</a>; default is <code translate="no" dir="ltr">[]</code></p> The list of other libraries that the library target depends on. Unlike with <code translate="no" dir="ltr">deps</code>, the headers and include paths of these libraries (and all their transitive deps) are only used for compilation of this library, and not libraries that depend on it. Libraries specified with <code translate="no" dir="ltr">implementation_deps</code> are still linked in binary targets that depend on this library. <p>For now usage is limited to cc_libraries and guarded by the flag <code translate="no" dir="ltr">--experimental_cc_implementation_deps</code>.</p> </td> </tr> <tr> <td id="cc_library.include_prefix"> <code translate="no" dir="ltr">include_prefix</code> </td> <td> <p>String; default is <code translate="no" dir="ltr">""</code></p> The prefix to add to the paths of the headers of this rule. <p>When set, the headers in the <code translate="no" dir="ltr">hdrs</code> attribute of this rule are accessible at is the value of this attribute prepended to their repository-relative path. </p>
<p>The prefix in the <code translate="no" dir="ltr">strip_include_prefix</code> attribute is removed before this prefix is added. </p>
</td> </tr> <tr> <td id="cc_library.includes"> <code translate="no" dir="ltr">includes</code> </td> <td> <p>List of strings; default is <code translate="no" dir="ltr">[]</code></p> List of include dirs to be added to the compile line. <p> Subject to <a href="make-variables">"Make variable"</a> substitution. Each string is prepended with <code translate="no" dir="ltr">-isystem</code> and added to <code translate="no" dir="ltr">COPTS</code>. Unlike <a href="#cc_binary.copts">COPTS</a>, these flags are added for this rule and every rule that depends on it. (Note: not the rules it depends upon!) Be very careful, since this may have far-reaching effects. When in doubt, add "-I" flags to <a href="#cc_binary.copts">COPTS</a> instead. </p> <p> Headers must be added to srcs or hdrs, otherwise they will not be available to dependent rules when compilation is sandboxed (the default). </p> </td> </tr> <tr> <td id="cc_library.linkopts"> <code translate="no" dir="ltr">linkopts</code> </td> <td> <p>List of strings; default is <code translate="no" dir="ltr">[]</code></p> Add these flags to the C++ linker command. Subject to <a href="make-variables">"Make" variable</a> substitution, <a href="common-definitions#sh-tokenization"> Bourne shell tokenization</a> and <a href="common-definitions#label-expansion">label expansion</a>. Each string in this attribute is added to <code translate="no" dir="ltr">LINKOPTS</code> before linking the binary target. <p> Each element of this list that does not start with <code translate="no" dir="ltr">$</code> or <code translate="no" dir="ltr">-</code> is assumed to be the label of a target in <code translate="no" dir="ltr">deps</code>. The list of files generated by that target is appended to the linker options. An error is reported if the label is invalid, or is not declared in <code translate="no" dir="ltr">deps</code>. </p> </td> </tr> <tr> <td id="cc_library.linkstamp"> <code translate="no" dir="ltr">linkstamp</code> </td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels">Label</a>; default is <code translate="no" dir="ltr">None</code></p> Simultaneously compiles and links the specified C++ source file into the final binary. This trickery is required to introduce timestamp information into binaries; if we compiled the source file to an object file in the usual way, the timestamp would be incorrect. A linkstamp compilation may not include any particular set of compiler flags and so should not depend on any particular header, compiler option, or other build variable. <em class="harmful">This option should only be needed in the <code translate="no" dir="ltr">base</code> package.</em> </td> </tr> <tr> <td id="cc_library.linkstatic"> <code translate="no" dir="ltr">linkstatic</code> </td> <td> <p>Boolean; default is <code translate="no" dir="ltr">False</code></p> For <a href="c-cpp#cc_binary"><code translate="no" dir="ltr">cc_binary</code></a> and <a href="c-cpp#cc_test"><code translate="no" dir="ltr">cc_test</code></a>: link the binary in static mode. For <code translate="no" dir="ltr">cc_library.linkstatic</code>: see below. <p> By default this option is on for <code translate="no" dir="ltr">cc_binary</code> and off for the rest. </p> <p> If enabled and this is a binary or test, this option tells the build tool to link in <code translate="no" dir="ltr">.a</code>'s instead of <code translate="no" dir="ltr">.so</code>'s for user libraries whenever possible. Some system libraries may still be linked dynamically, as are libraries for which there is no static library. So the resulting executable will still be dynamically linked, hence only <i>mostly</i> static. </p> <p>There are really three different ways to link an executable:</p> <ul> <li> STATIC with fully_static_link feature, in which everything is linked statically; e.g. "<code translate="no" dir="ltr">gcc -static foo.o libbar.a libbaz.a -lm</code>".<br> This mode is enabled by specifying <code translate="no" dir="ltr">fully_static_link</code> in the <a href="common-definitions#features"><code translate="no" dir="ltr">features</code></a> attribute.</li> <li> STATIC, in which all user libraries are linked statically (if a static version is available), but where system libraries (excluding C/C++ runtime libraries) are linked dynamically, e.g. "<code translate="no" dir="ltr">gcc foo.o libfoo.a libbaz.a -lm</code>".<br> This mode is enabled by specifying <code translate="no" dir="ltr">linkstatic=True</code>.</li> <li> DYNAMIC, in which all libraries are linked dynamically (if a dynamic version is available), e.g. "<code translate="no" dir="ltr">gcc foo.o libfoo.so libbaz.so -lm</code>".<br> This mode is enabled by specifying <code translate="no" dir="ltr">linkstatic=False</code>.</li> </ul> <p> The <code translate="no" dir="ltr">linkstatic</code> attribute has a different meaning if used on a <a href="c-cpp#cc_library"><code translate="no" dir="ltr">cc_library()</code></a> rule. For a C++ library, <code translate="no" dir="ltr">linkstatic=True</code> indicates that only static linking is allowed, so no <code translate="no" dir="ltr">.so</code> will be produced. linkstatic=False does not prevent static libraries from being created. The attribute is meant to control the creation of dynamic libraries. </p> <p> If <code translate="no" dir="ltr">linkstatic=False</code>, then the build tool will create symlinks to depended-upon shared libraries in the <code translate="no" dir="ltr">*.runfiles</code> area. </p> </td> </tr> <tr> <td id="cc_library.local_defines"> <code translate="no" dir="ltr">local_defines</code> </td> <td> <p>List of strings; default is <code translate="no" dir="ltr">[]</code></p> List of defines to add to the compile line. Subject to <a href="make-variables">"Make" variable</a> substitution and <a href="common-definitions#sh-tokenization">Bourne shell tokenization</a>. Each string, which must consist of a single Bourne shell token, is prepended with <code translate="no" dir="ltr">-D</code> and added to the compile command line for this target, but not to its dependents. </td> </tr> <tr> <td id="cc_library.nocopts"> <code translate="no" dir="ltr">nocopts</code> </td> <td> <p>String; default is <code translate="no" dir="ltr">""</code></p> Remove matching options from the C++ compilation command. Subject to <a href="make-variables">"Make" variable</a> substitution. The value of this attribute is interpreted as a regular expression. Any preexisting <code translate="no" dir="ltr">COPTS</code> that match this regular expression (including values explicitly specified in the rule's <a href="#cc_binary.copts">copts</a> attribute) will be removed from <code translate="no" dir="ltr">COPTS</code> for purposes of compiling this rule. This attribute should rarely be needed. </td> </tr> <tr> <td id="cc_library.strip_include_prefix"> <code translate="no" dir="ltr">strip_include_prefix</code> </td> <td> <p>String; default is <code translate="no" dir="ltr">""</code></p> The prefix to strip from the paths of the headers of this rule. <p>When set, the headers in the <code translate="no" dir="ltr">hdrs</code> attribute of this rule are accessible at their path with this prefix cut off. </p>
<p>If it's a relative path, it's taken as a package-relative one. If it's an absolute one, it's understood as a repository-relative path. </p>
<p>The prefix in the <code translate="no" dir="ltr">include_prefix</code> attribute is added after this prefix is stripped. </p>
</td> </tr> <tr> <td id="cc_library.textual_hdrs"> <code translate="no" dir="ltr">textual_hdrs</code> </td> <td> <p>List of <a href="https://bazel.build/versions/7.0.0/concepts/labels">labels</a>; default is <code translate="no" dir="ltr">[]</code></p> The list of header files published by this library to be textually included by sources in dependent rules. <p>This is the location for declaring header files that cannot be compiled on their own; that is, they always need to be textually included by other source files to build valid code.</p> </td> </tr> <tr> <td id="cc_library.win_def_file"> <code translate="no" dir="ltr">win_def_file</code> </td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels">Label</a>; default is <code translate="no" dir="ltr">None</code></p> The Windows DEF file to be passed to linker. <p>This attribute should only be used when Windows is the target platform. It can be used to <a href="https://msdn.microsoft.com/en-us/library/d91k01sh.aspx"> export symbols</a> during linking a shared library.</p> </td> </tr> </tbody> </table> <h2 id="cc_proto_library" data-text="     cc_proto_library   " tabindex="-1"> cc_proto_library </h2>  <pre class="rule-signature" translate="no" dir="ltr">cc_proto_library(<a href="#cc_proto_library.name">name</a>, <a href="#cc_proto_library.deps">deps</a>, <a href="common-definitions#typical.data">data</a>, <a href="common-definitions#common.compatible_with">compatible_with</a>, <a href="common-definitions#common.deprecation">deprecation</a>, <a href="common-definitions#common.distribs">distribs</a>, <a href="common-definitions#common.exec_compatible_with">exec_compatible_with</a>, <a href="common-definitions#common.exec_properties">exec_properties</a>, <a href="common-definitions#common.features">features</a>, <a href="common-definitions#typical.licenses">licenses</a>, <a href="common-definitions#common.restricted_to">restricted_to</a>, <a href="common-definitions#common.tags">tags</a>, <a href="common-definitions#common.target_compatible_with">target_compatible_with</a>, <a href="common-definitions#common.testonly">testonly</a>, <a href="common-definitions#common.visibility">visibility</a>)</pre> <p> <code translate="no" dir="ltr">cc_proto_library</code> generates C++ code from <code translate="no" dir="ltr">.proto</code> files. </p> <p> <code translate="no" dir="ltr">deps</code> must point to <a href="protocol-buffer#proto_library"><code translate="no" dir="ltr">proto_library
</code></a> rules. </p> <p> Example: </p> <pre class="code" translate="no" dir="ltr">
cc_library(
    name = "lib",
    deps = [":foo_cc_proto"],
)

cc_proto_library(
    name = "foo_cc_proto",
    deps = [":foo_proto"],
)

proto_library(
    name = "foo_proto",
)
</pre> <h3 id="cc_proto_library_args" data-text="Arguments" tabindex="-1">Arguments</h3> <table class="table table-condensed table-bordered table-params"> <colgroup> <col class="col-param"> <col class="param-description"> </colgroup> <thead> <tr> <th colspan="2">Attributes</th> </tr> </thead> <tbody> <tr> <td id="cc_proto_library.name"><code translate="no" dir="ltr">name</code></td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels#target-names">Name</a>; required</p> <p>A unique name for this target.</p> </td> </tr> <tr> <td id="cc_proto_library.deps"> <code translate="no" dir="ltr">deps</code> </td> <td> <p>List of <a href="https://bazel.build/versions/7.0.0/concepts/labels">labels</a>; default is <code translate="no" dir="ltr">[]</code></p> The list of <a href="protocol-buffer#proto_library"><code translate="no" dir="ltr">proto_library</code></a> rules to generate C++ code for. </td> </tr> </tbody> </table> <h2 id="cc_shared_library" data-text="     cc_shared_library   " tabindex="-1"> cc_shared_library </h2>  <pre class="rule-signature" translate="no" dir="ltr">cc_shared_library(<a href="#cc_shared_library.name">name</a>, <a href="#cc_shared_library.deps">deps</a>, <a href="#cc_shared_library.additional_linker_inputs">additional_linker_inputs</a>, <a href="#cc_shared_library.dynamic_deps">dynamic_deps</a>, <a href="#cc_shared_library.exports_filter">exports_filter</a>, <a href="#cc_shared_library.shared_lib_name">shared_lib_name</a>, <a href="common-definitions#common.tags">tags</a>, <a href="#cc_shared_library.user_link_flags">user_link_flags</a>, <a href="#cc_shared_library.win_def_file">win_def_file</a>)</pre> <p>It produces a shared library.</p> <h4 id="cc_shard_library_examples" data-text="Example" tabindex="-1">Example</h4> <pre class="code" translate="no" dir="ltr">
cc_shared_library(
    name = "foo_shared",
    deps = [
        ":foo",
    ],
    dynamic_deps = [
        ":bar_shared",
    ],
    additional_linker_inputs = [
        ":foo.lds",
    ],
    user_link_flags = [
        "-Wl,--version-script=$(location :foo.lds)",
    ],
)
cc_library(
    name = "foo",
    srcs = ["foo.cc"],
    hdrs = ["foo.h"],
    deps = [
        ":bar",
        ":baz",
    ],
)
cc_shared_library(
    name = "bar_shared",
    shared_lib_name = "bar.so",
    deps = [":bar"],
)
cc_library(
    name = "bar",
    srcs = ["bar.cc"],
    hdrs = ["bar.h"],
)
cc_library(
    name = "baz",
    srcs = ["baz.cc"],
    hdrs = ["baz.h"],
)
</pre> <p>In the example <code translate="no" dir="ltr">foo_shared</code> statically links <code translate="no" dir="ltr">foo</code> and <code translate="no" dir="ltr">baz</code>, the latter being a transitive dependency. It doesn't link <code translate="no" dir="ltr">bar</code> because it is already provided dynamically by the <code translate="no" dir="ltr">dynamic_dep</code> <code translate="no" dir="ltr">bar_shared</code>.</p> <p><code translate="no" dir="ltr">foo_shared</code> uses a linker script *.lds file to control which symbols should be exported. The <code translate="no" dir="ltr">cc_shared_library</code> rule logic does not control which symbols get exported, it only uses what is assumed to be exported to give errors during analysis phase if two shared libraries export the same targets.</p> <p>Every direct dependency of <code translate="no" dir="ltr">cc_shared_library</code> is assumed to be exported. Therefore, Bazel assumes during analysis that <code translate="no" dir="ltr">foo</code> is being exported by <code translate="no" dir="ltr">foo_shared</code>. <code translate="no" dir="ltr">baz</code> is not assumed to be exported by <code translate="no" dir="ltr">foo_shared</code>. Every target matched by the <code translate="no" dir="ltr">exports_filter</code> is also assumed to be exported.</p> <p>Every single <code translate="no" dir="ltr">cc_library</code> in the example should appear at most in one <code translate="no" dir="ltr">cc_shared_library</code>. If we wanted to link <code translate="no" dir="ltr">baz</code> also into <code translate="no" dir="ltr">bar_shared</code> we would need to add <code translate="no" dir="ltr">tags = ["LINKABLE_MORE_THAN_ONCE"]</code> to <code translate="no" dir="ltr">baz</code>.</p> <p>Due to the <code translate="no" dir="ltr">shared_lib_name</code> attribute, the file produced by <code translate="no" dir="ltr">bar_shared</code> will have the name <code translate="no" dir="ltr">bar.so</code> as opposed to the name <code translate="no" dir="ltr">libbar.so</code> that it would have by default on Linux.</p> <h4 id="cc_shard_library_examples" data-text="Errors" tabindex="-1">Errors</h4> <h5 id="two-shared-libraries-in-dependencies-export-the-same-symbols." data-text="Two shared libraries in dependencies export the same symbols." tabindex="-1"><code translate="no" dir="ltr">Two shared libraries in dependencies export the same symbols.</code></h5> <p>This will happen whenever you are creating a target with two different <code translate="no" dir="ltr">cc_shared_library</code> dependencies that export the same target. To fix this you need to stop the libraries from being exported in one of the <code translate="no" dir="ltr">cc_shared_library</code> dependencies.</p> <h5 id="two-shared-libraries-in-dependencies-link-the-same-library-statically" data-text="Two shared libraries in dependencies link the same library statically" tabindex="-1"><code translate="no" dir="ltr">Two shared libraries in dependencies link the same library statically</code></h5> <p>This will happen whenever you are creating a new <code translate="no" dir="ltr">cc_shared_library</code> with two different <code translate="no" dir="ltr">cc_shared_library</code> dependencies that link the same target statically. Similar to the error with exports.</p> <p>One way to fix this is to stop linking the library into one of the <code translate="no" dir="ltr">cc_shared_library</code> dependencies. At the same time, the one that still links it needs to export the library so that the one not linking it keeps visibility to the symbols. Another way is to pull out a third library that exports the target. A third way is to tag the culprit <code translate="no" dir="ltr">cc_library</code> with <code translate="no" dir="ltr">LINKABLE_MORE_THAN_ONCE</code> but this fix should be rare and you should absolutely make sure that the <code translate="no" dir="ltr">cc_library</code> is indeed safe to link more than once.</p> <h5 id="foo:foo-is-already-linked-statically-in-bar:bar-but-not-exported`" data-text="'//foo:foo' is already linked statically in '//bar:bar' but not exported`" tabindex="-1"><code translate="no" dir="ltr">'//foo:foo' is already linked statically in '//bar:bar' but not exported`</code></h5> <p>This means that a library in the transitive closure of your <code translate="no" dir="ltr">deps</code> is reachable without going through one of the <code translate="no" dir="ltr">cc_shared_library</code> dependencies but is already linked into a different <code translate="no" dir="ltr">cc_shared_library</code> in <code translate="no" dir="ltr">dynamic_deps</code> and is not exported.</p> <p>The solution is to export it from the <code translate="no" dir="ltr">cc_shared_library</code> dependency or pull out a third <code translate="no" dir="ltr">cc_shared_library</code> that exports it.</p> <h5 id="do-not-place-libraries-which-only-contain-a-precompiled-dynamic-library-in-deps." data-text="Do not place libraries which only contain a precompiled dynamic library in deps. " tabindex="-1"><code translate="no" dir="ltr">Do not place libraries which only contain a precompiled dynamic library in deps.
</code></h5> <p>If you have a precompiled dynamic library, this doesn't need to and cannot be linked statically into the current <code translate="no" dir="ltr">cc_shared_library</code> target that you are currently creating. Therefore, it doesn't belong in <code translate="no" dir="ltr">deps</code> of the <code translate="no" dir="ltr">cc_shared_library</code>. If this precompiled dynamic library is a dependency of one of your <code translate="no" dir="ltr">cc_libraries</code>, then the <code translate="no" dir="ltr">cc_library</code> needs to depend on it directly.</p> <h5 id="trying-to-export-a-library-already-exported-by-a-different-shared-library" data-text="Trying to export a library already exported by a different shared library" tabindex="-1"><code translate="no" dir="ltr">Trying to export a library already exported by a different shared library</code></h5> <p>You will see this error if on the current rule you are claiming to export a target that is already being exported by one of your dynamic dependencies.</p> <p>To fix this, remove the target from <code translate="no" dir="ltr">deps</code> and just rely on it from the dynamic dependency or make sure that the <code translate="no" dir="ltr">exports_filter</code> doesn't catch this target.</p> <h3 id="cc_shared_library_args" data-text="Arguments" tabindex="-1">Arguments</h3> <table class="table table-condensed table-bordered table-params"> <colgroup> <col class="col-param"> <col class="param-description"> </colgroup> <thead> <tr> <th colspan="2">Attributes</th> </tr> </thead> <tbody> <tr> <td id="cc_shared_library.name"><code translate="no" dir="ltr">name</code></td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels#target-names">Name</a>; required</p> <p>A unique name for this target.</p> </td> </tr> <tr> <td id="cc_shared_library.deps"> <code translate="no" dir="ltr">deps</code> </td> <td> <p>List of <a href="https://bazel.build/versions/7.0.0/concepts/labels">labels</a>; default is <code translate="no" dir="ltr">[]</code></p> Top level libraries that will unconditionally be statically linked into the shared library after being whole-archived. <p> Any transitive library dependency of these direct deps will be linked into this shared library as long as they have not already been linked by a <code translate="no" dir="ltr">cc_shared_library</code> in <code translate="no" dir="ltr">dynamic_deps</code>.</p> <p> During analysis, the rule implementation will consider any target listed in <code translate="no" dir="ltr">deps</code> as being exported by the shared library in order to give errors when multiple <code translate="no" dir="ltr">cc_shared_libraries</code> export the same targets. The rule implementation does not take care of informing the linker about which symbols should be exported by the shared object. The user should take care of this via linker scripts or visibility declarations in the source code.</p> <p> The implementation will also trigger errors whenever the same library is linked statically into more than one <code translate="no" dir="ltr">cc_shared_library</code>. This can be avoided by adding <code translate="no" dir="ltr">"LINKABLE_MORE_THAN_ONCE"</code> to the <code translate="no" dir="ltr">cc_library.tags</code> or by listing the `cc_library` as an export of one of the shared libraries so that one can be made a <code translate="no" dir="ltr">dynamic_dep</code> of the other. </p> </td> </tr> <tr> <td id="cc_shared_library.additional_linker_inputs"> <code translate="no" dir="ltr">additional_linker_inputs</code> </td> <td> <p>List of <a href="https://bazel.build/versions/7.0.0/concepts/labels">labels</a>; default is <code translate="no" dir="ltr">[]</code></p> Any additional files that you may want to pass to the linker, for example, linker scripts. You have to separately pass any linker flags that the linker needs in order to be aware of this file. You can do so via the <code translate="no" dir="ltr">user_link_flags</code> attribute. </td> </tr> <tr> <td id="cc_shared_library.dynamic_deps"> <code translate="no" dir="ltr">dynamic_deps</code> </td> <td> <p>List of <a href="https://bazel.build/versions/7.0.0/concepts/labels">labels</a>; default is <code translate="no" dir="ltr">[]</code></p> These are other <code translate="no" dir="ltr">cc_shared_library</code> dependencies the current target depends on. <p> The <code translate="no" dir="ltr">cc_shared_library</code> implementation will use the list of <code translate="no" dir="ltr">dynamic_deps</code> (transitively, i.e. also the <code translate="no" dir="ltr">dynamic_deps</code> of the current target's <code translate="no" dir="ltr">dynamic_deps</code>) to decide which <code translate="no" dir="ltr">cc_libraries</code> in the transitive <code translate="no" dir="ltr">deps</code> should not be linked in because they are already provided by a different <code translate="no" dir="ltr">cc_shared_library</code>. </p> </td> </tr> <tr> <td id="cc_shared_library.exports_filter"> <code translate="no" dir="ltr">exports_filter</code> </td> <td> <p>List of strings; default is <code translate="no" dir="ltr">[]</code></p> This attribute contains a list of targets that are claimed to be exported by the current shared library. <p> Any target <code translate="no" dir="ltr">deps</code> is already understood to be exported by the shared library. This attribute should be used to list any targets that are exported by the shared library but are transitive dependencies of <code translate="no" dir="ltr">deps</code>. </p> <p> Note that this attribute is not actually adding a dependency edge to those targets, the dependency edge should instead be created by <code translate="no" dir="ltr">deps</code>.The entries in this attribute are just strings. Keep in mind that when placing a target in this attribute, this is considered a claim that the shared library exports the symbols from that target. The <code translate="no" dir="ltr">cc_shared_library</code> logic doesn't actually handle telling the linker which symbols should be exported. </p> <p>The following syntax is allowed:</p> <p><code translate="no" dir="ltr">//foo:__package__</code> to account for any target in foo/BUILD</p> <p><code translate="no" dir="ltr">//foo:__subpackages__</code> to account for any target in foo/BUILD or any other package below foo/ like foo/bar/BUILD</p> </td> </tr> <tr> <td id="cc_shared_library.shared_lib_name"> <code translate="no" dir="ltr">shared_lib_name</code> </td> <td> <p>String; default is <code translate="no" dir="ltr">""</code></p> By default cc_shared_library will use a name for the shared library output file based on the target's name and the platform. This includes an extension and sometimes a prefix. Sometimes you may not want the default name, for example, when loading C++ shared libraries for Python the default lib* prefix is often not desired, in which case you can use this attribute to choose a custom name. </td> </tr> <tr> <td id="cc_shared_library.user_link_flags"> <code translate="no" dir="ltr">user_link_flags</code> </td> <td> <p>List of strings; default is <code translate="no" dir="ltr">[]</code></p> Any additional flags that you may want to pass to the linker. For example, to make the linker aware of a linker script passed via additional_linker_inputs you can use the following: <pre class="code" translate="no" dir="ltr">
         cc_shared_library(
            name = "foo_shared",
            additional_linker_inputs = select({
              "//src/conditions:linux": [
                ":foo.lds",
                ":additional_script.txt",
              ],
              "//conditions:default": []}),
            user_link_flags = select({
              "//src/conditions:linux": [
                "-Wl,-rpath,kittens",
                "-Wl,--version-script=$(location :foo.lds)",
                "-Wl,--script=$(location :additional_script.txt)",
              ],
              "//conditions:default": []}),
              ...
         )
        </pre> </td> </tr> <tr> <td id="cc_shared_library.win_def_file"> <code translate="no" dir="ltr">win_def_file</code> </td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels">Label</a>; default is <code translate="no" dir="ltr">None</code></p> The Windows DEF file to be passed to linker. <p>This attribute should only be used when Windows is the target platform. It can be used to <a href="https://msdn.microsoft.com/en-us/library/d91k01sh.aspx"> export symbols</a> during linking a shared library.</p> </td> </tr> </tbody> </table> <h2 id="fdo_prefetch_hints" data-text="     fdo_prefetch_hints   " tabindex="-1"> fdo_prefetch_hints </h2>  <pre class="rule-signature" translate="no" dir="ltr">fdo_prefetch_hints(<a href="#fdo_prefetch_hints.name">name</a>, <a href="common-definitions#common.compatible_with">compatible_with</a>, <a href="common-definitions#common.deprecation">deprecation</a>, <a href="common-definitions#common.distribs">distribs</a>, <a href="common-definitions#common.features">features</a>, <a href="common-definitions#typical.licenses">licenses</a>, <a href="#fdo_prefetch_hints.profile">profile</a>, <a href="common-definitions#common.restricted_to">restricted_to</a>, <a href="common-definitions#common.tags">tags</a>, <a href="common-definitions#common.target_compatible_with">target_compatible_with</a>, <a href="common-definitions#common.testonly">testonly</a>, <a href="common-definitions#common.visibility">visibility</a>)</pre> <p>Represents an FDO prefetch hints profile that is either in the workspace or at a specified absolute path. Examples:</p> <pre class="code" translate="no" dir="ltr">
fdo_prefetch_hints(
    name = "hints",
    profile = "//path/to/hints:profile.afdo",
)

fdo_profile(
  name = "hints_abs",
  absolute_path_profile = "/absolute/path/profile.afdo",
)
</pre> <h3 id="fdo_prefetch_hints_args" data-text="Arguments" tabindex="-1">Arguments</h3> <table class="table table-condensed table-bordered table-params"> <colgroup> <col class="col-param"> <col class="param-description"> </colgroup> <thead> <tr> <th colspan="2">Attributes</th> </tr> </thead> <tbody> <tr> <td id="fdo_prefetch_hints.name"><code translate="no" dir="ltr">name</code></td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels#target-names">Name</a>; required</p> <p>A unique name for this target.</p> </td> </tr> <tr> <td id="fdo_prefetch_hints.profile"> <code translate="no" dir="ltr">profile</code> </td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels">Label</a>; default is <code translate="no" dir="ltr">None</code></p> Label of the hints profile. The hints file has the .afdo extension The label can also point to an fdo_absolute_path_profile rule. </td> </tr> </tbody> </table> <h2 id="fdo_profile" data-text="     fdo_profile   " tabindex="-1"> fdo_profile </h2>  <pre class="rule-signature" translate="no" dir="ltr">fdo_profile(<a href="#fdo_profile.name">name</a>, <a href="#fdo_profile.absolute_path_profile">absolute_path_profile</a>, <a href="common-definitions#common.compatible_with">compatible_with</a>, <a href="common-definitions#common.deprecation">deprecation</a>, <a href="common-definitions#common.distribs">distribs</a>, <a href="common-definitions#common.features">features</a>, <a href="common-definitions#typical.licenses">licenses</a>, <a href="#fdo_profile.profile">profile</a>, <a href="#fdo_profile.proto_profile">proto_profile</a>, <a href="common-definitions#common.restricted_to">restricted_to</a>, <a href="common-definitions#common.tags">tags</a>, <a href="common-definitions#common.target_compatible_with">target_compatible_with</a>, <a href="common-definitions#common.testonly">testonly</a>, <a href="common-definitions#common.visibility">visibility</a>)</pre> <p>Represents an FDO profile that is either in the workspace or at a specified absolute path. Examples:</p> <pre class="code" translate="no" dir="ltr">
fdo_profile(
    name = "fdo",
    profile = "//path/to/fdo:profile.zip",
)

fdo_profile(
  name = "fdo_abs",
  absolute_path_profile = "/absolute/path/profile.zip",
)
</pre> <h3 id="fdo_profile_args" data-text="Arguments" tabindex="-1">Arguments</h3> <table class="table table-condensed table-bordered table-params"> <colgroup> <col class="col-param"> <col class="param-description"> </colgroup> <thead> <tr> <th colspan="2">Attributes</th> </tr> </thead> <tbody> <tr> <td id="fdo_profile.name"><code translate="no" dir="ltr">name</code></td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels#target-names">Name</a>; required</p> <p>A unique name for this target.</p> </td> </tr> <tr> <td id="fdo_profile.absolute_path_profile"> <code translate="no" dir="ltr">absolute_path_profile</code> </td> <td> <p>String; default is <code translate="no" dir="ltr">""</code></p> Absolute path to the FDO profile. The FDO file can have one of the following extensions: .profraw for unindexed LLVM profile, .profdata for indexed LLVM profile, .zip that holds an LLVM profraw profile, or .afdo for AutoFDO profile. </td> </tr> <tr> <td id="fdo_profile.profile"> <code translate="no" dir="ltr">profile</code> </td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels">Label</a>; default is <code translate="no" dir="ltr">None</code></p> Label of the FDO profile or a rule which generates it. The FDO file can have one of the following extensions: .profraw for unindexed LLVM profile, .profdata for indexed LLVM profile, .zip that holds an LLVM profraw profile, .afdo for AutoFDO profile, .xfdo for XBinary profile. The label can also point to an fdo_absolute_path_profile rule. </td> </tr> <tr> <td id="fdo_profile.proto_profile"> <code translate="no" dir="ltr">proto_profile</code> </td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels">Label</a>; default is <code translate="no" dir="ltr">None</code></p> Label of the protobuf profile. </td> </tr> </tbody> </table> <h2 id="memprof_profile" data-text="     memprof_profile   " tabindex="-1"> memprof_profile </h2>  <pre class="rule-signature" translate="no" dir="ltr">memprof_profile(<a href="#memprof_profile.name">name</a>, <a href="#memprof_profile.absolute_path_profile">absolute_path_profile</a>, <a href="common-definitions#common.compatible_with">compatible_with</a>, <a href="common-definitions#common.deprecation">deprecation</a>, <a href="common-definitions#common.distribs">distribs</a>, <a href="common-definitions#common.features">features</a>, <a href="common-definitions#typical.licenses">licenses</a>, <a href="#memprof_profile.profile">profile</a>, <a href="common-definitions#common.restricted_to">restricted_to</a>, <a href="common-definitions#common.tags">tags</a>, <a href="common-definitions#common.target_compatible_with">target_compatible_with</a>, <a href="common-definitions#common.testonly">testonly</a>, <a href="common-definitions#common.visibility">visibility</a>)</pre> <p>Represents a MEMPROF profile that is either in the workspace or at a specified absolute path. Examples:</p> <pre class="code" translate="no" dir="ltr">
memprof_profile(
    name = "memprof",
    profile = "//path/to/memprof:profile.afdo",
)

memprof_profile(
  name = "memprof_abs",
  absolute_path_profile = "/absolute/path/profile.afdo",
)
</pre> <h3 id="memprof_profile_args" data-text="Arguments" tabindex="-1">Arguments</h3> <table class="table table-condensed table-bordered table-params"> <colgroup> <col class="col-param"> <col class="param-description"> </colgroup> <thead> <tr> <th colspan="2">Attributes</th> </tr> </thead> <tbody> <tr> <td id="memprof_profile.name"><code translate="no" dir="ltr">name</code></td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels#target-names">Name</a>; required</p> <p>A unique name for this target.</p> </td> </tr> <tr> <td id="memprof_profile.absolute_path_profile"> <code translate="no" dir="ltr">absolute_path_profile</code> </td> <td> <p>String; default is <code translate="no" dir="ltr">""</code></p> Absolute path to the MEMPROF profile. The file may only have a .profdata or .zip extension (where the zipfile must contain a memprof.profdata file). </td> </tr> <tr> <td id="memprof_profile.profile"> <code translate="no" dir="ltr">profile</code> </td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels">Label</a>; default is <code translate="no" dir="ltr">None</code></p> Label of the MEMPROF profile. The profile is expected to have either a .profdata extension (for an indexed/symbolized memprof profile), or a .zip extension for a zipfile containing a memprof.profdata file. The label can also point to an fdo_absolute_path_profile rule. </td> </tr> </tbody> </table> <h2 id="propeller_optimize" data-text="     propeller_optimize   " tabindex="-1"> propeller_optimize </h2>  <pre class="rule-signature" translate="no" dir="ltr">propeller_optimize(<a href="#propeller_optimize.name">name</a>, <a href="common-definitions#common.compatible_with">compatible_with</a>, <a href="common-definitions#common.deprecation">deprecation</a>, <a href="common-definitions#common.distribs">distribs</a>, <a href="common-definitions#common.features">features</a>, <a href="#propeller_optimize.ld_profile">ld_profile</a>, <a href="common-definitions#typical.licenses">licenses</a>, <a href="common-definitions#common.restricted_to">restricted_to</a>, <a href="common-definitions#common.tags">tags</a>, <a href="common-definitions#common.target_compatible_with">target_compatible_with</a>, <a href="common-definitions#common.testonly">testonly</a>, <a href="common-definitions#common.visibility">visibility</a>)</pre> <p>Represents a Propeller optimization profile in the workspace. Example:</p> <pre class="code" translate="no" dir="ltr">
propeller_optimize(
    name = "layout",
    cc_profile = "//path:cc_profile.txt",
    ld_profile = "//path:ld_profile.txt"
)

propeller_optimize(
    name = "layout_absolute",
    absolute_cc_profile = "/absolute/cc_profile.txt",
    absolute_ld_profile = "/absolute/ld_profile.txt"
)
</pre> <h3 id="propeller_optimize_args" data-text="Arguments" tabindex="-1">Arguments</h3> <table class="table table-condensed table-bordered table-params"> <colgroup> <col class="col-param"> <col class="param-description"> </colgroup> <thead> <tr> <th colspan="2">Attributes</th> </tr> </thead> <tbody> <tr> <td id="propeller_optimize.name"><code translate="no" dir="ltr">name</code></td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels#target-names">Name</a>; required</p> <p>A unique name for this target.</p> </td> </tr> <tr> <td id="propeller_optimize.ld_profile"> <code translate="no" dir="ltr">ld_profile</code> </td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels">Label</a>; default is <code translate="no" dir="ltr">None</code></p> Label of the profile passed to the link action. This file has the .txt extension. </td> </tr> </tbody> </table> <h2 id="cc_test" data-text="     cc_test   " tabindex="-1"> cc_test </h2>  <pre class="rule-signature" translate="no" dir="ltr">cc_test(<a href="#cc_test.name">name</a>, <a href="#cc_test.deps">deps</a>, <a href="#cc_test.srcs">srcs</a>, <a href="common-definitions#typical.data">data</a>, <a href="#cc_test.additional_linker_inputs">additional_linker_inputs</a>, <a href="common-definitions#test.args">args</a>, <a href="common-definitions#common.compatible_with">compatible_with</a>, <a href="#cc_test.copts">copts</a>, <a href="#cc_test.defines">defines</a>, <a href="common-definitions#common.deprecation">deprecation</a>, <a href="common-definitions#common.distribs">distribs</a>, <a href="common-definitions#test.env">env</a>, <a href="common-definitions#test.env_inherit">env_inherit</a>, <a href="common-definitions#common.exec_compatible_with">exec_compatible_with</a>, <a href="common-definitions#common.exec_properties">exec_properties</a>, <a href="common-definitions#common.features">features</a>, <a href="common-definitions#test.flaky">flaky</a>, <a href="#cc_test.includes">includes</a>, <a href="common-definitions#typical.licenses">licenses</a>, <a href="#cc_test.link_extra_lib">link_extra_lib</a>, <a href="#cc_test.linkopts">linkopts</a>, <a href="#cc_test.linkstatic">linkstatic</a>, <a href="common-definitions#test.local">local</a>, <a href="#cc_test.local_defines">local_defines</a>, <a href="#cc_test.malloc">malloc</a>, <a href="#cc_test.nocopts">nocopts</a>, <a href="common-definitions#common.restricted_to">restricted_to</a>, <a href="common-definitions#test.shard_count">shard_count</a>, <a href="common-definitions#test.size">size</a>, <a href="#cc_test.stamp">stamp</a>, <a href="common-definitions#common.tags">tags</a>, <a href="common-definitions#common.target_compatible_with">target_compatible_with</a>, <a href="common-definitions#common.testonly">testonly</a>, <a href="common-definitions#test.timeout">timeout</a>, <a href="common-definitions#common.toolchains">toolchains</a>, <a href="common-definitions#common.visibility">visibility</a>, <a href="#cc_test.win_def_file">win_def_file</a>)</pre> <h3 id="cc_test_args" data-text="Arguments" tabindex="-1">Arguments</h3> <table class="table table-condensed table-bordered table-params"> <colgroup> <col class="col-param"> <col class="param-description"> </colgroup> <thead> <tr> <th colspan="2">Attributes</th> </tr> </thead> <tbody> <tr> <td id="cc_test.name"><code translate="no" dir="ltr">name</code></td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels#target-names">Name</a>; required</p> <p>A unique name for this target.</p> </td> </tr> <tr> <td id="cc_test.deps"> <code translate="no" dir="ltr">deps</code> </td> <td> <p>List of <a href="https://bazel.build/versions/7.0.0/concepts/labels">labels</a>; default is <code translate="no" dir="ltr">[]</code></p> The list of other libraries to be linked in to the binary target. <p>These can be <code translate="no" dir="ltr">cc_library</code> or <code translate="no" dir="ltr">objc_library</code> targets.</p> </td> </tr> <tr> <td id="cc_test.srcs"> <code translate="no" dir="ltr">srcs</code> </td> <td> <p>List of <a href="https://bazel.build/versions/7.0.0/concepts/labels">labels</a>; default is <code translate="no" dir="ltr">[]</code></p> The list of C and C++ files that are processed to create the target. These are C/C++ source and header files, either non-generated (normal source code) or generated. <p>All <code translate="no" dir="ltr">.cc</code>, <code translate="no" dir="ltr">.c</code>, and <code translate="no" dir="ltr">.cpp</code> files will be compiled. These might be generated files: if a named file is in the <code translate="no" dir="ltr">outs</code> of some other rule, this rule will automatically depend on that other rule. </p> <p>A <code translate="no" dir="ltr">.h</code> file will not be compiled, but will be available for inclusion by sources in this rule. Both <code translate="no" dir="ltr">.cc</code> and <code translate="no" dir="ltr">.h</code> files can directly include headers listed in these <code translate="no" dir="ltr">srcs</code> or in the <code translate="no" dir="ltr">hdrs</code> of any rule listed in the <code translate="no" dir="ltr">deps</code> argument. </p> <p>All <code translate="no" dir="ltr">#include</code>d files must be mentioned in the <code translate="no" dir="ltr">srcs</code> attribute of this rule, or in the <code translate="no" dir="ltr">hdrs</code> attribute of referenced <code translate="no" dir="ltr">cc_library()</code>s. The recommended style is for headers associated with a library to be listed in that library's <code translate="no" dir="ltr">hdrs</code> attribute, and any remaining headers associated with this rule's sources to be listed in <code translate="no" dir="ltr">srcs</code>. See <a href="#hdrs">"Header inclusion checking"</a> for a more detailed description. </p> <p>If a rule's name is in the <code translate="no" dir="ltr">srcs</code>, then this rule automatically depends on that one. If the named rule's <code translate="no" dir="ltr">outs</code> are C or C++ source files, they are compiled into this rule; if they are library files, they are linked in. </p> <p> Permitted <code translate="no" dir="ltr">srcs</code> file types: </p> <ul> <li>C and C++ source files: <code translate="no" dir="ltr">.c</code>, <code translate="no" dir="ltr">.cc</code>, <code translate="no" dir="ltr">.cpp</code>, <code translate="no" dir="ltr">.cxx</code>, <code translate="no" dir="ltr">.c++</code>, <code translate="no" dir="ltr">.C</code>
</li> <li>C and C++ header files: <code translate="no" dir="ltr">.h</code>, <code translate="no" dir="ltr">.hh</code>, <code translate="no" dir="ltr">.hpp</code>, <code translate="no" dir="ltr">.hxx</code>, <code translate="no" dir="ltr">.inc</code>, <code translate="no" dir="ltr">.inl</code>, <code translate="no" dir="ltr">.H</code>
</li> <li>Assembler with C preprocessor: <code translate="no" dir="ltr">.S</code>
</li> <li>Archive: <code translate="no" dir="ltr">.a</code>, <code translate="no" dir="ltr">.pic.a</code>
</li> <li>"Always link" library: <code translate="no" dir="ltr">.lo</code>, <code translate="no" dir="ltr">.pic.lo</code>
</li> <li>Shared library, versioned or unversioned: <code translate="no" dir="ltr">.so</code>, <code translate="no" dir="ltr">.so.<i>version</i></code>
</li> <li>Object file: <code translate="no" dir="ltr">.o</code>, <code translate="no" dir="ltr">.pic.o</code>
</li> </ul> <p> ...and any rules that produce those files. Different extensions denote different programming languages in accordance with gcc convention. </p> </td> </tr> <tr> <td id="cc_test.additional_linker_inputs"> <code translate="no" dir="ltr">additional_linker_inputs</code> </td> <td> <p>List of <a href="https://bazel.build/versions/7.0.0/concepts/labels">labels</a>; default is <code translate="no" dir="ltr">[]</code></p> Pass these files to the C++ linker command. <p> For example, compiled Windows .res files can be provided here to be embedded in the binary target. </p> </td> </tr> <tr> <td id="cc_test.copts"> <code translate="no" dir="ltr">copts</code> </td> <td> <p>List of strings; default is <code translate="no" dir="ltr">[]</code></p> Add these options to the C++ compilation command. Subject to <a href="make-variables">"Make variable"</a> substitution and <a href="common-definitions#sh-tokenization">Bourne shell tokenization</a>. <p> Each string in this attribute is added in the given order to <code translate="no" dir="ltr">COPTS</code> before compiling the binary target. The flags take effect only for compiling this target, not its dependencies, so be careful about header files included elsewhere. All paths should be relative to the workspace, not to the current package. </p> <p> If the package declares the <a href="functions#package.features">feature</a> <code translate="no" dir="ltr">no_copts_tokenization</code>, Bourne shell tokenization applies only to strings that consist of a single "Make" variable. </p> </td> </tr> <tr> <td id="cc_test.defines"> <code translate="no" dir="ltr">defines</code> </td> <td> <p>List of strings; default is <code translate="no" dir="ltr">[]</code></p> List of defines to add to the compile line. Subject to <a href="make-variables">"Make" variable</a> substitution and <a href="common-definitions#sh-tokenization">Bourne shell tokenization</a>. Each string, which must consist of a single Bourne shell token, is prepended with <code translate="no" dir="ltr">-D</code> and added to the compile command line to this target, as well as to every rule that depends on it. Be very careful, since this may have far-reaching effects. When in doubt, add define values to <a href="#cc_binary.local_defines"><code translate="no" dir="ltr">local_defines</code></a> instead. </td> </tr> <tr> <td id="cc_test.includes"> <code translate="no" dir="ltr">includes</code> </td> <td> <p>List of strings; default is <code translate="no" dir="ltr">[]</code></p> List of include dirs to be added to the compile line. <p> Subject to <a href="make-variables">"Make variable"</a> substitution. Each string is prepended with <code translate="no" dir="ltr">-isystem</code> and added to <code translate="no" dir="ltr">COPTS</code>. Unlike <a href="#cc_binary.copts">COPTS</a>, these flags are added for this rule and every rule that depends on it. (Note: not the rules it depends upon!) Be very careful, since this may have far-reaching effects. When in doubt, add "-I" flags to <a href="#cc_binary.copts">COPTS</a> instead. </p> <p> Headers must be added to srcs or hdrs, otherwise they will not be available to dependent rules when compilation is sandboxed (the default). </p> </td> </tr> <tr> <td id="cc_test.link_extra_lib"> <code translate="no" dir="ltr">link_extra_lib</code> </td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels">Label</a>; default is <code translate="no" dir="ltr">"@bazel_tools//tools/cpp:link_extra_lib"</code></p> Control linking of extra libraries. <p> By default, C++ binaries are linked against <code translate="no" dir="ltr">//tools/cpp:link_extra_lib</code>, which by default depends on the label flag <code translate="no" dir="ltr">//tools/cpp:link_extra_libs</code>. Without setting the flag, this library is empty by default. Setting the label flag allows linking optional dependencies, such as overrides for weak symbols, interceptors for shared library functions, or special runtime libraries (for malloc replacements, prefer <code translate="no" dir="ltr">malloc</code> or <code translate="no" dir="ltr">--custom_malloc</code>). Setting this attribute to <code translate="no" dir="ltr">None</code> disables this behaviour. </p> </td> </tr> <tr> <td id="cc_test.linkopts"> <code translate="no" dir="ltr">linkopts</code> </td> <td> <p>List of strings; default is <code translate="no" dir="ltr">[]</code></p> Add these flags to the C++ linker command. Subject to <a href="make-variables">"Make" variable</a> substitution, <a href="common-definitions#sh-tokenization"> Bourne shell tokenization</a> and <a href="common-definitions#label-expansion">label expansion</a>. Each string in this attribute is added to <code translate="no" dir="ltr">LINKOPTS</code> before linking the binary target. <p> Each element of this list that does not start with <code translate="no" dir="ltr">$</code> or <code translate="no" dir="ltr">-</code> is assumed to be the label of a target in <code translate="no" dir="ltr">deps</code>. The list of files generated by that target is appended to the linker options. An error is reported if the label is invalid, or is not declared in <code translate="no" dir="ltr">deps</code>. </p> </td> </tr> <tr> <td id="cc_test.linkstatic"> <code translate="no" dir="ltr">linkstatic</code> </td> <td> <p>Boolean; default is <code translate="no" dir="ltr">False</code></p> For <a href="c-cpp#cc_binary"><code translate="no" dir="ltr">cc_binary</code></a> and <a href="c-cpp#cc_test"><code translate="no" dir="ltr">cc_test</code></a>: link the binary in static mode. For <code translate="no" dir="ltr">cc_library.linkstatic</code>: see below. <p> By default this option is on for <code translate="no" dir="ltr">cc_binary</code> and off for the rest. </p> <p> If enabled and this is a binary or test, this option tells the build tool to link in <code translate="no" dir="ltr">.a</code>'s instead of <code translate="no" dir="ltr">.so</code>'s for user libraries whenever possible. Some system libraries may still be linked dynamically, as are libraries for which there is no static library. So the resulting executable will still be dynamically linked, hence only <i>mostly</i> static. </p> <p>There are really three different ways to link an executable:</p> <ul> <li> STATIC with fully_static_link feature, in which everything is linked statically; e.g. "<code translate="no" dir="ltr">gcc -static foo.o libbar.a libbaz.a -lm</code>".<br> This mode is enabled by specifying <code translate="no" dir="ltr">fully_static_link</code> in the <a href="common-definitions#features"><code translate="no" dir="ltr">features</code></a> attribute.</li> <li> STATIC, in which all user libraries are linked statically (if a static version is available), but where system libraries (excluding C/C++ runtime libraries) are linked dynamically, e.g. "<code translate="no" dir="ltr">gcc foo.o libfoo.a libbaz.a -lm</code>".<br> This mode is enabled by specifying <code translate="no" dir="ltr">linkstatic=True</code>.</li> <li> DYNAMIC, in which all libraries are linked dynamically (if a dynamic version is available), e.g. "<code translate="no" dir="ltr">gcc foo.o libfoo.so libbaz.so -lm</code>".<br> This mode is enabled by specifying <code translate="no" dir="ltr">linkstatic=False</code>.</li> </ul> <p> The <code translate="no" dir="ltr">linkstatic</code> attribute has a different meaning if used on a <a href="c-cpp#cc_library"><code translate="no" dir="ltr">cc_library()</code></a> rule. For a C++ library, <code translate="no" dir="ltr">linkstatic=True</code> indicates that only static linking is allowed, so no <code translate="no" dir="ltr">.so</code> will be produced. linkstatic=False does not prevent static libraries from being created. The attribute is meant to control the creation of dynamic libraries. </p> <p> If <code translate="no" dir="ltr">linkstatic=False</code>, then the build tool will create symlinks to depended-upon shared libraries in the <code translate="no" dir="ltr">*.runfiles</code> area. </p> </td> </tr> <tr> <td id="cc_test.local_defines"> <code translate="no" dir="ltr">local_defines</code> </td> <td> <p>List of strings; default is <code translate="no" dir="ltr">[]</code></p> List of defines to add to the compile line. Subject to <a href="make-variables">"Make" variable</a> substitution and <a href="common-definitions#sh-tokenization">Bourne shell tokenization</a>. Each string, which must consist of a single Bourne shell token, is prepended with <code translate="no" dir="ltr">-D</code> and added to the compile command line for this target, but not to its dependents. </td> </tr> <tr> <td id="cc_test.malloc"> <code translate="no" dir="ltr">malloc</code> </td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels">Label</a>; default is <code translate="no" dir="ltr">"@bazel_tools//tools/cpp:malloc"</code></p> Override the default dependency on malloc. <p> By default, C++ binaries are linked against <code translate="no" dir="ltr">//tools/cpp:malloc</code>, which is an empty library so the binary ends up using libc malloc. This label must refer to a <code translate="no" dir="ltr">cc_library</code>. If compilation is for a non-C++ rule, this option has no effect. The value of this attribute is ignored if <code translate="no" dir="ltr">linkshared=True</code> is specified. </p> </td> </tr> <tr> <td id="cc_test.nocopts"> <code translate="no" dir="ltr">nocopts</code> </td> <td> <p>String; default is <code translate="no" dir="ltr">""</code></p> Remove matching options from the C++ compilation command. Subject to <a href="make-variables">"Make" variable</a> substitution. The value of this attribute is interpreted as a regular expression. Any preexisting <code translate="no" dir="ltr">COPTS</code> that match this regular expression (including values explicitly specified in the rule's <a href="#cc_binary.copts">copts</a> attribute) will be removed from <code translate="no" dir="ltr">COPTS</code> for purposes of compiling this rule. This attribute should rarely be needed. </td> </tr> <tr> <td id="cc_test.stamp"> <code translate="no" dir="ltr">stamp</code> </td> <td> <p>Integer; default is <code translate="no" dir="ltr">0</code></p> Whether to encode build information into the binary. Possible values: <ul> <li> <code translate="no" dir="ltr">stamp = 1</code>: Always stamp the build information into the binary, even in <a href="https://bazel.build/versions/7.0.0/docs/user-manual#flag--stamp"><code translate="no" dir="ltr">--nostamp</code></a> builds. <b>This setting should be avoided</b>, since it potentially kills remote caching for the binary and any downstream actions that depend on it. </li> <li> <code translate="no" dir="ltr">stamp = 0</code>: Always replace build information by constant values. This gives good build result caching. </li> <li> <code translate="no" dir="ltr">stamp = -1</code>: Embedding of build information is controlled by the <a href="https://bazel.build/versions/7.0.0/docs/user-manual#flag--stamp"><code translate="no" dir="ltr">--[no]stamp</code></a> flag. </li> </ul> <p>Stamped binaries are <em>not</em> rebuilt unless their dependencies change.</p> </td> </tr> <tr> <td id="cc_test.win_def_file"> <code translate="no" dir="ltr">win_def_file</code> </td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels">Label</a>; default is <code translate="no" dir="ltr">None</code></p> The Windows DEF file to be passed to linker. <p>This attribute should only be used when Windows is the target platform. It can be used to <a href="https://msdn.microsoft.com/en-us/library/d91k01sh.aspx"> export symbols</a> during linking a shared library.</p> </td> </tr> </tbody> </table> <h2 id="cc_toolchain" data-text="     cc_toolchain   " tabindex="-1"> cc_toolchain </h2>  <pre class="rule-signature" translate="no" dir="ltr">cc_toolchain(<a href="#cc_toolchain.name">name</a>, <a href="#cc_toolchain.all_files">all_files</a>, <a href="#cc_toolchain.ar_files">ar_files</a>, <a href="#cc_toolchain.as_files">as_files</a>, <a href="common-definitions#common.compatible_with">compatible_with</a>, <a href="#cc_toolchain.compiler_files">compiler_files</a>, <a href="#cc_toolchain.compiler_files_without_includes">compiler_files_without_includes</a>, <a href="#cc_toolchain.coverage_files">coverage_files</a>, <a href="common-definitions#common.deprecation">deprecation</a>, <a href="common-definitions#common.distribs">distribs</a>, <a href="#cc_toolchain.dwp_files">dwp_files</a>, <a href="#cc_toolchain.dynamic_runtime_lib">dynamic_runtime_lib</a>, <a href="#cc_toolchain.exec_transition_for_inputs">exec_transition_for_inputs</a>, <a href="common-definitions#common.features">features</a>, <a href="#cc_toolchain.libc_top">libc_top</a>, <a href="common-definitions#typical.licenses">licenses</a>, <a href="#cc_toolchain.linker_files">linker_files</a>, <a href="#cc_toolchain.module_map">module_map</a>, <a href="#cc_toolchain.objcopy_files">objcopy_files</a>, <a href="common-definitions#common.restricted_to">restricted_to</a>, <a href="#cc_toolchain.static_runtime_lib">static_runtime_lib</a>, <a href="#cc_toolchain.strip_files">strip_files</a>, <a href="#cc_toolchain.supports_header_parsing">supports_header_parsing</a>, <a href="#cc_toolchain.supports_param_files">supports_param_files</a>, <a href="common-definitions#common.tags">tags</a>, <a href="common-definitions#common.target_compatible_with">target_compatible_with</a>, <a href="common-definitions#common.testonly">testonly</a>, <a href="#cc_toolchain.toolchain_config">toolchain_config</a>, <a href="#cc_toolchain.toolchain_identifier">toolchain_identifier</a>, <a href="common-definitions#common.visibility">visibility</a>)</pre> <p>Represents a C++ toolchain.</p> <p> This rule is responsible for: </p>
<ul> <li> Collecting all artifacts needed for C++ actions to run. This is done by attributes such as <code translate="no" dir="ltr">all_files</code>, <code translate="no" dir="ltr">compiler_files</code>, <code translate="no" dir="ltr">linker_files</code>, or other attributes ending with <code translate="no" dir="ltr">_files</code>). These are most commonly filegroups globbing all required files. </li> <li> Generating correct command lines for C++ actions. This is done using <code translate="no" dir="ltr">CcToolchainConfigInfo</code> provider (details below). </li> </ul> <p> Use <code translate="no" dir="ltr">toolchain_config</code> attribute to configure the C++ toolchain. See also this <a href="https://bazel.build/versions/7.0.0/docs/cc-toolchain-config-reference"> page </a> for elaborate C++ toolchain configuration and toolchain selection documentation. </p> <p> Use <code translate="no" dir="ltr">tags = ["manual"]</code> in order to prevent toolchains from being built and configured unnecessarily when invoking <code translate="no" dir="ltr">bazel build //...</code> </p> <h3 id="cc_toolchain_args" data-text="Arguments" tabindex="-1">Arguments</h3> <table class="table table-condensed table-bordered table-params"> <colgroup> <col class="col-param"> <col class="param-description"> </colgroup> <thead> <tr> <th colspan="2">Attributes</th> </tr> </thead> <tbody> <tr> <td id="cc_toolchain.name"><code translate="no" dir="ltr">name</code></td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels#target-names">Name</a>; required</p> <p>A unique name for this target.</p> </td> </tr> <tr> <td id="cc_toolchain.all_files"> <code translate="no" dir="ltr">all_files</code> </td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels">Label</a>; required</p> Collection of all cc_toolchain artifacts. These artifacts will be added as inputs to all rules_cc related actions (with the exception of actions that are using more precise sets of artifacts from attributes below). Bazel assumes that <code translate="no" dir="ltr">all_files</code> is a superset of all other artifact-providing attributes (e.g. linkstamp compilation needs both compile and link files, so it takes <code translate="no" dir="ltr">all_files</code>). <p> This is what <code translate="no" dir="ltr">cc_toolchain.files</code> contains, and this is used by all Starlark rules using C++ toolchain.</p> </td> </tr> <tr> <td id="cc_toolchain.ar_files"> <code translate="no" dir="ltr">ar_files</code> </td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels">Label</a>; default is <code translate="no" dir="ltr">None</code></p> <p>Collection of all cc_toolchain artifacts required for archiving actions.</p> </td> </tr> <tr> <td id="cc_toolchain.as_files"> <code translate="no" dir="ltr">as_files</code> </td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels">Label</a>; default is <code translate="no" dir="ltr">None</code></p> <p>Collection of all cc_toolchain artifacts required for assembly actions.</p> </td> </tr> <tr> <td id="cc_toolchain.compiler_files"> <code translate="no" dir="ltr">compiler_files</code> </td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels">Label</a>; required</p> Collection of all cc_toolchain artifacts required for compile actions. </td> </tr> <tr> <td id="cc_toolchain.compiler_files_without_includes"> <code translate="no" dir="ltr">compiler_files_without_includes</code> </td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels">Label</a>; default is <code translate="no" dir="ltr">None</code></p> Collection of all cc_toolchain artifacts required for compile actions in case when input discovery is supported (currently Google-only). </td> </tr> <tr> <td id="cc_toolchain.coverage_files"> <code translate="no" dir="ltr">coverage_files</code> </td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels">Label</a>; default is <code translate="no" dir="ltr">None</code></p> Collection of all cc_toolchain artifacts required for coverage actions. If not specified, all_files are used. </td> </tr> <tr> <td id="cc_toolchain.dwp_files"> <code translate="no" dir="ltr">dwp_files</code> </td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels">Label</a>; required</p> Collection of all cc_toolchain artifacts required for dwp actions. </td> </tr> <tr> <td id="cc_toolchain.dynamic_runtime_lib"> <code translate="no" dir="ltr">dynamic_runtime_lib</code> </td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels">Label</a>; default is <code translate="no" dir="ltr">None</code></p> Dynamic library artifact for the C++ runtime library (e.g. libstdc++.so). <p>This will be used when 'static_link_cpp_runtimes' feature is enabled, and we're linking dependencies dynamically.</p> </td> </tr> <tr> <td id="cc_toolchain.exec_transition_for_inputs"> <code translate="no" dir="ltr">exec_transition_for_inputs</code> </td> <td> <p>Boolean; default is <code translate="no" dir="ltr">True</code></p> Set to True to build all file inputs to cc_toolchain for the exec platform, instead of having no transition (i.e. target platform by default). </td> </tr> <tr> <td id="cc_toolchain.libc_top"> <code translate="no" dir="ltr">libc_top</code> </td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels">Label</a>; default is <code translate="no" dir="ltr">None</code></p> A collection of artifacts for libc passed as inputs to compile/linking actions. </td> </tr> <tr> <td id="cc_toolchain.linker_files"> <code translate="no" dir="ltr">linker_files</code> </td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels">Label</a>; required</p> Collection of all cc_toolchain artifacts required for linking actions. </td> </tr> <tr> <td id="cc_toolchain.module_map"> <code translate="no" dir="ltr">module_map</code> </td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels">Label</a>; default is <code translate="no" dir="ltr">None</code></p> Module map artifact to be used for modular builds. </td> </tr> <tr> <td id="cc_toolchain.objcopy_files"> <code translate="no" dir="ltr">objcopy_files</code> </td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels">Label</a>; required</p> Collection of all cc_toolchain artifacts required for objcopy actions. </td> </tr> <tr> <td id="cc_toolchain.static_runtime_lib"> <code translate="no" dir="ltr">static_runtime_lib</code> </td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels">Label</a>; default is <code translate="no" dir="ltr">None</code></p> Static library artifact for the C++ runtime library (e.g. libstdc++.a). <p>This will be used when 'static_link_cpp_runtimes' feature is enabled, and we're linking dependencies statically.</p> </td> </tr> <tr> <td id="cc_toolchain.strip_files"> <code translate="no" dir="ltr">strip_files</code> </td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels">Label</a>; required</p> Collection of all cc_toolchain artifacts required for strip actions. </td> </tr> <tr> <td id="cc_toolchain.supports_header_parsing"> <code translate="no" dir="ltr">supports_header_parsing</code> </td> <td> <p>Boolean; default is <code translate="no" dir="ltr">False</code></p> Set to True when cc_toolchain supports header parsing actions. </td> </tr> <tr> <td id="cc_toolchain.supports_param_files"> <code translate="no" dir="ltr">supports_param_files</code> </td> <td> <p>Boolean; default is <code translate="no" dir="ltr">True</code></p> Set to True when cc_toolchain supports using param files for linking actions. </td> </tr> <tr> <td id="cc_toolchain.toolchain_config"> <code translate="no" dir="ltr">toolchain_config</code> </td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels">Label</a>; required</p> The label of the rule providing <code translate="no" dir="ltr">cc_toolchain_config_info</code>. </td> </tr> <tr> <td id="cc_toolchain.toolchain_identifier"> <code translate="no" dir="ltr">toolchain_identifier</code> </td> <td> <p>String; <a href="common-definitions#configurable-attributes">nonconfigurable</a>; default is <code translate="no" dir="ltr">""</code></p> The identifier used to match this cc_toolchain with the corresponding crosstool_config.toolchain. <p> Until issue <a href="https://github.com/bazelbuild/bazel/issues/5380">#5380</a> is fixed this is the recommended way of associating <code translate="no" dir="ltr">cc_toolchain</code> with <code translate="no" dir="ltr">CROSSTOOL.toolchain</code>. It will be replaced by the <code translate="no" dir="ltr">toolchain_config</code> attribute (<a href="https://github.com/bazelbuild/bazel/issues/5380">#5380</a>).</p> </td> </tr> </tbody> </table> <h2 id="cc_toolchain_suite" data-text="     cc_toolchain_suite   " tabindex="-1"> cc_toolchain_suite </h2>  <pre class="rule-signature" translate="no" dir="ltr">cc_toolchain_suite(<a href="#cc_toolchain_suite.name">name</a>, <a href="common-definitions#common.compatible_with">compatible_with</a>, <a href="common-definitions#common.deprecation">deprecation</a>, <a href="common-definitions#common.distribs">distribs</a>, <a href="common-definitions#common.features">features</a>, <a href="common-definitions#typical.licenses">licenses</a>, <a href="common-definitions#common.restricted_to">restricted_to</a>, <a href="common-definitions#common.tags">tags</a>, <a href="common-definitions#common.target_compatible_with">target_compatible_with</a>, <a href="common-definitions#common.testonly">testonly</a>, <a href="#cc_toolchain_suite.toolchains">toolchains</a>, <a href="common-definitions#common.visibility">visibility</a>)</pre> <p>Represents a collections of C++ toolchains.</p> <p> This rule is responsible for: </p>
<ul> <li>Collecting all relevant C++ toolchains.</li> <li> Selecting one toolchain depending on <code translate="no" dir="ltr">--cpu</code> and <code translate="no" dir="ltr">--compiler</code> options passed to Bazel. </li> </ul> <p> See also this <a href="https://bazel.build/versions/7.0.0/docs/cc-toolchain-config-reference"> page </a> for elaborate C++ toolchain configuration and toolchain selection documentation. </p> <h3 id="cc_toolchain_suite_args" data-text="Arguments" tabindex="-1">Arguments</h3> <table class="table table-condensed table-bordered table-params"> <colgroup> <col class="col-param"> <col class="param-description"> </colgroup> <thead> <tr> <th colspan="2">Attributes</th> </tr> </thead> <tbody> <tr> <td id="cc_toolchain_suite.name"><code translate="no" dir="ltr">name</code></td> <td> <p><a href="https://bazel.build/versions/7.0.0/concepts/labels#target-names">Name</a>; required</p> <p>A unique name for this target.</p> </td> </tr> <tr> <td id="cc_toolchain_suite.toolchains"> <code translate="no" dir="ltr">toolchains</code> </td> <td> <p>Dictionary mapping strings to <a href="https://bazel.build/versions/7.0.0/concepts/labels">labels</a>; <a href="common-definitions#configurable-attributes">nonconfigurable</a>; required</p> A map from "&lt;cpu&gt;" or "&lt;cpu&gt;|&lt;compiler&gt;" strings to a <code translate="no" dir="ltr">cc_toolchain</code> label. "&lt;cpu&gt;" will be used when only <code translate="no" dir="ltr">--cpu</code> is passed to Bazel, and "&lt;cpu&gt;|&lt;compiler&gt;" will be used when both <code translate="no" dir="ltr">--cpu</code> and <code translate="no" dir="ltr">--compiler</code> are passed to Bazel. Example: 
<pre translate="no" dir="ltr">
          cc_toolchain_suite(
            name = "toolchain",
            toolchains = {
              "piii|gcc": ":my_cc_toolchain_for_piii_using_gcc",
              "piii": ":my_cc_toolchain_for_piii_using_default_compiler",
            },
          )
          </pre> </td> </tr> </tbody> </table>  </div>  </article> <devsite-content-footer class="nocontent"> <p>Except as otherwise noted, the content of this page is licensed under the <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 License</a>, and code samples are licensed under the <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 License</a>. For details, see the <a href="https://developers.google.com/site-policies">Google Developers Site Policies</a>. Java is a registered trademark of Oracle and/or its affiliates.</p> <p>Last updated 2023-12-11 UTC.</p> </devsite-content-footer> <devsite-notification> </devsite-notification> <div class="devsite-content-data"> <template class="devsite-thumb-rating-down-categories"> [{ "type": "thumb-down", "id": "missingTheInformationINeed", "label":"Missing the information I need" },{ "type": "thumb-down", "id": "tooComplicatedTooManySteps", "label":"Too complicated / too many steps" },{ "type": "thumb-down", "id": "outOfDate", "label":"Out of date" },{ "type": "thumb-down", "id": "samplesCodeIssue", "label":"Samples / code issue" },{ "type": "thumb-down", "id": "otherDown", "label":"Other" }] </template> <template class="devsite-thumb-rating-up-categories"> [{ "type": "thumb-up", "id": "easyToUnderstand", "label":"Easy to understand" },{ "type": "thumb-up", "id": "solvedMyProblem", "label":"Solved my problem" },{ "type": "thumb-up", "id": "otherUp", "label":"Other" }] </template> </div>
<div class="_attribution">
  <p class="_attribution-p">
    Licensed under the Creative Commons Attribution 4.0 License, and code samples are licensed under the Apache 2.0 License.<br>
    <a href="https://bazel.build/versions/7.0.0/reference/be/c-cpp" class="_attribution-link">https://bazel.build/versions/7.0.0/reference/be/c-cpp</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
