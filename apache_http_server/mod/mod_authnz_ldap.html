
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Mod_authnz_ldap - Apache HTTP Server - W3cubDocs</title>
  
  <meta name="description" content=" This module allows authentication front-ends such as mod_auth_basic to authenticate users through an ldap directory. ">
  <meta name="keywords" content="apache, module, mod, authnz, ldap, http, server, apache_http_server">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/apache_http_server/mod/mod_authnz_ldap.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e4ebd3a2a5652ff55173659804c4390a004917f3bdd17b5bb3ba78ea5c9c46fe181cadaac34517ccd815f5bdc982bbfe67179d6f4ac2f084ef2265e2a3dc8dc5.css" integrity="sha512-5OvToqVlL/VRc2WYBMQ5CgBJF/O90Xtbs7p46lycRv4YHK2qw0UXzNgV9b3Jgrv+Zxedb0rC8ITvImXio9yNxQ==" crossorigin="anonymous">
  <script type="text/javascript" integrity="sha512-EpkDeu98lN/jPKijllzVWdRg/dUSSMCaldYZNFz6bcNoBvpWRNz0HSTRQJ3ENmQc5Cuj1zDW1vHd7b0DzpOgyA==" crossorigin="anonymous" src="/assets/application-1299037aef7c94dfe33ca8a3965cd559d460fdd51248c09a95d619345cfa6dc36806fa5644dcf41d24d1409dc436641ce42ba3d730d6d6f1ddedbd03ce93a0c8.js"></script>
  <script src="/json/apache_http_server.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/apache_http_server/" class="_nav-link" title="" style="margin-left:0;">Apache HTTP Server</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _apache">
				
				
<h1>Apache Module mod_authnz_ldap</h1>  <table class="module">
<tr>
<th>Description:</th>
<td>Allows an LDAP directory to be used to store the database for HTTP Basic authentication.</td>
</tr> <tr>
<th>Status:</th>
<td>Extension</td>
</tr> <tr>
<th>ModuleIdentifier:</th>
<td>authnz_ldap_module</td>
</tr> <tr>
<th>SourceFile:</th>
<td>mod_authnz_ldap.c</td>
</tr> <tr>
<th>Compatibility:</th>
<td>Available in version 2.1 and later</td>
</tr>
</table> <h3>Summary</h3> <p>This module allows authentication front-ends such as <code class="module"><a href="mod_auth_basic">mod_auth_basic</a></code> to authenticate users through an ldap directory.</p> <p><code class="module"><a href="mod_authnz_ldap">mod_authnz_ldap</a></code> supports the following features:</p> <ul> <li>Known to support the <a href="http://www.openldap.org/">OpenLDAP SDK</a> (both 1.x and 2.x), <a href="http://developer.novell.com/ndk/cldap.htm"> Novell LDAP SDK</a> and the <a href="http://www.iplanet.com/downloads/developer/">iPlanet (Netscape)</a> SDK.</li> <li>Complex authorization policies can be implemented by representing the policy with LDAP filters.</li> <li>Uses extensive caching of LDAP operations via <a href="mod_ldap">mod_ldap</a>.</li> <li>Support for LDAP over SSL (requires the Netscape SDK) or TLS (requires the OpenLDAP 2.x SDK or Novell LDAP SDK).</li> </ul> <p>When using <code class="module"><a href="mod_auth_basic">mod_auth_basic</a></code>, this module is invoked via the <code class="directive"><a href="mod_auth_basic#authbasicprovider">AuthBasicProvider</a></code> directive with the <code>ldap</code> value.</p>     <h2 id="contents">Contents</h2> <ul> <li> <a href="#gcaveats">General caveats</a> </li> <li> <a href="#operation">Operation</a> <ul> <li><a href="#authenphase">The Authentication Phase</a></li> <li><a href="#authorphase">The Authorization Phase</a></li> </ul> </li> <li> <a href="#requiredirectives">The Require Directives</a> <ul> <li><a href="#requser">Require ldap-user</a></li> <li><a href="#reqgroup">Require ldap-group</a></li> <li><a href="#reqdn">Require ldap-dn</a></li> <li><a href="#reqattribute">Require ldap-attribute</a></li> <li><a href="#reqfilter">Require ldap-filter</a></li> </ul> </li> <li><a href="#examples">Examples</a></li> <li><a href="#usingtls">Using TLS</a></li> <li><a href="#usingssl">Using SSL</a></li> <li><a href="#exposed">Exposing Login Information</a></li> <li><a href="#activedirectory">Using Active Directory</a></li> <li> <a href="#frontpage">Using Microsoft FrontPage with <code class="module"><a href="mod_authnz_ldap">mod_authnz_ldap</a></code></a> <ul> <li><a href="#howitworks">How It Works</a></li> <li><a href="#fpcaveats">Caveats</a></li> </ul> </li> </ul>   <h2 id="gcaveats">General caveats</h2> <p> This module caches authentication and authorization results based on the configuration of <code class="module"><a href="mod_ldap">mod_ldap</a></code>. Changes made to the backing LDAP server will not be immediately reflected on the HTTP Server, including but not limited to user lockouts/revocations, password changes, or changes to group memberships. Consult the directives in <code class="module"><a href="mod_ldap">mod_ldap</a></code> for details of the cache tunables. </p>   <h2 id="operation">Operation</h2> <p>There are two phases in granting access to a user. The first phase is authentication, in which the <code class="module"><a href="mod_authnz_ldap">mod_authnz_ldap</a></code> authentication provider verifies that the user's credentials are valid. This is also called the <em>search/bind</em> phase. The second phase is authorization, in which <code class="module"><a href="mod_authnz_ldap">mod_authnz_ldap</a></code> determines if the authenticated user is allowed access to the resource in question. This is also known as the <em>compare</em> phase.</p> <p><code class="module"><a href="mod_authnz_ldap">mod_authnz_ldap</a></code> registers both an authn_ldap authentication provider and an authz_ldap authorization handler. The authn_ldap authentication provider can be enabled through the <code class="directive"><a href="mod_auth_basic#authbasicprovider">AuthBasicProvider</a></code> directive using the <code>ldap</code> value. The authz_ldap handler extends the <code class="directive"><a href="mod_authz_core#require">Require</a></code> directive's authorization types by adding <code>ldap-user</code>, <code>ldap-dn</code> and <code>ldap-group</code> values.</p> <h3><a name="authenphase" id="authenphase">The Authentication Phase</a></h3> <p>During the authentication phase, <code class="module"><a href="mod_authnz_ldap">mod_authnz_ldap</a></code> searches for an entry in the directory that matches the username that the HTTP client passes. If a single unique match is found, then <code class="module"><a href="mod_authnz_ldap">mod_authnz_ldap</a></code> attempts to bind to the directory server using the DN of the entry plus the password provided by the HTTP client. Because it does a search, then a bind, it is often referred to as the search/bind phase. Here are the steps taken during the search/bind phase.</p> <ol> <li>Generate a search filter by combining the attribute and filter provided in the <code class="directive"><a href="#authldapurl">AuthLDAPURL</a></code> directive with the username passed by the HTTP client.</li> <li>Search the directory using the generated filter. If the search does not return exactly one entry, deny or decline access.</li> <li>Fetch the distinguished name of the entry retrieved from the search and attempt to bind to the LDAP server using that DN and the password passed by the HTTP client. If the bind is unsuccessful, deny or decline access.</li> </ol> <p>The following directives are used during the search/bind phase</p> <table> <tr> <td><code class="directive">AuthLDAPURL</code></td> <td>Specifies the LDAP server, the base DN, the attribute to use in the search, as well as the extra search filter to use.</td> </tr> <tr> <td><code class="directive">AuthLDAPBindDN</code></td> <td>An optional DN to bind with during the search phase.</td> </tr> <tr> <td><code class="directive">AuthLDAPBindPassword</code></td> <td>An optional password to bind with during the search phase.</td> </tr> </table> <h3><a name="authorphase" id="authorphase">The Authorization Phase</a></h3> <p>During the authorization phase, <code class="module"><a href="mod_authnz_ldap">mod_authnz_ldap</a></code> attempts to determine if the user is authorized to access the resource. Many of these checks require <code class="module"><a href="mod_authnz_ldap">mod_authnz_ldap</a></code> to do a compare operation on the LDAP server. This is why this phase is often referred to as the compare phase. <code class="module"><a href="mod_authnz_ldap">mod_authnz_ldap</a></code> accepts the following <code class="directive"><a href="mod_authz_core#require">Require</a></code> directives to determine if the credentials are acceptable:</p> <ul> <li>Grant access if there is a <a href="#reqgroup"><code>Require ldap-user</code></a> directive, and the username in the directive matches the username passed by the client.</li> <li>Grant access if there is a <a href="#reqdn"><code>Require ldap-dn</code></a> directive, and the DN in the directive matches the DN fetched from the LDAP directory.</li> <li>Grant access if there is a <a href="#reqgroup"><code>Require ldap-group</code></a> directive, and the DN fetched from the LDAP directory (or the username passed by the client) occurs in the LDAP group or, potentially, in one of its sub-groups.</li> <li>Grant access if there is a <a href="#reqattribute"> <code>Require ldap-attribute</code></a> directive, and the attribute fetched from the LDAP directory matches the given value.</li> <li>Grant access if there is a <a href="#reqfilter"> <code>Require ldap-filter</code></a> directive, and the search filter successfully finds a single user object that matches the dn of the authenticated user.</li> <li>otherwise, deny or decline access</li> </ul> <p>Other <code class="directive"><a href="mod_authz_core#require">Require</a></code> values may also be used which may require loading additional authorization modules.</p> <ul> <li>Grant access to all successfully authenticated users if there is a <a href="#requser"><code>Require valid-user</code></a> directive. (requires <code class="module"><a href="mod_authz_user">mod_authz_user</a></code>)</li> <li>Grant access if there is a <a href="#reqgroup"><code>Require group</code></a> directive, and <code class="module"><a href="mod_authz_groupfile">mod_authz_groupfile</a></code> has been loaded with the <code class="directive"><a href="mod_authz_groupfile#authgroupfile">AuthGroupFile</a></code> directive set.</li> <li>others...</li> </ul> <p><code class="module"><a href="mod_authnz_ldap">mod_authnz_ldap</a></code> uses the following directives during the compare phase:</p> <table> <tr> <td>
<code class="directive">AuthLDAPURL</code> </td> <td>The attribute specified in the URL is used in compare operations for the <code>Require ldap-user</code> operation.</td> </tr> <tr> <td><code class="directive">AuthLDAPCompareDNOnServer</code></td> <td>Determines the behavior of the <code>Require ldap-dn</code> directive.</td> </tr> <tr> <td><code class="directive">AuthLDAPGroupAttribute</code></td> <td>Determines the attribute to use for comparisons in the <code>Require ldap-group</code> directive.</td> </tr> <tr> <td><code class="directive">AuthLDAPGroupAttributeIsDN</code></td> <td>Specifies whether to use the user DN or the username when doing comparisons for the <code>Require ldap-group</code> directive.</td> </tr> <tr> <td><code class="directive">AuthLDAPMaxSubGroupDepth</code></td> <td>Determines the maximum depth of sub-groups that will be evaluated during comparisons in the <code>Require ldap-group</code> directive.</td> </tr> <tr> <td><code class="directive">AuthLDAPSubGroupAttribute</code></td> <td>Determines the attribute to use when obtaining sub-group members of the current group during comparisons in the <code>Require ldap-group</code> directive.</td> </tr> <tr> <td><code class="directive">AuthLDAPSubGroupClass</code></td> <td>Specifies the LDAP objectClass values used to identify if queried directory objects really are group objects (as opposed to user objects) during the <code>Require ldap-group</code> directive's sub-group processing.</td> </tr> </table>   <h2 id="requiredirectives">The Require Directives</h2> <p>Apache's <code class="directive"><a href="mod_authz_core#require">Require</a></code> directives are used during the authorization phase to ensure that a user is allowed to access a resource. mod_authnz_ldap extends the authorization types with <code>ldap-user</code>, <code>ldap-dn</code>, <code>ldap-group</code>, <code>ldap-attribute</code> and <code>ldap-filter</code>. Other authorization types may also be used but may require that additional authorization modules be loaded.</p> <p>Since v2.4.8, <a href="../expr">expressions</a> are supported within the LDAP require directives.</p> <h3><a name="requser" id="requser">Require ldap-user</a></h3> <p>The <code>Require ldap-user</code> directive specifies what usernames can access the resource. Once <code class="module"><a href="mod_authnz_ldap">mod_authnz_ldap</a></code> has retrieved a unique DN from the directory, it does an LDAP compare operation using the username specified in the <code>Require ldap-user</code> to see if that username is part of the just-fetched LDAP entry. Multiple users can be granted access by putting multiple usernames on the line, separated with spaces. If a username has a space in it, then it must be surrounded with double quotes. Multiple users can also be granted access by using multiple <code>Require ldap-user</code> directives, with one user per line. For example, with a <code class="directive"><a href="#authldapurl">AuthLDAPURL</a></code> of <code>ldap://ldap/o=Example?cn</code> (i.e., <code>cn</code> is used for searches), the following Require directives could be used to restrict access:</p> <pre class="prettyprint lang-config">Require ldap-user "Barbara Jenson"
Require ldap-user "Fred User"
Require ldap-user "Joe Manager"</pre> <p>Because of the way that <code class="module"><a href="mod_authnz_ldap">mod_authnz_ldap</a></code> handles this directive, Barbara Jenson could sign on as <em>Barbara Jenson</em>, <em>Babs Jenson</em> or any other <code>cn</code> that she has in her LDAP entry. Only the single <code>Require ldap-user</code> line is needed to support all values of the attribute in the user's entry.</p> <p>If the <code>uid</code> attribute was used instead of the <code>cn</code> attribute in the URL above, the above three lines could be condensed to</p> <pre class="prettyprint lang-config">Require ldap-user bjenson fuser jmanager</pre> <h3><a name="reqgroup" id="reqgroup">Require ldap-group</a></h3> <p>This directive specifies an LDAP group whose members are allowed access. It takes the distinguished name of the LDAP group. Note: Do not surround the group name with quotes. For example, assume that the following entry existed in the LDAP directory:</p> <div class="example"><pre>dn: cn=Administrators, o=Example
objectClass: groupOfUniqueNames
uniqueMember: cn=Barbara Jenson, o=Example
uniqueMember: cn=Fred User, o=Example</pre></div> <p>The following directive would grant access to both Fred and Barbara:</p> <pre class="prettyprint lang-config">Require ldap-group cn=Administrators, o=Example</pre> <p>Members can also be found within sub-groups of a specified LDAP group if <code class="directive"><a href="#authldapmaxsubgroupdepth">AuthLDAPMaxSubGroupDepth</a></code> is set to a value greater than 0. For example, assume the following entries exist in the LDAP directory:</p> <div class="example"><pre>dn: cn=Employees, o=Example
objectClass: groupOfUniqueNames
uniqueMember: cn=Managers, o=Example
uniqueMember: cn=Administrators, o=Example
uniqueMember: cn=Users, o=Example

dn: cn=Managers, o=Example
objectClass: groupOfUniqueNames
uniqueMember: cn=Bob Ellis, o=Example
uniqueMember: cn=Tom Jackson, o=Example

dn: cn=Administrators, o=Example
objectClass: groupOfUniqueNames
uniqueMember: cn=Barbara Jenson, o=Example
uniqueMember: cn=Fred User, o=Example

dn: cn=Users, o=Example
objectClass: groupOfUniqueNames
uniqueMember: cn=Allan Jefferson, o=Example
uniqueMember: cn=Paul Tilley, o=Example
uniqueMember: cn=Temporary Employees, o=Example

dn: cn=Temporary Employees, o=Example
objectClass: groupOfUniqueNames
uniqueMember: cn=Jim Swenson, o=Example
uniqueMember: cn=Elliot Rhodes, o=Example</pre></div> <p>The following directives would allow access for Bob Ellis, Tom Jackson, Barbara Jenson, Fred User, Allan Jefferson, and Paul Tilley but would not allow access for Jim Swenson, or Elliot Rhodes (since they are at a sub-group depth of 2):</p> <pre class="prettyprint lang-config">Require ldap-group cn=Employees, o=Example
AuthLDAPMaxSubGroupDepth 1</pre> <p>Behavior of this directive is modified by the <code class="directive"><a href="#authldapgroupattribute">AuthLDAPGroupAttribute</a></code>, <code class="directive"><a href="#authldapgroupattributeisdn">AuthLDAPGroupAttributeIsDN</a></code>, <code class="directive"><a href="#authldapmaxsubgroupdepth">AuthLDAPMaxSubGroupDepth</a></code>, <code class="directive"><a href="#authldapsubgroupattribute">AuthLDAPSubGroupAttribute</a></code>, and <code class="directive"><a href="#authldapsubgroupclass">AuthLDAPSubGroupClass</a></code> directives.</p> <h3><a name="reqdn" id="reqdn">Require ldap-dn</a></h3> <p>The <code>Require ldap-dn</code> directive allows the administrator to grant access based on distinguished names. It specifies a DN that must match for access to be granted. If the distinguished name that was retrieved from the directory server matches the distinguished name in the <code>Require ldap-dn</code>, then authorization is granted. Note: do not surround the distinguished name with quotes.</p> <p>The following directive would grant access to a specific DN:</p> <pre class="prettyprint lang-config">Require ldap-dn cn=Barbara Jenson, o=Example</pre> <p>Behavior of this directive is modified by the <code class="directive"><a href="#authldapcomparednonserver">AuthLDAPCompareDNOnServer</a></code> directive.</p> <h3><a name="reqattribute" id="reqattribute">Require ldap-attribute</a></h3> <p>The <code>Require ldap-attribute</code> directive allows the administrator to grant access based on attributes of the authenticated user in the LDAP directory. If the attribute in the directory matches the value given in the configuration, access is granted.</p> <p>The following directive would grant access to anyone with the attribute employeeType = active</p> <pre class="prettyprint lang-config">Require ldap-attribute employeeType="active"</pre> <p>Multiple attribute/value pairs can be specified on the same line separated by spaces or they can be specified in multiple <code>Require ldap-attribute</code> directives. The effect of listing multiple attribute/values pairs is an OR operation. Access will be granted if any of the listed attribute values match the value of the corresponding attribute in the user object. If the value of the attribute contains a space, only the value must be within double quotes.</p> <p>The following directive would grant access to anyone with the city attribute equal to "San Jose" or status equal to "Active"</p> <pre class="prettyprint lang-config">Require ldap-attribute city="San Jose" status="active"</pre> <h3><a name="reqfilter" id="reqfilter">Require ldap-filter</a></h3> <p>The <code>Require ldap-filter</code> directive allows the administrator to grant access based on a complex LDAP search filter. If the dn returned by the filter search matches the authenticated user dn, access is granted.</p> <p>The following directive would grant access to anyone having a cell phone and is in the marketing department</p> <pre class="prettyprint lang-config">Require ldap-filter "&amp;(cell=*)(department=marketing)"</pre> <p>The difference between the <code>Require ldap-filter</code> directive and the <code>Require ldap-attribute</code> directive is that <code>ldap-filter</code> performs a search operation on the LDAP directory using the specified search filter rather than a simple attribute comparison. If a simple attribute comparison is all that is required, the comparison operation performed by <code>ldap-attribute</code> will be faster than the search operation used by <code>ldap-filter</code> especially within a large directory.</p>   <h2 id="examples">Examples</h2> <ul> <li> Grant access to anyone who exists in the LDAP directory, using their UID for searches. <pre class="prettyprint lang-config">AuthLDAPURL "ldap://ldap1.example.com:389/ou=People, o=Example?uid?sub?(objectClass=*)"
Require valid-user</pre> </li> <li> The next example is the same as above; but with the fields that have useful defaults omitted. Also, note the use of a redundant LDAP server. <pre class="prettyprint lang-config">AuthLDAPURL "ldap://ldap1.example.com ldap2.example.com/ou=People, o=Example"
Require valid-user</pre> </li> <li> The next example is similar to the previous one, but it uses the common name instead of the UID. Note that this could be problematical if multiple people in the directory share the same <code>cn</code>, because a search on <code>cn</code> <strong>must</strong> return exactly one entry. That's why this approach is not recommended: it's a better idea to choose an attribute that is guaranteed unique in your directory, such as <code>uid</code>. <pre class="prettyprint lang-config">AuthLDAPURL "ldap://ldap.example.com/ou=People, o=Example?cn"
Require valid-user</pre> </li> <li> Grant access to anybody in the Administrators group. The users must authenticate using their UID. <pre class="prettyprint lang-config">AuthLDAPURL ldap://ldap.example.com/o=Example?uid
Require ldap-group cn=Administrators, o=Example</pre> </li> <li> Grant access to anybody in the group whose name matches the hostname of the virtual host. In this example an <a href="../expr">expression</a> is used to build the filter. <pre class="prettyprint lang-config">AuthLDAPURL ldap://ldap.example.com/o=Example?uid
Require ldap-group cn=%{SERVER_NAME}, o=Example</pre> </li> <li> The next example assumes that everyone at Example who carries an alphanumeric pager will have an LDAP attribute of <code>qpagePagerID</code>. The example will grant access only to people (authenticated via their UID) who have alphanumeric pagers: <pre class="prettyprint lang-config">AuthLDAPURL ldap://ldap.example.com/o=Example?uid??(qpagePagerID=*)
Require valid-user</pre> </li> <li> <p>The next example demonstrates the power of using filters to accomplish complicated administrative requirements. Without filters, it would have been necessary to create a new LDAP group and ensure that the group's members remain synchronized with the pager users. This becomes trivial with filters. The goal is to grant access to anyone who has a pager, plus grant access to Joe Manager, who doesn't have a pager, but does need to access the same resource:</p> <pre class="prettyprint lang-config">AuthLDAPURL ldap://ldap.example.com/o=Example?uid??(|(qpagePagerID=*)(uid=jmanager))
Require valid-user</pre> <p>This last may look confusing at first, so it helps to evaluate what the search filter will look like based on who connects, as shown below. If Fred User connects as <code>fuser</code>, the filter would look like</p> <div class="example"><code>(&amp;(|(qpagePagerID=*)(uid=jmanager))(uid=fuser))</code></div> <p>The above search will only succeed if <em>fuser</em> has a pager. When Joe Manager connects as <em>jmanager</em>, the filter looks like</p> <div class="example"><code>(&amp;(|(qpagePagerID=*)(uid=jmanager))(uid=jmanager))</code></div> <p>The above search will succeed whether <em>jmanager</em> has a pager or not.</p> </li> </ul>   <h2 id="usingtls">Using TLS</h2> <p>To use TLS, see the <code class="module"><a href="mod_ldap">mod_ldap</a></code> directives <code class="directive"><a href="mod_ldap#ldaptrustedclientcert">LDAPTrustedClientCert</a></code>, <code class="directive"><a href="mod_ldap#ldaptrustedglobalcert">LDAPTrustedGlobalCert</a></code> and <code class="directive"><a href="mod_ldap#ldaptrustedmode">LDAPTrustedMode</a></code>.</p> <p>An optional second parameter can be added to the <code class="directive"><a href="#authldapurl">AuthLDAPURL</a></code> to override the default connection type set by <code class="directive"><a href="mod_ldap#ldaptrustedmode">LDAPTrustedMode</a></code>. This will allow the connection established by an <em>ldap://</em> Url to be upgraded to a secure connection on the same port.</p>   <h2 id="usingssl">Using SSL</h2> <p>To use SSL, see the <code class="module"><a href="mod_ldap">mod_ldap</a></code> directives <code class="directive"><a href="mod_ldap#ldaptrustedclientcert">LDAPTrustedClientCert</a></code>, <code class="directive"><a href="mod_ldap#ldaptrustedglobalcert">LDAPTrustedGlobalCert</a></code> and <code class="directive"><a href="mod_ldap#ldaptrustedmode">LDAPTrustedMode</a></code>.</p> <p>To specify a secure LDAP server, use <em>ldaps://</em> in the <code class="directive"><a href="#authldapurl">AuthLDAPURL</a></code> directive, instead of <em>ldap://</em>.</p>   <h2 id="exposed">Exposing Login Information</h2> <p>when this module performs <em>authentication</em>, ldap attributes specified in the <code class="directive"><a href="#authldapurl">authldapurl</a></code> directive are placed in environment variables with the prefix "AUTHENTICATE_".</p> <p>when this module performs <em>authorization</em>, ldap attributes specified in the <code class="directive"><a href="#authldapurl">authldapurl</a></code> directive are placed in environment variables with the prefix "AUTHORIZE_".</p> <p>If the attribute field contains the username, common name and telephone number of a user, a CGI program will have access to this information without the need to make a second independent LDAP query to gather this additional information.</p> <p>This has the potential to dramatically simplify the coding and configuration required in some web applications.</p>   <h2 id="activedirectory">Using Active Directory</h2> <p>An Active Directory installation may support multiple domains at the same time. To distinguish users between domains, an identifier called a User Principle Name (UPN) can be added to a user's entry in the directory. This UPN usually takes the form of the user's account name, followed by the domain components of the particular domain, for example <em>somebody@nz.example.com</em>.</p> <p>You may wish to configure the <code class="module"><a href="mod_authnz_ldap">mod_authnz_ldap</a></code> module to authenticate users present in any of the domains making up the Active Directory forest. In this way both <em>somebody@nz.example.com</em> and <em>someone@au.example.com</em> can be authenticated using the same query at the same time.</p> <p>To make this practical, Active Directory supports the concept of a Global Catalog. This Global Catalog is a read only copy of selected attributes of all the Active Directory servers within the Active Directory forest. Querying the Global Catalog allows all the domains to be queried in a single query, without the query spanning servers over potentially slow links.</p> <p>If enabled, the Global Catalog is an independent directory server that runs on port 3268 (3269 for SSL). To search for a user, do a subtree search for the attribute <em>userPrincipalName</em>, with an empty search root, like so:</p> <pre class="prettyprint lang-config">AuthLDAPBindDN apache@example.com
AuthLDAPBindPassword password
AuthLDAPURL ldap://10.0.0.1:3268/?userPrincipalName?sub</pre> <p>Users will need to enter their User Principal Name as a login, in the form <em>somebody@nz.example.com</em>.</p>   <h2 id="frontpage">Using Microsoft FrontPage with mod_authnz_ldap</h2> <p>Normally, FrontPage uses FrontPage-web-specific user/group files (i.e., the <code class="module"><a href="mod_authn_file">mod_authn_file</a></code> and <code class="module"><a href="mod_authz_groupfile">mod_authz_groupfile</a></code> modules) to handle all authentication. Unfortunately, it is not possible to just change to LDAP authentication by adding the proper directives, because it will break the <em>Permissions</em> forms in the FrontPage client, which attempt to modify the standard text-based authorization files.</p> <p>Once a FrontPage web has been created, adding LDAP authentication to it is a matter of adding the following directives to <em>every</em> <code>.htaccess</code> file that gets created in the web</p> <pre class="prettyprint lang-config">AuthLDAPURL       "the url"
AuthGroupFile     "mygroupfile"
Require group     "mygroupfile"</pre> <h3><a name="howitworks" id="howitworks">How It Works</a></h3> <p>FrontPage restricts access to a web by adding the <code>Require valid-user</code> directive to the <code>.htaccess</code> files. The <code>Require valid-user</code> directive will succeed for any user who is valid <em>as far as LDAP is concerned</em>. This means that anybody who has an entry in the LDAP directory is considered a valid user, whereas FrontPage considers only those people in the local user file to be valid. By substituting the ldap-group with group file authorization, Apache is allowed to consult the local user file (which is managed by FrontPage) - instead of LDAP - when handling authorizing the user.</p> <p>Once directives have been added as specified above, FrontPage users will be able to perform all management operations from the FrontPage client.</p> <h3><a name="fpcaveats" id="fpcaveats">Caveats</a></h3> <ul> <li>When choosing the LDAP URL, the attribute to use for authentication should be something that will also be valid for putting into a <code class="module"><a href="mod_authn_file">mod_authn_file</a></code> user file. The user ID is ideal for this.</li> <li>When adding users via FrontPage, FrontPage administrators should choose usernames that already exist in the LDAP directory (for obvious reasons). Also, the password that the administrator enters into the form is ignored, since Apache will actually be authenticating against the password in the LDAP database, and not against the password in the local user file. This could cause confusion for web administrators.</li> <li>Apache must be compiled with <code class="module"><a href="mod_auth_basic">mod_auth_basic</a></code>, <code class="module"><a href="mod_authn_file">mod_authn_file</a></code> and <code class="module"><a href="mod_authz_groupfile">mod_authz_groupfile</a></code> in order to use FrontPage support. This is because Apache will still use the <code class="module"><a href="mod_authz_groupfile">mod_authz_groupfile</a></code> group file for determine the extent of a user's access to the FrontPage web.</li> <li>The directives must be put in the <code>.htaccess</code> files. Attempting to put them inside <code class="directive"><a href="core#location">&lt;Location&gt;</a></code> or <code class="directive"><a href="core#directory">&lt;Directory&gt;</a></code> directives won't work. This is because <code class="module"><a href="mod_authnz_ldap">mod_authnz_ldap</a></code> has to be able to grab the <code class="directive"><a href="mod_authz_groupfile#authgroupfile">AuthGroupFile</a></code> directive that is found in FrontPage <code>.htaccess</code> files so that it knows where to look for the valid user list. If the <code class="module"><a href="mod_authnz_ldap">mod_authnz_ldap</a></code> directives aren't in the same <code>.htaccess</code> file as the FrontPage directives, then the hack won't work, because <code class="module"><a href="mod_authnz_ldap">mod_authnz_ldap</a></code> will never get a chance to process the <code>.htaccess</code> file, and won't be able to find the FrontPage-managed user file.</li> </ul>   <div class="directive-section">
<h2 id="authldapauthorizeprefix">AuthLDAPAuthorizePrefix Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>Specifies the prefix for environment variables set during authorization</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>AuthLDAPAuthorizePrefix prefix</pre></td>
</tr> <tr>
<th>Default:</th>
<td><pre>AuthLDAPAuthorizePrefix AUTHORIZE_</pre></td>
</tr> <tr>
<th>Context:</th>
<td>directory, .htaccess</td>
</tr> <tr>
<th>Override:</th>
<td>AuthConfig</td>
</tr> <tr>
<th>Status:</th>
<td>Extension</td>
</tr> <tr>
<th>Module:</th>
<td>mod_authnz_ldap</td>
</tr> <tr>
<th>Compatibility:</th>
<td>Available in version 2.3.6 and later</td>
</tr> </table> <p>This directive allows you to override the prefix used for environment variables set during LDAP authorization. If <em>AUTHENTICATE_</em> is specified, consumers of these environment variables see the same information whether LDAP has performed authentication, authorization, or both.</p> <div class="note">
<p><strong>Note</strong></p> No authorization variables are set when a user is authorized on the basis of <code>Require valid-user</code>. </div> </div>  <div class="directive-section">
<h2 id="authldapbindauthoritative">AuthLDAPBindAuthoritative Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>Determines if other authentication providers are used when a user can be mapped to a DN but the server cannot successfully bind with the user's credentials.</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>AuthLDAPBindAuthoritative off|on</pre></td>
</tr> <tr>
<th>Default:</th>
<td><pre>AuthLDAPBindAuthoritative on</pre></td>
</tr> <tr>
<th>Context:</th>
<td>directory, .htaccess</td>
</tr> <tr>
<th>Override:</th>
<td>AuthConfig</td>
</tr> <tr>
<th>Status:</th>
<td>Extension</td>
</tr> <tr>
<th>Module:</th>
<td>mod_authnz_ldap</td>
</tr> </table> <p>By default, subsequent authentication providers are only queried if a user cannot be mapped to a DN, but not if the user can be mapped to a DN and their password cannot be verified with an LDAP bind. If <code class="directive">AuthLDAPBindAuthoritative</code> is set to <em>off</em>, other configured authentication modules will have a chance to validate the user if the LDAP bind (with the current user's credentials) fails for any reason.</p> <p> This allows users present in both LDAP and <code class="directive"><a href="mod_authn_file#authuserfile">AuthUserFile</a></code> to authenticate when the LDAP server is available but the user's account is locked or password is otherwise unusable.</p> <h3>See also</h3> <ul> <li><code class="directive"><a href="mod_authn_file#authuserfile">AuthUserFile</a></code></li> <li><code class="directive"><a href="mod_auth_basic#authbasicprovider">AuthBasicProvider</a></code></li> </ul> </div>  <div class="directive-section">
<h2 id="authldapbinddn">AuthLDAPBindDN Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>Optional DN to use in binding to the LDAP server</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>AuthLDAPBindDN distinguished-name</pre></td>
</tr> <tr>
<th>Context:</th>
<td>directory, .htaccess</td>
</tr> <tr>
<th>Override:</th>
<td>AuthConfig</td>
</tr> <tr>
<th>Status:</th>
<td>Extension</td>
</tr> <tr>
<th>Module:</th>
<td>mod_authnz_ldap</td>
</tr> </table> <p>An optional DN used to bind to the server when searching for entries. If not provided, <code class="module"><a href="mod_authnz_ldap">mod_authnz_ldap</a></code> will use an anonymous bind.</p> </div>  <div class="directive-section">
<h2 id="authldapbindpassword">AuthLDAPBindPassword Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>Password used in conjunction with the bind DN</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>AuthLDAPBindPassword password</pre></td>
</tr> <tr>
<th>Context:</th>
<td>directory, .htaccess</td>
</tr> <tr>
<th>Override:</th>
<td>AuthConfig</td>
</tr> <tr>
<th>Status:</th>
<td>Extension</td>
</tr> <tr>
<th>Module:</th>
<td>mod_authnz_ldap</td>
</tr> <tr>
<th>Compatibility:</th>
<td>
<em>exec:</em> was added in 2.4.5.</td>
</tr> </table> <p>A bind password to use in conjunction with the bind DN. Note that the bind password is probably sensitive data, and should be properly protected. You should only use the <code class="directive"><a href="#authldapbinddn">AuthLDAPBindDN</a></code> and <code class="directive">AuthLDAPBindPassword</code> if you absolutely need them to search the directory.</p> <p>If the value begins with exec: the resulting command will be executed and the first line returned to standard output by the program will be used as the password.</p> <pre class="prettyprint lang-config">#Password used as-is
AuthLDAPBindPassword secret

#Run /path/to/program to get my password
AuthLDAPBindPassword exec:/path/to/program

#Run /path/to/otherProgram and provide arguments
AuthLDAPBindPassword "exec:/path/to/otherProgram argument1"</pre> </div>  <div class="directive-section">
<h2 id="authldapcharsetconfig">AuthLDAPCharsetConfig Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>Language to charset conversion configuration file</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>AuthLDAPCharsetConfig file-path</pre></td>
</tr> <tr>
<th>Context:</th>
<td>server config</td>
</tr> <tr>
<th>Status:</th>
<td>Extension</td>
</tr> <tr>
<th>Module:</th>
<td>mod_authnz_ldap</td>
</tr> </table> <p>The <code class="directive">AuthLDAPCharsetConfig</code> directive sets the location of the language to charset conversion configuration file. <var>File-path</var> is relative to the <code class="directive"><a href="core#serverroot">ServerRoot</a></code>. This file specifies the list of language extensions to character sets. Most administrators use the provided <code>charset.conv</code> file, which associates common language extensions to character sets.</p> <p>The file contains lines in the following format:</p> <div class="example"><pre>Language-Extension charset [Language-String] ...</pre></div> <p>The case of the extension does not matter. Blank lines, and lines beginning with a hash character (<code>#</code>) are ignored.</p> </div>  <div class="directive-section">
<h2 id="authldapcompareasuser">AuthLDAPCompareAsUser Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>Use the authenticated user's credentials to perform authorization comparisons</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>AuthLDAPCompareAsUser on|off</pre></td>
</tr> <tr>
<th>Default:</th>
<td><pre>AuthLDAPCompareAsUser off</pre></td>
</tr> <tr>
<th>Context:</th>
<td>directory, .htaccess</td>
</tr> <tr>
<th>Override:</th>
<td>AuthConfig</td>
</tr> <tr>
<th>Status:</th>
<td>Extension</td>
</tr> <tr>
<th>Module:</th>
<td>mod_authnz_ldap</td>
</tr> <tr>
<th>Compatibility:</th>
<td>Available in version 2.3.6 and later</td>
</tr> </table> <p>When set, and <code class="module"><a href="mod_authnz_ldap">mod_authnz_ldap</a></code> has authenticated the user, LDAP comparisons for authorization use the queried distinguished name (DN) and HTTP basic authentication password of the authenticated user instead of the servers configured credentials.</p> <p> The <em>ldap-attribute</em>, <em>ldap-user</em>, and <em>ldap-group</em> (single-level only) authorization checks use comparisons.</p> <p>This directive only has effect on the comparisons performed during nested group processing when <code class="directive"><a href="#authldapsearchasuser"> AuthLDAPSearchAsUser</a></code> is also enabled.</p> <p> This directive should only be used when your LDAP server doesn't accept anonymous comparisons and you cannot use a dedicated <code class="directive"><a href="#authldapbinddn">AuthLDAPBindDN</a></code>. </p> <h3>See also</h3> <ul> <li><code class="directive"><a href="#authldapinitialbindasuser">AuthLDAPInitialBindAsUser</a></code></li> <li><code class="directive"><a href="#authldapsearchasuser">AuthLDAPSearchAsUser</a></code></li> </ul> </div>  <div class="directive-section">
<h2 id="authldapcomparednonserver">AuthLDAPCompareDNOnServer Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>Use the LDAP server to compare the DNs</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>AuthLDAPCompareDNOnServer on|off</pre></td>
</tr> <tr>
<th>Default:</th>
<td><pre>AuthLDAPCompareDNOnServer on</pre></td>
</tr> <tr>
<th>Context:</th>
<td>directory, .htaccess</td>
</tr> <tr>
<th>Override:</th>
<td>AuthConfig</td>
</tr> <tr>
<th>Status:</th>
<td>Extension</td>
</tr> <tr>
<th>Module:</th>
<td>mod_authnz_ldap</td>
</tr> </table> <p>When set, <code class="module"><a href="mod_authnz_ldap">mod_authnz_ldap</a></code> will use the LDAP server to compare the DNs. This is the only foolproof way to compare DNs. <code class="module"><a href="mod_authnz_ldap">mod_authnz_ldap</a></code> will search the directory for the DN specified with the <a href="#reqdn"><code>Require dn</code></a> directive, then, retrieve the DN and compare it with the DN retrieved from the user entry. If this directive is not set, <code class="module"><a href="mod_authnz_ldap">mod_authnz_ldap</a></code> simply does a string comparison. It is possible to get false negatives with this approach, but it is much faster. Note the <code class="module"><a href="mod_ldap">mod_ldap</a></code> cache can speed up DN comparison in most situations.</p> </div>  <div class="directive-section">
<h2 id="authldapdereferencealiases">AuthLDAPDereferenceAliases Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>When will the module de-reference aliases</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>AuthLDAPDereferenceAliases never|searching|finding|always</pre></td>
</tr> <tr>
<th>Default:</th>
<td><pre>AuthLDAPDereferenceAliases always</pre></td>
</tr> <tr>
<th>Context:</th>
<td>directory, .htaccess</td>
</tr> <tr>
<th>Override:</th>
<td>AuthConfig</td>
</tr> <tr>
<th>Status:</th>
<td>Extension</td>
</tr> <tr>
<th>Module:</th>
<td>mod_authnz_ldap</td>
</tr> </table> <p>This directive specifies when <code class="module"><a href="mod_authnz_ldap">mod_authnz_ldap</a></code> will de-reference aliases during LDAP operations. The default is <code>always</code>.</p> </div>  <div class="directive-section">
<h2 id="authldapgroupattribute">AuthLDAPGroupAttribute Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>LDAP attributes used to identify the user members of groups.</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>AuthLDAPGroupAttribute attribute</pre></td>
</tr> <tr>
<th>Default:</th>
<td><pre>AuthLDAPGroupAttribute member uniquemember</pre></td>
</tr> <tr>
<th>Context:</th>
<td>directory, .htaccess</td>
</tr> <tr>
<th>Override:</th>
<td>AuthConfig</td>
</tr> <tr>
<th>Status:</th>
<td>Extension</td>
</tr> <tr>
<th>Module:</th>
<td>mod_authnz_ldap</td>
</tr> </table> <p>This directive specifies which LDAP attributes are used to check for user members within groups. Multiple attributes can be used by specifying this directive multiple times. If not specified, then <code class="module"><a href="mod_authnz_ldap">mod_authnz_ldap</a></code> uses the <code>member</code> and <code>uniquemember</code> attributes.</p> </div>  <div class="directive-section">
<h2 id="authldapgroupattributeisdn">AuthLDAPGroupAttributeIsDN Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>Use the DN of the client username when checking for group membership</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>AuthLDAPGroupAttributeIsDN on|off</pre></td>
</tr> <tr>
<th>Default:</th>
<td><pre>AuthLDAPGroupAttributeIsDN on</pre></td>
</tr> <tr>
<th>Context:</th>
<td>directory, .htaccess</td>
</tr> <tr>
<th>Override:</th>
<td>AuthConfig</td>
</tr> <tr>
<th>Status:</th>
<td>Extension</td>
</tr> <tr>
<th>Module:</th>
<td>mod_authnz_ldap</td>
</tr> </table> <p>When set <code>on</code>, this directive says to use the distinguished name of the client username when checking for group membership. Otherwise, the username will be used. For example, assume that the client sent the username <code>bjenson</code>, which corresponds to the LDAP DN <code>cn=Babs Jenson, o=Example</code>. If this directive is set, <code class="module"><a href="mod_authnz_ldap">mod_authnz_ldap</a></code> will check if the group has <code>cn=Babs Jenson, o=Example</code> as a member. If this directive is not set, then <code class="module"><a href="mod_authnz_ldap">mod_authnz_ldap</a></code> will check if the group has <code>bjenson</code> as a member.</p> </div>  <div class="directive-section">
<h2 id="authldapinitialbindasuser">AuthLDAPInitialBindAsUser Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>Determines if the server does the initial DN lookup using the basic authentication users' own username, instead of anonymously or with hard-coded credentials for the server</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>AuthLDAPInitialBindAsUser off|on</pre></td>
</tr> <tr>
<th>Default:</th>
<td><pre>AuthLDAPInitialBindAsUser off</pre></td>
</tr> <tr>
<th>Context:</th>
<td>directory, .htaccess</td>
</tr> <tr>
<th>Override:</th>
<td>AuthConfig</td>
</tr> <tr>
<th>Status:</th>
<td>Extension</td>
</tr> <tr>
<th>Module:</th>
<td>mod_authnz_ldap</td>
</tr> <tr>
<th>Compatibility:</th>
<td>Available in version 2.3.6 and later</td>
</tr> </table> <p>By default, the server either anonymously, or with a dedicated user and password, converts the basic authentication username into an LDAP distinguished name (DN). This directive forces the server to use the verbatim username and password provided by the incoming user to perform the initial DN search.</p> <p> If the verbatim username can't directly bind, but needs some cosmetic transformation, see <code class="directive"><a href="#authldapinitialbindpattern"> AuthLDAPInitialBindPattern</a></code>.</p> <p> This directive should only be used when your LDAP server doesn't accept anonymous searches and you cannot use a dedicated <code class="directive"><a href="#authldapbinddn">AuthLDAPBindDN</a></code>. </p> <div class="note">
<p><strong>Not available with authorization-only</strong></p> This directive can only be used if this module authenticates the user, and has no effect when this module is used exclusively for authorization. </div> <h3>See also</h3> <ul> <li><code class="directive"><a href="#authldapinitialbindpattern">AuthLDAPInitialBindPattern</a></code></li> <li><code class="directive"><a href="#authldapbinddn">AuthLDAPBindDN</a></code></li> <li><code class="directive"><a href="#authldapcompareasuser">AuthLDAPCompareAsUser</a></code></li> <li><code class="directive"><a href="#authldapsearchasuser">AuthLDAPSearchAsUser</a></code></li> </ul> </div>  <div class="directive-section">
<h2 id="authldapinitialbindpattern">AuthLDAPInitialBindPattern Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>Specifies the transformation of the basic authentication username to be used when binding to the LDAP server to perform a DN lookup</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>AuthLDAPInitialBindPattern regex substitution</pre></td>
</tr> <tr>
<th>Default:</th>
<td><pre>AuthLDAPInitialBindPattern (.*) $1 (remote username used verbatim)</pre></td>
</tr> <tr>
<th>Context:</th>
<td>directory, .htaccess</td>
</tr> <tr>
<th>Override:</th>
<td>AuthConfig</td>
</tr> <tr>
<th>Status:</th>
<td>Extension</td>
</tr> <tr>
<th>Module:</th>
<td>mod_authnz_ldap</td>
</tr> <tr>
<th>Compatibility:</th>
<td>Available in version 2.3.6 and later</td>
</tr> </table> <p>If <code class="directive"><a href="#authldapinitialbindasuser">AuthLDAPInitialBindAsUser</a></code> is set to <em>ON</em>, the basic authentication username will be transformed according to the regular expression and substitution arguments.</p> <p> The regular expression argument is compared against the current basic authentication username. The substitution argument may contain backreferences, but has no other variable interpolation.</p> <p> This directive should only be used when your LDAP server doesn't accept anonymous searches and you cannot use a dedicated <code class="directive"><a href="#authldapbinddn">AuthLDAPBindDN</a></code>. </p> <pre class="prettyprint lang-config">AuthLDAPInitialBindPattern (.+) $1@example.com</pre> <pre class="prettyprint lang-config">AuthLDAPInitialBindPattern (.+) cn=$1,dc=example,dc=com</pre> <div class="note">
<p><strong>Not available with authorization-only</strong></p> This directive can only be used if this module authenticates the user, and has no effect when this module is used exclusively for authorization. </div> <div class="note">
<p><strong>debugging</strong></p> The substituted DN is recorded in the environment variable <em>LDAP_BINDASUSER</em>. If the regular expression does not match the input, the verbatim username is used. </div> <h3>See also</h3> <ul> <li><code class="directive"><a href="#authldapinitialbindasuser">AuthLDAPInitialBindAsUser</a></code></li> <li><code class="directive"><a href="#authldapbinddn">AuthLDAPBindDN</a></code></li> </ul> </div>  <div class="directive-section">
<h2 id="authldapmaxsubgroupdepth">AuthLDAPMaxSubGroupDepth Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>Specifies the maximum sub-group nesting depth that will be evaluated before the user search is discontinued.</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>AuthLDAPMaxSubGroupDepth Number</pre></td>
</tr> <tr>
<th>Default:</th>
<td><pre>AuthLDAPMaxSubGroupDepth 10</pre></td>
</tr> <tr>
<th>Context:</th>
<td>directory, .htaccess</td>
</tr> <tr>
<th>Override:</th>
<td>AuthConfig</td>
</tr> <tr>
<th>Status:</th>
<td>Extension</td>
</tr> <tr>
<th>Module:</th>
<td>mod_authnz_ldap</td>
</tr> <tr>
<th>Compatibility:</th>
<td>Available in version 2.3.0 and later</td>
</tr> </table> <p>When this directive is set to a non-zero value <code>X</code> combined with use of the <code>Require ldap-group someGroupDN</code> directive, the provided user credentials will be searched for as a member of the <code>someGroupDN</code> directory object or of any group member of the current group up to the maximum nesting level <code>X</code> specified by this directive.</p> <p>See the <a href="#reqgroup"><code>Require ldap-group</code></a> section for a more detailed example.</p> <div class="note">
<p><strong>Nested groups performance</strong></p> <p> When <code class="directive">AuthLDAPSubGroupAttribute</code> overlaps with <code class="directive">AuthLDAPGroupAttribute</code> (as it does by default and as required by common LDAP schemas), uncached searching for subgroups in large groups can be very slow. If you use large, non-nested groups, set <code class="directive">AuthLDAPMaxSubGroupDepth</code> to zero.</p> </div> </div>  <div class="directive-section">
<h2 id="authldapremoteuserattribute">AuthLDAPRemoteUserAttribute Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>Use the value of the attribute returned during the user query to set the REMOTE_USER environment variable</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>AuthLDAPRemoteUserAttribute uid</pre></td>
</tr> <tr>
<th>Default:</th>
<td><code>none</code></td>
</tr> <tr>
<th>Context:</th>
<td>directory, .htaccess</td>
</tr> <tr>
<th>Override:</th>
<td>AuthConfig</td>
</tr> <tr>
<th>Status:</th>
<td>Extension</td>
</tr> <tr>
<th>Module:</th>
<td>mod_authnz_ldap</td>
</tr> </table> <p>If this directive is set, the value of the <code>REMOTE_USER</code> environment variable will be set to the value of the attribute specified. Make sure that this attribute is included in the list of attributes in the AuthLDAPUrl definition, otherwise this directive will have no effect. This directive, if present, takes precedence over <code class="directive"><a href="#authldapremoteuserisdn">AuthLDAPRemoteUserIsDN</a></code>. This directive is useful should you want people to log into a website using an email address, but a backend application expects the username as a userid.</p> </div>  <div class="directive-section">
<h2 id="authldapremoteuserisdn">AuthLDAPRemoteUserIsDN Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>Use the DN of the client username to set the REMOTE_USER environment variable</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>AuthLDAPRemoteUserIsDN on|off</pre></td>
</tr> <tr>
<th>Default:</th>
<td><pre>AuthLDAPRemoteUserIsDN off</pre></td>
</tr> <tr>
<th>Context:</th>
<td>directory, .htaccess</td>
</tr> <tr>
<th>Override:</th>
<td>AuthConfig</td>
</tr> <tr>
<th>Status:</th>
<td>Extension</td>
</tr> <tr>
<th>Module:</th>
<td>mod_authnz_ldap</td>
</tr> </table> <p>If this directive is set to on, the value of the <code>REMOTE_USER</code> environment variable will be set to the full distinguished name of the authenticated user, rather than just the username that was passed by the client. It is turned off by default.</p> </div>  <div class="directive-section">
<h2 id="authldapsearchasuser">AuthLDAPSearchAsUser Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>Use the authenticated user's credentials to perform authorization searches</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>AuthLDAPSearchAsUser on|off</pre></td>
</tr> <tr>
<th>Default:</th>
<td><pre>AuthLDAPSearchAsUser off</pre></td>
</tr> <tr>
<th>Context:</th>
<td>directory, .htaccess</td>
</tr> <tr>
<th>Override:</th>
<td>AuthConfig</td>
</tr> <tr>
<th>Status:</th>
<td>Extension</td>
</tr> <tr>
<th>Module:</th>
<td>mod_authnz_ldap</td>
</tr> <tr>
<th>Compatibility:</th>
<td>Available in version 2.3.6 and later</td>
</tr> </table> <p>When set, and <code class="module"><a href="mod_authnz_ldap">mod_authnz_ldap</a></code> has authenticated the user, LDAP searches for authorization use the queried distinguished name (DN) and HTTP basic authentication password of the authenticated user instead of the servers configured credentials.</p> <p> The <em>ldap-filter</em> and <em>ldap-dn</em> authorization checks use searches.</p> <p>This directive only has effect on the comparisons performed during nested group processing when <code class="directive"><a href="#authldapcompareasuser"> AuthLDAPCompareAsUser</a></code> is also enabled.</p> <p> This directive should only be used when your LDAP server doesn't accept anonymous searches and you cannot use a dedicated <code class="directive"><a href="#authldapbinddn">AuthLDAPBindDN</a></code>. </p> <h3>See also</h3> <ul> <li><code class="directive"><a href="#authldapinitialbindasuser">AuthLDAPInitialBindAsUser</a></code></li> <li><code class="directive"><a href="#authldapcompareasuser">AuthLDAPCompareAsUser</a></code></li> </ul> </div>  <div class="directive-section">
<h2 id="authldapsubgroupattribute">AuthLDAPSubGroupAttribute Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>Specifies the attribute labels, one value per directive line, used to distinguish the members of the current group that are groups.</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>AuthLDAPSubGroupAttribute attribute</pre></td>
</tr> <tr>
<th>Default:</th>
<td><pre>AuthLDAPSubgroupAttribute member uniquemember</pre></td>
</tr> <tr>
<th>Context:</th>
<td>directory, .htaccess</td>
</tr> <tr>
<th>Override:</th>
<td>AuthConfig</td>
</tr> <tr>
<th>Status:</th>
<td>Extension</td>
</tr> <tr>
<th>Module:</th>
<td>mod_authnz_ldap</td>
</tr> <tr>
<th>Compatibility:</th>
<td>Available in version 2.3.0 and later</td>
</tr> </table> <p>An LDAP group object may contain members that are users and members that are groups (called nested or sub groups). The <code class="directive">AuthLDAPSubGroupAttribute</code> directive identifies the labels of group members and the <code class="directive"><a href="#authldapgroupattribute">AuthLDAPGroupAttribute</a></code> directive identifies the labels of the user members. Multiple attributes can be used by specifying this directive multiple times. If not specified, then <code class="module"><a href="mod_authnz_ldap">mod_authnz_ldap</a></code> uses the <code>member</code> and <code>uniqueMember</code> attributes.</p> </div>  <div class="directive-section">
<h2 id="authldapsubgroupclass">AuthLDAPSubGroupClass Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>Specifies which LDAP objectClass values identify directory objects that are groups during sub-group processing.</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>AuthLDAPSubGroupClass LdapObjectClass</pre></td>
</tr> <tr>
<th>Default:</th>
<td><pre>AuthLDAPSubGroupClass groupOfNames groupOfUniqueNames</pre></td>
</tr> <tr>
<th>Context:</th>
<td>directory, .htaccess</td>
</tr> <tr>
<th>Override:</th>
<td>AuthConfig</td>
</tr> <tr>
<th>Status:</th>
<td>Extension</td>
</tr> <tr>
<th>Module:</th>
<td>mod_authnz_ldap</td>
</tr> <tr>
<th>Compatibility:</th>
<td>Available in version 2.3.0 and later</td>
</tr> </table> <p>An LDAP group object may contain members that are users and members that are groups (called nested or sub groups). The <code class="directive"><a href="#authldapsubgroupattribute">AuthLDAPSubGroupAttribute</a></code> directive identifies the labels of members that may be sub-groups of the current group (as opposed to user members). The <code class="directive">AuthLDAPSubGroupClass</code> directive specifies the LDAP objectClass values used in verifying that these potential sub-groups are in fact group objects. Verified sub-groups can then be searched for more user or sub-group members. Multiple attributes can be used by specifying this directive multiple times. If not specified, then <code class="module"><a href="mod_authnz_ldap">mod_authnz_ldap</a></code> uses the <code>groupOfNames</code> and <code>groupOfUniqueNames</code> values.</p> </div>  <div class="directive-section">
<h2 id="authldapurl">AuthLDAPUrl Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>URL specifying the LDAP search parameters</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>AuthLDAPUrl url [NONE|SSL|TLS|STARTTLS]</pre></td>
</tr> <tr>
<th>Context:</th>
<td>directory, .htaccess</td>
</tr> <tr>
<th>Override:</th>
<td>AuthConfig</td>
</tr> <tr>
<th>Status:</th>
<td>Extension</td>
</tr> <tr>
<th>Module:</th>
<td>mod_authnz_ldap</td>
</tr> </table> <p>An RFC 2255 URL which specifies the LDAP search parameters to use. The syntax of the URL is</p> <div class="example"><code>ldap://host:port/basedn?attribute?scope?filter</code></div> <p>If you want to specify more than one LDAP URL that Apache should try in turn, the syntax is:</p> <pre class="prettyprint lang-config">AuthLDAPUrl "ldap://ldap1.example.com ldap2.example.com/dc=..."</pre> <p><em><strong>Caveat: </strong>If you specify multiple servers, you need to enclose the entire URL string in quotes; otherwise you will get an error: "AuthLDAPURL takes one argument, URL to define LDAP connection.." </em> You can of course use search parameters on each of these.</p> <dl> <dt>ldap</dt> <dd>For regular ldap, use the string <code>ldap</code>. For secure LDAP, use <code>ldaps</code> instead. Secure LDAP is only available if Apache was linked to an LDAP library with SSL support.</dd> <dt>host:port</dt> <dd> <p>The name/port of the ldap server (defaults to <code>localhost:389</code> for <code>ldap</code>, and <code>localhost:636</code> for <code>ldaps</code>). To specify multiple, redundant LDAP servers, just list all servers, separated by spaces. <code class="module"><a href="mod_authnz_ldap">mod_authnz_ldap</a></code> will try connecting to each server in turn, until it makes a successful connection. If multiple ldap servers are specified, then entire LDAP URL must be encapsulated in double quotes.</p> <p>Once a connection has been made to a server, that connection remains active for the life of the <code class="program"><a href="../programs/httpd">httpd</a></code> process, or until the LDAP server goes down.</p> <p>If the LDAP server goes down and breaks an existing connection, <code class="module"><a href="mod_authnz_ldap">mod_authnz_ldap</a></code> will attempt to re-connect, starting with the primary server, and trying each redundant server in turn. Note that this is different than a true round-robin search.</p> </dd> <dt>basedn</dt> <dd>The DN of the branch of the directory where all searches should start from. At the very least, this must be the top of your directory tree, but could also specify a subtree in the directory.</dd> <dt>attribute</dt> <dd>The attribute to search for. Although RFC 2255 allows a comma-separated list of attributes, only the first attribute will be used, no matter how many are provided. If no attributes are provided, the default is to use <code>uid</code>. It's a good idea to choose an attribute that will be unique across all entries in the subtree you will be using. All attributes listed will be put into the environment with an AUTHENTICATE_ prefix for use by other modules.</dd> <dt>scope</dt> <dd>The scope of the search. Can be either <code>one</code> or <code>sub</code>. Note that a scope of <code>base</code> is also supported by RFC 2255, but is not supported by this module. If the scope is not provided, or if <code>base</code> scope is specified, the default is to use a scope of <code>sub</code>.</dd> <dt>filter</dt> <dd>A valid LDAP search filter. If not provided, defaults to <code>(objectClass=*)</code>, which will search for all objects in the tree. Filters are limited to approximately 8000 characters (the definition of <code>MAX_STRING_LEN</code> in the Apache source code). This should be more than sufficient for any application. In 2.4.10 and later, the keyword <code>none</code> disables the use of a filter; this is required by some primitive LDAP servers.</dd> </dl> <p>When doing searches, the attribute, filter and username passed by the HTTP client are combined to create a search filter that looks like <code>(&amp;(<em>filter</em>)(<em>attribute</em>=<em>username</em>))</code>.</p> <p>For example, consider an URL of <code>ldap://ldap.example.com/o=Example?cn?sub?(posixid=*)</code>. When a client attempts to connect using a username of <code>Babs Jenson</code>, the resulting search filter will be <code>(&amp;(posixid=*)(cn=Babs Jenson))</code>.</p> <p>An optional parameter can be added to allow the LDAP Url to override the connection type. This parameter can be one of the following:</p> <dl> <dt>NONE</dt> <dd>Establish an unsecure connection on the default LDAP port. This is the same as <code>ldap://</code> on port 389.</dd> <dt>SSL</dt> <dd>Establish a secure connection on the default secure LDAP port. This is the same as <code>ldaps://</code>
</dd> <dt>TLS | STARTTLS</dt> <dd>Establish an upgraded secure connection on the default LDAP port. This connection will be initiated on port 389 by default and then upgraded to a secure connection on the same port.</dd> </dl> <p>See above for examples of <code class="directive"><a href="#authldapurl">AuthLDAPUrl</a></code> URLs.</p> </div>
<div class="_attribution">
  <p class="_attribution-p">
     2018 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://httpd.apache.org/docs/2.4/en/mod/mod_authnz_ldap.html" class="_attribution-link">https://httpd.apache.org/docs/2.4/en/mod/mod_authnz_ldap.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
