
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>MPM Common Directives - Apache HTTP Server - W3cubDocs</title>
  
  <meta name="description" content="This controls the directory to which Apache httpd attempts to switch before dumping core. If your operating system is configured to create core &hellip;">
  <meta name="keywords" content="apache, mpm, common, directives, http, server, apache_http_server">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/apache_http_server/mod/mpm_common.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e4ebd3a2a5652ff55173659804c4390a004917f3bdd17b5bb3ba78ea5c9c46fe181cadaac34517ccd815f5bdc982bbfe67179d6f4ac2f084ef2265e2a3dc8dc5.css" integrity="sha512-5OvToqVlL/VRc2WYBMQ5CgBJF/O90Xtbs7p46lycRv4YHK2qw0UXzNgV9b3Jgrv+Zxedb0rC8ITvImXio9yNxQ==" crossorigin="anonymous">
  <script type="text/javascript" integrity="sha512-EpkDeu98lN/jPKijllzVWdRg/dUSSMCaldYZNFz6bcNoBvpWRNz0HSTRQJ3ENmQc5Cuj1zDW1vHd7b0DzpOgyA==" crossorigin="anonymous" src="/assets/application-1299037aef7c94dfe33ca8a3965cd559d460fdd51248c09a95d619345cfa6dc36806fa5644dcf41d24d1409dc436641ce42ba3d730d6d6f1ddedbd03ce93a0c8.js"></script>
  <script src="/json/apache_http_server.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/apache_http_server/" class="_nav-link" title="" style="margin-left:0;">Apache HTTP Server</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _apache">
				
				
<h1>Apache MPM Common Directives</h1>  <table class="module">
<tr>
<th>Description:</th>
<td>A collection of directives that are implemented by more than one multi-processing module (MPM)</td>
</tr> <tr>
<th>Status:</th>
<td>MPM</td>
</tr>
</table>    <div class="directive-section">
<h2 id="coredumpdirectory">CoreDumpDirectory Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>Directory where Apache HTTP Server attempts to switch before dumping core</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>CoreDumpDirectory directory</pre></td>
</tr> <tr>
<th>Default:</th>
<td><pre>See usage for the default setting</pre></td>
</tr> <tr>
<th>Context:</th>
<td>server config</td>
</tr> <tr>
<th>Status:</th>
<td>MPM</td>
</tr> <tr>
<th>Module:</th>
<td>
<code class="module"><a href="event">event</a></code>, <code class="module"><a href="worker">worker</a></code>, <code class="module"><a href="prefork">prefork</a></code>
</td>
</tr> </table> <p>This controls the directory to which Apache httpd attempts to switch before dumping core. If your operating system is configured to create core files in the working directory of the crashing process, <code class="directive">CoreDumpDirectory</code> is necessary to change working directory from the default <code class="directive"><a href="core#serverroot">ServerRoot</a></code> directory, which should not be writable by the user the server runs as.</p> <p>If you want a core dump for debugging, you can use this directive to place it in a different location. This directive has no effect if your operating system is not configured to write core files to the working directory of the crashing processes.</p> <div class="note">
<p><strong>Core Dumps on Linux</strong></p> <p>If Apache httpd starts as root and switches to another user, the Linux kernel <em>disables</em> core dumps even if the directory is writable for the process. Apache httpd (2.0.46 and later) reenables core dumps on Linux 2.4 and beyond, but only if you explicitly configure a <code class="directive">CoreDumpDirectory</code>.</p> </div> <div class="note"> <p><strong>Core Dumps on BSD</strong></p> <p>To enable core-dumping of suid-executables on BSD-systems (such as FreeBSD), set <code>kern.sugid_coredump</code> to 1. </p> </div> <div class="note">
<p><strong>Specific signals</strong></p> <p><code class="directive">CoreDumpDirectory</code> processing only occurs for a select set of fatal signals: SIGFPE, SIGILL, SIGABORT, SIGSEGV, and SIGBUS.</p> <p>On some operating systems, SIGQUIT also results in a core dump but does not go through <code class="directive">CoreDumpDirectory</code> or <code class="directive">EnableExceptionHook</code> processing, so the core location is dictated entirely by the operating system.</p> </div> </div>  <div class="directive-section">
<h2 id="enableexceptionhook">EnableExceptionHook Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>Enables a hook that runs exception handlers after a crash</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>EnableExceptionHook On|Off</pre></td>
</tr> <tr>
<th>Default:</th>
<td><pre>EnableExceptionHook Off</pre></td>
</tr> <tr>
<th>Context:</th>
<td>server config</td>
</tr> <tr>
<th>Status:</th>
<td>MPM</td>
</tr> <tr>
<th>Module:</th>
<td>
<code class="module"><a href="event">event</a></code>, <code class="module"><a href="worker">worker</a></code>, <code class="module"><a href="prefork">prefork</a></code>
</td>
</tr> </table> <p>For safety reasons this directive is only available if the server was configured with the <code>--enable-exception-hook</code> option. It enables a hook that allows external modules to plug in and do something after a child crashed.</p> <p>There are already two modules, <code>mod_whatkilledus</code> and <code>mod_backtrace</code> that make use of this hook. Please have a look at Jeff Trawick's <a href="https://emptyhammock.com/projects/httpd/diag/">EnableExceptionHook site</a> for more information about these.</p> </div>  <div class="directive-section">
<h2 id="gracefulshutdowntimeout">GracefulShutdownTimeout Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>Specify a timeout after which a gracefully shutdown server will exit.</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>GracefulShutdownTimeout seconds</pre></td>
</tr> <tr>
<th>Default:</th>
<td><pre>GracefulShutdownTimeout 0</pre></td>
</tr> <tr>
<th>Context:</th>
<td>server config</td>
</tr> <tr>
<th>Status:</th>
<td>MPM</td>
</tr> <tr>
<th>Module:</th>
<td>
<code class="module"><a href="event">event</a></code>, <code class="module"><a href="worker">worker</a></code>, <code class="module"><a href="prefork">prefork</a></code>
</td>
</tr> <tr>
<th>Compatibility:</th>
<td>Available in version 2.2 and later</td>
</tr> </table> <p>The <code class="directive">GracefulShutdownTimeout</code> specifies how many seconds after receiving a "graceful-stop" signal, a server should continue to run, handling the existing connections.</p> <p>Setting this value to zero means that the server will wait indefinitely until all remaining requests have been fully served.</p> </div>  <div class="directive-section">
<h2 id="listen">Listen Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>IP addresses and ports that the server listens to</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>Listen [IP-address:]portnumber [protocol]</pre></td>
</tr> <tr>
<th>Context:</th>
<td>server config</td>
</tr> <tr>
<th>Status:</th>
<td>MPM</td>
</tr> <tr>
<th>Module:</th>
<td>
<code class="module"><a href="event">event</a></code>, <code class="module"><a href="worker">worker</a></code>, <code class="module"><a href="prefork">prefork</a></code>, <code class="module"><a href="mpm_winnt">mpm_winnt</a></code>, <code class="module"><a href="mpm_netware">mpm_netware</a></code>, <code class="module"><a href="mpmt_os2">mpmt_os2</a></code>
</td>
</tr> <tr>
<th>Compatibility:</th>
<td>The <var>protocol</var> argument was added in 2.1.5</td>
</tr> </table> <p>The <code class="directive">Listen</code> directive instructs Apache httpd to listen to only specific IP addresses or ports; by default it responds to requests on all IP interfaces. <code class="directive">Listen</code> is now a required directive. If it is not in the config file, the server will fail to start. This is a change from previous versions of Apache httpd.</p> <p>The <code class="directive">Listen</code> directive tells the server to accept incoming requests on the specified port or address-and-port combination. If only a port number is specified, the server listens to the given port on all interfaces. If an IP address is given as well as a port, the server will listen on the given port and interface.</p> <p>Multiple <code class="directive">Listen</code> directives may be used to specify a number of addresses and ports to listen to. The server will respond to requests from any of the listed addresses and ports.</p> <p>For example, to make the server accept connections on both port 80 and port 8000, use:</p> <pre class="prettyprint lang-config">Listen 80
Listen 8000</pre> <p>To make the server accept connections on two specified interfaces and port numbers, use </p> <pre class="prettyprint lang-config">Listen 192.170.2.1:80
Listen 192.170.2.5:8000</pre> <p>IPv6 addresses must be surrounded in square brackets, as in the following example:</p> <pre class="prettyprint lang-config">Listen [2001:db8::a00:20ff:fea7:ccea]:80</pre> <p>The optional <var>protocol</var> argument is not required for most configurations. If not specified, <code>https</code> is the default for port 443 and <code>http</code> the default for all other ports. The protocol is used to determine which module should handle a request, and to apply protocol specific optimizations with the <code class="directive"><a href="core#acceptfilter">AcceptFilter</a></code> directive.</p> <p>You only need to set the protocol if you are running on non-standard ports. For example, running an <code>https</code> site on port 8443:</p> <pre class="prettyprint lang-config">Listen 192.170.2.1:8443 https</pre> <div class="note">
<p><strong>Error condition</strong></p> Multiple <code class="directive">Listen</code> directives for the same ip address and port will result in an <code>Address already in use</code> error message. </div> <h3>See also</h3> <ul> <li><a href="../dns-caveats">DNS Issues</a></li> <li><a href="../bind">Setting which addresses and ports Apache HTTP Server uses</a></li> <li><a href="http://wiki.apache.org/httpd/CouldNotBindToAddress">Further discussion of the <code>Address already in use</code> error message, including other causes.</a></li> </ul> </div>  <div class="directive-section">
<h2 id="listenbacklog">ListenBackLog Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>Maximum length of the queue of pending connections</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>ListenBacklog backlog</pre></td>
</tr> <tr>
<th>Default:</th>
<td><pre>ListenBacklog 511</pre></td>
</tr> <tr>
<th>Context:</th>
<td>server config</td>
</tr> <tr>
<th>Status:</th>
<td>MPM</td>
</tr> <tr>
<th>Module:</th>
<td>
<code class="module"><a href="event">event</a></code>, <code class="module"><a href="worker">worker</a></code>, <code class="module"><a href="prefork">prefork</a></code>, <code class="module"><a href="mpm_winnt">mpm_winnt</a></code>, <code class="module"><a href="mpm_netware">mpm_netware</a></code>, <code class="module"><a href="mpmt_os2">mpmt_os2</a></code>
</td>
</tr> </table> <p>The maximum length of the queue of pending connections. Generally no tuning is needed or desired, however on some systems it is desirable to increase this when under a TCP SYN flood attack. See the backlog parameter to the <code>listen(2)</code> system call.</p> <p>This will often be limited to a smaller number by the operating system. This varies from OS to OS. Also note that many OSes do not use exactly what is specified as the backlog, but use a number based on (but normally larger than) what is set.</p> </div>  <div class="directive-section">
<h2 id="listencoresbucketsratio">ListenCoresBucketsRatio Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>Ratio between the number of CPU cores (online) and the number of listeners' buckets</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>ListenCoresBucketsRatio ratio</pre></td>
</tr> <tr>
<th>Default:</th>
<td><pre>ListenCoresBucketsRatio 0 (disabled)</pre></td>
</tr> <tr>
<th>Context:</th>
<td>server config</td>
</tr> <tr>
<th>Status:</th>
<td>MPM</td>
</tr> <tr>
<th>Module:</th>
<td>
<code class="module"><a href="event">event</a></code>, <code class="module"><a href="worker">worker</a></code>, <code class="module"><a href="prefork">prefork</a></code>
</td>
</tr> <tr>
<th>Compatibility:</th>
<td>Available in Apache HTTP Server 2.4.17, with a kernel supporting the socket option <code>SO_REUSEPORT</code> and distributing new connections evenly across listening processes' (or threads') sockets using it (eg. Linux 3.9 and later, but not the current implementations of <code>SO_REUSEPORT</code> in *BSDs.</td>
</tr> </table> <p>A <var>ratio</var> between the number of (online) CPU cores and the number of listeners' buckets can be used to make Apache HTTP Server create <code>num_cpu_cores / ratio</code> listening buckets, each containing its own <code class="directive">Listen</code>-ing socket(s) on the same port(s), and then make each child handle a single bucket (with round-robin distribution of the buckets at children creation time).</p> <div class="note">
<p><strong>Meaning of "online" CPU core</strong></p> <p>On Linux (and also BSD) a CPU core can be turned on/off if <a href="https://www.kernel.org/doc/Documentation/cpu-hotplug.txt">Hotplug</a> is configured, therefore <code class="directive">ListenCoresBucketsRatio</code> needs to take this parameter into account while calculating the number of buckets to create.</p> </div> <p><code class="directive">ListenCoresBucketsRatio</code> can improve the scalability when accepting new connections is/becomes the bottleneck. On systems with a large number of CPU cores, enabling this feature has been tested to show significant performances improvement and shorter responses time.</p> <p>There must be at least twice the number of CPU cores than the configured <var>ratio</var> for this to be active. The recommended <var>ratio</var> is <code>8</code>, hence at least <code>16</code> cores should be available at runtime when this value is used. The right <var>ratio</var> to obtain maximum performance needs to be calculated for each target system, testing multiple values and observing the variations in your key performance metrics.</p> <p>This directive influences the calculation of the <code class="directive"><a href="#minsparethreads">MinSpareThreads</a></code> and <code class="directive"><a href="#maxsparethreads">MaxSpareThreads</a></code> lower bound values. The number of children processes needs to be a multiple of the number of buckets to optimally accept connections.</p> <div class="note"> <p><strong>Multiple <code class="directive">Listen</code>ers or Apache HTTP servers on the same IP address and port</strong></p> <p>Setting the <code>SO_REUSEPORT</code> option on the listening socket(s) consequently allows multiple processes (sharing the same <code>EUID</code>, e.g. <code>root</code>) to bind to the the same IP address and port, without the binding error raised by the system in the usual case.</p> <p>This also means that multiple instances of Apache httpd configured on a same <code>IP:port</code> and with a positive <code class="directive">ListenCoresBucketsRatio</code> would start without an error too, and then run with incoming connections evenly distributed accross both instances (this is NOT a recommendation or a sensible usage in any case, but just a notice that it would prevent such possible issues to be detected).</p> <p>Within the same instance, Apache httpd will check and fail to start if multiple <code class="directive">Listen</code> directives on the exact same IP (or hostname) and port are configured, thus avoiding the creation of some duplicated buckets which would be useless and kill performances. However it can't (and won't try harder to) catch all the possible overlapping cases (like a hostname resolving to an IP used elsewhere).</p> </div> </div>  <div class="directive-section">
<h2 id="maxconnectionsperchild">MaxConnectionsPerChild Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>Limit on the number of connections that an individual child server will handle during its life</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>MaxConnectionsPerChild number</pre></td>
</tr> <tr>
<th>Default:</th>
<td><pre>MaxConnectionsPerChild 0</pre></td>
</tr> <tr>
<th>Context:</th>
<td>server config</td>
</tr> <tr>
<th>Status:</th>
<td>MPM</td>
</tr> <tr>
<th>Module:</th>
<td>
<code class="module"><a href="event">event</a></code>, <code class="module"><a href="worker">worker</a></code>, <code class="module"><a href="prefork">prefork</a></code>, <code class="module"><a href="mpm_winnt">mpm_winnt</a></code>, <code class="module"><a href="mpm_netware">mpm_netware</a></code>, <code class="module"><a href="mpmt_os2">mpmt_os2</a></code>
</td>
</tr> <tr>
<th>Compatibility:</th>
<td>Available Apache HTTP Server 2.3.9 and later. The old name <code>MaxRequestsPerChild</code> is still supported.</td>
</tr> </table> <p>The <code class="directive">MaxConnectionsPerChild</code> directive sets the limit on the number of connections that an individual child server process will handle. After <code class="directive">MaxConnectionsPerChild</code> connections, the child process will die. If <code class="directive">MaxConnectionsPerChild</code> is <code>0</code>, then the process will never expire.</p> <p>Setting <code class="directive">MaxConnectionsPerChild</code> to a non-zero value limits the amount of memory that process can consume by (accidental) memory leakage.</p> </div>  <div class="directive-section">
<h2 id="maxmemfree">MaxMemFree Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>Maximum amount of memory that the main allocator is allowed to hold without calling <code>free()</code>
</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>MaxMemFree KBytes</pre></td>
</tr> <tr>
<th>Default:</th>
<td><pre>MaxMemFree 2048</pre></td>
</tr> <tr>
<th>Context:</th>
<td>server config</td>
</tr> <tr>
<th>Status:</th>
<td>MPM</td>
</tr> <tr>
<th>Module:</th>
<td>
<code class="module"><a href="event">event</a></code>, <code class="module"><a href="worker">worker</a></code>, <code class="module"><a href="prefork">prefork</a></code>, <code class="module"><a href="mpm_winnt">mpm_winnt</a></code>, <code class="module"><a href="mpm_netware">mpm_netware</a></code>
</td>
</tr> </table> <p>The <code class="directive">MaxMemFree</code> directive sets the maximum number of free Kbytes that every allocator is allowed to hold without calling <code>free()</code>. In threaded MPMs, every thread has its own allocator. When set to zero, the threshold will be set to unlimited.</p> </div>  <div class="directive-section">
<h2 id="maxrequestworkers">MaxRequestWorkers Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>Maximum number of connections that will be processed simultaneously</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>MaxRequestWorkers number</pre></td>
</tr> <tr>
<th>Default:</th>
<td><pre>See usage for details</pre></td>
</tr> <tr>
<th>Context:</th>
<td>server config</td>
</tr> <tr>
<th>Status:</th>
<td>MPM</td>
</tr> <tr>
<th>Module:</th>
<td>
<code class="module"><a href="event">event</a></code>, <code class="module"><a href="worker">worker</a></code>, <code class="module"><a href="prefork">prefork</a></code>
</td>
</tr> </table> <p>The <code class="directive">MaxRequestWorkers</code> directive sets the limit on the number of simultaneous requests that will be served. Any connection attempts over the <code class="directive">MaxRequestWorkers</code> limit will normally be queued, up to a number based on the <code class="directive"><a href="#listenbacklog">ListenBacklog</a></code> directive. Once a child process is freed at the end of a different request, the connection will then be serviced.</p> <p>For non-threaded servers (<em>i.e.</em>, <code class="module"><a href="prefork">prefork</a></code>), <code class="directive">MaxRequestWorkers</code> translates into the maximum number of child processes that will be launched to serve requests. The default value is <code>256</code>; to increase it, you must also raise <code class="directive"><a href="#serverlimit">ServerLimit</a></code>.</p> <p>For threaded and hybrid servers (<em>e.g.</em> <code class="module"><a href="event">event</a></code> or <code class="module"><a href="worker">worker</a></code>) <code class="directive">MaxRequestWorkers</code> restricts the total number of threads that will be available to serve clients. For hybrid MPMs the default value is <code>16</code> (<code class="directive"><a href="#serverlimit">ServerLimit</a></code>) multiplied by the value of <code>25</code> (<code class="directive"><a href="#threadsperchild">ThreadsPerChild</a></code>). Therefore, to increase <code class="directive">MaxRequestWorkers</code> to a value that requires more than 16 processes, you must also raise <code class="directive"><a href="#serverlimit">ServerLimit</a></code>.</p> <p><code class="directive">MaxRequestWorkers</code> was called <code class="directive">MaxClients</code> before version 2.3.13. The old name is still supported.</p> </div>  <div class="directive-section">
<h2 id="maxsparethreads">MaxSpareThreads Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>Maximum number of idle threads</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>MaxSpareThreads number</pre></td>
</tr> <tr>
<th>Default:</th>
<td><pre>See usage for details</pre></td>
</tr> <tr>
<th>Context:</th>
<td>server config</td>
</tr> <tr>
<th>Status:</th>
<td>MPM</td>
</tr> <tr>
<th>Module:</th>
<td>
<code class="module"><a href="event">event</a></code>, <code class="module"><a href="worker">worker</a></code>, <code class="module"><a href="mpm_netware">mpm_netware</a></code>, <code class="module"><a href="mpmt_os2">mpmt_os2</a></code>
</td>
</tr> </table> <p>Maximum number of idle threads. Different MPMs deal with this directive differently.</p> <p>For <code class="module"><a href="worker">worker</a></code> and <code class="module"><a href="event">event</a></code>, the default is <code>MaxSpareThreads 250</code>. These MPMs deal with idle threads on a server-wide basis. If there are too many idle threads in the server then child processes are killed until the number of idle threads is less than this number. Additional processes/threads might be created if <code class="directive"><a href="#listencoresbucketsratio">ListenCoresBucketsRatio</a></code> is enabled.</p> <p>For <code class="module"><a href="mpm_netware">mpm_netware</a></code> the default is <code>MaxSpareThreads 100</code>. Since this MPM runs a single-process, the spare thread count is also server-wide.</p> <p><code class="module"><a href="mpmt_os2">mpmt_os2</a></code> works similar to <code class="module"><a href="mpm_netware">mpm_netware</a></code>. For <code class="module"><a href="mpmt_os2">mpmt_os2</a></code> the default value is <code>10</code>.</p> <div class="note">
<p><strong>Restrictions</strong></p> <p>The range of the <code class="directive">MaxSpareThreads</code> value is restricted. Apache httpd will correct the given value automatically according to the following rules:</p> <ul> <li>
<code class="module"><a href="mpm_netware">mpm_netware</a></code> wants the value to be greater than <code class="directive"><a href="#minsparethreads">MinSpareThreads</a></code>.</li> <li>For <code class="module"><a href="worker">worker</a></code> and <code class="module"><a href="event">event</a></code>, the value must be greater or equal to the sum of <code class="directive"><a href="#minsparethreads"> MinSpareThreads</a></code> and <code class="directive"><a href="#threadsperchild"> ThreadsPerChild</a></code>.</li> </ul> </div> <h3>See also</h3> <ul> <li><code class="directive"><a href="#minsparethreads">MinSpareThreads</a></code></li> <li><code class="directive"><a href="#startservers">StartServers</a></code></li> <li><code class="directive"><a href="prefork#maxspareservers">MaxSpareServers</a></code></li> </ul> </div>  <div class="directive-section">
<h2 id="minsparethreads">MinSpareThreads Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>Minimum number of idle threads available to handle request spikes</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>MinSpareThreads number</pre></td>
</tr> <tr>
<th>Default:</th>
<td><pre>See usage for details</pre></td>
</tr> <tr>
<th>Context:</th>
<td>server config</td>
</tr> <tr>
<th>Status:</th>
<td>MPM</td>
</tr> <tr>
<th>Module:</th>
<td>
<code class="module"><a href="event">event</a></code>, <code class="module"><a href="worker">worker</a></code>, <code class="module"><a href="mpm_netware">mpm_netware</a></code>, <code class="module"><a href="mpmt_os2">mpmt_os2</a></code>
</td>
</tr> </table> <p>Minimum number of idle threads to handle request spikes. Different MPMs deal with this directive differently.</p> <p><code class="module"><a href="worker">worker</a></code> and <code class="module"><a href="event">event</a></code> use a default of <code>MinSpareThreads 75</code> and deal with idle threads on a server-wide basis. If there aren't enough idle threads in the server then child processes are created until the number of idle threads is greater than <var>number</var>. Additional processes/threads might be created if <code class="directive"><a href="#listencoresbucketsratio">ListenCoresBucketsRatio</a></code> is enabled.</p> <p><code class="module"><a href="mpm_netware">mpm_netware</a></code> uses a default of <code>MinSpareThreads 10</code> and, since it is a single-process MPM, tracks this on a server-wide bases.</p> <p><code class="module"><a href="mpmt_os2">mpmt_os2</a></code> works similar to <code class="module"><a href="mpm_netware">mpm_netware</a></code>. For <code class="module"><a href="mpmt_os2">mpmt_os2</a></code> the default value is <code>5</code>.</p> <h3>See also</h3> <ul> <li><code class="directive"><a href="#maxsparethreads">MaxSpareThreads</a></code></li> <li><code class="directive"><a href="#startservers">StartServers</a></code></li> <li><code class="directive"><a href="prefork#minspareservers">MinSpareServers</a></code></li> </ul> </div>  <div class="directive-section">
<h2 id="pidfile">PidFile Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>File where the server records the process ID of the daemon</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>PidFile filename</pre></td>
</tr> <tr>
<th>Default:</th>
<td><pre>PidFile logs/httpd.pid</pre></td>
</tr> <tr>
<th>Context:</th>
<td>server config</td>
</tr> <tr>
<th>Status:</th>
<td>MPM</td>
</tr> <tr>
<th>Module:</th>
<td>
<code class="module"><a href="event">event</a></code>, <code class="module"><a href="worker">worker</a></code>, <code class="module"><a href="prefork">prefork</a></code>, <code class="module"><a href="mpm_winnt">mpm_winnt</a></code>, <code class="module"><a href="mpmt_os2">mpmt_os2</a></code>
</td>
</tr> </table> <p>The <code class="directive">PidFile</code> directive sets the file to which the server records the process id of the daemon. If the filename is not absolute then it is assumed to be relative to the <code class="directive"><a href="core#serverroot">ServerRoot</a></code>.</p> <div class="example">
<h3>Example</h3>
<pre class="prettyprint lang-config">PidFile /var/run/apache.pid</pre> </div> <p>It is often useful to be able to send the server a signal, so that it closes and then re-opens its <code class="directive"><a href="core#errorlog">ErrorLog</a></code> and <code class="directive"><a href="mod_log_config#transferlog">TransferLog</a></code>, and re-reads its configuration files. This is done by sending a SIGHUP (kill -1) signal to the process id listed in the <code class="directive">PidFile</code>.</p> <p>The <code class="directive">PidFile</code> is subject to the same warnings about log file placement and <a href="../misc/security_tips#serverroot">security</a>.</p> <div class="note">
<p><strong>Note</strong></p> <p>As of Apache HTTP Server 2, we recommended that you only use the <code class="program"><a href="../programs/apachectl">apachectl</a></code> script, or the init script that your OS provides, for (re-)starting or stopping the server.</p> </div> </div>  <div class="directive-section">
<h2 id="receivebuffersize">ReceiveBufferSize Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>TCP receive buffer size</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>ReceiveBufferSize bytes</pre></td>
</tr> <tr>
<th>Default:</th>
<td><pre>ReceiveBufferSize 0</pre></td>
</tr> <tr>
<th>Context:</th>
<td>server config</td>
</tr> <tr>
<th>Status:</th>
<td>MPM</td>
</tr> <tr>
<th>Module:</th>
<td>
<code class="module"><a href="event">event</a></code>, <code class="module"><a href="worker">worker</a></code>, <code class="module"><a href="prefork">prefork</a></code>, <code class="module"><a href="mpm_winnt">mpm_winnt</a></code>, <code class="module"><a href="mpm_netware">mpm_netware</a></code>, <code class="module"><a href="mpmt_os2">mpmt_os2</a></code>
</td>
</tr> </table> <p>The server will set the TCP receive buffer size to the number of bytes specified.</p> <p>If set to the value of <code>0</code>, the server will use the OS default.</p> </div>  <div class="directive-section">
<h2 id="scoreboardfile">ScoreBoardFile Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>Location of the file used to store coordination data for the child processes</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>ScoreBoardFile file-path</pre></td>
</tr> <tr>
<th>Default:</th>
<td><pre>ScoreBoardFile logs/apache_runtime_status</pre></td>
</tr> <tr>
<th>Context:</th>
<td>server config</td>
</tr> <tr>
<th>Status:</th>
<td>MPM</td>
</tr> <tr>
<th>Module:</th>
<td>
<code class="module"><a href="event">event</a></code>, <code class="module"><a href="worker">worker</a></code>, <code class="module"><a href="prefork">prefork</a></code>, <code class="module"><a href="mpm_winnt">mpm_winnt</a></code>
</td>
</tr> </table> <p>Apache HTTP Server uses a scoreboard to communicate between its parent and child processes. Some architectures require a file to facilitate this communication. If the file is left unspecified, Apache httpd first attempts to create the scoreboard entirely in memory (using anonymous shared memory) and, failing that, will attempt to create the file on disk (using file-based shared memory). Specifying this directive causes Apache httpd to always create the file on the disk.</p> <div class="example">
<h3>Example</h3>
<pre class="prettyprint lang-config">ScoreBoardFile /var/run/apache_runtime_status</pre> </div> <p>File-based shared memory is useful for third-party applications that require direct access to the scoreboard.</p> <p>If you use a <code class="directive">ScoreBoardFile</code> then you may see improved speed by placing it on a RAM disk. But be careful that you heed the same warnings about log file placement and <a href="../misc/security_tips">security</a>.</p> <h3>See also</h3> <ul> <li><a href="../stopping">Stopping and Restarting Apache HTTP Server</a></li> </ul> </div>  <div class="directive-section">
<h2 id="sendbuffersize">SendBufferSize Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>TCP buffer size</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>SendBufferSize bytes</pre></td>
</tr> <tr>
<th>Default:</th>
<td><pre>SendBufferSize 0</pre></td>
</tr> <tr>
<th>Context:</th>
<td>server config</td>
</tr> <tr>
<th>Status:</th>
<td>MPM</td>
</tr> <tr>
<th>Module:</th>
<td>
<code class="module"><a href="event">event</a></code>, <code class="module"><a href="worker">worker</a></code>, <code class="module"><a href="prefork">prefork</a></code>, <code class="module"><a href="mpm_winnt">mpm_winnt</a></code>, <code class="module"><a href="mpm_netware">mpm_netware</a></code>, <code class="module"><a href="mpmt_os2">mpmt_os2</a></code>
</td>
</tr> </table> <p>Sets the server's TCP send buffer size to the number of bytes specified. It is often useful to set this past the OS's standard default value on high speed, high latency connections (<em>i.e.</em>, 100ms or so, such as transcontinental fast pipes).</p> <p>If set to the value of <code>0</code>, the server will use the default value provided by your OS.</p> <p>Further configuration of your operating system may be required to elicit better performance on high speed, high latency connections.</p> <div class="note"> <p> On some operating systems, changes in TCP behavior resulting from a larger <code class="directive">SendBufferSize</code> may not be seen unless <code class="directive"><a href="core#enablesendfile">EnableSendfile</a></code> is set to OFF. This interaction applies only to static files.</p> </div> </div>  <div class="directive-section">
<h2 id="serverlimit">ServerLimit Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>Upper limit on configurable number of processes</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>ServerLimit number</pre></td>
</tr> <tr>
<th>Default:</th>
<td><pre>See usage for details</pre></td>
</tr> <tr>
<th>Context:</th>
<td>server config</td>
</tr> <tr>
<th>Status:</th>
<td>MPM</td>
</tr> <tr>
<th>Module:</th>
<td>
<code class="module"><a href="event">event</a></code>, <code class="module"><a href="worker">worker</a></code>, <code class="module"><a href="prefork">prefork</a></code>
</td>
</tr> </table> <p>For the <code class="module"><a href="prefork">prefork</a></code> MPM, this directive sets the maximum configured value for <code class="directive"><a href="#maxrequestworkers">MaxRequestWorkers</a></code> for the lifetime of the Apache httpd process. For the <code class="module"><a href="worker">worker</a></code> and <code class="module"><a href="event">event </a></code> MPMs, this directive in combination with <code class="directive"><a href="#threadlimit">ThreadLimit</a></code> sets the maximum configured value for <code class="directive"><a href="#maxrequestworkers">MaxRequestWorkers</a></code> for the lifetime of the Apache httpd process. For the <code class="module"><a href="event">event</a></code> MPM, this directive also defines how many old server processes may keep running and finish processing open connections. Any attempts to change this directive during a restart will be ignored, but <code class="directive"><a href="#maxrequestworkers">MaxRequestWorkers</a></code> can be modified during a restart.</p> <p>Special care must be taken when using this directive. If <code class="directive">ServerLimit</code> is set to a value much higher than necessary, extra, unused shared memory will be allocated. If both <code class="directive">ServerLimit</code> and <code class="directive"><a href="#maxrequestworkers">MaxRequestWorkers</a></code> are set to values higher than the system can handle, Apache httpd may not start or the system may become unstable.</p> <p>With the <code class="module"><a href="prefork">prefork</a></code> MPM, use this directive only if you need to set <code class="directive"><a href="#maxrequestworkers">MaxRequestWorkers</a></code> higher than 256 (default). Do not set the value of this directive any higher than what you might want to set <code class="directive"><a href="#maxrequestworkers">MaxRequestWorkers</a></code> to.</p> <p>With <code class="module"><a href="worker">worker</a></code>, use this directive only if your <code class="directive"><a href="#maxrequestworkers">MaxRequestWorkers </a></code> and <code class="directive"><a href="#threadsperchild">ThreadsPerChild</a></code> settings require more than 16 server processes (default). Do not set the value of this directive any higher than the number of server processes required by what you may want for <code class="directive"><a href="#maxrequestworkers">MaxRequestWorkers </a></code> and <code class="directive"><a href="#threadsperchild">ThreadsPerChild</a></code>.</p> <p>With <code class="module"><a href="event">event</a></code>, increase this directive if the process number defined by your <code class="directive"><a href="#maxrequestworkers">MaxRequestWorkers</a></code> and <code class="directive"><a href="#threadsperchild">ThreadsPerChild</a></code> settings, plus the number of gracefully shutting down processes, is more than 16 server processes (default).</p> <div class="note">
<p><strong>Note</strong></p> <p>There is a hard limit of <code>ServerLimit 20000</code> compiled into the server (for the <code class="module"><a href="prefork">prefork</a></code> MPM 200000). This is intended to avoid nasty effects caused by typos. To increase it even further past this limit, you will need to modify the value of MAX_SERVER_LIMIT in the mpm source file and rebuild the server.</p> </div> <h3>See also</h3> <ul> <li><a href="../stopping">Stopping and Restarting Apache HTTP Server</a></li> </ul> </div>  <div class="directive-section">
<h2 id="startservers">StartServers Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>Number of child server processes created at startup</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>StartServers number</pre></td>
</tr> <tr>
<th>Default:</th>
<td><pre>See usage for details</pre></td>
</tr> <tr>
<th>Context:</th>
<td>server config</td>
</tr> <tr>
<th>Status:</th>
<td>MPM</td>
</tr> <tr>
<th>Module:</th>
<td>
<code class="module"><a href="event">event</a></code>, <code class="module"><a href="worker">worker</a></code>, <code class="module"><a href="prefork">prefork</a></code>, <code class="module"><a href="mpmt_os2">mpmt_os2</a></code>
</td>
</tr> </table> <p>The <code class="directive">StartServers</code> directive sets the number of child server processes created on startup. As the number of processes is dynamically controlled depending on the load, (see <code class="directive"><a href="#minsparethreads">MinSpareThreads</a></code>, <code class="directive"><a href="#maxsparethreads">MaxSpareThreads</a></code>, <code class="directive"><a href="prefork#minspareservers">MinSpareServers</a></code>, <code class="directive"><a href="prefork#maxspareservers">MaxSpareServers</a></code>) there is usually little reason to adjust this parameter.</p> <p>The default value differs from MPM to MPM. <code class="module"><a href="worker">worker</a></code> and <code class="module"><a href="event">event</a></code> default to <code>StartServers 3</code>; <code class="module"><a href="prefork"> prefork</a></code> defaults to <code>5</code>; <code class="module"><a href="mpmt_os2">mpmt_os2</a></code> defaults to <code>2</code>.</p> </div>  <div class="directive-section">
<h2 id="startthreads">StartThreads Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>Number of threads created on startup</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>StartThreads number</pre></td>
</tr> <tr>
<th>Default:</th>
<td><pre>See usage for details</pre></td>
</tr> <tr>
<th>Context:</th>
<td>server config</td>
</tr> <tr>
<th>Status:</th>
<td>MPM</td>
</tr> <tr>
<th>Module:</th>
<td><code class="module">mpm_netware</code></td>
</tr> </table> <p>Number of threads created on startup. As the number of threads is dynamically controlled depending on the load, (see <code class="directive"><a href="#minsparethreads">MinSpareThreads</a></code>, <code class="directive"><a href="#maxsparethreads">MaxSpareThreads</a></code>, <code class="directive"><a href="prefork#minspareservers">MinSpareServers</a></code>, <code class="directive"><a href="prefork#maxspareservers">MaxSpareServers</a></code>) there is usually little reason to adjust this parameter.</p> <p>For <code class="module"><a href="mpm_netware">mpm_netware</a></code> the default is <code>StartThreads 50</code> and, since there is only a single process, this is the total number of threads created at startup to serve requests.</p> </div>  <div class="directive-section">
<h2 id="threadlimit">ThreadLimit Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>Sets the upper limit on the configurable number of threads per child process</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>ThreadLimit number</pre></td>
</tr> <tr>
<th>Default:</th>
<td><pre>See usage for details</pre></td>
</tr> <tr>
<th>Context:</th>
<td>server config</td>
</tr> <tr>
<th>Status:</th>
<td>MPM</td>
</tr> <tr>
<th>Module:</th>
<td>
<code class="module"><a href="event">event</a></code>, <code class="module"><a href="worker">worker</a></code>, <code class="module"><a href="mpm_winnt">mpm_winnt</a></code>
</td>
</tr> </table> <p>This directive sets the maximum configured value for <code class="directive"><a href="#threadsperchild">ThreadsPerChild</a></code> for the lifetime of the Apache httpd process. Any attempts to change this directive during a restart will be ignored, but <code class="directive"><a href="#threadsperchild">ThreadsPerChild</a></code> can be modified during a restart up to the value of this directive.</p> <p>Special care must be taken when using this directive. If <code class="directive">ThreadLimit</code> is set to a value much higher than <code class="directive"><a href="#threadsperchild">ThreadsPerChild</a></code>, extra unused shared memory will be allocated. If both <code class="directive">ThreadLimit</code> and <code class="directive"><a href="#threadsperchild">ThreadsPerChild</a></code> are set to values higher than the system can handle, Apache httpd may not start or the system may become unstable. Do not set the value of this directive any higher than your greatest predicted setting of <code class="directive"><a href="#threadsperchild">ThreadsPerChild</a></code> for the current run of Apache httpd.</p> <p>The default value for <code class="directive">ThreadLimit</code> is <code>1920</code> when used with <code class="module"><a href="mpm_winnt">mpm_winnt</a></code> and <code>64</code> when used with the others.</p> <div class="note">
<p><strong>Note</strong></p> <p>There is a hard limit of <code>ThreadLimit 20000</code> (or <code>ThreadLimit 100000</code> with <code class="module"><a href="event">event</a></code>, <code>ThreadLimit 15000</code> with <code class="module"><a href="mpm_winnt">mpm_winnt</a></code>) compiled into the server. This is intended to avoid nasty effects caused by typos. To increase it even further past this limit, you will need to modify the value of MAX_THREAD_LIMIT in the mpm source file and rebuild the server.</p> </div> </div>  <div class="directive-section">
<h2 id="threadsperchild">ThreadsPerChild Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>Number of threads created by each child process</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>ThreadsPerChild number</pre></td>
</tr> <tr>
<th>Default:</th>
<td><pre>See usage for details</pre></td>
</tr> <tr>
<th>Context:</th>
<td>server config</td>
</tr> <tr>
<th>Status:</th>
<td>MPM</td>
</tr> <tr>
<th>Module:</th>
<td>
<code class="module"><a href="event">event</a></code>, <code class="module"><a href="worker">worker</a></code>, <code class="module"><a href="mpm_winnt">mpm_winnt</a></code>
</td>
</tr> </table> <p>This directive sets the number of threads created by each child process. The child creates these threads at startup and never creates more. If using an MPM like <code class="module"><a href="mpm_winnt">mpm_winnt</a></code>, where there is only one child process, this number should be high enough to handle the entire load of the server. If using an MPM like <code class="module"><a href="worker">worker</a></code>, where there are multiple child processes, the <em>total</em> number of threads should be high enough to handle the common load on the server.</p> <p>The default value for <code class="directive">ThreadsPerChild</code> is <code>64</code> when used with <code class="module"><a href="mpm_winnt">mpm_winnt</a></code> and <code>25</code> when used with the others.</p> </div>  <div class="directive-section">
<h2 id="threadstacksize">ThreadStackSize Directive</h2> <table class="directive"> <tr>
<th>Description:</th>
<td>The size in bytes of the stack used by threads handling client connections</td>
</tr> <tr>
<th>Syntax:</th>
<td><pre>ThreadStackSize size</pre></td>
</tr> <tr>
<th>Default:</th>
<td><pre>65536 on NetWare; varies on other operating systems</pre></td>
</tr> <tr>
<th>Context:</th>
<td>server config</td>
</tr> <tr>
<th>Status:</th>
<td>MPM</td>
</tr> <tr>
<th>Module:</th>
<td>
<code class="module"><a href="event">event</a></code>, <code class="module"><a href="worker">worker</a></code>, <code class="module"><a href="mpm_winnt">mpm_winnt</a></code>, <code class="module"><a href="mpm_netware">mpm_netware</a></code>, <code class="module"><a href="mpmt_os2">mpmt_os2</a></code>
</td>
</tr> <tr>
<th>Compatibility:</th>
<td>Available in Apache HTTP Server 2.1 and later</td>
</tr> </table> <p>The <code class="directive">ThreadStackSize</code> directive sets the size of the stack (for autodata) of threads which handle client connections and call modules to help process those connections. In most cases the operating system default for stack size is reasonable, but there are some conditions where it may need to be adjusted:</p> <ul> <li>On platforms with a relatively small default thread stack size (e.g., HP-UX), Apache httpd may crash when using some third-party modules which use a relatively large amount of autodata storage. Those same modules may have worked fine on other platforms where the default thread stack size is larger. This type of crash is resolved by setting <code class="directive">ThreadStackSize</code> to a value higher than the operating system default. This type of adjustment is necessary only if the provider of the third-party module specifies that it is required, or if diagnosis of an Apache httpd crash indicates that the thread stack size was too small.</li> <li>On platforms where the default thread stack size is significantly larger than necessary for the web server configuration, a higher number of threads per child process will be achievable if <code class="directive">ThreadStackSize</code> is set to a value lower than the operating system default. This type of adjustment should only be made in a test environment which allows the full set of web server processing can be exercised, as there may be infrequent requests which require more stack to process. The minimum required stack size strongly depends on the modules used, but any change in the web server configuration can invalidate the current <code class="directive">ThreadStackSize</code> setting.</li> <li>On Linux, this directive can only be used to increase the default stack size, as the underlying system call uses the value as a <em>minimum</em> stack size. The (often large) soft limit for <code>ulimit -s</code> (8MB if unlimited) is used as the default stack size.</li> </ul> <div class="note">It is recommended to not reduce <code class="directive">ThreadStackSize</code> unless a high number of threads per child process is needed. On some platforms (including Linux), a setting of 128000 is already too low and causes crashes with some common modules.</div> </div>
<div class="_attribution">
  <p class="_attribution-p">
    Â© 2018 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://httpd.apache.org/docs/2.4/en/mod/mpm_common.html" class="_attribution-link">https://httpd.apache.org/docs/2.4/en/mod/mpm_common.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
