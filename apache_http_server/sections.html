
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Configuration Sections - Apache HTTP Server - W3cubDocs</title>
  
  <meta name="description" content="Directives in the configuration files may apply to the entire server, or they may be restricted to apply only to particular directories, files, &hellip;">
  <meta name="keywords" content="configuration, sections, apache, http, server, apache_http_server">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/apache_http_server/sections.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e498cd0ebe8746846fec95b1a53ab3bb0fb7f47f794f0a38f44c98a1f0d03b21d777ae2c583732e44a5a890f6eacb79a5333545db9d5f3616091ba21ca17d916.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/apache_http_server.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/apache_http_server/" class="_nav-link" title="" style="margin-left:0;">Apache HTTP Server</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _apache">
				
				
<h1>Configuration Sections</h1>  <p>Directives in the <a href="configuring">configuration files</a> may apply to the entire server, or they may be restricted to apply only to particular directories, files, hosts, or URLs. This document describes how to use configuration section containers or <code>.htaccess</code> files to change the scope of other configuration directives.</p>     <h2 id="types">Types of Configuration Section Containers</h2> <table class="related">
<tr>
<th>Related Modules</th>
<th>Related Directives</th>
</tr>
<tr>
<td><ul>
<li><code class="module"><a href="mod/core">core</a></code></li>
<li><code class="module"><a href="mod/mod_version">mod_version</a></code></li>
<li><code class="module"><a href="mod/mod_proxy">mod_proxy</a></code></li>
</ul></td>
<td><ul>
<li><code class="directive"><a href="mod/core#directory">&lt;Directory&gt;</a></code></li>
<li><code class="directive"><a href="mod/core#directorymatch">&lt;DirectoryMatch&gt;</a></code></li>
<li><code class="directive"><a href="mod/core#files">&lt;Files&gt;</a></code></li>
<li><code class="directive"><a href="mod/core#filesmatch">&lt;FilesMatch&gt;</a></code></li>
<li><code class="directive"><a href="mod/core#if">&lt;If&gt;</a></code></li>
<li><code class="directive"><a href="mod/core#ifdefine">&lt;IfDefine&gt;</a></code></li>
<li><code class="directive"><a href="mod/core#ifmodule">&lt;IfModule&gt;</a></code></li>
<li><code class="directive"><a href="mod/mod_version#ifversion">&lt;IfVersion&gt;</a></code></li>
<li><code class="directive"><a href="mod/core#location">&lt;Location&gt;</a></code></li>
<li><code class="directive"><a href="mod/core#locationmatch">&lt;LocationMatch&gt;</a></code></li>
<li><code class="directive"><a href="mod/mod_md#mdomainsetsection">&lt;MDomainSet&gt;</a></code></li>
<li><code class="directive"><a href="mod/mod_proxy#proxy">&lt;Proxy&gt;</a></code></li>
<li><code class="directive"><a href="mod/mod_proxy#proxymatch">&lt;ProxyMatch&gt;</a></code></li>
<li><code class="directive"><a href="mod/core#virtualhost">&lt;VirtualHost&gt;</a></code></li>
</ul></td>
</tr>
</table> <p>There are two basic types of containers. Most containers are evaluated for each request. The enclosed directives are applied only for those requests that match the containers. The <code class="directive"><a href="mod/core#ifdefine">&lt;IfDefine&gt;</a></code>, <code class="directive"><a href="mod/core#ifmodule">&lt;IfModule&gt;</a></code>, and <code class="directive"><a href="mod/mod_version#ifversion">&lt;IfVersion&gt;</a></code> containers, on the other hand, are evaluated only at server startup and restart. If their conditions are true at startup, then the enclosed directives will apply to all requests. If the conditions are not true, the enclosed directives will be ignored.</p> <p>The <code class="directive"><a href="mod/core#ifdefine">&lt;IfDefine&gt;</a></code> directive encloses directives that will only be applied if an appropriate parameter is defined on the <code class="program"><a href="programs/httpd">httpd</a></code> command line. For example, with the following configuration, all requests will be redirected to another site only if the server is started using <code>httpd -DClosedForNow</code>:</p> <pre class="prettyprint lang-config">&lt;IfDefine ClosedForNow&gt;
    Redirect "/" "http://otherserver.example.com/"
&lt;/IfDefine&gt;</pre> <p>The <code class="directive"><a href="mod/core#ifmodule">&lt;IfModule&gt;</a></code> directive is very similar, except it encloses directives that will only be applied if a particular module is available in the server. The module must either be statically compiled in the server, or it must be dynamically compiled and its <code class="directive"><a href="mod/mod_so#loadmodule">LoadModule</a></code> line must be earlier in the configuration file. This directive should only be used if you need your configuration file to work whether or not certain modules are installed. It should not be used to enclose directives that you want to work all the time, because it can suppress useful error messages about missing modules.</p> <p>In the following example, the <code class="directive"><a href="mod/mod_mime_magic#mimemagicfile">MimeMagicFile</a></code> directive will be applied only if <code class="module"><a href="mod/mod_mime_magic">mod_mime_magic</a></code> is available.</p> <pre class="prettyprint lang-config">&lt;IfModule mod_mime_magic.c&gt;
    MimeMagicFile "conf/magic"
&lt;/IfModule&gt;</pre> <p>The <code class="directive"><a href="mod/mod_version#ifversion">&lt;IfVersion&gt;</a></code> directive is very similar to <code class="directive"><a href="mod/core#ifdefine">&lt;IfDefine&gt;</a></code> and <code class="directive"><a href="mod/core#ifmodule">&lt;IfModule&gt;</a></code>, except it encloses directives that will only be applied if a particular version of the server is executing. This module is designed for the use in test suites and large networks which have to deal with different httpd versions and different configurations.</p> <pre class="prettyprint lang-config">&lt;IfVersion &gt;= 2.4&gt;
    # this happens only in versions greater or
    # equal 2.4.0.
&lt;/IfVersion&gt;</pre> <p><code class="directive"><a href="mod/core#ifdefine">&lt;IfDefine&gt;</a></code>, <code class="directive"><a href="mod/core#ifmodule">&lt;IfModule&gt;</a></code>, and the <code class="directive"><a href="mod/mod_version#ifversion">&lt;IfVersion&gt;</a></code> can apply negative conditions by preceding their test with "!". Also, these sections can be nested to achieve more complex restrictions.</p>   <h2 id="file-and-web">Filesystem, Webspace, and Boolean Expressions</h2> <p>The most commonly used configuration section containers are the ones that change the configuration of particular places in the filesystem or webspace. First, it is important to understand the difference between the two. The filesystem is the view of your disks as seen by your operating system. For example, in a default install, Apache httpd resides at <code>/usr/local/apache2</code> in the Unix filesystem or <code>"c:/Program Files/Apache Group/Apache2"</code> in the Windows filesystem. (Note that forward slashes should always be used as the path separator in Apache httpd configuration files, even for Windows.) In contrast, the webspace is the view of your site as delivered by the web server and seen by the client. So the path <code>/dir/</code> in the webspace corresponds to the path <code>/usr/local/apache2/htdocs/dir/</code> in the filesystem of a default Apache httpd install on Unix. The webspace need not map directly to the filesystem, since webpages may be generated dynamically from databases or other locations.</p> <h3><a name="filesystem" id="filesystem">Filesystem Containers</a></h3> <p>The <code class="directive"><a href="mod/core#directory">&lt;Directory&gt;</a></code> and <code class="directive"><a href="mod/core#files">&lt;Files&gt;</a></code> directives, along with their <a class="glossarylink" href="https://httpd.apache.org/docs/2.4/en/glossary.html#regex" title="see glossary">regex</a> counterparts, apply directives to parts of the filesystem. Directives enclosed in a <code class="directive"><a href="mod/core#directory">&lt;Directory&gt;</a></code> section apply to the named filesystem directory and all subdirectories of that directory (as well as the files in those directories). The same effect can be obtained using <a href="howto/htaccess">.htaccess files</a>. For example, in the following configuration, directory indexes will be enabled for the <code>/var/web/dir1</code> directory and all subdirectories.</p> <pre class="prettyprint lang-config">&lt;Directory "/var/web/dir1"&gt;
    Options +Indexes
&lt;/Directory&gt;</pre> <p>Directives enclosed in a <code class="directive"><a href="mod/core#files">&lt;Files&gt;</a></code> section apply to any file with the specified name, regardless of what directory it lies in. So for example, the following configuration directives will, when placed in the main section of the configuration file, deny access to any file named <code>private.html</code> regardless of where it is found.</p> <pre class="prettyprint lang-config">&lt;Files "private.html"&gt;
    Require all denied
&lt;/Files&gt;</pre> <p>To address files found in a particular part of the filesystem, the <code class="directive"><a href="mod/core#files">&lt;Files&gt;</a></code> and <code class="directive"><a href="mod/core#directory">&lt;Directory&gt;</a></code> sections can be combined. For example, the following configuration will deny access to <code>/var/web/dir1/private.html</code>, <code>/var/web/dir1/subdir2/private.html</code>, <code>/var/web/dir1/subdir3/private.html</code>, and any other instance of <code>private.html</code> found under the <code>/var/web/dir1/</code> directory.</p> <pre class="prettyprint lang-config">&lt;Directory "/var/web/dir1"&gt;
    &lt;Files "private.html"&gt;
        Require all denied
    &lt;/Files&gt;
&lt;/Directory&gt;</pre> <h3><a name="webspace" id="webspace">Webspace Containers</a></h3> <p>The <code class="directive"><a href="mod/core#location">&lt;Location&gt;</a></code> directive and its <a class="glossarylink" href="https://httpd.apache.org/docs/2.4/en/glossary.html#regex" title="see glossary">regex</a> counterpart, on the other hand, change the configuration for content in the webspace. For example, the following configuration prevents access to any URL-path that begins in /private. In particular, it will apply to requests for <code>http://yoursite.example.com/private</code>, <code>http://yoursite.example.com/private123</code>, and <code>http://yoursite.example.com/private/dir/file.html</code> as well as any other requests starting with the <code>/private</code> string.</p> <pre class="prettyprint lang-config">&lt;LocationMatch "^/private"&gt;
    Require all denied
&lt;/LocationMatch&gt;</pre> <p>The <code class="directive"><a href="mod/core#location">&lt;Location&gt;</a></code> directive need not have anything to do with the filesystem. For example, the following example shows how to map a particular URL to an internal Apache HTTP Server handler provided by <code class="module"><a href="mod/mod_status">mod_status</a></code>. No file called <code>server-status</code> needs to exist in the filesystem.</p> <pre class="prettyprint lang-config">&lt;Location "/server-status"&gt;
    SetHandler server-status
&lt;/Location&gt;</pre> <h3><a name="overlapping-webspace" id="overlapping-webspace">Overlapping Webspace</a></h3> <p>In order to have two overlapping URLs one has to consider the order in which certain sections or directives are evaluated. For <code class="directive"><a href="mod/core#location">&lt;Location&gt;</a></code> this would be:</p> <pre class="prettyprint lang-config">&lt;Location "/foo"&gt;
&lt;/Location&gt;
&lt;Location "/foo/bar"&gt;
&lt;/Location&gt;</pre> <p><code class="directive"><a href="mod/mod_alias#alias">&lt;Alias&gt;</a></code>es on the other hand, are mapped vice-versa:</p> <pre class="prettyprint lang-config">Alias "/foo/bar" "/srv/www/uncommon/bar"
Alias "/foo"     "/srv/www/common/foo"</pre> <p>The same is true for the <code class="directive"><a href="mod/mod_proxy#proxypass">ProxyPass</a></code> directives:</p> <pre class="prettyprint lang-config">ProxyPass "/special-area" "http://special.example.com" smax=5 max=10
ProxyPass "/" "balancer://mycluster/" stickysession=JSESSIONID|jsessionid nofailover=On</pre> <h3><a name="wildcards" id="wildcards">Wildcards and Regular Expressions</a></h3> <p>The <code class="directive"><a href="mod/core#directory">&lt;Directory&gt;</a></code>, <code class="directive"><a href="mod/core#files">&lt;Files&gt;</a></code>, and <code class="directive"><a href="mod/core#location">&lt;Location&gt;</a></code> directives can each use shell-style wildcard characters as in <code>fnmatch</code> from the C standard library. The character "*" matches any sequence of characters, "?" matches any single character, and "[<em>seq</em>]" matches any character in <em>seq</em>. The "/" character will not be matched by any wildcard; it must be specified explicitly.</p> <p>If even more flexible matching is required, each container has a regular expression (regex) counterpart <code class="directive"><a href="mod/core#directorymatch">&lt;DirectoryMatch&gt;</a></code>, <code class="directive"><a href="mod/core#filesmatch">&lt;FilesMatch&gt;</a></code>, and <code class="directive"><a href="mod/core#locationmatch">&lt;LocationMatch&gt;</a></code> that allow perl-compatible <a class="glossarylink" href="https://httpd.apache.org/docs/2.4/en/glossary.html#regex" title="see glossary">regular expressions</a> to be used in choosing the matches. But see the section below on configuration merging to find out how using regex sections will change how directives are applied.</p> <p>A non-regex wildcard section that changes the configuration of all user directories could look as follows:</p> <pre class="prettyprint lang-config">&lt;Directory "/home/*/public_html"&gt;
    Options Indexes
&lt;/Directory&gt;</pre> <p>Using regex sections, we can deny access to many types of image files at once:</p> <pre class="prettyprint lang-config">&lt;FilesMatch "\.(?i:gif|jpe?g|png)$"&gt;
    Require all denied
&lt;/FilesMatch&gt;</pre> <p>Regular expressions containing <strong>named groups and backreferences</strong> are added to the environment with the corresponding name in uppercase. This allows elements of filename paths and URLs to be referenced from within <a href="expr">expressions</a> and modules like <code class="module"><a href="mod/mod_rewrite">mod_rewrite</a></code>.</p> <pre class="prettyprint lang-config">&lt;DirectoryMatch "^/var/www/combined/(?&lt;SITENAME&gt;[^/]+)"&gt;
    require ldap-group "cn=%{env:MATCH_SITENAME},ou=combined,o=Example"
&lt;/DirectoryMatch&gt;</pre> <h3><a name="expressions" id="expressions">Boolean expressions</a></h3> <p>The <code class="directive"><a href="mod/core#if">&lt;If&gt;</a></code> directive change the configuration depending on a condition which can be expressed by a boolean expression. For example, the following configuration denies access if the HTTP Referer header does not start with "http://www.example.com/".</p> <pre class="prettyprint lang-config">&lt;If "!(%{HTTP_REFERER} -strmatch 'http://www.example.com/*')"&gt;
    Require all denied
&lt;/If&gt;</pre> <h3><a name="whichwhen" id="whichwhen">What to use When</a></h3> <p>Choosing between filesystem containers and webspace containers is actually quite easy. When applying directives to objects that reside in the filesystem always use <code class="directive"><a href="mod/core#directory">&lt;Directory&gt;</a></code> or <code class="directive"><a href="mod/core#files">&lt;Files&gt;</a></code>. When applying directives to objects that do not reside in the filesystem (such as a webpage generated from a database), use <code class="directive"><a href="mod/core#location">&lt;Location&gt;</a></code>.</p> <p>It is important to never use <code class="directive"><a href="mod/core#location">&lt;Location&gt;</a></code> when trying to restrict access to objects in the filesystem. This is because many different webspace locations (URLs) could map to the same filesystem location, allowing your restrictions to be circumvented. For example, consider the following configuration:</p> <pre class="prettyprint lang-config">&lt;Location "/dir/"&gt;
    Require all denied
&lt;/Location&gt;</pre> <p>This works fine if the request is for <code>http://yoursite.example.com/dir/</code>. But what if you are on a case-insensitive filesystem? Then your restriction could be easily circumvented by requesting <code>http://yoursite.example.com/DIR/</code>. The <code class="directive"><a href="mod/core#directory">&lt;Directory&gt;</a></code> directive, in contrast, will apply to any content served from that location, regardless of how it is called. (An exception is filesystem links. The same directory can be placed in more than one part of the filesystem using symbolic links. The <code class="directive"><a href="mod/core#directory">&lt;Directory&gt;</a></code> directive will follow the symbolic link without resetting the pathname. Therefore, for the highest level of security, symbolic links should be disabled with the appropriate <code class="directive"><a href="mod/core#options">Options</a></code> directive.)</p> <p>If you are, perhaps, thinking that none of this applies to you because you use a case-sensitive filesystem, remember that there are many other ways to map multiple webspace locations to the same filesystem location. Therefore you should always use the filesystem containers when you can. There is, however, one exception to this rule. Putting configuration restrictions in a <code>&lt;Location "/"&gt;</code> section is perfectly safe because this section will apply to all requests regardless of the specific URL.</p> <h3><a name="nesting" id="nesting">Nesting of sections</a></h3> <p>Some section types can be nested inside other section types. On the one hand, <code class="directive"><a href="mod/core#files">&lt;Files&gt;</a></code> can be used inside <code class="directive"><a href="mod/core#directory">&lt;Directory&gt;</a></code>. On the other hand, <code class="directive"><a href="mod/core#if">&lt;If&gt;</a></code> can be used inside <code class="directive"><a href="mod/core#directory">&lt;Directory&gt;</a></code>, <code class="directive"><a href="mod/core#location">&lt;Location&gt;</a></code>, and <code class="directive"><a href="mod/core#files">&lt;Files&gt;</a></code> sections (but not inside another <code class="directive"><a href="mod/core#if">&lt;If&gt;</a></code>). The regex counterparts of the named section behave identically.</p> <p>Nested sections are merged after non-nested sections of the same type.</p>   <h2 id="virtualhost">Virtual Hosts</h2> <p>The <code class="directive"><a href="mod/core#virtualhost">&lt;VirtualHost&gt;</a></code> container encloses directives that apply to specific hosts. This is useful when serving multiple hosts from the same machine with a different configuration for each. For more information, see the <a href="vhosts/index">Virtual Host Documentation</a>.</p>   <h2 id="proxy">Proxy</h2> <p>The <code class="directive"><a href="mod/mod_proxy#proxy">&lt;Proxy&gt;</a></code> and <code class="directive"><a href="mod/mod_proxy#proxymatch">&lt;ProxyMatch&gt;</a></code> containers apply enclosed configuration directives only to sites accessed through <code class="module"><a href="mod/mod_proxy">mod_proxy</a></code>'s proxy server that match the specified URL. For example, the following configuration will allow only a subset of clients to access the <code>www.example.com</code> website using the proxy server:</p> <pre class="prettyprint lang-config">&lt;Proxy "http://www.example.com/*"&gt;
    Require host yournetwork.example.com
&lt;/Proxy&gt;</pre>   <h2 id="whatwhere">What Directives are Allowed?</h2> <p>To find out what directives are allowed in what types of configuration sections, check the Context of the directive. Everything that is allowed in <code class="directive"><a href="mod/core#directory">&lt;Directory&gt;</a></code> sections is also syntactically allowed in <code class="directive"><a href="mod/core#directorymatch">&lt;DirectoryMatch&gt;</a></code>, <code class="directive"><a href="mod/core#files">&lt;Files&gt;</a></code>, <code class="directive"><a href="mod/core#filesmatch">&lt;FilesMatch&gt;</a></code>, <code class="directive"><a href="mod/core#location">&lt;Location&gt;</a></code>, <code class="directive"><a href="mod/core#locationmatch">&lt;LocationMatch&gt;</a></code>, <code class="directive"><a href="mod/mod_proxy#proxy">&lt;Proxy&gt;</a></code>, and <code class="directive"><a href="mod/mod_proxy#proxymatch">&lt;ProxyMatch&gt;</a></code> sections. There are some exceptions, however:</p> <ul> <li>The <code class="directive"><a href="mod/core#allowoverride">AllowOverride</a></code> directive works only in <code class="directive"><a href="mod/core#directory">&lt;Directory&gt;</a></code> sections.</li> <li>The <code>FollowSymLinks</code> and <code>SymLinksIfOwnerMatch</code> <code class="directive"><a href="mod/core#options">Options</a></code> work only in <code class="directive"><a href="mod/core#directory">&lt;Directory&gt;</a></code> sections or <code>.htaccess</code> files.</li> <li>The <code class="directive"><a href="mod/core#options">Options</a></code> directive cannot be used in <code class="directive"><a href="mod/core#files">&lt;Files&gt;</a></code> and <code class="directive"><a href="mod/core#filesmatch">&lt;FilesMatch&gt;</a></code> sections.</li> </ul>   <h2 id="merging">How the sections are merged</h2> <p>The configuration sections are applied in a very particular order. Since this can have important effects on how configuration directives are interpreted, it is important to understand how this works.</p> <p>The order of merging is:</p> <ol> <li> <code class="directive"><a href="mod/core#directory">&lt;Directory&gt;</a></code> (except regular expressions) and <code>.htaccess</code> done simultaneously (with <code>.htaccess</code>, if allowed, overriding <code class="directive"><a href="mod/core#directory">&lt;Directory&gt;</a></code>)</li> <li>
<code class="directive"><a href="mod/core#directorymatch">&lt;DirectoryMatch&gt;</a></code> (and <code>&lt;Directory "~"&gt;</code>)</li> <li>
<code class="directive"><a href="mod/core#files">&lt;Files&gt;</a></code> and <code class="directive"><a href="mod/core#filesmatch">&lt;FilesMatch&gt;</a></code> done simultaneously</li> <li>
<code class="directive"><a href="mod/core#location">&lt;Location&gt;</a></code> and <code class="directive"><a href="mod/core#locationmatch">&lt;LocationMatch&gt;</a></code> done simultaneously</li> <li>
<code class="directive"><a href="mod/core#if">&lt;If&gt;</a></code> </li> </ol> <p>Some important remarks:</p> <ul> <li>Apart from <code class="directive"><a href="mod/core#directory">&lt;Directory&gt;</a></code>, within each group the sections are processed in the order they appear in the configuration files. For example, a request for <em>/foo/bar</em> will match <code>&lt;Location "/foo/bar"&gt;</code> and <code>&lt;Location "/foo"&gt;</code> (group 4 in this case): both sections will be evaluated but in the order they appear in the configuration files.</li> <li>
<code class="directive"><a href="mod/core#directory">&lt;Directory&gt;</a></code> (group 1 above) is processed in the order shortest directory component to longest. For example, <code>&lt;Directory "/var/web/dir"&gt;</code> will be processed before <code>&lt;Directory "/var/web/dir/subdir"&gt;</code>.</li> <li>If multiple <code class="directive"><a href="mod/core#directory">&lt;Directory&gt;</a></code> sections apply to the same directory they are processed in the configuration file order.</li> <li>Configurations included via the <code class="directive"><a href="mod/core#include">Include</a></code> directive will be treated as if they were inside the including file at the location of the <code class="directive"><a href="mod/core#include">Include</a></code> directive.</li> <li>Sections inside <code class="directive"><a href="mod/core#virtualhost">&lt;VirtualHost&gt;</a></code> sections are applied <em>after</em> the corresponding sections outside the virtual host definition. This allows virtual hosts to override the main server configuration.</li> <li>When the request is served by <code class="module"><a href="mod/mod_proxy">mod_proxy</a></code>, the <code class="directive"><a href="mod/mod_proxy#proxy">&lt;Proxy&gt;</a></code> container takes the place of the <code class="directive"><a href="mod/core#directory">&lt;Directory&gt;</a></code> container in the processing order.</li> </ul> <div class="note">
<p><strong>Technical Note</strong></p> There is actually a <code>&lt;Location&gt;</code>/<code>&lt;LocationMatch&gt;</code> sequence performed just before the name translation phase (where <code>Aliases</code> and <code>DocumentRoots</code> are used to map URLs to filenames). The results of this sequence are completely thrown away after the translation has completed. </div> <h3><a name="relationship-module-configuration" id="relationship-module-configuration">Relationship between modules and configuration sections</a></h3> <p>One question that often arises after reading how configuration sections are merged is related to how and when directives of specific modules like <code class="module"><a href="mod/mod_rewrite">mod_rewrite</a></code> are processed. The answer is not trivial and needs a bit of background. Each httpd module manages its own configuration, and each of its directives in httpd.conf specify one piece of configuration in a particular context. httpd does not execute a command as it is read.</p> <p>At runtime, the core of httpd iterates over the defined configuration sections in the order described above to determine which ones apply to the current request. When the first section matches, it is considered the current configuration for this request. If a subsequent section matches too, then each module with a directive in either of the sections is given a chance to merge its configuration between the two sections. The result is a third configuration, and the process goes on until all the configuration sections are evaluated.</p> <p>After the above step, the "real" processing of the HTTP request begins: each module has a chance to run and perform whatever tasks they like. They can retrieve their own final merged configuration from the core of the httpd to determine how they should act.</p> <p>An example can help to visualize the whole process. The following configuration uses the <code class="directive"><a href="mod/mod_headers#header">Header</a></code> directive of <code class="module"><a href="mod/mod_headers">mod_headers</a></code> to set a specific HTTP header. What value will httpd set in the <code>CustomHeaderName</code> header for a request to <code>/example/index.html</code> ? </p> <pre class="prettyprint lang-config">&lt;Directory "/"&gt;
    Header set CustomHeaderName one
    &lt;FilesMatch ".*"&gt;
        Header set CustomHeaderName three
    &lt;/FilesMatch&gt;
&lt;/Directory&gt;

&lt;Directory "/example"&gt;
    Header set CustomHeaderName two
&lt;/Directory&gt;</pre> <ul> <li>
<code class="directive">Directory</code> "/" matches and an initial configuration to set the <code>CustomHeaderName</code> header with the value <code>one</code> is created.</li> <li>
<code class="directive">Directory</code> "/example" matches, and since <code class="module"><a href="mod/mod_headers">mod_headers</a></code> specifies in its code to override in case of a merge, a new configuration is created to set the <code>CustomHeaderName</code> header with the value <code>two</code>.</li> <li>
<code class="directive">FilesMatch</code> ".*" matches and another merge opportunity arises, causing the <code>CustomHeaderName</code> header to be set with the value <code>three</code>.</li> <li>Eventually during the next steps of the HTTP request processing <code class="module"><a href="mod/mod_headers">mod_headers</a></code> will be called and it will receive the configuration to set the <code>CustomHeaderName</code> header with the value <code>three</code>. <code class="module"><a href="mod/mod_headers">mod_headers</a></code> normally uses this configuration to perfom its job, namely setting the foo header. This does not mean that a module can't perform a more complex action like discarding directives because not needed or deprecated, etc..</li> </ul> <p>This is true for .htaccess too since they have the same priority as <code class="directive">Directory</code> in the merge order. The important concept to understand is that configuration sections like <code class="directive">Directory</code> and <code class="directive">FilesMatch</code> are not comparable to module specific directives like <code class="directive"><a href="mod/mod_headers#header">Header</a></code> or <code class="directive"><a href="mod/mod_rewrite#rewriterule">RewriteRule</a></code> because they operate on different levels. </p> <h3><a name="merge-examples" id="merge-examples">Some useful examples</a></h3> <p>Below is an artificial example to show the order of merging. Assuming they all apply to the request, the directives in this example will be applied in the order A &gt; B &gt; C &gt; D &gt; E.</p> <pre class="prettyprint lang-config">&lt;Location "/"&gt;
    E
&lt;/Location&gt;

&lt;Files "f.html"&gt;
    D
&lt;/Files&gt;

&lt;VirtualHost *&gt;
    &lt;Directory "/a/b"&gt;
        B
    &lt;/Directory&gt;
&lt;/VirtualHost&gt;

&lt;DirectoryMatch "^.*b$"&gt;
    C
&lt;/DirectoryMatch&gt;

&lt;Directory "/a/b"&gt;
    A
&lt;/Directory&gt;</pre> <p>For a more concrete example, consider the following. Regardless of any access restrictions placed in <code class="directive"><a href="mod/core#directory">&lt;Directory&gt;</a></code> sections, the <code class="directive"><a href="mod/core#location">&lt;Location&gt;</a></code> section will be evaluated last and will allow unrestricted access to the server. In other words, order of merging is important, so be careful!</p> <pre class="prettyprint lang-config">&lt;Location "/"&gt;
    Require all granted
&lt;/Location&gt;

# Whoops!  This &lt;Directory&gt; section will have no effect
&lt;Directory "/"&gt;
    &lt;RequireAll&gt;
        Require all granted
        Require not host badguy.example.com
    &lt;/RequireAll&gt;
&lt;/Directory&gt;</pre>
<div class="_attribution">
  <p class="_attribution-p">
    Â© 2018 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://httpd.apache.org/docs/2.4/en/sections.html" class="_attribution-link">https://httpd.apache.org/docs/2.4/en/sections.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
